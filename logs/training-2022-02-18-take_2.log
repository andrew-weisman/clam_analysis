Started: Fri Feb 18 23:33:21 EST 2022
[+] Loading zlib 1.2.11  ... 
[+] Loading gcc  10.2.0  ... 
[+] Loading libpng 1.6.37  ... 
[+] Loading libjpeg-turbo 2.0.6  ... 
[-] Unloading gcc  10.2.0  ... 
[+] Loading gcc  7.2.0  ... 
[+] Loading libtiff libraries v 4.0.9  ... 
[+] Loading openjpeg  2.3.1  ... 
[+] Loading SQLite 3.34.1  for gcc 4.8.5  ... 

Load Dataset
label column: label
label dictionary: {'pole': 0, 'msi': 1, 'lcn': 2, 'p53': 3}
number of classes: 4
slide-level counts:  
 0    20
1    18
2    16
3    17
Name: label, dtype: int64
Patient-LVL; Number of samples registered in class 0: 20
Slide-LVL; Number of samples registered in class 0: 20
Patient-LVL; Number of samples registered in class 1: 18
Slide-LVL; Number of samples registered in class 1: 18
Patient-LVL; Number of samples registered in class 2: 16
Slide-LVL; Number of samples registered in class 2: 16
Patient-LVL; Number of samples registered in class 3: 17
Slide-LVL; Number of samples registered in class 3: 17
split_dir:  splits/idibell_100
################# Settings ###################
num_splits:  10
k_start:  -1
k_end:  -1
task:  idibell
max_epochs:  200
results_dir:  /home/weismanal/projects/idibell/repo/results/bwh_resection/training
lr:  0.0002
experiment:  2022-02-18-take_2
reg:  1e-05
label_frac:  1.0
bag_loss:  ce
seed:  1
model_type:  clam_sb
model_size:  small
use_drop_out:  True
weighted_sample:  True
opt:  adam
bag_weight:  0.7
inst_loss:  svm
B:  8
split_dir:  splits/idibell_100

Training Fold 0!

Init train/val/test splits... 
Done!
Training on 49 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 2.0484, instance_loss: 1.0867, weighted_loss: 1.7599, label: 1, bag_size: 132271
batch 39, loss: 1.9933, instance_loss: 0.9284, weighted_loss: 1.6738, label: 1, bag_size: 47433


class 0 clustering acc 0.9170918367346939: correct 1438/1568
class 1 clustering acc 0.14030612244897958: correct 55/392
Epoch: 0, train_loss: 1.4484, train_clustering_loss:  1.0155, train_error: 0.6939
class 0: acc 0.0, correct 0/11
class 1: acc 0.0, correct 0/10
class 2: acc 0.0, correct 0/12
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.4085, val_error: 0.7273, auc: 0.6528
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.408508).  Saving model ...


batch 19, loss: 1.2711, instance_loss: 0.7734, weighted_loss: 1.1218, label: 1, bag_size: 66789
batch 39, loss: 1.1124, instance_loss: 0.6994, weighted_loss: 0.9885, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 1, train_loss: 1.3550, train_clustering_loss:  0.7745, train_error: 0.6735
class 0: acc 0.0, correct 0/7
class 1: acc 0.4, correct 8/20
class 2: acc 0.0, correct 0/9
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.4150, val_error: 0.7273, auc: 0.4861
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6969, instance_loss: 0.6881, weighted_loss: 1.3942, label: 2, bag_size: 149988
batch 39, loss: 1.3267, instance_loss: 0.5943, weighted_loss: 1.1070, label: 3, bag_size: 4963


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 2, train_loss: 1.4510, train_clustering_loss:  0.6525, train_error: 0.8367
class 0: acc 0.0, correct 0/10
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.14285714285714285, correct 2/14
class 3: acc 0.0, correct 0/14

Val Set, val_loss: 1.4028, val_error: 0.8182, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.408508 --> 1.402776).  Saving model ...


batch 19, loss: 1.4826, instance_loss: 0.6540, weighted_loss: 1.2340, label: 2, bag_size: 176020
batch 39, loss: 1.4098, instance_loss: 0.6340, weighted_loss: 1.1770, label: 2, bag_size: 158432


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 3, train_loss: 1.3833, train_clustering_loss:  0.6145, train_error: 0.7551
class 0: acc 0.0, correct 0/11
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.0625, correct 1/16
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.4212, val_error: 0.8182, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6964, instance_loss: 0.6174, weighted_loss: 1.3727, label: 1, bag_size: 47433
batch 39, loss: 1.0892, instance_loss: 0.5813, weighted_loss: 0.9368, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 4, train_loss: 1.3814, train_clustering_loss:  0.6011, train_error: 0.7143
class 0: acc 0.0, correct 0/4
class 1: acc 0.0625, correct 1/16
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.2, correct 3/15

Val Set, val_loss: 1.4420, val_error: 0.7273, auc: 0.6875
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1040, instance_loss: 0.5986, weighted_loss: 0.9524, label: 1, bag_size: 16373
batch 39, loss: 1.3363, instance_loss: 0.5788, weighted_loss: 1.1090, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 5, train_loss: 1.3862, train_clustering_loss:  0.6095, train_error: 0.7143
class 0: acc 0.17647058823529413, correct 3/17
class 1: acc 0.35714285714285715, correct 5/14
class 2: acc 0.0, correct 0/5
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.3574, val_error: 0.7273, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.402776 --> 1.357440).  Saving model ...


batch 19, loss: 1.3539, instance_loss: 0.5675, weighted_loss: 1.1180, label: 3, bag_size: 152150
batch 39, loss: 1.0959, instance_loss: 0.6005, weighted_loss: 0.9473, label: 0, bag_size: 19277


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 6, train_loss: 1.3617, train_clustering_loss:  0.6090, train_error: 0.6327
class 0: acc 1.0, correct 16/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.0, correct 0/13
class 3: acc 0.125, correct 1/8

Val Set, val_loss: 1.3667, val_error: 0.7273, auc: 0.7361
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4617, instance_loss: 0.6098, weighted_loss: 1.2061, label: 2, bag_size: 22416
batch 39, loss: 1.6595, instance_loss: 0.5973, weighted_loss: 1.3408, label: 3, bag_size: 196107


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 7, train_loss: 1.3273, train_clustering_loss:  0.6048, train_error: 0.6531
class 0: acc 1.0, correct 15/15
class 1: acc 0.0, correct 0/11
class 2: acc 0.14285714285714285, correct 2/14
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3792, val_error: 0.6364, auc: 0.7396
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4379, instance_loss: 0.6229, weighted_loss: 1.1934, label: 1, bag_size: 58270
batch 39, loss: 1.5706, instance_loss: 0.6360, weighted_loss: 1.2902, label: 3, bag_size: 4963


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 8, train_loss: 1.3371, train_clustering_loss:  0.6020, train_error: 0.6735
class 0: acc 0.4, correct 4/10
class 1: acc 0.0, correct 0/11
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.3783, val_error: 0.8182, auc: 0.6875
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.4067, instance_loss: 0.6271, weighted_loss: 1.1728, label: 3, bag_size: 56291
batch 39, loss: 1.4383, instance_loss: 0.6226, weighted_loss: 1.1936, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 9, train_loss: 1.3107, train_clustering_loss:  0.5989, train_error: 0.6327
class 0: acc 0.0, correct 0/10
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.9375, correct 15/16
class 3: acc 0.18181818181818182, correct 2/11

Val Set, val_loss: 1.3680, val_error: 0.7273, auc: 0.6875
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.5585, instance_loss: 0.6157, weighted_loss: 1.2757, label: 1, bag_size: 66789
batch 39, loss: 1.8185, instance_loss: 0.6501, weighted_loss: 1.4680, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 10, train_loss: 1.2695, train_clustering_loss:  0.5990, train_error: 0.6531
class 0: acc 0.0, correct 0/8
class 1: acc 0.4117647058823529, correct 7/17
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.0, correct 0/12

Val Set, val_loss: 1.3884, val_error: 0.7273, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.0477, instance_loss: 0.5940, weighted_loss: 0.9116, label: 1, bag_size: 69073
batch 39, loss: 1.0613, instance_loss: 0.5344, weighted_loss: 0.9033, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 11, train_loss: 1.2950, train_clustering_loss:  0.5928, train_error: 0.5918
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.07142857142857142, correct 1/14
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3726, val_error: 0.6364, auc: 0.5694
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.8753, instance_loss: 0.6092, weighted_loss: 0.7954, label: 0, bag_size: 41829
batch 39, loss: 1.1849, instance_loss: 0.5349, weighted_loss: 0.9899, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 12, train_loss: 1.2377, train_clustering_loss:  0.5901, train_error: 0.4694
class 0: acc 0.625, correct 10/16
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.4, correct 4/10
class 3: acc 0.42857142857142855, correct 6/14

Val Set, val_loss: 1.4157, val_error: 0.8182, auc: 0.5000
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.1715, instance_loss: 0.5560, weighted_loss: 0.9869, label: 3, bag_size: 56291
batch 39, loss: 1.1645, instance_loss: 0.5555, weighted_loss: 0.9818, label: 2, bag_size: 22416


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 13, train_loss: 1.2887, train_clustering_loss:  0.5897, train_error: 0.6531
class 0: acc 0.25, correct 2/8
class 1: acc 0.3076923076923077, correct 4/13
class 2: acc 0.42857142857142855, correct 6/14
class 3: acc 0.35714285714285715, correct 5/14

Val Set, val_loss: 1.4330, val_error: 0.5455, auc: 0.5347
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.3111, instance_loss: 0.6158, weighted_loss: 1.1026, label: 0, bag_size: 19277
batch 39, loss: 1.2514, instance_loss: 0.6042, weighted_loss: 1.0572, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 14, train_loss: 1.1804, train_clustering_loss:  0.5851, train_error: 0.5102
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.2857142857142857, correct 4/14
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.5625, correct 9/16

Val Set, val_loss: 1.4216, val_error: 0.7273, auc: 0.5625
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.7776, instance_loss: 0.5794, weighted_loss: 0.7181, label: 1, bag_size: 104549
batch 39, loss: 0.8787, instance_loss: 0.5321, weighted_loss: 0.7747, label: 3, bag_size: 152150


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 15, train_loss: 1.1119, train_clustering_loss:  0.5652, train_error: 0.4898
class 0: acc 0.0, correct 0/7
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.07142857142857142, correct 1/14
class 3: acc 0.8947368421052632, correct 17/19

Val Set, val_loss: 1.5324, val_error: 0.9091, auc: 0.4306
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.4166, instance_loss: 0.6622, weighted_loss: 1.1903, label: 2, bag_size: 149988
batch 39, loss: 0.9760, instance_loss: 0.6089, weighted_loss: 0.8659, label: 2, bag_size: 149988


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 16, train_loss: 1.1402, train_clustering_loss:  0.5832, train_error: 0.4082
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.5158, val_error: 0.9091, auc: 0.4306
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.5889, instance_loss: 0.5410, weighted_loss: 0.5745, label: 0, bag_size: 18551
batch 39, loss: 0.4874, instance_loss: 0.4115, weighted_loss: 0.4647, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 17, train_loss: 1.0798, train_clustering_loss:  0.5727, train_error: 0.4490
class 0: acc 0.35714285714285715, correct 5/14
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.8947368421052632, correct 17/19
class 3: acc 0.42857142857142855, correct 3/7

Val Set, val_loss: 1.5160, val_error: 0.8182, auc: 0.5417
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.6610, instance_loss: 0.5379, weighted_loss: 0.6240, label: 1, bag_size: 20030
batch 39, loss: 1.1040, instance_loss: 0.5228, weighted_loss: 0.9297, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 18, train_loss: 1.0849, train_clustering_loss:  0.5682, train_error: 0.4490
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.18181818181818182, correct 2/11

Val Set, val_loss: 1.5339, val_error: 0.9091, auc: 0.5312
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.9118, instance_loss: 0.5608, weighted_loss: 0.8065, label: 1, bag_size: 20030
batch 39, loss: 0.8895, instance_loss: 0.5190, weighted_loss: 0.7784, label: 3, bag_size: 262536


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 19, train_loss: 0.9722, train_clustering_loss:  0.5519, train_error: 0.3469
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5625, correct 9/16
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.4725, val_error: 0.8182, auc: 0.5590
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.7041, instance_loss: 0.5070, weighted_loss: 0.6450, label: 1, bag_size: 58270
batch 39, loss: 0.7960, instance_loss: 0.4985, weighted_loss: 0.7067, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 20, train_loss: 0.9234, train_clustering_loss:  0.5268, train_error: 0.3061
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.85, correct 17/20
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.5376, val_error: 0.7273, auc: 0.5729
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.1408, instance_loss: 0.3033, weighted_loss: 0.1896, label: 3, bag_size: 181076
batch 39, loss: 1.8169, instance_loss: 0.6097, weighted_loss: 1.4547, label: 1, bag_size: 445537


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.00510204081632653: correct 2/392
Epoch: 21, train_loss: 0.8953, train_clustering_loss:  0.5165, train_error: 0.2857
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.5010, val_error: 0.8182, auc: 0.5660
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.6528, instance_loss: 0.5812, weighted_loss: 1.3313, label: 1, bag_size: 77634
batch 39, loss: 0.5554, instance_loss: 0.4730, weighted_loss: 0.5307, label: 2, bag_size: 22416


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.002551020408163265: correct 1/392
Epoch: 22, train_loss: 0.9202, train_clustering_loss:  0.5103, train_error: 0.2653
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.4, correct 4/10
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.4405, val_error: 0.6364, auc: 0.5660
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 2.2997, instance_loss: 0.7386, weighted_loss: 1.8313, label: 3, bag_size: 28883
batch 39, loss: 0.7103, instance_loss: 0.4891, weighted_loss: 0.6440, label: 2, bag_size: 163352


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.002551020408163265: correct 1/392
Epoch: 23, train_loss: 0.9529, train_clustering_loss:  0.5328, train_error: 0.2857
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.4022, val_error: 0.6364, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.1331, instance_loss: 0.2516, weighted_loss: 0.1687, label: 3, bag_size: 181076
batch 39, loss: 0.4912, instance_loss: 0.4662, weighted_loss: 0.4837, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.017857142857142856: correct 7/392
Epoch: 24, train_loss: 0.7050, train_clustering_loss:  0.4735, train_error: 0.2653
class 0: acc 0.8125, correct 13/16
class 1: acc 0.5, correct 4/8
class 2: acc 0.75, correct 12/16
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.5274, val_error: 0.6364, auc: 0.5938
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2690, instance_loss: 0.3626, weighted_loss: 0.2971, label: 2, bag_size: 149988
batch 39, loss: 0.4680, instance_loss: 0.4503, weighted_loss: 0.4627, label: 2, bag_size: 176020


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 25, train_loss: 0.8590, train_clustering_loss:  0.5092, train_error: 0.3469
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.5062, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 1.4463, instance_loss: 0.5955, weighted_loss: 1.1911, label: 2, bag_size: 17501
batch 39, loss: 1.8658, instance_loss: 0.7397, weighted_loss: 1.5280, label: 3, bag_size: 28883


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.01020408163265306: correct 4/392
Epoch: 26, train_loss: 0.7547, train_clustering_loss:  0.4833, train_error: 0.2449
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 0.875, correct 7/8
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.6663, val_error: 0.8182, auc: 0.5278
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.7222, instance_loss: 0.7475, weighted_loss: 1.4298, label: 1, bag_size: 104549
batch 39, loss: 0.4221, instance_loss: 0.3502, weighted_loss: 0.4005, label: 3, bag_size: 240896


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.04846938775510204: correct 19/392
Epoch: 27, train_loss: 0.7887, train_clustering_loss:  0.4729, train_error: 0.2857
class 0: acc 0.75, correct 9/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 1.0, correct 12/12
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.4601, val_error: 0.7273, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.4031, instance_loss: 0.4025, weighted_loss: 0.4029, label: 1, bag_size: 104549
batch 39, loss: 0.5040, instance_loss: 0.4285, weighted_loss: 0.4814, label: 1, bag_size: 132271


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.015306122448979591: correct 6/392
Epoch: 28, train_loss: 0.7772, train_clustering_loss:  0.4867, train_error: 0.3061
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.5396, val_error: 0.7273, auc: 0.5660
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.1205, instance_loss: 0.2910, weighted_loss: 0.1716, label: 0, bag_size: 41829
batch 39, loss: 1.0126, instance_loss: 0.8172, weighted_loss: 0.9540, label: 3, bag_size: 56291


class 0 clustering acc 0.9955357142857143: correct 1561/1568
class 1 clustering acc 0.09693877551020408: correct 38/392
Epoch: 29, train_loss: 0.5892, train_clustering_loss:  0.4305, train_error: 0.1837
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.5, correct 3/6
class 2: acc 1.0, correct 16/16
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.5723, val_error: 0.7273, auc: 0.5660
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.5967, instance_loss: 0.4052, weighted_loss: 0.5393, label: 2, bag_size: 54449
batch 39, loss: 0.2046, instance_loss: 0.2499, weighted_loss: 0.2182, label: 2, bag_size: 278757


class 0 clustering acc 0.9929846938775511: correct 1557/1568
class 1 clustering acc 0.1326530612244898: correct 52/392
Epoch: 30, train_loss: 0.6249, train_clustering_loss:  0.4302, train_error: 0.1633
class 0: acc 1.0, correct 15/15
class 1: acc 0.75, correct 9/12
class 2: acc 1.0, correct 13/13
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.3922, val_error: 0.5455, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.4643, instance_loss: 0.4421, weighted_loss: 0.4577, label: 1, bag_size: 132271
batch 39, loss: 0.3319, instance_loss: 0.3370, weighted_loss: 0.3334, label: 0, bag_size: 19277


class 0 clustering acc 0.9929846938775511: correct 1557/1568
class 1 clustering acc 0.04081632653061224: correct 16/392
Epoch: 31, train_loss: 0.6625, train_clustering_loss:  0.4578, train_error: 0.2449
class 0: acc 0.875, correct 14/16
class 1: acc 0.7368421052631579, correct 14/19
class 2: acc 1.0, correct 6/6
class 3: acc 0.375, correct 3/8

Val Set, val_loss: 1.5224, val_error: 0.7273, auc: 0.6007
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.2897, instance_loss: 0.3678, weighted_loss: 0.3131, label: 3, bag_size: 240896
batch 39, loss: 0.2512, instance_loss: 0.2152, weighted_loss: 0.2404, label: 2, bag_size: 525276


class 0 clustering acc 0.9948979591836735: correct 1560/1568
class 1 clustering acc 0.1836734693877551: correct 72/392
Epoch: 32, train_loss: 0.6136, train_clustering_loss:  0.4215, train_error: 0.2449
class 0: acc 0.5, correct 4/8
class 1: acc 1.0, correct 10/10
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.5650, val_error: 0.8182, auc: 0.5903
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.4793, instance_loss: 0.4693, weighted_loss: 0.4763, label: 0, bag_size: 22124
batch 39, loss: 0.4415, instance_loss: 0.2864, weighted_loss: 0.3950, label: 3, bag_size: 196107


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.2423469387755102: correct 95/392
Epoch: 33, train_loss: 0.4373, train_clustering_loss:  0.3704, train_error: 0.1020
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 14/14
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.3703, val_error: 0.5455, auc: 0.6910
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 1.2372, instance_loss: 0.4738, weighted_loss: 1.0081, label: 1, bag_size: 18329
batch 39, loss: 0.4076, instance_loss: 0.4358, weighted_loss: 0.4161, label: 1, bag_size: 66789


class 0 clustering acc 0.9942602040816326: correct 1559/1568
class 1 clustering acc 0.20918367346938777: correct 82/392
Epoch: 34, train_loss: 0.4468, train_clustering_loss:  0.3774, train_error: 0.1429
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.3991, val_error: 0.4545, auc: 0.6910
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.1799, instance_loss: 0.3202, weighted_loss: 0.2220, label: 3, bag_size: 196107
batch 39, loss: 1.0266, instance_loss: 0.5437, weighted_loss: 0.8817, label: 0, bag_size: 13999


class 0 clustering acc 0.9866071428571429: correct 1547/1568
class 1 clustering acc 0.29846938775510207: correct 117/392
Epoch: 35, train_loss: 0.4697, train_clustering_loss:  0.3757, train_error: 0.1837
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 1.0, correct 12/12
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.4706, val_error: 0.5455, auc: 0.6736
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.2262, instance_loss: 0.2349, weighted_loss: 0.2288, label: 0, bag_size: 46742
batch 39, loss: 0.0799, instance_loss: 0.1841, weighted_loss: 0.1111, label: 3, bag_size: 99257


class 0 clustering acc 0.9776785714285714: correct 1533/1568
class 1 clustering acc 0.288265306122449: correct 113/392
Epoch: 36, train_loss: 0.7338, train_clustering_loss:  0.4469, train_error: 0.3265
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.4174, val_error: 0.7273, auc: 0.7014
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.1699, instance_loss: 0.2126, weighted_loss: 0.1827, label: 2, bag_size: 17501
batch 39, loss: 3.0975, instance_loss: 1.0412, weighted_loss: 2.4806, label: 1, bag_size: 445537


class 0 clustering acc 0.9783163265306123: correct 1534/1568
class 1 clustering acc 0.23979591836734693: correct 94/392
Epoch: 37, train_loss: 0.6346, train_clustering_loss:  0.4202, train_error: 0.1837
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.75, correct 9/12
class 2: acc 1.0, correct 12/12
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.4923, val_error: 0.6364, auc: 0.6458
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 1.4372, instance_loss: 0.6525, weighted_loss: 1.2018, label: 0, bag_size: 13999
batch 39, loss: 0.2333, instance_loss: 0.2211, weighted_loss: 0.2296, label: 2, bag_size: 23349


class 0 clustering acc 0.9878826530612245: correct 1549/1568
class 1 clustering acc 0.2066326530612245: correct 81/392
Epoch: 38, train_loss: 0.5246, train_clustering_loss:  0.3950, train_error: 0.1837
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.8, correct 8/10
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.5495, val_error: 0.8182, auc: 0.6875
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.1932, instance_loss: 0.2422, weighted_loss: 0.2079, label: 2, bag_size: 17501
batch 39, loss: 0.0752, instance_loss: 0.1957, weighted_loss: 0.1113, label: 0, bag_size: 222326


class 0 clustering acc 0.9955357142857143: correct 1561/1568
class 1 clustering acc 0.2857142857142857: correct 112/392
Epoch: 39, train_loss: 0.4810, train_clustering_loss:  0.3801, train_error: 0.1633
class 0: acc 0.8, correct 8/10
class 1: acc 0.7, correct 7/10
class 2: acc 0.9411764705882353, correct 16/17
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.3829, val_error: 0.5455, auc: 0.6944
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.1311, instance_loss: 0.1818, weighted_loss: 0.1463, label: 3, bag_size: 99257
batch 39, loss: 0.4626, instance_loss: 0.4371, weighted_loss: 0.4550, label: 3, bag_size: 262536


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.3903061224489796: correct 153/392
Epoch: 40, train_loss: 0.3648, train_clustering_loss:  0.3336, train_error: 0.0612
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 1.0, correct 8/8
class 2: acc 1.0, correct 14/14
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.3244, val_error: 0.6364, auc: 0.6944
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.357440 --> 1.324441).  Saving model ...


batch 19, loss: 0.7363, instance_loss: 0.9933, weighted_loss: 0.8134, label: 3, bag_size: 56291
batch 39, loss: 0.5797, instance_loss: 0.5129, weighted_loss: 0.5597, label: 3, bag_size: 4963


class 0 clustering acc 0.982780612244898: correct 1541/1568
class 1 clustering acc 0.34183673469387754: correct 134/392
Epoch: 41, train_loss: 0.5005, train_clustering_loss:  0.3971, train_error: 0.1429
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8235294117647058, correct 14/17
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.4540, val_error: 0.7273, auc: 0.6736
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1428, instance_loss: 0.2045, weighted_loss: 0.1613, label: 1, bag_size: 69073
batch 39, loss: 0.1150, instance_loss: 0.2196, weighted_loss: 0.1464, label: 0, bag_size: 6353


class 0 clustering acc 0.9878826530612245: correct 1549/1568
class 1 clustering acc 0.5637755102040817: correct 221/392
Epoch: 42, train_loss: 0.3315, train_clustering_loss:  0.2912, train_error: 0.0612
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 19/19
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.5310, val_error: 0.5455, auc: 0.6389
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1518, instance_loss: 0.1583, weighted_loss: 0.1538, label: 2, bag_size: 22416
batch 39, loss: 0.4722, instance_loss: 0.4831, weighted_loss: 0.4755, label: 3, bag_size: 262536


class 0 clustering acc 0.9853316326530612: correct 1545/1568
class 1 clustering acc 0.6020408163265306: correct 236/392
Epoch: 43, train_loss: 0.3794, train_clustering_loss:  0.3137, train_error: 0.1020
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 11/11
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.5497, val_error: 0.6364, auc: 0.7118
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4028, instance_loss: 0.2774, weighted_loss: 0.3652, label: 1, bag_size: 23122
batch 39, loss: 0.4107, instance_loss: 0.3612, weighted_loss: 0.3959, label: 1, bag_size: 66789


class 0 clustering acc 0.9815051020408163: correct 1539/1568
class 1 clustering acc 0.5943877551020408: correct 233/392
Epoch: 44, train_loss: 0.3070, train_clustering_loss:  0.2978, train_error: 0.0816
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 16/16
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.4675, val_error: 0.4545, auc: 0.7118
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1620, instance_loss: 0.3395, weighted_loss: 0.2152, label: 3, bag_size: 262536
batch 39, loss: 0.2194, instance_loss: 0.3028, weighted_loss: 0.2444, label: 3, bag_size: 262536


class 0 clustering acc 0.9642857142857143: correct 1512/1568
class 1 clustering acc 0.2627551020408163: correct 103/392
Epoch: 45, train_loss: 0.8372, train_clustering_loss:  0.4949, train_error: 0.3265
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.7, correct 7/10
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.6863, val_error: 0.7273, auc: 0.6806
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.2395, instance_loss: 0.2692, weighted_loss: 0.2484, label: 1, bag_size: 69073
batch 39, loss: 0.3637, instance_loss: 0.3096, weighted_loss: 0.3475, label: 1, bag_size: 66789


class 0 clustering acc 0.9866071428571429: correct 1547/1568
class 1 clustering acc 0.4030612244897959: correct 158/392
Epoch: 46, train_loss: 0.7344, train_clustering_loss:  0.4213, train_error: 0.3469
class 0: acc 0.6, correct 9/15
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.7, correct 7/10
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.6200, val_error: 0.4545, auc: 0.6215
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.2046, instance_loss: 0.2383, weighted_loss: 0.2147, label: 1, bag_size: 20030
batch 39, loss: 0.1015, instance_loss: 0.2274, weighted_loss: 0.1393, label: 0, bag_size: 59350


class 0 clustering acc 0.9834183673469388: correct 1542/1568
class 1 clustering acc 0.1913265306122449: correct 75/392
Epoch: 47, train_loss: 0.7914, train_clustering_loss:  0.4660, train_error: 0.2857
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.7, correct 7/10
class 3: acc 0.75, correct 12/16

Val Set, val_loss: 1.7418, val_error: 0.6364, auc: 0.5833
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.4305, instance_loss: 0.4562, weighted_loss: 0.4382, label: 1, bag_size: 20030
batch 39, loss: 0.1932, instance_loss: 0.2370, weighted_loss: 0.2063, label: 2, bag_size: 149988


class 0 clustering acc 0.9929846938775511: correct 1557/1568
class 1 clustering acc 0.4413265306122449: correct 173/392
Epoch: 48, train_loss: 0.3897, train_clustering_loss:  0.3216, train_error: 0.1224
class 0: acc 1.0, correct 8/8
class 1: acc 0.8235294117647058, correct 14/17
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.5633, val_error: 0.7273, auc: 0.7014
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.7780, instance_loss: 0.5417, weighted_loss: 0.7071, label: 2, bag_size: 54449
batch 39, loss: 0.1754, instance_loss: 0.2409, weighted_loss: 0.1950, label: 3, bag_size: 48489


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.4744897959183674: correct 186/392
Epoch: 49, train_loss: 0.3412, train_clustering_loss:  0.3222, train_error: 0.0612
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.875, correct 7/8
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.5871, val_error: 0.6364, auc: 0.6632
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0555, instance_loss: 0.1801, weighted_loss: 0.0929, label: 0, bag_size: 41829
batch 39, loss: 0.1055, instance_loss: 0.1827, weighted_loss: 0.1287, label: 2, bag_size: 103108


class 0 clustering acc 0.9834183673469388: correct 1542/1568
class 1 clustering acc 0.5510204081632653: correct 216/392
Epoch: 50, train_loss: 0.4091, train_clustering_loss:  0.3212, train_error: 0.1633
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 1.0, correct 7/7
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.5702, val_error: 0.5455, auc: 0.6840
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.1047, instance_loss: 0.2060, weighted_loss: 0.1351, label: 3, bag_size: 48489
batch 39, loss: 0.1105, instance_loss: 0.3299, weighted_loss: 0.1763, label: 3, bag_size: 152150


class 0 clustering acc 0.985969387755102: correct 1546/1568
class 1 clustering acc 0.49489795918367346: correct 194/392
Epoch: 51, train_loss: 0.3923, train_clustering_loss:  0.3317, train_error: 0.0816
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 14/14
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.5717, val_error: 0.6364, auc: 0.6458
class 0 clustering acc 0.8977272727272727: correct 316/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0197, instance_loss: 0.0690, weighted_loss: 0.0345, label: 3, bag_size: 181076
batch 39, loss: 0.0237, instance_loss: 0.0727, weighted_loss: 0.0384, label: 3, bag_size: 181076


class 0 clustering acc 0.9789540816326531: correct 1535/1568
class 1 clustering acc 0.5663265306122449: correct 222/392
Epoch: 52, train_loss: 0.3734, train_clustering_loss:  0.3238, train_error: 0.1224
class 0: acc 0.9473684210526315, correct 18/19
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 1.0, correct 10/10
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.5276, val_error: 0.5455, auc: 0.7083
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0723, instance_loss: 0.1335, weighted_loss: 0.0907, label: 3, bag_size: 99257
batch 39, loss: 0.3387, instance_loss: 0.3104, weighted_loss: 0.3302, label: 1, bag_size: 23122


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.6020408163265306: correct 236/392
Epoch: 53, train_loss: 0.2595, train_clustering_loss:  0.2660, train_error: 0.0408
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.5492, val_error: 0.6364, auc: 0.7222
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.4437, instance_loss: 0.3547, weighted_loss: 0.4170, label: 2, bag_size: 54449
batch 39, loss: 1.2300, instance_loss: 0.6698, weighted_loss: 1.0619, label: 0, bag_size: 13999


class 0 clustering acc 0.9783163265306123: correct 1534/1568
class 1 clustering acc 0.5918367346938775: correct 232/392
Epoch: 54, train_loss: 0.3765, train_clustering_loss:  0.3310, train_error: 0.1429
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 13/13
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.5783, val_error: 0.6364, auc: 0.6806
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1766, instance_loss: 0.2720, weighted_loss: 0.2052, label: 2, bag_size: 17501
batch 39, loss: 0.5317, instance_loss: 0.5479, weighted_loss: 0.5365, label: 3, bag_size: 28883


class 0 clustering acc 0.9897959183673469: correct 1552/1568
class 1 clustering acc 0.4923469387755102: correct 193/392
Epoch: 55, train_loss: 0.2995, train_clustering_loss:  0.3113, train_error: 0.0612
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 10/10
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.6036, val_error: 0.6364, auc: 0.6910
class 0 clustering acc 0.9204545454545454: correct 324/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0324, instance_loss: 0.0955, weighted_loss: 0.0513, label: 0, bag_size: 41829
batch 39, loss: 0.0441, instance_loss: 0.2138, weighted_loss: 0.0950, label: 0, bag_size: 18551


class 0 clustering acc 0.9872448979591837: correct 1548/1568
class 1 clustering acc 0.6071428571428571: correct 238/392
Epoch: 56, train_loss: 0.3103, train_clustering_loss:  0.2947, train_error: 0.0816
class 0: acc 1.0, correct 11/11
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 1.0, correct 15/15
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.7649, val_error: 0.7273, auc: 0.6910
class 0 clustering acc 0.9119318181818182: correct 321/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1308, instance_loss: 0.1858, weighted_loss: 0.1473, label: 0, bag_size: 19277
batch 39, loss: 0.0181, instance_loss: 0.0691, weighted_loss: 0.0334, label: 0, bag_size: 41829


class 0 clustering acc 0.9681122448979592: correct 1518/1568
class 1 clustering acc 0.5816326530612245: correct 228/392
Epoch: 57, train_loss: 0.3723, train_clustering_loss:  0.3395, train_error: 0.1429
class 0: acc 0.7777777777777778, correct 14/18
class 1: acc 0.875, correct 7/8
class 2: acc 1.0, correct 9/9
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.4583, val_error: 0.4545, auc: 0.7951
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0428, instance_loss: 0.0898, weighted_loss: 0.0569, label: 1, bag_size: 47433
batch 39, loss: 0.0856, instance_loss: 0.2618, weighted_loss: 0.1384, label: 0, bag_size: 10671


class 0 clustering acc 0.9770408163265306: correct 1532/1568
class 1 clustering acc 0.5127551020408163: correct 201/392
Epoch: 58, train_loss: 0.3697, train_clustering_loss:  0.3277, train_error: 0.1224
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.7894736842105263, correct 15/19
class 2: acc 1.0, correct 8/8
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.8722, val_error: 0.7273, auc: 0.7014
class 0 clustering acc 0.9147727272727273: correct 322/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.1867, instance_loss: 0.2468, weighted_loss: 0.2047, label: 2, bag_size: 176020
batch 39, loss: 0.2029, instance_loss: 0.1979, weighted_loss: 0.2014, label: 2, bag_size: 17501


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.6377551020408163: correct 250/392
Epoch: 59, train_loss: 0.2334, train_clustering_loss:  0.2598, train_error: 0.0612
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 11/11
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.7755, val_error: 0.7273, auc: 0.7118
class 0 clustering acc 0.8806818181818182: correct 310/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.1525, instance_loss: 0.1941, weighted_loss: 0.1650, label: 3, bag_size: 262536
batch 39, loss: 0.2841, instance_loss: 0.2304, weighted_loss: 0.2680, label: 2, bag_size: 17501


class 0 clustering acc 0.9783163265306123: correct 1534/1568
class 1 clustering acc 0.6377551020408163: correct 250/392
Epoch: 60, train_loss: 0.2829, train_clustering_loss:  0.2961, train_error: 0.0816
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 1.0, correct 8/8
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.4447, val_error: 0.4545, auc: 0.7951
class 0 clustering acc 0.8863636363636364: correct 312/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.6364, ROC AUC: 0.6944
Test error: 0.3636, ROC AUC: 0.7187
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3

Training Fold 1!

Init train/val/test splits... 
Done!
Training on 49 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.2355, instance_loss: 1.0249, weighted_loss: 1.1723, label: 3, bag_size: 48489
batch 39, loss: 1.9560, instance_loss: 0.9179, weighted_loss: 1.6446, label: 1, bag_size: 47433


class 0 clustering acc 0.9661989795918368: correct 1515/1568
class 1 clustering acc 0.04336734693877551: correct 17/392
Epoch: 0, train_loss: 1.4253, train_clustering_loss:  1.0207, train_error: 0.7143
class 0: acc 0.0, correct 0/12
class 1: acc 0.0, correct 0/9
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.4256, val_error: 0.8182, auc: 0.3819
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.425622).  Saving model ...


batch 19, loss: 1.5095, instance_loss: 0.7588, weighted_loss: 1.2843, label: 1, bag_size: 66789
batch 39, loss: 1.2704, instance_loss: 0.6851, weighted_loss: 1.0948, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 1, train_loss: 1.3882, train_clustering_loss:  0.7412, train_error: 0.6531
class 0: acc 0.0, correct 0/8
class 1: acc 0.35294117647058826, correct 6/17
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.09090909090909091, correct 1/11

Val Set, val_loss: 1.4236, val_error: 0.7273, auc: 0.2812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.425622 --> 1.423557).  Saving model ...


batch 19, loss: 1.6079, instance_loss: 0.6253, weighted_loss: 1.3132, label: 2, bag_size: 209612
batch 39, loss: 1.0953, instance_loss: 0.5678, weighted_loss: 0.9370, label: 3, bag_size: 22057


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 2, train_loss: 1.4084, train_clustering_loss:  0.6404, train_error: 0.7143
class 0: acc 0.0, correct 0/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.0, correct 0/10
class 3: acc 0.4375, correct 7/16

Val Set, val_loss: 1.4055, val_error: 0.7273, auc: 0.4097
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.423557 --> 1.405544).  Saving model ...


batch 19, loss: 1.4921, instance_loss: 0.5657, weighted_loss: 1.2142, label: 3, bag_size: 40869
batch 39, loss: 1.7154, instance_loss: 0.6471, weighted_loss: 1.3949, label: 2, bag_size: 22416


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 3, train_loss: 1.3972, train_clustering_loss:  0.6176, train_error: 0.7347
class 0: acc 0.14285714285714285, correct 2/14
class 1: acc 0.75, correct 9/12
class 2: acc 0.0, correct 0/14
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.4175, val_error: 0.7273, auc: 0.4201
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.7100, instance_loss: 0.6507, weighted_loss: 1.3922, label: 1, bag_size: 47433
batch 39, loss: 1.0690, instance_loss: 0.5779, weighted_loss: 0.9216, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 4, train_loss: 1.3656, train_clustering_loss:  0.6111, train_error: 0.7143
class 0: acc 0.125, correct 1/8
class 1: acc 0.07142857142857142, correct 1/14
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.26666666666666666, correct 4/15

Val Set, val_loss: 1.4231, val_error: 0.7273, auc: 0.4410
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2111, instance_loss: 0.6432, weighted_loss: 1.0407, label: 1, bag_size: 16373
batch 39, loss: 0.8214, instance_loss: 0.5300, weighted_loss: 0.7339, label: 3, bag_size: 99257


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 5, train_loss: 1.3204, train_clustering_loss:  0.6083, train_error: 0.6122
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.0, correct 0/7
class 3: acc 0.631578947368421, correct 12/19

Val Set, val_loss: 1.4724, val_error: 0.7273, auc: 0.3889
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.6091, instance_loss: 0.6680, weighted_loss: 1.3268, label: 0, bag_size: 47775
batch 39, loss: 1.4166, instance_loss: 0.6389, weighted_loss: 1.1833, label: 1, bag_size: 49894


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 6, train_loss: 1.4156, train_clustering_loss:  0.6193, train_error: 0.7347
class 0: acc 0.07692307692307693, correct 1/13
class 1: acc 0.21428571428571427, correct 3/14
class 2: acc 0.0, correct 0/11
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.3856, val_error: 0.8182, auc: 0.4618
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.405544 --> 1.385591).  Saving model ...


batch 19, loss: 0.9730, instance_loss: 0.6261, weighted_loss: 0.8690, label: 0, bag_size: 59350
batch 39, loss: 1.3504, instance_loss: 0.6181, weighted_loss: 1.1307, label: 2, bag_size: 278757


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 7, train_loss: 1.2925, train_clustering_loss:  0.6071, train_error: 0.6122
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.07692307692307693, correct 1/13
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.4389, val_error: 0.8182, auc: 0.4688
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3150, instance_loss: 0.6190, weighted_loss: 1.1062, label: 1, bag_size: 58270
batch 39, loss: 1.4711, instance_loss: 0.6469, weighted_loss: 1.2238, label: 3, bag_size: 22057


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 8, train_loss: 1.3228, train_clustering_loss:  0.6055, train_error: 0.6122
class 0: acc 0.2727272727272727, correct 3/11
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.875, correct 14/16
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.4187, val_error: 0.8182, auc: 0.4896
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1666, instance_loss: 0.5723, weighted_loss: 0.9883, label: 3, bag_size: 99257
batch 39, loss: 1.0222, instance_loss: 0.5950, weighted_loss: 0.8940, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 9, train_loss: 1.2994, train_clustering_loss:  0.5975, train_error: 0.5714
class 0: acc 0.5, correct 7/14
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.8125, correct 13/16
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.4269, val_error: 0.8182, auc: 0.5243
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.8200, instance_loss: 0.6377, weighted_loss: 1.4653, label: 1, bag_size: 66789
batch 39, loss: 1.6060, instance_loss: 0.6611, weighted_loss: 1.3225, label: 0, bag_size: 130978


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 10, train_loss: 1.2498, train_clustering_loss:  0.5962, train_error: 0.5510
class 0: acc 0.2727272727272727, correct 3/11
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.4258, val_error: 0.7273, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.9913, instance_loss: 0.5794, weighted_loss: 0.8677, label: 1, bag_size: 36943
batch 39, loss: 1.1676, instance_loss: 0.5930, weighted_loss: 0.9952, label: 1, bag_size: 57038


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 11, train_loss: 1.2268, train_clustering_loss:  0.5902, train_error: 0.4286
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 0.75, correct 9/12
class 2: acc 0.3076923076923077, correct 4/13
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.4377, val_error: 0.7273, auc: 0.5833
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 2.0074, instance_loss: 0.6805, weighted_loss: 1.6093, label: 3, bag_size: 25448
batch 39, loss: 1.2363, instance_loss: 0.6370, weighted_loss: 1.0565, label: 3, bag_size: 152150


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 12, train_loss: 1.2553, train_clustering_loss:  0.5942, train_error: 0.5102
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.4659, val_error: 0.9091, auc: 0.4896
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.4562, instance_loss: 0.5064, weighted_loss: 0.4713, label: 3, bag_size: 99257
batch 39, loss: 1.1432, instance_loss: 0.6358, weighted_loss: 0.9910, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 13, train_loss: 1.1404, train_clustering_loss:  0.5856, train_error: 0.4286
class 0: acc 0.0, correct 0/7
class 1: acc 0.2, correct 2/10
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.5248, val_error: 0.9091, auc: 0.4514
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.2529, instance_loss: 0.6142, weighted_loss: 1.0613, label: 0, bag_size: 22124
batch 39, loss: 1.7260, instance_loss: 0.5868, weighted_loss: 1.3842, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 14, train_loss: 1.1139, train_clustering_loss:  0.5806, train_error: 0.4286
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.25, correct 3/12
class 2: acc 1.0, correct 13/13
class 3: acc 0.4, correct 6/15

Val Set, val_loss: 1.4671, val_error: 0.8182, auc: 0.4722
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.6374, instance_loss: 0.5994, weighted_loss: 0.6260, label: 1, bag_size: 104549
batch 39, loss: 1.3136, instance_loss: 0.6207, weighted_loss: 1.1057, label: 0, bag_size: 47775


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 15, train_loss: 1.0854, train_clustering_loss:  0.5793, train_error: 0.4694
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.5333333333333333, correct 8/15

Val Set, val_loss: 1.4628, val_error: 0.9091, auc: 0.5243
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5408, instance_loss: 0.5263, weighted_loss: 0.5364, label: 2, bag_size: 209612
batch 39, loss: 0.4646, instance_loss: 0.4734, weighted_loss: 0.4672, label: 2, bag_size: 209612


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 16, train_loss: 1.0378, train_clustering_loss:  0.5694, train_error: 0.4286
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.3076923076923077, correct 4/13
class 2: acc 0.85, correct 17/20
class 3: acc 0.5714285714285714, correct 4/7

Val Set, val_loss: 1.5851, val_error: 0.8182, auc: 0.5347
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.4453, instance_loss: 0.5190, weighted_loss: 0.4674, label: 0, bag_size: 18551
batch 39, loss: 0.1642, instance_loss: 0.3897, weighted_loss: 0.2319, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 17, train_loss: 1.1087, train_clustering_loss:  0.5758, train_error: 0.4490
class 0: acc 0.5, correct 8/16
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.75, correct 6/8
class 3: acc 0.625, correct 10/16

Val Set, val_loss: 1.6100, val_error: 0.9091, auc: 0.4792
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.1916, instance_loss: 0.5910, weighted_loss: 1.0114, label: 0, bag_size: 6353
batch 39, loss: 1.0934, instance_loss: 0.5483, weighted_loss: 0.9299, label: 0, bag_size: 54249


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 18, train_loss: 1.0510, train_clustering_loss:  0.5653, train_error: 0.4082
class 0: acc 0.6875, correct 11/16
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.5295, val_error: 0.8182, auc: 0.5347
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.8108, instance_loss: 0.5129, weighted_loss: 0.7214, label: 0, bag_size: 65047
batch 39, loss: 0.7690, instance_loss: 0.4911, weighted_loss: 0.6856, label: 0, bag_size: 222326


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 19, train_loss: 0.9172, train_clustering_loss:  0.5392, train_error: 0.3469
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.4666666666666667, correct 7/15

Val Set, val_loss: 1.5829, val_error: 0.8182, auc: 0.5174
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.8692, instance_loss: 0.5833, weighted_loss: 0.7835, label: 1, bag_size: 58270
batch 39, loss: 0.7620, instance_loss: 0.5046, weighted_loss: 0.6848, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 20, train_loss: 0.8822, train_clustering_loss:  0.5316, train_error: 0.2245
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.8, correct 16/20
class 2: acc 0.9, correct 9/10
class 3: acc 0.4, correct 2/5

Val Set, val_loss: 1.6544, val_error: 0.7273, auc: 0.6076
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.7053, instance_loss: 0.5109, weighted_loss: 0.6470, label: 1, bag_size: 57038
batch 39, loss: 1.2937, instance_loss: 0.5753, weighted_loss: 1.0782, label: 1, bag_size: 445537


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 21, train_loss: 0.8824, train_clustering_loss:  0.5345, train_error: 0.3061
class 0: acc 0.75, correct 12/16
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.7, correct 7/10
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.7392, val_error: 0.9091, auc: 0.5312
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.8323, instance_loss: 0.7249, weighted_loss: 1.5001, label: 3, bag_size: 4963
batch 39, loss: 0.2373, instance_loss: 0.3786, weighted_loss: 0.2797, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 22, train_loss: 0.9420, train_clustering_loss:  0.5401, train_error: 0.3469
class 0: acc 0.8888888888888888, correct 16/18
class 1: acc 0.375, correct 3/8
class 2: acc 0.9, correct 9/10
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.6997, val_error: 0.9091, auc: 0.4826
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.2053, instance_loss: 0.6316, weighted_loss: 1.0332, label: 3, bag_size: 231301
batch 39, loss: 0.6985, instance_loss: 0.4368, weighted_loss: 0.6200, label: 2, bag_size: 149988


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.015306122448979591: correct 6/392
Epoch: 23, train_loss: 0.8646, train_clustering_loss:  0.4996, train_error: 0.3265
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.7364, val_error: 0.8182, auc: 0.4826
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.7697, instance_loss: 0.5236, weighted_loss: 0.6959, label: 1, bag_size: 57038
batch 39, loss: 0.8320, instance_loss: 0.5669, weighted_loss: 0.7525, label: 0, bag_size: 130978


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.015306122448979591: correct 6/392
Epoch: 24, train_loss: 0.9335, train_clustering_loss:  0.5200, train_error: 0.3469
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.8244, val_error: 0.8182, auc: 0.5000
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.1752, instance_loss: 0.3555, weighted_loss: 0.2293, label: 2, bag_size: 209612
batch 39, loss: 0.4918, instance_loss: 0.4166, weighted_loss: 0.4692, label: 3, bag_size: 40869


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.01020408163265306: correct 4/392
Epoch: 25, train_loss: 0.8080, train_clustering_loss:  0.5005, train_error: 0.3878
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.3, correct 3/10
class 2: acc 0.75, correct 9/12
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.9360, val_error: 0.8182, auc: 0.5104
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0776, instance_loss: 0.2363, weighted_loss: 0.1252, label: 3, bag_size: 196107
batch 39, loss: 1.3839, instance_loss: 0.6094, weighted_loss: 1.1516, label: 3, bag_size: 231301


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.030612244897959183: correct 12/392
Epoch: 26, train_loss: 0.9386, train_clustering_loss:  0.5161, train_error: 0.3673
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.4834, val_error: 0.5455, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.6441, instance_loss: 0.5313, weighted_loss: 0.6103, label: 1, bag_size: 104549
batch 39, loss: 0.6297, instance_loss: 0.5009, weighted_loss: 0.5911, label: 2, bag_size: 176020


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.11479591836734694: correct 45/392
Epoch: 27, train_loss: 0.7442, train_clustering_loss:  0.4645, train_error: 0.2245
class 0: acc 0.5, correct 5/10
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.8207, val_error: 0.8182, auc: 0.6042
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.2848, instance_loss: 0.4113, weighted_loss: 0.3227, label: 1, bag_size: 104549
batch 39, loss: 0.5316, instance_loss: 0.4600, weighted_loss: 0.5101, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.09948979591836735: correct 39/392
Epoch: 28, train_loss: 0.8586, train_clustering_loss:  0.4910, train_error: 0.3265
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.5333333333333333, correct 8/15

Val Set, val_loss: 1.7178, val_error: 0.7273, auc: 0.5451
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.1802, instance_loss: 0.3816, weighted_loss: 0.2406, label: 0, bag_size: 41829
batch 39, loss: 0.0777, instance_loss: 0.1745, weighted_loss: 0.1067, label: 3, bag_size: 99257


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.1096938775510204: correct 43/392
Epoch: 29, train_loss: 0.6508, train_clustering_loss:  0.4518, train_error: 0.2245
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.2, correct 1/5
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.8125, correct 13/16

Val Set, val_loss: 1.6878, val_error: 0.8182, auc: 0.5139
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 1.3185, instance_loss: 0.5106, weighted_loss: 1.0762, label: 2, bag_size: 54449
batch 39, loss: 0.5678, instance_loss: 0.4243, weighted_loss: 0.5247, label: 2, bag_size: 163352


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.21428571428571427: correct 84/392
Epoch: 30, train_loss: 0.7221, train_clustering_loss:  0.4338, train_error: 0.3265
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.875, correct 14/16
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.8571, val_error: 0.8182, auc: 0.5556
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.3581, instance_loss: 0.4276, weighted_loss: 0.3790, label: 3, bag_size: 48489
batch 39, loss: 1.4357, instance_loss: 0.6372, weighted_loss: 1.1962, label: 1, bag_size: 49894


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.061224489795918366: correct 24/392
Epoch: 31, train_loss: 0.7087, train_clustering_loss:  0.4571, train_error: 0.2653
class 0: acc 1.0, correct 14/14
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.5, correct 7/14

Val Set, val_loss: 1.7638, val_error: 0.8182, auc: 0.5729
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.2853, instance_loss: 0.2975, weighted_loss: 0.2889, label: 2, bag_size: 176020
batch 39, loss: 0.4245, instance_loss: 0.4384, weighted_loss: 0.4287, label: 2, bag_size: 393657


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.22448979591836735: correct 88/392
Epoch: 32, train_loss: 0.6592, train_clustering_loss:  0.4159, train_error: 0.2653
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.625, correct 5/8
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.7333333333333333, correct 11/15

Val Set, val_loss: 1.9201, val_error: 0.6364, auc: 0.5451
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 1.5808, instance_loss: 0.6966, weighted_loss: 1.3156, label: 1, bag_size: 77634
batch 39, loss: 0.1535, instance_loss: 0.2260, weighted_loss: 0.1753, label: 2, bag_size: 278757


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.14030612244897958: correct 55/392
Epoch: 33, train_loss: 0.6245, train_clustering_loss:  0.4351, train_error: 0.1837
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.8125, correct 13/16
class 2: acc 1.0, correct 11/11
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.8697, val_error: 0.8182, auc: 0.5312
class 0 clustering acc 0.90625: correct 319/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.9438, instance_loss: 0.5096, weighted_loss: 0.8135, label: 1, bag_size: 18329
batch 39, loss: 1.1207, instance_loss: 0.5129, weighted_loss: 0.9383, label: 1, bag_size: 66789


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.13010204081632654: correct 51/392
Epoch: 34, train_loss: 0.7681, train_clustering_loss:  0.4544, train_error: 0.3061
class 0: acc 0.5, correct 6/12
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.8, correct 8/10
class 3: acc 0.6666666666666666, correct 10/15

Val Set, val_loss: 1.9560, val_error: 0.8182, auc: 0.5243
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.1711, instance_loss: 0.2384, weighted_loss: 0.1913, label: 2, bag_size: 278757
batch 39, loss: 1.2627, instance_loss: 0.5508, weighted_loss: 1.0491, label: 0, bag_size: 13999


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.23214285714285715: correct 91/392
Epoch: 35, train_loss: 0.5858, train_clustering_loss:  0.4100, train_error: 0.1633
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 1.0, correct 14/14
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.9107, val_error: 0.8182, auc: 0.4965
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0727, instance_loss: 0.1136, weighted_loss: 0.0849, label: 2, bag_size: 22416
batch 39, loss: 0.0365, instance_loss: 0.0941, weighted_loss: 0.0538, label: 3, bag_size: 99257


class 0 clustering acc 0.9955357142857143: correct 1561/1568
class 1 clustering acc 0.20153061224489796: correct 79/392
Epoch: 36, train_loss: 0.7159, train_clustering_loss:  0.4284, train_error: 0.2449
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.7878, val_error: 0.8182, auc: 0.5868
class 0 clustering acc 0.90625: correct 319/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.7851, instance_loss: 0.6418, weighted_loss: 0.7421, label: 3, bag_size: 196107
batch 39, loss: 1.8068, instance_loss: 0.8589, weighted_loss: 1.5224, label: 1, bag_size: 445537


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.21428571428571427: correct 84/392
Epoch: 37, train_loss: 0.6921, train_clustering_loss:  0.4301, train_error: 0.2449
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.9802, val_error: 0.7273, auc: 0.6215
class 0 clustering acc 0.90625: correct 319/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 1.3351, instance_loss: 0.5979, weighted_loss: 1.1139, label: 0, bag_size: 13999
batch 39, loss: 1.2532, instance_loss: 0.6212, weighted_loss: 1.0636, label: 0, bag_size: 54249


class 0 clustering acc 0.9980867346938775: correct 1565/1568
class 1 clustering acc 0.10204081632653061: correct 40/392
Epoch: 38, train_loss: 0.7600, train_clustering_loss:  0.4696, train_error: 0.3469
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.38461538461538464, correct 5/13

Val Set, val_loss: 2.0151, val_error: 0.7273, auc: 0.5451
class 0 clustering acc 0.8948863636363636: correct 315/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.0876, instance_loss: 0.2332, weighted_loss: 0.1313, label: 3, bag_size: 196107
batch 39, loss: 0.1213, instance_loss: 0.2021, weighted_loss: 0.1456, label: 2, bag_size: 525276


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.19642857142857142: correct 77/392
Epoch: 39, train_loss: 0.5656, train_clustering_loss:  0.4088, train_error: 0.2041
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 2.0359, val_error: 0.7273, auc: 0.5521
class 0 clustering acc 0.90625: correct 319/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0339, instance_loss: 0.1080, weighted_loss: 0.0561, label: 3, bag_size: 99257
batch 39, loss: 0.7039, instance_loss: 0.4875, weighted_loss: 0.6390, label: 0, bag_size: 222326


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.2423469387755102: correct 95/392
Epoch: 40, train_loss: 0.4977, train_clustering_loss:  0.3879, train_error: 0.1837
class 0: acc 0.75, correct 9/12
class 1: acc 0.9, correct 9/10
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.9799, val_error: 0.7273, auc: 0.5521
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0238, instance_loss: 0.0731, weighted_loss: 0.0386, label: 3, bag_size: 99257
batch 39, loss: 1.0817, instance_loss: 0.6338, weighted_loss: 0.9473, label: 3, bag_size: 22057


class 0 clustering acc 0.9968112244897959: correct 1563/1568
class 1 clustering acc 0.2193877551020408: correct 86/392
Epoch: 41, train_loss: 0.5517, train_clustering_loss:  0.3981, train_error: 0.1633
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.875, correct 14/16
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 2.0823, val_error: 0.7273, auc: 0.5347
class 0 clustering acc 0.8835227272727273: correct 311/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.3524, instance_loss: 0.3344, weighted_loss: 0.3470, label: 1, bag_size: 36943
batch 39, loss: 1.0867, instance_loss: 0.4813, weighted_loss: 0.9051, label: 1, bag_size: 49894


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.36989795918367346: correct 145/392
Epoch: 42, train_loss: 0.4326, train_clustering_loss:  0.3332, train_error: 0.1429
class 0: acc 0.8, correct 12/15
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.875, correct 14/16
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 2.0590, val_error: 0.7273, auc: 0.5521
class 0 clustering acc 0.8835227272727273: correct 311/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.0430, instance_loss: 0.0628, weighted_loss: 0.0489, label: 2, bag_size: 59749
batch 39, loss: 0.8505, instance_loss: 0.4282, weighted_loss: 0.7238, label: 0, bag_size: 222326


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.26785714285714285: correct 105/392
Epoch: 43, train_loss: 0.5325, train_clustering_loss:  0.3944, train_error: 0.1837
class 0: acc 0.75, correct 9/12
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 2.1215, val_error: 0.9091, auc: 0.5486
class 0 clustering acc 0.8636363636363636: correct 304/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.5919, instance_loss: 0.4753, weighted_loss: 0.5569, label: 1, bag_size: 23122
batch 39, loss: 1.1204, instance_loss: 0.5177, weighted_loss: 0.9396, label: 1, bag_size: 66789


class 0 clustering acc 0.9948979591836735: correct 1560/1568
class 1 clustering acc 0.43112244897959184: correct 169/392
Epoch: 44, train_loss: 0.4538, train_clustering_loss:  0.3453, train_error: 0.1429
class 0: acc 1.0, correct 11/11
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 1.0, correct 19/19
class 3: acc 0.4, correct 2/5

Val Set, val_loss: 2.0500, val_error: 0.8182, auc: 0.5903
class 0 clustering acc 0.8806818181818182: correct 310/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.8245, instance_loss: 0.5086, weighted_loss: 0.7297, label: 0, bag_size: 222326
batch 39, loss: 0.9152, instance_loss: 0.4763, weighted_loss: 0.7836, label: 0, bag_size: 222326


class 0 clustering acc 0.9853316326530612: correct 1545/1568
class 1 clustering acc 0.2780612244897959: correct 109/392
Epoch: 45, train_loss: 0.6100, train_clustering_loss:  0.4056, train_error: 0.2245
class 0: acc 0.8, correct 12/15
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8, correct 8/10
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 2.0234, val_error: 0.7273, auc: 0.6215
class 0 clustering acc 0.8778409090909091: correct 309/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.1642, instance_loss: 0.2772, weighted_loss: 0.1981, label: 1, bag_size: 36943
batch 39, loss: 0.3064, instance_loss: 0.3234, weighted_loss: 0.3115, label: 1, bag_size: 66789


class 0 clustering acc 0.9955357142857143: correct 1561/1568
class 1 clustering acc 0.4030612244897959: correct 158/392
Epoch: 46, train_loss: 0.4415, train_clustering_loss:  0.3331, train_error: 0.1429
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 2.1636, val_error: 0.7273, auc: 0.5833
class 0 clustering acc 0.8664772727272727: correct 305/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.3003, instance_loss: 0.3034, weighted_loss: 0.3012, label: 0, bag_size: 65047
batch 39, loss: 0.0702, instance_loss: 0.0802, weighted_loss: 0.0732, label: 2, bag_size: 59749


class 0 clustering acc 0.9942602040816326: correct 1559/1568
class 1 clustering acc 0.31887755102040816: correct 125/392
Epoch: 47, train_loss: 0.4491, train_clustering_loss:  0.3635, train_error: 0.1429
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.9, correct 9/10
class 3: acc 0.8333333333333334, correct 15/18

Val Set, val_loss: 1.8680, val_error: 0.6364, auc: 0.5590
class 0 clustering acc 0.9005681818181818: correct 317/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.5334, instance_loss: 0.4246, weighted_loss: 0.5008, label: 0, bag_size: 65047
batch 39, loss: 0.2452, instance_loss: 0.2575, weighted_loss: 0.2489, label: 2, bag_size: 209612


class 0 clustering acc 0.9955357142857143: correct 1561/1568
class 1 clustering acc 0.3010204081632653: correct 118/392
Epoch: 48, train_loss: 0.5225, train_clustering_loss:  0.3861, train_error: 0.2245
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8333333333333334, correct 5/6
class 3: acc 0.7777777777777778, correct 14/18

Val Set, val_loss: 2.0169, val_error: 0.7273, auc: 0.5417
class 0 clustering acc 0.8721590909090909: correct 307/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 42 out of 20


batch 19, loss: 2.0221, instance_loss: 0.8879, weighted_loss: 1.6819, label: 2, bag_size: 54449
batch 39, loss: 0.7142, instance_loss: 0.5500, weighted_loss: 0.6649, label: 3, bag_size: 152150


class 0 clustering acc 0.9897959183673469: correct 1552/1568
class 1 clustering acc 0.36989795918367346: correct 145/392
Epoch: 49, train_loss: 0.4735, train_clustering_loss:  0.3676, train_error: 0.2041
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.8333333333333334, correct 5/6
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 2.1084, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 0.8607954545454546: correct 303/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.8328, instance_loss: 0.4460, weighted_loss: 0.7168, label: 3, bag_size: 25448
batch 39, loss: 0.2309, instance_loss: 0.3280, weighted_loss: 0.2601, label: 3, bag_size: 56291


class 0 clustering acc 0.9866071428571429: correct 1547/1568
class 1 clustering acc 0.2780612244897959: correct 109/392
Epoch: 50, train_loss: 0.5877, train_clustering_loss:  0.4012, train_error: 0.3265
class 0: acc 0.6470588235294118, correct 11/17
class 1: acc 0.75, correct 9/12
class 2: acc 0.6666666666666666, correct 4/6
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 2.1894, val_error: 0.6364, auc: 0.5833
class 0 clustering acc 0.8579545454545454: correct 302/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 44 out of 20


batch 19, loss: 0.4783, instance_loss: 0.4578, weighted_loss: 0.4721, label: 3, bag_size: 152150
batch 39, loss: 0.3762, instance_loss: 0.3564, weighted_loss: 0.3702, label: 0, bag_size: 47775


class 0 clustering acc 0.9948979591836735: correct 1560/1568
class 1 clustering acc 0.28061224489795916: correct 110/392
Epoch: 51, train_loss: 0.4238, train_clustering_loss:  0.3553, train_error: 0.1429
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 1.0, correct 13/13
class 2: acc 0.75, correct 6/8
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 2.0401, val_error: 0.5455, auc: 0.5694
class 0 clustering acc 0.8778409090909091: correct 309/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 45 out of 20
Early stopping
Val error: 0.8182, ROC AUC: 0.4618
Test error: 0.5455, ROC AUC: 0.6944
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3

Training Fold 2!

Init train/val/test splits... 
Done!
Training on 49 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6780, instance_loss: 1.0819, weighted_loss: 1.4992, label: 1, bag_size: 132271
batch 39, loss: 1.6779, instance_loss: 0.9283, weighted_loss: 1.4530, label: 1, bag_size: 18329


class 0 clustering acc 0.9655612244897959: correct 1514/1568
class 1 clustering acc 0.04846938775510204: correct 19/392
Epoch: 0, train_loss: 1.4215, train_clustering_loss:  1.0365, train_error: 0.7347
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/12
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.0, correct 0/12

Val Set, val_loss: 1.4164, val_error: 0.8182, auc: 0.5694
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.416435).  Saving model ...


batch 19, loss: 1.1231, instance_loss: 0.7810, weighted_loss: 1.0205, label: 1, bag_size: 58270
batch 39, loss: 1.0352, instance_loss: 0.6483, weighted_loss: 0.9191, label: 1, bag_size: 66789


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 1, train_loss: 1.3321, train_clustering_loss:  0.7591, train_error: 0.6122
class 0: acc 0.0, correct 0/7
class 1: acc 0.8, correct 16/20
class 2: acc 0.2727272727272727, correct 3/11
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.4175, val_error: 0.7273, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.7257, instance_loss: 0.6832, weighted_loss: 1.4130, label: 2, bag_size: 22130
batch 39, loss: 1.0803, instance_loss: 0.5882, weighted_loss: 0.9326, label: 3, bag_size: 152150


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 2, train_loss: 1.3823, train_clustering_loss:  0.6319, train_error: 0.6939
class 0: acc 0.0, correct 0/12
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.0, correct 0/7
class 3: acc 0.4444444444444444, correct 8/18

Val Set, val_loss: 1.3706, val_error: 0.7273, auc: 0.6319
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.416435 --> 1.370566).  Saving model ...


batch 19, loss: 1.1860, instance_loss: 0.5909, weighted_loss: 1.0074, label: 3, bag_size: 40869
batch 39, loss: 1.8393, instance_loss: 0.6586, weighted_loss: 1.4851, label: 2, bag_size: 158432


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 3, train_loss: 1.4297, train_clustering_loss:  0.6278, train_error: 0.7959
class 0: acc 0.14285714285714285, correct 2/14
class 1: acc 0.0, correct 0/11
class 2: acc 0.0, correct 0/14
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.3560, val_error: 0.6364, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.370566 --> 1.355976).  Saving model ...


batch 19, loss: 1.4442, instance_loss: 0.6228, weighted_loss: 1.1978, label: 1, bag_size: 18329
batch 39, loss: 1.2291, instance_loss: 0.6023, weighted_loss: 1.0411, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 4, train_loss: 1.3343, train_clustering_loss:  0.6141, train_error: 0.6735
class 0: acc 0.0, correct 0/4
class 1: acc 0.125, correct 2/16
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.06666666666666667, correct 1/15

Val Set, val_loss: 1.4429, val_error: 0.6364, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1691, instance_loss: 0.6239, weighted_loss: 1.0056, label: 1, bag_size: 47433
batch 39, loss: 1.1355, instance_loss: 0.5957, weighted_loss: 0.9735, label: 3, bag_size: 113328


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 5, train_loss: 1.4158, train_clustering_loss:  0.6266, train_error: 0.6531
class 0: acc 0.0, correct 0/15
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.125, correct 1/8
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.3359, val_error: 0.6364, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.355976 --> 1.335856).  Saving model ...


batch 19, loss: 1.5345, instance_loss: 0.6236, weighted_loss: 1.2612, label: 2, bag_size: 113492
batch 39, loss: 1.2792, instance_loss: 0.6348, weighted_loss: 1.0859, label: 0, bag_size: 6353


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 6, train_loss: 1.3763, train_clustering_loss:  0.6211, train_error: 0.7347
class 0: acc 0.4666666666666667, correct 7/15
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.0, correct 0/12
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.3164, val_error: 0.4545, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.335856 --> 1.316413).  Saving model ...


batch 19, loss: 0.9474, instance_loss: 0.6122, weighted_loss: 0.8468, label: 0, bag_size: 59350
batch 39, loss: 1.4709, instance_loss: 0.6287, weighted_loss: 1.2182, label: 2, bag_size: 278757


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 7, train_loss: 1.2827, train_clustering_loss:  0.6153, train_error: 0.6122
class 0: acc 0.9, correct 18/20
class 1: acc 0.0, correct 0/11
class 2: acc 0.0, correct 0/11
class 3: acc 0.14285714285714285, correct 1/7

Val Set, val_loss: 1.3585, val_error: 0.7273, auc: 0.7743
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5384, instance_loss: 0.6302, weighted_loss: 1.2659, label: 1, bag_size: 104549
batch 39, loss: 1.3817, instance_loss: 0.6481, weighted_loss: 1.1616, label: 3, bag_size: 152150


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 8, train_loss: 1.3581, train_clustering_loss:  0.6186, train_error: 0.7143
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.0, correct 0/11
class 2: acc 0.2857142857142857, correct 4/14
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.2967, val_error: 0.6364, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.316413 --> 1.296723).  Saving model ...


batch 19, loss: 1.5085, instance_loss: 0.6496, weighted_loss: 1.2508, label: 3, bag_size: 113328
batch 39, loss: 1.2297, instance_loss: 0.5825, weighted_loss: 1.0355, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 9, train_loss: 1.3011, train_clustering_loss:  0.6113, train_error: 0.5306
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6, correct 9/15
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3025, val_error: 0.6364, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4948, instance_loss: 0.6484, weighted_loss: 1.2409, label: 1, bag_size: 58270
batch 39, loss: 1.8028, instance_loss: 0.6225, weighted_loss: 1.4487, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 10, train_loss: 1.2494, train_clustering_loss:  0.6043, train_error: 0.5714
class 0: acc 0.1111111111111111, correct 1/9
class 1: acc 0.25, correct 4/16
class 2: acc 1.0, correct 16/16
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3575, val_error: 0.7273, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9086, instance_loss: 0.5781, weighted_loss: 0.8094, label: 1, bag_size: 36943
batch 39, loss: 0.9878, instance_loss: 0.5642, weighted_loss: 0.8607, label: 1, bag_size: 57038


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 11, train_loss: 1.3136, train_clustering_loss:  0.6058, train_error: 0.5510
class 0: acc 0.1111111111111111, correct 1/9
class 1: acc 1.0, correct 15/15
class 2: acc 0.4, correct 6/15
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.2992, val_error: 0.6364, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2025, instance_loss: 0.6264, weighted_loss: 1.0296, label: 0, bag_size: 59141
batch 39, loss: 1.7398, instance_loss: 0.6951, weighted_loss: 1.4264, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 12, train_loss: 1.2469, train_clustering_loss:  0.6051, train_error: 0.5918
class 0: acc 0.5, correct 11/22
class 1: acc 0.625, correct 5/8
class 2: acc 0.5, correct 4/8
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.3548, val_error: 0.6364, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7388, instance_loss: 0.5780, weighted_loss: 0.6905, label: 3, bag_size: 113328
batch 39, loss: 1.0516, instance_loss: 0.5761, weighted_loss: 0.9090, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 13, train_loss: 1.3064, train_clustering_loss:  0.6104, train_error: 0.6531
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.0, correct 0/10
class 2: acc 0.2857142857142857, correct 4/14
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.2561, val_error: 0.6364, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.296723 --> 1.256135).  Saving model ...


batch 19, loss: 1.3979, instance_loss: 0.6052, weighted_loss: 1.1601, label: 0, bag_size: 6353
batch 39, loss: 1.0286, instance_loss: 0.5914, weighted_loss: 0.8975, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 14, train_loss: 1.2212, train_clustering_loss:  0.5967, train_error: 0.5714
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.625, correct 5/8
class 3: acc 0.3684210526315789, correct 7/19

Val Set, val_loss: 1.2378, val_error: 0.4545, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.256135 --> 1.237761).  Saving model ...


batch 19, loss: 0.6665, instance_loss: 0.5321, weighted_loss: 0.6262, label: 1, bag_size: 64834
batch 39, loss: 1.0686, instance_loss: 0.6245, weighted_loss: 0.9353, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 15, train_loss: 1.2012, train_clustering_loss:  0.5995, train_error: 0.4694
class 0: acc 0.0, correct 0/4
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.25, correct 4/16
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.3919, val_error: 0.7273, auc: 0.7639
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1183, instance_loss: 0.5714, weighted_loss: 0.9542, label: 2, bag_size: 22130
batch 39, loss: 0.8684, instance_loss: 0.5270, weighted_loss: 0.7660, label: 2, bag_size: 22130


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 16, train_loss: 1.2368, train_clustering_loss:  0.5923, train_error: 0.5306
class 0: acc 0.0, correct 0/9
class 1: acc 0.5, correct 5/10
class 2: acc 0.631578947368421, correct 12/19
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.2727, val_error: 0.6364, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2417, instance_loss: 0.6625, weighted_loss: 1.0680, label: 0, bag_size: 10671
batch 39, loss: 1.4823, instance_loss: 0.6298, weighted_loss: 1.2266, label: 1, bag_size: 57038


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 17, train_loss: 1.2382, train_clustering_loss:  0.6015, train_error: 0.6531
class 0: acc 0.35294117647058826, correct 6/17
class 1: acc 0.2, correct 2/10
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.23076923076923078, correct 3/13

Val Set, val_loss: 1.2081, val_error: 0.4545, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.237761 --> 1.208100).  Saving model ...


batch 19, loss: 0.6154, instance_loss: 0.5117, weighted_loss: 0.5842, label: 1, bag_size: 20030
batch 39, loss: 1.1771, instance_loss: 0.6009, weighted_loss: 1.0042, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 18, train_loss: 1.2676, train_clustering_loss:  0.5993, train_error: 0.6122
class 0: acc 0.3, correct 3/10
class 1: acc 0.5, correct 7/14
class 2: acc 0.4, correct 6/15
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.2388, val_error: 0.6364, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0577, instance_loss: 0.5616, weighted_loss: 0.9088, label: 1, bag_size: 20030
batch 39, loss: 1.8115, instance_loss: 0.6019, weighted_loss: 1.4486, label: 0, bag_size: 222491


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 19, train_loss: 1.1618, train_clustering_loss:  0.5848, train_error: 0.4898
class 0: acc 0.0, correct 0/7
class 1: acc 0.6470588235294118, correct 11/17
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.2000, val_error: 0.5455, auc: 0.8750
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.208100 --> 1.199955).  Saving model ...


batch 19, loss: 1.1017, instance_loss: 0.5782, weighted_loss: 0.9447, label: 1, bag_size: 104549
batch 39, loss: 1.1458, instance_loss: 0.5010, weighted_loss: 0.9524, label: 1, bag_size: 66789


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 20, train_loss: 1.1810, train_clustering_loss:  0.5686, train_error: 0.5306
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.9473684210526315, correct 18/19
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.2529, val_error: 0.7273, auc: 0.9097
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7995, instance_loss: 0.4852, weighted_loss: 0.7052, label: 1, bag_size: 57038
batch 39, loss: 1.1336, instance_loss: 0.5516, weighted_loss: 0.9590, label: 3, bag_size: 28883


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 21, train_loss: 1.1111, train_clustering_loss:  0.5710, train_error: 0.4490
class 0: acc 0.38461538461538464, correct 5/13
class 1: acc 1.0, correct 15/15
class 2: acc 0.1, correct 1/10
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.1441, val_error: 0.3636, auc: 0.8889
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.199955 --> 1.144077).  Saving model ...


batch 19, loss: 1.7311, instance_loss: 0.7058, weighted_loss: 1.4235, label: 3, bag_size: 16626
batch 39, loss: 0.4545, instance_loss: 0.5502, weighted_loss: 0.4832, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 22, train_loss: 1.0442, train_clustering_loss:  0.5774, train_error: 0.3878
class 0: acc 0.8, correct 12/15
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.42857142857142855, correct 6/14

Val Set, val_loss: 1.1570, val_error: 0.4545, auc: 0.8681
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7448, instance_loss: 0.5317, weighted_loss: 0.6809, label: 3, bag_size: 240896
batch 39, loss: 0.9069, instance_loss: 0.5682, weighted_loss: 0.8053, label: 2, bag_size: 149988


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 23, train_loss: 1.0192, train_clustering_loss:  0.5617, train_error: 0.3265
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.5, correct 5/10
class 2: acc 0.25, correct 3/12
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.0116, val_error: 0.3636, auc: 0.8681
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.144077 --> 1.011573).  Saving model ...


batch 19, loss: 1.3606, instance_loss: 0.6162, weighted_loss: 1.1373, label: 1, bag_size: 57038
batch 39, loss: 1.0149, instance_loss: 0.5538, weighted_loss: 0.8766, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 24, train_loss: 1.0424, train_clustering_loss:  0.5595, train_error: 0.3469
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.6, correct 6/10
class 2: acc 0.8, correct 12/15
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 0.9834, val_error: 0.4545, auc: 0.8681
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.011573 --> 0.983448).  Saving model ...


batch 19, loss: 1.1392, instance_loss: 0.5590, weighted_loss: 0.9651, label: 2, bag_size: 22130
batch 39, loss: 1.0268, instance_loss: 0.5438, weighted_loss: 0.8819, label: 3, bag_size: 40869


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 25, train_loss: 1.0048, train_clustering_loss:  0.5459, train_error: 0.4286
class 0: acc 0.875, correct 14/16
class 1: acc 0.3, correct 3/10
class 2: acc 0.5, correct 5/10
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 0.9845, val_error: 0.4545, auc: 0.8576
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0575, instance_loss: 0.5257, weighted_loss: 0.8980, label: 3, bag_size: 196107
batch 39, loss: 0.7269, instance_loss: 0.4689, weighted_loss: 0.6495, label: 2, bag_size: 17501


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 26, train_loss: 0.9487, train_clustering_loss:  0.5483, train_error: 0.4286
class 0: acc 0.7, correct 7/10
class 1: acc 0.5, correct 4/8
class 2: acc 0.8, correct 12/15
class 3: acc 0.3125, correct 5/16

Val Set, val_loss: 1.1392, val_error: 0.5455, auc: 0.8021
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1537, instance_loss: 0.5838, weighted_loss: 0.9827, label: 1, bag_size: 64834
batch 39, loss: 0.5275, instance_loss: 0.4692, weighted_loss: 0.5100, label: 2, bag_size: 176020


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 27, train_loss: 0.8738, train_clustering_loss:  0.5213, train_error: 0.3469
class 0: acc 0.6, correct 6/10
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.46153846153846156, correct 6/13
class 3: acc 0.8666666666666667, correct 13/15

Val Set, val_loss: 1.0012, val_error: 0.5455, auc: 0.8472
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6557, instance_loss: 0.4363, weighted_loss: 0.5899, label: 1, bag_size: 64834
batch 39, loss: 1.1558, instance_loss: 0.4902, weighted_loss: 0.9561, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 28, train_loss: 0.8643, train_clustering_loss:  0.5065, train_error: 0.3265
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.75, correct 12/16
class 3: acc 0.38461538461538464, correct 5/13

Val Set, val_loss: 0.9820, val_error: 0.4545, auc: 0.8438
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (0.983448 --> 0.982000).  Saving model ...


batch 19, loss: 0.5414, instance_loss: 0.5636, weighted_loss: 0.5481, label: 0, bag_size: 59141
batch 39, loss: 0.5821, instance_loss: 0.4335, weighted_loss: 0.5375, label: 3, bag_size: 113328


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 29, train_loss: 0.8256, train_clustering_loss:  0.5148, train_error: 0.2449
class 0: acc 0.8888888888888888, correct 16/18
class 1: acc 0.3333333333333333, correct 2/6
class 2: acc 0.7, correct 7/10
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.1067, val_error: 0.6364, auc: 0.8368
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.9518, instance_loss: 0.7163, weighted_loss: 1.5811, label: 2, bag_size: 54449
batch 39, loss: 0.4097, instance_loss: 0.4014, weighted_loss: 0.4072, label: 2, bag_size: 163352


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 30, train_loss: 0.7829, train_clustering_loss:  0.5052, train_error: 0.2857
class 0: acc 0.5, correct 6/12
class 1: acc 0.75, correct 9/12
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 0.9724, val_error: 0.5455, auc: 0.8611
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (0.982000 --> 0.972398).  Saving model ...


batch 19, loss: 0.8365, instance_loss: 0.4550, weighted_loss: 0.7221, label: 1, bag_size: 132271
batch 39, loss: 0.6396, instance_loss: 0.5298, weighted_loss: 0.6066, label: 0, bag_size: 6353


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 31, train_loss: 0.9301, train_clustering_loss:  0.5207, train_error: 0.4286
class 0: acc 0.6875, correct 11/16
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.7142857142857143, correct 5/7
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.1601, val_error: 0.4545, auc: 0.8681
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4083, instance_loss: 0.4143, weighted_loss: 0.4101, label: 2, bag_size: 176020
batch 39, loss: 1.0029, instance_loss: 0.5144, weighted_loss: 0.8563, label: 0, bag_size: 453871


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 32, train_loss: 0.8259, train_clustering_loss:  0.4974, train_error: 0.2857
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.875, correct 7/8
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.0467, val_error: 0.4545, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2820, instance_loss: 0.6405, weighted_loss: 1.0895, label: 3, bag_size: 16626
batch 39, loss: 0.4436, instance_loss: 0.3829, weighted_loss: 0.4254, label: 2, bag_size: 278757


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.015306122448979591: correct 6/392
Epoch: 33, train_loss: 0.6967, train_clustering_loss:  0.4771, train_error: 0.2449
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.7, correct 7/10
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.0155, val_error: 0.4545, auc: 0.8507
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8913, instance_loss: 0.4559, weighted_loss: 0.7607, label: 1, bag_size: 66789
batch 39, loss: 0.3949, instance_loss: 0.3639, weighted_loss: 0.3856, label: 1, bag_size: 58270


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 34, train_loss: 0.6610, train_clustering_loss:  0.4709, train_error: 0.1837
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.75, correct 9/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.0643, val_error: 0.6364, auc: 0.8611
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.4255, instance_loss: 0.3517, weighted_loss: 0.4034, label: 2, bag_size: 278757
batch 39, loss: 0.8417, instance_loss: 0.5458, weighted_loss: 0.7530, label: 0, bag_size: 13999


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 35, train_loss: 0.6562, train_clustering_loss:  0.4648, train_error: 0.2857
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.2, correct 2/10
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.0359, val_error: 0.6364, auc: 0.8472
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.7974, instance_loss: 0.7527, weighted_loss: 1.4840, label: 0, bag_size: 46742
batch 39, loss: 0.3714, instance_loss: 0.3502, weighted_loss: 0.3650, label: 3, bag_size: 113328


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.007653061224489796: correct 3/392
Epoch: 36, train_loss: 0.7663, train_clustering_loss:  0.4829, train_error: 0.2449
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.8, correct 8/10
class 2: acc 0.375, correct 3/8
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.1032, val_error: 0.5455, auc: 0.8368
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.4234, instance_loss: 0.6122, weighted_loss: 1.1800, label: 3, bag_size: 196107
batch 39, loss: 0.8903, instance_loss: 0.5788, weighted_loss: 0.7968, label: 3, bag_size: 28883


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.01020408163265306: correct 4/392
Epoch: 37, train_loss: 0.6769, train_clustering_loss:  0.4587, train_error: 0.2857
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 0.9672, val_error: 0.4545, auc: 0.8368
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (0.972398 --> 0.967228).  Saving model ...


batch 19, loss: 0.7808, instance_loss: 0.5635, weighted_loss: 0.7156, label: 0, bag_size: 13999
batch 39, loss: 0.4368, instance_loss: 0.3576, weighted_loss: 0.4131, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.02040816326530612: correct 8/392
Epoch: 38, train_loss: 0.7300, train_clustering_loss:  0.4823, train_error: 0.2449
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 0.9862, val_error: 0.6364, auc: 0.8993
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9918, instance_loss: 0.5582, weighted_loss: 0.8617, label: 3, bag_size: 196107
batch 39, loss: 0.4613, instance_loss: 0.4576, weighted_loss: 0.4602, label: 3, bag_size: 189694


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.03826530612244898: correct 15/392
Epoch: 39, train_loss: 0.6110, train_clustering_loss:  0.4376, train_error: 0.1429
class 0: acc 0.875, correct 7/8
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9411764705882353, correct 16/17
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.1090, val_error: 0.6364, auc: 0.7812
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5360, instance_loss: 0.4022, weighted_loss: 0.4959, label: 3, bag_size: 113328
batch 39, loss: 0.5893, instance_loss: 0.4640, weighted_loss: 0.5517, label: 0, bag_size: 222491


class 0 clustering acc 0.9980867346938775: correct 1565/1568
class 1 clustering acc 0.03826530612244898: correct 15/392
Epoch: 40, train_loss: 0.5366, train_clustering_loss:  0.4412, train_error: 0.1837
class 0: acc 1.0, correct 18/18
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.2409, val_error: 0.7273, auc: 0.8160
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6857, instance_loss: 0.4192, weighted_loss: 0.6057, label: 3, bag_size: 113328
batch 39, loss: 0.2662, instance_loss: 0.4344, weighted_loss: 0.3167, label: 3, bag_size: 152150


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.1377551020408163: correct 54/392
Epoch: 41, train_loss: 0.5260, train_clustering_loss:  0.4174, train_error: 0.1633
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.1485, val_error: 0.5455, auc: 0.8264
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2073, instance_loss: 0.2742, weighted_loss: 0.2273, label: 1, bag_size: 36943
batch 39, loss: 1.2172, instance_loss: 0.5636, weighted_loss: 1.0211, label: 0, bag_size: 22124


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.22704081632653061: correct 89/392
Epoch: 42, train_loss: 0.5463, train_clustering_loss:  0.4201, train_error: 0.2449
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 18/18
class 3: acc 0.2857142857142857, correct 2/7

Val Set, val_loss: 1.1311, val_error: 0.6364, auc: 0.8576
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.4691, instance_loss: 0.3158, weighted_loss: 0.4231, label: 2, bag_size: 59749
batch 39, loss: 0.7091, instance_loss: 0.4657, weighted_loss: 0.6361, label: 0, bag_size: 222491


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.3086734693877551: correct 121/392
Epoch: 43, train_loss: 0.4888, train_clustering_loss:  0.3836, train_error: 0.1633
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.9375, correct 15/16
class 2: acc 1.0, correct 13/13
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.1591, val_error: 0.5455, auc: 0.8368
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.5240, instance_loss: 0.3219, weighted_loss: 0.4634, label: 1, bag_size: 16373
batch 39, loss: 0.4087, instance_loss: 0.2833, weighted_loss: 0.3711, label: 1, bag_size: 58270


class 0 clustering acc 0.9955357142857143: correct 1561/1568
class 1 clustering acc 0.37755102040816324: correct 148/392
Epoch: 44, train_loss: 0.4314, train_clustering_loss:  0.3729, train_error: 0.1633
class 0: acc 1.0, correct 11/11
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.9444444444444444, correct 17/18
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.1343, val_error: 0.5455, auc: 0.8194
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.7933, instance_loss: 0.4295, weighted_loss: 0.6842, label: 0, bag_size: 222491
batch 39, loss: 0.5563, instance_loss: 0.4253, weighted_loss: 0.5170, label: 0, bag_size: 222491


class 0 clustering acc 0.9815051020408163: correct 1539/1568
class 1 clustering acc 0.18112244897959184: correct 71/392
Epoch: 45, train_loss: 0.5381, train_clustering_loss:  0.4285, train_error: 0.2041
class 0: acc 0.875, correct 14/16
class 1: acc 1.0, correct 7/7
class 2: acc 0.9, correct 9/10
class 3: acc 0.5625, correct 9/16

Val Set, val_loss: 1.2495, val_error: 0.5455, auc: 0.8507
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.2270, instance_loss: 0.3078, weighted_loss: 0.2513, label: 1, bag_size: 36943
batch 39, loss: 0.1173, instance_loss: 0.2020, weighted_loss: 0.1427, label: 1, bag_size: 58270


class 0 clustering acc 0.9897959183673469: correct 1552/1568
class 1 clustering acc 0.1913265306122449: correct 75/392
Epoch: 46, train_loss: 0.5755, train_clustering_loss:  0.4145, train_error: 0.2653
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.8125, correct 13/16
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.0071, val_error: 0.4545, auc: 0.8611
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.6745, instance_loss: 0.3728, weighted_loss: 0.5840, label: 1, bag_size: 20030
batch 39, loss: 0.5796, instance_loss: 0.3958, weighted_loss: 0.5244, label: 2, bag_size: 59749


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.1377551020408163: correct 54/392
Epoch: 47, train_loss: 0.5460, train_clustering_loss:  0.4120, train_error: 0.1633
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.9, correct 18/20

Val Set, val_loss: 1.0105, val_error: 0.5455, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.3681, instance_loss: 0.3252, weighted_loss: 0.3552, label: 1, bag_size: 20030
batch 39, loss: 0.6625, instance_loss: 0.5191, weighted_loss: 0.6195, label: 2, bag_size: 22130


class 0 clustering acc 0.9955357142857143: correct 1561/1568
class 1 clustering acc 0.22193877551020408: correct 87/392
Epoch: 48, train_loss: 0.3997, train_clustering_loss:  0.3694, train_error: 0.0816
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 8/8
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.0306, val_error: 0.5455, auc: 0.8160
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.3772, instance_loss: 0.4094, weighted_loss: 0.3868, label: 2, bag_size: 54449
batch 39, loss: 0.2546, instance_loss: 0.3509, weighted_loss: 0.2835, label: 3, bag_size: 48489


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.2066326530612245: correct 81/392
Epoch: 49, train_loss: 0.4339, train_clustering_loss:  0.3881, train_error: 0.1633
class 0: acc 0.8125, correct 13/16
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 1.0, correct 9/9
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.2348, val_error: 0.7273, auc: 0.8160
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.4409, instance_loss: 0.3928, weighted_loss: 0.4265, label: 0, bag_size: 59141
batch 39, loss: 0.0769, instance_loss: 0.2068, weighted_loss: 0.1159, label: 3, bag_size: 56291


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.25: correct 98/392
Epoch: 50, train_loss: 0.4308, train_clustering_loss:  0.3838, train_error: 0.1224
class 0: acc 0.8947368421052632, correct 17/19
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 1.0, correct 8/8
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.3505, val_error: 0.6364, auc: 0.8264
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.2341, instance_loss: 0.3601, weighted_loss: 0.2719, label: 3, bag_size: 48489
batch 39, loss: 0.8323, instance_loss: 0.4443, weighted_loss: 0.7159, label: 2, bag_size: 113492


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.2602040816326531: correct 102/392
Epoch: 51, train_loss: 0.3599, train_clustering_loss:  0.3740, train_error: 0.0408
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 10/10
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 0.9605, val_error: 0.4545, auc: 0.8507
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (0.967228 --> 0.960455).  Saving model ...


batch 19, loss: 0.1667, instance_loss: 0.2548, weighted_loss: 0.1931, label: 1, bag_size: 57038
batch 39, loss: 0.1047, instance_loss: 0.2396, weighted_loss: 0.1452, label: 1, bag_size: 57038


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.27040816326530615: correct 106/392
Epoch: 52, train_loss: 0.3235, train_clustering_loss:  0.3545, train_error: 0.0408
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.2876, val_error: 0.6364, auc: 0.8611
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1692, instance_loss: 0.2136, weighted_loss: 0.1825, label: 1, bag_size: 57038
batch 39, loss: 0.3050, instance_loss: 0.3342, weighted_loss: 0.3138, label: 1, bag_size: 16373


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.35714285714285715: correct 140/392
Epoch: 53, train_loss: 0.4283, train_clustering_loss:  0.3627, train_error: 0.1429
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 1.3754, val_error: 0.5455, auc: 0.8021
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2118, instance_loss: 0.3525, weighted_loss: 0.2540, label: 2, bag_size: 54449
batch 39, loss: 1.0947, instance_loss: 0.6471, weighted_loss: 0.9604, label: 0, bag_size: 13999


class 0 clustering acc 0.9866071428571429: correct 1547/1568
class 1 clustering acc 0.42091836734693877: correct 165/392
Epoch: 54, train_loss: 0.4343, train_clustering_loss:  0.3658, train_error: 0.2041
class 0: acc 0.7, correct 7/10
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.2095, val_error: 0.5455, auc: 0.8403
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7062, instance_loss: 0.7531, weighted_loss: 0.7202, label: 3, bag_size: 196107
batch 39, loss: 0.2786, instance_loss: 0.3700, weighted_loss: 0.3060, label: 3, bag_size: 240896


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.26785714285714285: correct 105/392
Epoch: 55, train_loss: 0.4320, train_clustering_loss:  0.3796, train_error: 0.1429
class 0: acc 0.95, correct 19/20
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.75, correct 6/8
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.4278, val_error: 0.5455, auc: 0.8403
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1228, instance_loss: 0.3202, weighted_loss: 0.1820, label: 0, bag_size: 59141
batch 39, loss: 1.4932, instance_loss: 0.6572, weighted_loss: 1.2424, label: 0, bag_size: 10671


class 0 clustering acc 0.9808673469387755: correct 1538/1568
class 1 clustering acc 0.3239795918367347: correct 127/392
Epoch: 56, train_loss: 0.4429, train_clustering_loss:  0.3881, train_error: 0.1633
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 12/12
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 0.8465, val_error: 0.3636, auc: 0.8507
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (0.960455 --> 0.846510).  Saving model ...


batch 19, loss: 0.2139, instance_loss: 0.3346, weighted_loss: 0.2501, label: 0, bag_size: 6353
batch 39, loss: 0.2062, instance_loss: 0.2986, weighted_loss: 0.2339, label: 0, bag_size: 59141


class 0 clustering acc 0.9840561224489796: correct 1543/1568
class 1 clustering acc 0.23469387755102042: correct 92/392
Epoch: 57, train_loss: 0.4963, train_clustering_loss:  0.4014, train_error: 0.2041
class 0: acc 0.875, correct 14/16
class 1: acc 0.8333333333333334, correct 5/6
class 2: acc 0.7, correct 7/10
class 3: acc 0.7647058823529411, correct 13/17

Val Set, val_loss: 1.1305, val_error: 0.5455, auc: 0.8194
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4426, instance_loss: 0.3441, weighted_loss: 0.4130, label: 1, bag_size: 18329
batch 39, loss: 0.4250, instance_loss: 0.4645, weighted_loss: 0.4369, label: 0, bag_size: 130978


class 0 clustering acc 0.9904336734693877: correct 1553/1568
class 1 clustering acc 0.34183673469387754: correct 134/392
Epoch: 58, train_loss: 0.3705, train_clustering_loss:  0.3514, train_error: 0.0612
class 0: acc 1.0, correct 12/12
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 1.0, correct 14/14
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.1705, val_error: 0.3636, auc: 0.8194
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4886, instance_loss: 0.4895, weighted_loss: 0.4889, label: 3, bag_size: 40869
batch 39, loss: 0.5080, instance_loss: 0.5154, weighted_loss: 0.5102, label: 3, bag_size: 196107


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.37244897959183676: correct 146/392
Epoch: 59, train_loss: 0.2780, train_clustering_loss:  0.3286, train_error: 0.0204
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 18/18

Val Set, val_loss: 1.2604, val_error: 0.4545, auc: 0.8090
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2788, instance_loss: 0.3393, weighted_loss: 0.2970, label: 3, bag_size: 28883
batch 39, loss: 0.4026, instance_loss: 0.5936, weighted_loss: 0.4599, label: 3, bag_size: 196107


class 0 clustering acc 0.9853316326530612: correct 1545/1568
class 1 clustering acc 0.30357142857142855: correct 119/392
Epoch: 60, train_loss: 0.3417, train_clustering_loss:  0.3617, train_error: 0.0612
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 15/15
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.1877, val_error: 0.5455, auc: 0.8160
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.6511, instance_loss: 0.4450, weighted_loss: 0.5893, label: 1, bag_size: 104549
batch 39, loss: 0.0772, instance_loss: 0.1309, weighted_loss: 0.0933, label: 2, bag_size: 158432


class 0 clustering acc 0.9948979591836735: correct 1560/1568
class 1 clustering acc 0.3239795918367347: correct 127/392
Epoch: 61, train_loss: 0.3057, train_clustering_loss:  0.3491, train_error: 0.0408
class 0: acc 1.0, correct 17/17
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 1.0, correct 11/11
class 3: acc 0.8571428571428571, correct 6/7

Val Set, val_loss: 1.0974, val_error: 0.4545, auc: 0.8507
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 2.6599, instance_loss: 0.8961, weighted_loss: 2.1307, label: 0, bag_size: 46742
batch 39, loss: 0.1077, instance_loss: 0.2282, weighted_loss: 0.1438, label: 2, bag_size: 163352


class 0 clustering acc 0.9942602040816326: correct 1559/1568
class 1 clustering acc 0.3520408163265306: correct 138/392
Epoch: 62, train_loss: 0.5905, train_clustering_loss:  0.3741, train_error: 0.2245
class 0: acc 0.75, correct 6/8
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 1.0, correct 15/15
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.1234, val_error: 0.7273, auc: 0.8056
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1538, instance_loss: 0.2301, weighted_loss: 0.1767, label: 0, bag_size: 59350
batch 39, loss: 0.1798, instance_loss: 0.2796, weighted_loss: 0.2098, label: 0, bag_size: 22124


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.41581632653061223: correct 163/392
Epoch: 63, train_loss: 0.3405, train_clustering_loss:  0.3321, train_error: 0.0612
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 14/14
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.4364, val_error: 0.4545, auc: 0.7986
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.4088, instance_loss: 0.4356, weighted_loss: 0.4169, label: 0, bag_size: 46742
batch 39, loss: 0.2153, instance_loss: 0.3217, weighted_loss: 0.2472, label: 3, bag_size: 240896


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.5306122448979592: correct 208/392
Epoch: 64, train_loss: 0.3384, train_clustering_loss:  0.2830, train_error: 0.1224
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 1.0, correct 24/24
class 2: acc 1.0, correct 4/4
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.2812, val_error: 0.5455, auc: 0.8264
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.2093, instance_loss: 0.3932, weighted_loss: 0.2645, label: 3, bag_size: 152150
batch 39, loss: 0.0781, instance_loss: 0.3575, weighted_loss: 0.1619, label: 1, bag_size: 104549


class 0 clustering acc 0.9891581632653061: correct 1551/1568
class 1 clustering acc 0.4872448979591837: correct 191/392
Epoch: 65, train_loss: 0.3283, train_clustering_loss:  0.3105, train_error: 0.1224
class 0: acc 1.0, correct 16/16
class 1: acc 0.75, correct 6/8
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.4861, val_error: 0.5455, auc: 0.8160
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1649, instance_loss: 0.2918, weighted_loss: 0.2029, label: 2, bag_size: 54449
batch 39, loss: 0.8046, instance_loss: 0.6941, weighted_loss: 0.7714, label: 3, bag_size: 25448


class 0 clustering acc 0.9853316326530612: correct 1545/1568
class 1 clustering acc 0.44642857142857145: correct 175/392
Epoch: 66, train_loss: 0.3642, train_clustering_loss:  0.3267, train_error: 0.1020
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.3127, val_error: 0.5455, auc: 0.8056
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.1678, instance_loss: 0.2664, weighted_loss: 0.1974, label: 0, bag_size: 22124
batch 39, loss: 0.6821, instance_loss: 0.5438, weighted_loss: 0.6406, label: 0, bag_size: 13999


class 0 clustering acc 0.985969387755102: correct 1546/1568
class 1 clustering acc 0.45663265306122447: correct 179/392
Epoch: 67, train_loss: 0.2800, train_clustering_loss:  0.3255, train_error: 0.0000
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.3274, val_error: 0.5455, auc: 0.7813
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.3976, instance_loss: 0.2525, weighted_loss: 0.3540, label: 1, bag_size: 132271
batch 39, loss: 0.4845, instance_loss: 0.5385, weighted_loss: 0.5007, label: 0, bag_size: 6353


class 0 clustering acc 0.9853316326530612: correct 1545/1568
class 1 clustering acc 0.49489795918367346: correct 194/392
Epoch: 68, train_loss: 0.2492, train_clustering_loss:  0.3099, train_error: 0.0204
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 12/12
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.4588, val_error: 0.4545, auc: 0.8056
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0279, instance_loss: 0.0888, weighted_loss: 0.0462, label: 2, bag_size: 163352
batch 39, loss: 1.9003, instance_loss: 0.9954, weighted_loss: 1.6288, label: 3, bag_size: 196107


class 0 clustering acc 0.9866071428571429: correct 1547/1568
class 1 clustering acc 0.4923469387755102: correct 193/392
Epoch: 69, train_loss: 0.3130, train_clustering_loss:  0.3064, train_error: 0.0408
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 11/11
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.2893, val_error: 0.5455, auc: 0.8264
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.1021, instance_loss: 0.2582, weighted_loss: 0.1489, label: 0, bag_size: 70920
batch 39, loss: 1.3160, instance_loss: 0.8403, weighted_loss: 1.1733, label: 2, bag_size: 103108


class 0 clustering acc 0.9821428571428571: correct 1540/1568
class 1 clustering acc 0.5204081632653061: correct 204/392
Epoch: 70, train_loss: 0.3135, train_clustering_loss:  0.3167, train_error: 0.0612
class 0: acc 1.0, correct 11/11
class 1: acc 1.0, correct 13/13
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.2555, val_error: 0.5455, auc: 0.8090
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0491, instance_loss: 0.6165, weighted_loss: 0.2193, label: 3, bag_size: 189694
batch 39, loss: 0.3751, instance_loss: 0.3247, weighted_loss: 0.3600, label: 1, bag_size: 66789


class 0 clustering acc 0.9897959183673469: correct 1552/1568
class 1 clustering acc 0.5459183673469388: correct 214/392
Epoch: 71, train_loss: 0.2497, train_clustering_loss:  0.2927, train_error: 0.1020
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 1.0, correct 13/13
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.3536, val_error: 0.3636, auc: 0.8299
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.1527, instance_loss: 0.3431, weighted_loss: 0.2098, label: 2, bag_size: 176020
batch 39, loss: 0.1518, instance_loss: 0.2363, weighted_loss: 0.1772, label: 2, bag_size: 22130


class 0 clustering acc 0.985969387755102: correct 1546/1568
class 1 clustering acc 0.5612244897959183: correct 220/392
Epoch: 72, train_loss: 0.3367, train_clustering_loss:  0.3153, train_error: 0.0612
class 0: acc 1.0, correct 10/10
class 1: acc 1.0, correct 13/13
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.2966, val_error: 0.5455, auc: 0.8299
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0895, instance_loss: 0.1894, weighted_loss: 0.1195, label: 2, bag_size: 278757
batch 39, loss: 0.2100, instance_loss: 0.2938, weighted_loss: 0.2352, label: 2, bag_size: 17501


class 0 clustering acc 0.9872448979591837: correct 1548/1568
class 1 clustering acc 0.5102040816326531: correct 200/392
Epoch: 73, train_loss: 0.2491, train_clustering_loss:  0.2992, train_error: 0.0204
class 0: acc 1.0, correct 11/11
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 16/16
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.1030, val_error: 0.4545, auc: 0.8403
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1836, instance_loss: 0.2425, weighted_loss: 0.2013, label: 2, bag_size: 278757
batch 39, loss: 0.5652, instance_loss: 0.4856, weighted_loss: 0.5413, label: 2, bag_size: 113492


class 0 clustering acc 0.9885204081632653: correct 1550/1568
class 1 clustering acc 0.5714285714285714: correct 224/392
Epoch: 74, train_loss: 0.2429, train_clustering_loss:  0.2749, train_error: 0.0612
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 16/16
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.2822, val_error: 0.4545, auc: 0.8507
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0904, instance_loss: 0.1317, weighted_loss: 0.1028, label: 1, bag_size: 64834
batch 39, loss: 1.8190, instance_loss: 0.8782, weighted_loss: 1.5367, label: 3, bag_size: 196107


class 0 clustering acc 0.9891581632653061: correct 1551/1568
class 1 clustering acc 0.5841836734693877: correct 229/392
Epoch: 75, train_loss: 0.2258, train_clustering_loss:  0.2727, train_error: 0.0612
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 14/14
class 3: acc 0.5714285714285714, correct 4/7

Val Set, val_loss: 0.9259, val_error: 0.3636, auc: 0.8403
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2406, instance_loss: 0.2642, weighted_loss: 0.2477, label: 1, bag_size: 66789
batch 39, loss: 0.6973, instance_loss: 0.5316, weighted_loss: 0.6476, label: 2, bag_size: 113492


class 0 clustering acc 0.9815051020408163: correct 1539/1568
class 1 clustering acc 0.461734693877551: correct 181/392
Epoch: 76, train_loss: 0.3109, train_clustering_loss:  0.3185, train_error: 0.1224
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 1.0, correct 11/11
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.8421052631578947, correct 16/19

Val Set, val_loss: 1.1861, val_error: 0.4545, auc: 0.8090
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.3636, ROC AUC: 0.8507
Test error: 0.5455, ROC AUC: 0.6701
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3

Training Fold 3!

Init train/val/test splits... 
Done!
Training on 49 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.2026, instance_loss: 1.0314, weighted_loss: 1.1512, label: 3, bag_size: 25448
batch 39, loss: 1.4384, instance_loss: 0.9191, weighted_loss: 1.2826, label: 1, bag_size: 69073


class 0 clustering acc 0.9534438775510204: correct 1495/1568
class 1 clustering acc 0.06377551020408163: correct 25/392
Epoch: 0, train_loss: 1.3995, train_clustering_loss:  1.0290, train_error: 0.7347
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/15
class 2: acc 0.0, correct 0/11
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.4074, val_error: 0.7273, auc: 0.3333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.407386).  Saving model ...


batch 19, loss: 1.0392, instance_loss: 0.7357, weighted_loss: 0.9482, label: 1, bag_size: 16373
batch 39, loss: 1.0146, instance_loss: 0.6749, weighted_loss: 0.9127, label: 1, bag_size: 23122


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 1, train_loss: 1.3595, train_clustering_loss:  0.7236, train_error: 0.6122
class 0: acc 0.0, correct 0/8
class 1: acc 1.0, correct 18/18
class 2: acc 0.0, correct 0/10
class 3: acc 0.07692307692307693, correct 1/13

Val Set, val_loss: 1.4212, val_error: 0.7273, auc: 0.4479
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6676, instance_loss: 0.6594, weighted_loss: 1.3652, label: 2, bag_size: 209612
batch 39, loss: 1.1800, instance_loss: 0.6368, weighted_loss: 1.0170, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 2, train_loss: 1.4420, train_clustering_loss:  0.6468, train_error: 0.8163
class 0: acc 0.0, correct 0/12
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.23076923076923078, correct 3/13
class 3: acc 0.08333333333333333, correct 1/12

Val Set, val_loss: 1.3900, val_error: 0.8182, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.407386 --> 1.390028).  Saving model ...


batch 19, loss: 1.4400, instance_loss: 0.6169, weighted_loss: 1.1931, label: 2, bag_size: 163352
batch 39, loss: 1.3932, instance_loss: 0.6154, weighted_loss: 1.1598, label: 2, bag_size: 158432


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 3, train_loss: 1.3654, train_clustering_loss:  0.6102, train_error: 0.6735
class 0: acc 0.25, correct 2/8
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.17647058823529413, correct 3/17
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.4526, val_error: 0.8182, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5644, instance_loss: 0.6013, weighted_loss: 1.2755, label: 1, bag_size: 23122
batch 39, loss: 1.1110, instance_loss: 0.5389, weighted_loss: 0.9393, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 4, train_loss: 1.3597, train_clustering_loss:  0.6065, train_error: 0.6531
class 0: acc 0.0, correct 0/11
class 1: acc 0.0, correct 0/10
class 2: acc 1.0, correct 16/16
class 3: acc 0.08333333333333333, correct 1/12

Val Set, val_loss: 1.4161, val_error: 0.8182, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.3253, instance_loss: 0.6056, weighted_loss: 1.1094, label: 1, bag_size: 36943
batch 39, loss: 1.2818, instance_loss: 0.5254, weighted_loss: 1.0549, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 5, train_loss: 1.3839, train_clustering_loss:  0.6099, train_error: 0.7755
class 0: acc 0.5714285714285714, correct 8/14
class 1: acc 0.0, correct 0/10
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.0625, correct 1/16

Val Set, val_loss: 1.4036, val_error: 0.7273, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8788, instance_loss: 0.5117, weighted_loss: 0.7687, label: 3, bag_size: 48489
batch 39, loss: 1.3636, instance_loss: 0.6215, weighted_loss: 1.1410, label: 1, bag_size: 77634


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 6, train_loss: 1.3608, train_clustering_loss:  0.6053, train_error: 0.6122
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.375, correct 6/16
class 2: acc 0.0, correct 0/9
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.3821, val_error: 0.7273, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.390028 --> 1.382094).  Saving model ...


batch 19, loss: 1.2999, instance_loss: 0.6683, weighted_loss: 1.1105, label: 0, bag_size: 59350
batch 39, loss: 1.5230, instance_loss: 0.5924, weighted_loss: 1.2438, label: 3, bag_size: 40869


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 7, train_loss: 1.3309, train_clustering_loss:  0.6059, train_error: 0.6939
class 0: acc 0.08333333333333333, correct 1/12
class 1: acc 1.0, correct 13/13
class 2: acc 0.0, correct 0/13
class 3: acc 0.09090909090909091, correct 1/11

Val Set, val_loss: 1.3714, val_error: 0.5455, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.382094 --> 1.371402).  Saving model ...


batch 19, loss: 1.4208, instance_loss: 0.6081, weighted_loss: 1.1770, label: 1, bag_size: 81420
batch 39, loss: 1.1555, instance_loss: 0.5799, weighted_loss: 0.9828, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 8, train_loss: 1.2874, train_clustering_loss:  0.6044, train_error: 0.5918
class 0: acc 0.2857142857142857, correct 4/14
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.3729, val_error: 0.7273, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5023, instance_loss: 0.6343, weighted_loss: 1.2419, label: 1, bag_size: 104549
batch 39, loss: 1.1011, instance_loss: 0.6104, weighted_loss: 0.9538, label: 0, bag_size: 130978


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 9, train_loss: 1.3152, train_clustering_loss:  0.6003, train_error: 0.6327
class 0: acc 0.3076923076923077, correct 4/13
class 1: acc 0.0, correct 0/11
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.1, correct 1/10

Val Set, val_loss: 1.3847, val_error: 0.8182, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6607, instance_loss: 0.6432, weighted_loss: 1.3555, label: 1, bag_size: 16373
batch 39, loss: 1.9570, instance_loss: 0.6344, weighted_loss: 1.5602, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 10, train_loss: 1.3021, train_clustering_loss:  0.6082, train_error: 0.6531
class 0: acc 0.125, correct 1/8
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.25, correct 4/16

Val Set, val_loss: 1.3804, val_error: 0.5455, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.6163, instance_loss: 0.6458, weighted_loss: 1.3252, label: 0, bag_size: 10671
batch 39, loss: 0.9584, instance_loss: 0.5751, weighted_loss: 0.8434, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 11, train_loss: 1.2387, train_clustering_loss:  0.5889, train_error: 0.4898
class 0: acc 0.0, correct 0/7
class 1: acc 1.0, correct 17/17
class 2: acc 0.0, correct 0/12
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.3473, val_error: 0.5455, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.371402 --> 1.347320).  Saving model ...


batch 19, loss: 1.2218, instance_loss: 0.6372, weighted_loss: 1.0464, label: 0, bag_size: 59141
batch 39, loss: 1.3839, instance_loss: 0.5799, weighted_loss: 1.1427, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 12, train_loss: 1.2114, train_clustering_loss:  0.5922, train_error: 0.5102
class 0: acc 0.4444444444444444, correct 8/18
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.0, correct 0/6
class 3: acc 0.75, correct 12/16

Val Set, val_loss: 1.3216, val_error: 0.6364, auc: 0.7639
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.347320 --> 1.321642).  Saving model ...


batch 19, loss: 1.5739, instance_loss: 0.6493, weighted_loss: 1.2965, label: 1, bag_size: 104549
batch 39, loss: 0.7540, instance_loss: 0.5680, weighted_loss: 0.6982, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 13, train_loss: 1.2365, train_clustering_loss:  0.5916, train_error: 0.5918
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.0, correct 0/8
class 2: acc 0.16666666666666666, correct 2/12
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.3484, val_error: 0.6364, auc: 0.7743
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.7109, instance_loss: 0.6648, weighted_loss: 1.3971, label: 1, bag_size: 77634
batch 39, loss: 1.4531, instance_loss: 0.5814, weighted_loss: 1.1916, label: 3, bag_size: 25448


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 14, train_loss: 1.1965, train_clustering_loss:  0.5792, train_error: 0.5306
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.2857142857142857, correct 4/14
class 2: acc 0.3333333333333333, correct 2/6
class 3: acc 0.7058823529411765, correct 12/17

Val Set, val_loss: 1.3137, val_error: 0.4545, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.321642 --> 1.313747).  Saving model ...


batch 19, loss: 0.8947, instance_loss: 0.5718, weighted_loss: 0.7979, label: 1, bag_size: 81420
batch 39, loss: 0.6283, instance_loss: 0.4401, weighted_loss: 0.5718, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 15, train_loss: 1.1920, train_clustering_loss:  0.5871, train_error: 0.4286
class 0: acc 0.2857142857142857, correct 2/7
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.07142857142857142, correct 1/14
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.4355, val_error: 0.6364, auc: 0.7639
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9282, instance_loss: 0.6322, weighted_loss: 0.8394, label: 2, bag_size: 22130
batch 39, loss: 0.7272, instance_loss: 0.5699, weighted_loss: 0.6800, label: 2, bag_size: 22130


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 16, train_loss: 1.1892, train_clustering_loss:  0.5900, train_error: 0.5306
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.8947368421052632, correct 17/19
class 3: acc 0.36363636363636365, correct 4/11

Val Set, val_loss: 1.4555, val_error: 0.8182, auc: 0.7639
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9600, instance_loss: 0.6773, weighted_loss: 0.8752, label: 0, bag_size: 130978
batch 39, loss: 1.9427, instance_loss: 0.6484, weighted_loss: 1.5544, label: 1, bag_size: 66789


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 17, train_loss: 1.0376, train_clustering_loss:  0.5647, train_error: 0.3673
class 0: acc 0.6842105263157895, correct 13/19
class 1: acc 0.0, correct 0/5
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.3696, val_error: 0.5455, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.1215, instance_loss: 0.5668, weighted_loss: 0.9551, label: 0, bag_size: 6353
batch 39, loss: 1.2574, instance_loss: 0.5935, weighted_loss: 1.0582, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 18, train_loss: 1.2502, train_clustering_loss:  0.5925, train_error: 0.6327
class 0: acc 0.4, correct 4/10
class 1: acc 0.4, correct 6/15
class 2: acc 0.23076923076923078, correct 3/13
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3103, val_error: 0.5455, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.313747 --> 1.310270).  Saving model ...


batch 19, loss: 1.3574, instance_loss: 0.6026, weighted_loss: 1.1310, label: 0, bag_size: 19277
batch 39, loss: 1.1936, instance_loss: 0.4841, weighted_loss: 0.9808, label: 3, bag_size: 189694


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 19, train_loss: 1.0819, train_clustering_loss:  0.5603, train_error: 0.4898
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.15384615384615385, correct 2/13
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.2954, val_error: 0.5455, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.310270 --> 1.295380).  Saving model ...


batch 19, loss: 1.0497, instance_loss: 0.5895, weighted_loss: 0.9116, label: 1, bag_size: 47433
batch 39, loss: 0.7051, instance_loss: 0.5028, weighted_loss: 0.6444, label: 1, bag_size: 23122


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 20, train_loss: 0.9996, train_clustering_loss:  0.5423, train_error: 0.3061
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.8333333333333334, correct 15/18
class 2: acc 0.5, correct 4/8
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.3601, val_error: 0.7273, auc: 0.7361
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8585, instance_loss: 0.5055, weighted_loss: 0.7526, label: 1, bag_size: 18329
batch 39, loss: 1.0677, instance_loss: 0.5107, weighted_loss: 0.9006, label: 1, bag_size: 445537


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 21, train_loss: 1.0592, train_clustering_loss:  0.5577, train_error: 0.5306
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.875, correct 14/16
class 2: acc 0.08333333333333333, correct 1/12
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.3124, val_error: 0.4545, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.8033, instance_loss: 0.7851, weighted_loss: 2.1978, label: 3, bag_size: 22057
batch 39, loss: 0.4538, instance_loss: 0.4881, weighted_loss: 0.4641, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 22, train_loss: 0.9626, train_clustering_loss:  0.5366, train_error: 0.3673
class 0: acc 0.875, correct 14/16
class 1: acc 0.0, correct 0/10
class 2: acc 0.9, correct 9/10
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.3284, val_error: 0.7273, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.5657, instance_loss: 0.6361, weighted_loss: 1.2869, label: 3, bag_size: 28883
batch 39, loss: 0.8058, instance_loss: 0.5960, weighted_loss: 0.7429, label: 2, bag_size: 209612


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 23, train_loss: 0.9230, train_clustering_loss:  0.5302, train_error: 0.4082
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 0.4, correct 4/10
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.3507, val_error: 0.6364, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.8142, instance_loss: 0.6452, weighted_loss: 1.4635, label: 1, bag_size: 18329
batch 39, loss: 1.1162, instance_loss: 0.5032, weighted_loss: 0.9323, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.01020408163265306: correct 4/392
Epoch: 24, train_loss: 1.0266, train_clustering_loss:  0.5327, train_error: 0.5102
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.0, correct 0/9
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.3016, val_error: 0.4545, auc: 0.7361
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.8611, instance_loss: 0.5517, weighted_loss: 0.7683, label: 2, bag_size: 209612
batch 39, loss: 0.6906, instance_loss: 0.4529, weighted_loss: 0.6193, label: 3, bag_size: 40869


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.03571428571428571: correct 14/392
Epoch: 25, train_loss: 0.9155, train_clustering_loss:  0.5214, train_error: 0.2857
class 0: acc 0.9, correct 9/10
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.3713, val_error: 0.5455, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0866, instance_loss: 0.2519, weighted_loss: 0.1362, label: 3, bag_size: 196107
batch 39, loss: 1.2995, instance_loss: 0.5585, weighted_loss: 1.0772, label: 3, bag_size: 28883


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.05612244897959184: correct 22/392
Epoch: 26, train_loss: 0.9899, train_clustering_loss:  0.5189, train_error: 0.4490
class 0: acc 0.4, correct 4/10
class 1: acc 0.5, correct 3/6
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.5714285714285714, correct 12/21

Val Set, val_loss: 1.2965, val_error: 0.4545, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.2582, instance_loss: 0.6063, weighted_loss: 1.0626, label: 1, bag_size: 81420
batch 39, loss: 0.0753, instance_loss: 0.2574, weighted_loss: 0.1299, label: 3, bag_size: 196107


class 0 clustering acc 0.9968112244897959: correct 1563/1568
class 1 clustering acc 0.10204081632653061: correct 40/392
Epoch: 27, train_loss: 0.9529, train_clustering_loss:  0.5090, train_error: 0.3673
class 0: acc 0.2, correct 1/5
class 1: acc 0.5882352941176471, correct 10/17
class 2: acc 0.6153846153846154, correct 8/13
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.4809, val_error: 0.6364, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.6508, instance_loss: 0.4910, weighted_loss: 0.6029, label: 1, bag_size: 18329
batch 39, loss: 1.8092, instance_loss: 0.5937, weighted_loss: 1.4446, label: 3, bag_size: 25448


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.05612244897959184: correct 22/392
Epoch: 28, train_loss: 0.9289, train_clustering_loss:  0.5044, train_error: 0.4082
class 0: acc 0.2, correct 2/10
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.4125, val_error: 0.7273, auc: 0.6632
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.0204, instance_loss: 0.6038, weighted_loss: 0.8954, label: 0, bag_size: 59141
batch 39, loss: 0.0254, instance_loss: 0.1061, weighted_loss: 0.0496, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.04846938775510204: correct 19/392
Epoch: 29, train_loss: 0.8343, train_clustering_loss:  0.4991, train_error: 0.2653
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.5, correct 3/6
class 2: acc 0.875, correct 14/16
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.4103, val_error: 0.7273, auc: 0.7049
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.1813, instance_loss: 0.5602, weighted_loss: 0.9950, label: 2, bag_size: 54449
batch 39, loss: 0.7874, instance_loss: 0.5238, weighted_loss: 0.7083, label: 2, bag_size: 149988


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.06887755102040816: correct 27/392
Epoch: 30, train_loss: 0.8829, train_clustering_loss:  0.4906, train_error: 0.3265
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.3457, val_error: 0.7273, auc: 0.6736
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.3057, instance_loss: 0.5957, weighted_loss: 1.0927, label: 1, bag_size: 132271
batch 39, loss: 1.1552, instance_loss: 0.5784, weighted_loss: 0.9822, label: 1, bag_size: 77634


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.05357142857142857: correct 21/392
Epoch: 31, train_loss: 0.9043, train_clustering_loss:  0.5050, train_error: 0.4082
class 0: acc 0.8888888888888888, correct 16/18
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.0, correct 0/6
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.4097, val_error: 0.7273, auc: 0.6632
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.4999, instance_loss: 0.4623, weighted_loss: 0.4886, label: 2, bag_size: 278757
batch 39, loss: 0.6641, instance_loss: 0.4859, weighted_loss: 0.6106, label: 2, bag_size: 393657


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.09948979591836735: correct 39/392
Epoch: 32, train_loss: 0.7275, train_clustering_loss:  0.4582, train_error: 0.2245
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.8, correct 12/15
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4425, val_error: 0.5455, auc: 0.6840
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.4664, instance_loss: 0.5997, weighted_loss: 1.2064, label: 3, bag_size: 16626
batch 39, loss: 0.3011, instance_loss: 0.3153, weighted_loss: 0.3054, label: 3, bag_size: 40869


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.07653061224489796: correct 30/392
Epoch: 33, train_loss: 0.6869, train_clustering_loss:  0.4423, train_error: 0.2449
class 0: acc 0.8, correct 8/10
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.5565, val_error: 0.5455, auc: 0.6528
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.7534, instance_loss: 0.5329, weighted_loss: 0.6872, label: 1, bag_size: 23122
batch 39, loss: 1.1659, instance_loss: 0.6052, weighted_loss: 0.9977, label: 1, bag_size: 16373


class 0 clustering acc 0.9942602040816326: correct 1559/1568
class 1 clustering acc 0.17346938775510204: correct 68/392
Epoch: 34, train_loss: 0.8285, train_clustering_loss:  0.4789, train_error: 0.3469
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.375, correct 3/8
class 2: acc 0.7, correct 7/10
class 3: acc 0.631578947368421, correct 12/19

Val Set, val_loss: 1.4535, val_error: 0.5455, auc: 0.6632
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.1209, instance_loss: 0.2581, weighted_loss: 0.1621, label: 3, bag_size: 40869
batch 39, loss: 0.8074, instance_loss: 0.4402, weighted_loss: 0.6973, label: 0, bag_size: 13999


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.14540816326530612: correct 57/392
Epoch: 35, train_loss: 0.6275, train_clustering_loss:  0.4226, train_error: 0.1633
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4933, val_error: 0.5455, auc: 0.6632
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.3815, instance_loss: 0.4074, weighted_loss: 0.3893, label: 0, bag_size: 46742
batch 39, loss: 1.1186, instance_loss: 0.5628, weighted_loss: 0.9519, label: 1, bag_size: 104549


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.16326530612244897: correct 64/392
Epoch: 36, train_loss: 0.7504, train_clustering_loss:  0.4414, train_error: 0.2653
class 0: acc 1.0, correct 11/11
class 1: acc 0.5, correct 5/10
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.8125, correct 13/16

Val Set, val_loss: 1.5062, val_error: 0.5455, auc: 0.6424
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0374, instance_loss: 0.1332, weighted_loss: 0.0662, label: 3, bag_size: 196107
batch 39, loss: 1.5560, instance_loss: 0.6090, weighted_loss: 1.2719, label: 1, bag_size: 445537


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.15816326530612246: correct 62/392
Epoch: 37, train_loss: 0.7222, train_clustering_loss:  0.4418, train_error: 0.2041
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 1.0, correct 12/12
class 3: acc 0.75, correct 12/16

Val Set, val_loss: 1.5963, val_error: 0.7273, auc: 0.6736
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.7101, instance_loss: 0.4271, weighted_loss: 0.6252, label: 0, bag_size: 13999
batch 39, loss: 0.4815, instance_loss: 0.4004, weighted_loss: 0.4572, label: 2, bag_size: 23349


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.08163265306122448: correct 32/392
Epoch: 38, train_loss: 0.8745, train_clustering_loss:  0.4881, train_error: 0.3469
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.7, correct 7/10
class 3: acc 0.36363636363636365, correct 4/11

Val Set, val_loss: 1.4354, val_error: 0.6364, auc: 0.7465
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0861, instance_loss: 0.1509, weighted_loss: 0.1055, label: 3, bag_size: 196107
batch 39, loss: 0.3196, instance_loss: 0.2429, weighted_loss: 0.2966, label: 3, bag_size: 262536


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.19642857142857142: correct 77/392
Epoch: 39, train_loss: 0.7313, train_clustering_loss:  0.4466, train_error: 0.2653
class 0: acc 0.5, correct 4/8
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.6210, val_error: 0.6364, auc: 0.7049
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.4585, instance_loss: 0.4324, weighted_loss: 0.4506, label: 1, bag_size: 104549
batch 39, loss: 0.3008, instance_loss: 0.2202, weighted_loss: 0.2766, label: 3, bag_size: 189694


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.17091836734693877: correct 67/392
Epoch: 40, train_loss: 0.7113, train_clustering_loss:  0.4361, train_error: 0.2449
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.5784, val_error: 0.5455, auc: 0.6840
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.6300, instance_loss: 0.7747, weighted_loss: 1.3734, label: 1, bag_size: 104549
batch 39, loss: 0.1974, instance_loss: 0.2242, weighted_loss: 0.2054, label: 2, bag_size: 113492


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.1989795918367347: correct 78/392
Epoch: 41, train_loss: 0.6368, train_clustering_loss:  0.4159, train_error: 0.2041
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7894736842105263, correct 15/19
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.7830, val_error: 0.7273, auc: 0.7153
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 1.0603, instance_loss: 0.5906, weighted_loss: 0.9194, label: 0, bag_size: 10671
batch 39, loss: 1.3992, instance_loss: 0.6534, weighted_loss: 1.1754, label: 3, bag_size: 16626


class 0 clustering acc 0.9980867346938775: correct 1565/1568
class 1 clustering acc 0.1096938775510204: correct 43/392
Epoch: 42, train_loss: 0.6288, train_clustering_loss:  0.4322, train_error: 0.2449
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.8125, correct 13/16
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.4873, val_error: 0.5455, auc: 0.7153
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 2.3719, instance_loss: 0.9742, weighted_loss: 1.9526, label: 2, bag_size: 59749
batch 39, loss: 0.2563, instance_loss: 0.1801, weighted_loss: 0.2334, label: 3, bag_size: 189694


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.1096938775510204: correct 43/392
Epoch: 43, train_loss: 0.7284, train_clustering_loss:  0.4601, train_error: 0.2449
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.6, correct 6/10
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.5042, val_error: 0.6364, auc: 0.6944
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.2465, instance_loss: 0.3029, weighted_loss: 0.2634, label: 0, bag_size: 18551
batch 39, loss: 0.6505, instance_loss: 0.5303, weighted_loss: 0.6144, label: 1, bag_size: 16373


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.18877551020408162: correct 74/392
Epoch: 44, train_loss: 0.6119, train_clustering_loss:  0.4179, train_error: 0.2245
class 0: acc 0.75, correct 6/8
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 1.0, correct 16/16
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.6136, val_error: 0.7273, auc: 0.6528
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.1288, instance_loss: 0.1868, weighted_loss: 0.1462, label: 3, bag_size: 189694
batch 39, loss: 0.1655, instance_loss: 0.1954, weighted_loss: 0.1745, label: 3, bag_size: 189694


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.29081632653061223: correct 114/392
Epoch: 45, train_loss: 0.7192, train_clustering_loss:  0.4263, train_error: 0.2653
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.5, correct 4/8
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.75, correct 12/16

Val Set, val_loss: 1.5180, val_error: 0.6364, auc: 0.6944
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.4686, instance_loss: 0.4240, weighted_loss: 0.4552, label: 0, bag_size: 10671
batch 39, loss: 0.3259, instance_loss: 0.4155, weighted_loss: 0.3528, label: 1, bag_size: 47433


class 0 clustering acc 0.9929846938775511: correct 1557/1568
class 1 clustering acc 0.23214285714285715: correct 91/392
Epoch: 46, train_loss: 0.4994, train_clustering_loss:  0.3767, train_error: 0.1633
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.9, correct 18/20
class 2: acc 0.6666666666666666, correct 4/6
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.7072, val_error: 0.7273, auc: 0.6319
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.6103, instance_loss: 0.4253, weighted_loss: 0.5548, label: 0, bag_size: 19277
batch 39, loss: 2.7543, instance_loss: 1.0640, weighted_loss: 2.2472, label: 2, bag_size: 59749


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.2423469387755102: correct 95/392
Epoch: 47, train_loss: 0.7418, train_clustering_loss:  0.4273, train_error: 0.2857
class 0: acc 0.8, correct 12/15
class 1: acc 1.0, correct 6/6
class 2: acc 0.5, correct 6/12
class 3: acc 0.6875, correct 11/16

Val Set, val_loss: 1.5754, val_error: 0.7273, auc: 0.6840
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.6229, instance_loss: 0.4066, weighted_loss: 0.5580, label: 0, bag_size: 19277
batch 39, loss: 0.5886, instance_loss: 0.4121, weighted_loss: 0.5357, label: 2, bag_size: 22130


class 0 clustering acc 0.9980867346938775: correct 1565/1568
class 1 clustering acc 0.18622448979591838: correct 73/392
Epoch: 48, train_loss: 0.5501, train_clustering_loss:  0.3932, train_error: 0.2449
class 0: acc 0.875, correct 14/16
class 1: acc 0.5, correct 5/10
class 2: acc 1.0, correct 11/11
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.5091, val_error: 0.6364, auc: 0.7257
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.4636, instance_loss: 0.3721, weighted_loss: 0.4362, label: 2, bag_size: 54449
batch 39, loss: 0.4928, instance_loss: 0.4443, weighted_loss: 0.4783, label: 1, bag_size: 132271


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.22193877551020408: correct 87/392
Epoch: 49, train_loss: 0.5789, train_clustering_loss:  0.4070, train_error: 0.1429
class 0: acc 1.0, correct 14/14
class 1: acc 0.8, correct 12/15
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.6369, val_error: 0.7273, auc: 0.6319
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.2284, instance_loss: 0.3554, weighted_loss: 0.2665, label: 0, bag_size: 59141
batch 39, loss: 0.0030, instance_loss: 0.0358, weighted_loss: 0.0128, label: 3, bag_size: 181076


class 0 clustering acc 0.985969387755102: correct 1546/1568
class 1 clustering acc 0.18112244897959184: correct 71/392
Epoch: 50, train_loss: 0.6235, train_clustering_loss:  0.4250, train_error: 0.2245
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.5, correct 3/6
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.4015, val_error: 0.5455, auc: 0.7153
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.3075, instance_loss: 0.3295, weighted_loss: 0.3141, label: 1, bag_size: 132271
batch 39, loss: 0.1201, instance_loss: 0.1467, weighted_loss: 0.1281, label: 3, bag_size: 48489


class 0 clustering acc 0.9872448979591837: correct 1548/1568
class 1 clustering acc 0.27040816326530615: correct 106/392
Epoch: 51, train_loss: 0.5571, train_clustering_loss:  0.3732, train_error: 0.1837
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.9, correct 9/10
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.4825, val_error: 0.6364, auc: 0.6944
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 32 out of 20
Early stopping
Val error: 0.5455, ROC AUC: 0.7674
Test error: 0.6364, ROC AUC: 0.7500
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3

Training Fold 4!

Init train/val/test splits... 
Done!
Training on 49 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 2.0203, instance_loss: 1.0820, weighted_loss: 1.7388, label: 0, bag_size: 108548
batch 39, loss: 1.8656, instance_loss: 0.9158, weighted_loss: 1.5806, label: 1, bag_size: 58270


class 0 clustering acc 0.9368622448979592: correct 1469/1568
class 1 clustering acc 0.10714285714285714: correct 42/392
Epoch: 0, train_loss: 1.4167, train_clustering_loss:  1.0097, train_error: 0.6327
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/9
class 2: acc 0.0, correct 0/12
class 3: acc 1.0, correct 18/18

Val Set, val_loss: 1.4215, val_error: 0.7273, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.421544).  Saving model ...


batch 19, loss: 1.5704, instance_loss: 0.7548, weighted_loss: 1.3257, label: 1, bag_size: 104549
batch 39, loss: 1.6402, instance_loss: 0.7051, weighted_loss: 1.3597, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 1, train_loss: 1.4074, train_clustering_loss:  0.7161, train_error: 0.7551
class 0: acc 0.1875, correct 3/16
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/10
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.3804, val_error: 0.7273, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.421544 --> 1.380445).  Saving model ...


batch 19, loss: 1.5470, instance_loss: 0.6401, weighted_loss: 1.2749, label: 2, bag_size: 278757
batch 39, loss: 1.3236, instance_loss: 0.6058, weighted_loss: 1.1083, label: 0, bag_size: 47775


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 2, train_loss: 1.3910, train_clustering_loss:  0.6306, train_error: 0.7347
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.07692307692307693, correct 1/13
class 2: acc 0.3333333333333333, correct 5/15
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4080, val_error: 0.8182, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2876, instance_loss: 0.6145, weighted_loss: 1.0857, label: 2, bag_size: 17501
batch 39, loss: 1.1870, instance_loss: 0.6125, weighted_loss: 1.0146, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 3, train_loss: 1.3648, train_clustering_loss:  0.6194, train_error: 0.6327
class 0: acc 0.0, correct 0/12
class 1: acc 0.8, correct 8/10
class 2: acc 0.625, correct 10/16
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.4253, val_error: 0.8182, auc: 0.7396
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6174, instance_loss: 0.6255, weighted_loss: 1.3198, label: 1, bag_size: 58270
batch 39, loss: 1.5160, instance_loss: 0.5692, weighted_loss: 1.2320, label: 2, bag_size: 149988


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 4, train_loss: 1.3817, train_clustering_loss:  0.6185, train_error: 0.6939
class 0: acc 0.0, correct 0/8
class 1: acc 0.17647058823529413, correct 3/17
class 2: acc 0.7, correct 7/10
class 3: acc 0.35714285714285715, correct 5/14

Val Set, val_loss: 1.3720, val_error: 0.7273, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.380445 --> 1.372025).  Saving model ...


batch 19, loss: 1.1333, instance_loss: 0.6129, weighted_loss: 0.9772, label: 1, bag_size: 18329
batch 39, loss: 1.5879, instance_loss: 0.6217, weighted_loss: 1.2981, label: 2, bag_size: 209612


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 5, train_loss: 1.3894, train_clustering_loss:  0.6257, train_error: 0.7347
class 0: acc 0.13333333333333333, correct 2/15
class 1: acc 0.8, correct 8/10
class 2: acc 0.0, correct 0/9
class 3: acc 0.2, correct 3/15

Val Set, val_loss: 1.3625, val_error: 0.8182, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.372025 --> 1.362514).  Saving model ...


batch 19, loss: 0.8762, instance_loss: 0.5795, weighted_loss: 0.7872, label: 3, bag_size: 152150
batch 39, loss: 1.3298, instance_loss: 0.6089, weighted_loss: 1.1135, label: 1, bag_size: 77634


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 6, train_loss: 1.3686, train_clustering_loss:  0.6158, train_error: 0.6939
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.15384615384615385, correct 2/13
class 2: acc 0.21428571428571427, correct 3/14
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3952, val_error: 0.6364, auc: 0.6875
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4290, instance_loss: 0.6419, weighted_loss: 1.1929, label: 0, bag_size: 46742
batch 39, loss: 1.4831, instance_loss: 0.6157, weighted_loss: 1.2229, label: 3, bag_size: 28883


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 7, train_loss: 1.3499, train_clustering_loss:  0.6111, train_error: 0.6531
class 0: acc 0.0, correct 0/10
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.5714285714285714, correct 8/14
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.3868, val_error: 0.6364, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2030, instance_loss: 0.5909, weighted_loss: 1.0194, label: 1, bag_size: 57038
batch 39, loss: 1.2761, instance_loss: 0.6552, weighted_loss: 1.0898, label: 0, bag_size: 47775


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 8, train_loss: 1.3104, train_clustering_loss:  0.6187, train_error: 0.6531
class 0: acc 0.07692307692307693, correct 1/13
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.1111111111111111, correct 1/9
class 3: acc 0.5, correct 8/16

Val Set, val_loss: 1.3426, val_error: 0.7273, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.362514 --> 1.342625).  Saving model ...


batch 19, loss: 1.4786, instance_loss: 0.6076, weighted_loss: 1.2173, label: 2, bag_size: 209612
batch 39, loss: 1.6518, instance_loss: 0.6365, weighted_loss: 1.3472, label: 1, bag_size: 23122


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 9, train_loss: 1.2813, train_clustering_loss:  0.6175, train_error: 0.5306
class 0: acc 1.0, correct 11/11
class 1: acc 0.14285714285714285, correct 2/14
class 2: acc 0.0, correct 0/10
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.3376, val_error: 0.6364, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.342625 --> 1.337634).  Saving model ...


batch 19, loss: 0.9467, instance_loss: 0.5648, weighted_loss: 0.8321, label: 1, bag_size: 64834
batch 39, loss: 1.8008, instance_loss: 0.6973, weighted_loss: 1.4698, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 10, train_loss: 1.1682, train_clustering_loss:  0.5982, train_error: 0.4286
class 0: acc 0.0, correct 0/8
class 1: acc 0.7647058823529411, correct 13/17
class 2: acc 0.0, correct 0/7
class 3: acc 0.8823529411764706, correct 15/17

Val Set, val_loss: 1.4046, val_error: 0.7273, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8525, instance_loss: 0.5086, weighted_loss: 0.7494, label: 1, bag_size: 16373
batch 39, loss: 1.0285, instance_loss: 0.6257, weighted_loss: 0.9076, label: 2, bag_size: 103108


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 11, train_loss: 1.2421, train_clustering_loss:  0.6022, train_error: 0.5510
class 0: acc 0.0, correct 0/8
class 1: acc 0.9375, correct 15/16
class 2: acc 0.2777777777777778, correct 5/18
class 3: acc 0.2857142857142857, correct 2/7

Val Set, val_loss: 1.4162, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2319, instance_loss: 0.6346, weighted_loss: 1.0527, label: 0, bag_size: 59141
batch 39, loss: 1.1940, instance_loss: 0.5982, weighted_loss: 1.0153, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 12, train_loss: 1.3421, train_clustering_loss:  0.6114, train_error: 0.5510
class 0: acc 0.4117647058823529, correct 7/17
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4043, val_error: 0.6364, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.1686, instance_loss: 0.5538, weighted_loss: 0.9841, label: 2, bag_size: 209612
batch 39, loss: 1.1158, instance_loss: 0.5652, weighted_loss: 0.9506, label: 0, bag_size: 46742


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 13, train_loss: 1.2234, train_clustering_loss:  0.5989, train_error: 0.5918
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.0, correct 0/9
class 2: acc 0.46153846153846156, correct 6/13
class 3: acc 0.23076923076923078, correct 3/13

Val Set, val_loss: 1.3853, val_error: 0.7273, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.4123, instance_loss: 0.5796, weighted_loss: 1.1625, label: 1, bag_size: 77634
batch 39, loss: 1.3653, instance_loss: 0.6101, weighted_loss: 1.1387, label: 0, bag_size: 108548


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 14, train_loss: 1.1917, train_clustering_loss:  0.5948, train_error: 0.5102
class 0: acc 0.3, correct 3/10
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.3068, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.337634 --> 1.306824).  Saving model ...


batch 19, loss: 0.8074, instance_loss: 0.5661, weighted_loss: 0.7350, label: 3, bag_size: 113328
batch 39, loss: 0.6796, instance_loss: 0.5679, weighted_loss: 0.6461, label: 3, bag_size: 152150


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 15, train_loss: 1.2515, train_clustering_loss:  0.6008, train_error: 0.6327
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.3076923076923077, correct 4/13
class 3: acc 0.6111111111111112, correct 11/18

Val Set, val_loss: 1.2930, val_error: 0.7273, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.306824 --> 1.292958).  Saving model ...


batch 19, loss: 0.8552, instance_loss: 0.5208, weighted_loss: 0.7549, label: 2, bag_size: 278757
batch 39, loss: 1.0130, instance_loss: 0.5454, weighted_loss: 0.8727, label: 2, bag_size: 278757


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 16, train_loss: 1.2745, train_clustering_loss:  0.5946, train_error: 0.6735
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.35714285714285715, correct 5/14
class 2: acc 0.25, correct 3/12
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.2953, val_error: 0.5455, auc: 0.7500
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5158, instance_loss: 0.5941, weighted_loss: 1.2393, label: 1, bag_size: 23122
batch 39, loss: 0.9279, instance_loss: 0.6034, weighted_loss: 0.8306, label: 2, bag_size: 103108


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 17, train_loss: 1.1466, train_clustering_loss:  0.5876, train_error: 0.4286
class 0: acc 0.5, correct 7/14
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.2653, val_error: 0.5455, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.292958 --> 1.265267).  Saving model ...


batch 19, loss: 1.3269, instance_loss: 0.5947, weighted_loss: 1.1072, label: 0, bag_size: 6353
batch 39, loss: 1.5905, instance_loss: 0.6403, weighted_loss: 1.3054, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 18, train_loss: 1.1175, train_clustering_loss:  0.5853, train_error: 0.5918
class 0: acc 0.1, correct 1/10
class 1: acc 0.42857142857142855, correct 6/14
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.4375, correct 7/16

Val Set, val_loss: 1.2547, val_error: 0.6364, auc: 0.8125
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.265267 --> 1.254650).  Saving model ...


batch 19, loss: 1.3453, instance_loss: 0.6149, weighted_loss: 1.1262, label: 0, bag_size: 65047
batch 39, loss: 0.9834, instance_loss: 0.5842, weighted_loss: 0.8636, label: 0, bag_size: 222326


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 19, train_loss: 1.2997, train_clustering_loss:  0.6028, train_error: 0.5510
class 0: acc 0.2727272727272727, correct 3/11
class 1: acc 0.5, correct 7/14
class 2: acc 0.3076923076923077, correct 4/13
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.2471, val_error: 0.4545, auc: 0.8229
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.254650 --> 1.247076).  Saving model ...


batch 19, loss: 1.4767, instance_loss: 0.5770, weighted_loss: 1.2068, label: 1, bag_size: 57038
batch 39, loss: 0.9236, instance_loss: 0.6029, weighted_loss: 0.8274, label: 1, bag_size: 104549


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 20, train_loss: 1.1128, train_clustering_loss:  0.5760, train_error: 0.4082
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.6111111111111112, correct 11/18
class 2: acc 0.45454545454545453, correct 5/11
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.2125, val_error: 0.6364, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.247076 --> 1.212451).  Saving model ...


batch 19, loss: 0.7708, instance_loss: 0.5938, weighted_loss: 0.7177, label: 2, bag_size: 103108
batch 39, loss: 0.4721, instance_loss: 0.5527, weighted_loss: 0.4963, label: 0, bag_size: 453871


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 21, train_loss: 1.0196, train_clustering_loss:  0.5685, train_error: 0.4082
class 0: acc 0.47058823529411764, correct 8/17
class 1: acc 0.7, correct 7/10
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.2958, val_error: 0.6364, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9755, instance_loss: 0.6076, weighted_loss: 0.8652, label: 3, bag_size: 16626
batch 39, loss: 0.8285, instance_loss: 0.4675, weighted_loss: 0.7202, label: 0, bag_size: 46742


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 22, train_loss: 1.0501, train_clustering_loss:  0.5699, train_error: 0.4490
class 0: acc 0.9375, correct 15/16
class 1: acc 0.09090909090909091, correct 1/11
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.1593, val_error: 0.5455, auc: 0.8021
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.212451 --> 1.159336).  Saving model ...


batch 19, loss: 0.8527, instance_loss: 0.5693, weighted_loss: 0.7677, label: 3, bag_size: 189694
batch 39, loss: 0.6031, instance_loss: 0.6686, weighted_loss: 0.6228, label: 3, bag_size: 196107


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 23, train_loss: 0.9647, train_clustering_loss:  0.5592, train_error: 0.2041
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.1467, val_error: 0.6364, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.159336 --> 1.146722).  Saving model ...


batch 19, loss: 0.9454, instance_loss: 0.4323, weighted_loss: 0.7915, label: 2, bag_size: 103108
batch 39, loss: 0.9938, instance_loss: 0.5381, weighted_loss: 0.8571, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 24, train_loss: 1.0766, train_clustering_loss:  0.5635, train_error: 0.4898
class 0: acc 0.3, correct 3/10
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.46153846153846156, correct 6/13
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.1653, val_error: 0.5455, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0715, instance_loss: 0.4864, weighted_loss: 0.8960, label: 2, bag_size: 278757
batch 39, loss: 0.9837, instance_loss: 0.5761, weighted_loss: 0.8614, label: 2, bag_size: 17501


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 25, train_loss: 0.9624, train_clustering_loss:  0.5382, train_error: 0.3673
class 0: acc 0.5, correct 6/12
class 1: acc 0.875, correct 14/16
class 2: acc 0.46153846153846156, correct 6/13
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.1606, val_error: 0.6364, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.5823, instance_loss: 0.6752, weighted_loss: 2.0102, label: 1, bag_size: 445537
batch 39, loss: 0.4204, instance_loss: 0.5365, weighted_loss: 0.4552, label: 3, bag_size: 189694


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 26, train_loss: 1.1293, train_clustering_loss:  0.5763, train_error: 0.5102
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.625, correct 5/8
class 3: acc 0.42857142857142855, correct 9/21

Val Set, val_loss: 1.1898, val_error: 0.6364, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.3980, instance_loss: 0.5140, weighted_loss: 0.4328, label: 3, bag_size: 113328
batch 39, loss: 2.3083, instance_loss: 0.8593, weighted_loss: 1.8736, label: 0, bag_size: 222491


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 27, train_loss: 0.9614, train_clustering_loss:  0.5556, train_error: 0.3673
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5, correct 6/12
class 2: acc 0.42857142857142855, correct 6/14
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.1740, val_error: 0.5455, auc: 0.7500
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.4229, instance_loss: 0.5042, weighted_loss: 0.4473, label: 3, bag_size: 113328
batch 39, loss: 0.7366, instance_loss: 0.5725, weighted_loss: 0.6874, label: 0, bag_size: 108548


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 28, train_loss: 0.9231, train_clustering_loss:  0.5557, train_error: 0.3469
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.2497, val_error: 0.5455, auc: 0.8021
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.7194, instance_loss: 0.4973, weighted_loss: 0.6527, label: 0, bag_size: 59141
batch 39, loss: 0.2637, instance_loss: 0.2910, weighted_loss: 0.2719, label: 2, bag_size: 209612


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 29, train_loss: 0.8599, train_clustering_loss:  0.5079, train_error: 0.3673
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/8
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.125, correct 1/8

Val Set, val_loss: 1.2026, val_error: 0.6364, auc: 0.8090
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.6390, instance_loss: 0.5285, weighted_loss: 0.6058, label: 1, bag_size: 20030
batch 39, loss: 0.9088, instance_loss: 0.6920, weighted_loss: 0.8438, label: 3, bag_size: 231301


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.00510204081632653: correct 2/392
Epoch: 30, train_loss: 0.8899, train_clustering_loss:  0.5312, train_error: 0.4286
class 0: acc 0.8, correct 4/5
class 1: acc 0.47058823529411764, correct 8/17
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.1736, val_error: 0.5455, auc: 0.7812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.4274, instance_loss: 0.2615, weighted_loss: 0.3776, label: 2, bag_size: 113492
batch 39, loss: 0.7486, instance_loss: 0.4253, weighted_loss: 0.6516, label: 1, bag_size: 77634


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.002551020408163265: correct 1/392
Epoch: 31, train_loss: 0.9230, train_clustering_loss:  0.5530, train_error: 0.3673
class 0: acc 0.5, correct 7/14
class 1: acc 0.8, correct 12/15
class 2: acc 0.6666666666666666, correct 4/6
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.1550, val_error: 0.7273, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.3474, instance_loss: 0.7586, weighted_loss: 1.1707, label: 0, bag_size: 222491
batch 39, loss: 0.6133, instance_loss: 0.2808, weighted_loss: 0.5135, label: 2, bag_size: 393657


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.002551020408163265: correct 1/392
Epoch: 32, train_loss: 0.9283, train_clustering_loss:  0.5164, train_error: 0.3878
class 0: acc 0.5, correct 6/12
class 1: acc 0.75, correct 9/12
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.1838, val_error: 0.4545, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.7541, instance_loss: 0.5606, weighted_loss: 0.6960, label: 3, bag_size: 4963
batch 39, loss: 1.0168, instance_loss: 0.5996, weighted_loss: 0.8917, label: 3, bag_size: 28883


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.04081632653061224: correct 16/392
Epoch: 33, train_loss: 0.7844, train_clustering_loss:  0.4850, train_error: 0.2653
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.1776, val_error: 0.5455, auc: 0.7674
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 2.1630, instance_loss: 0.8801, weighted_loss: 1.7781, label: 1, bag_size: 104549
batch 39, loss: 0.4792, instance_loss: 0.4069, weighted_loss: 0.4575, label: 1, bag_size: 64834


class 0 clustering acc 0.9942602040816326: correct 1559/1568
class 1 clustering acc 0.007653061224489796: correct 3/392
Epoch: 34, train_loss: 0.9131, train_clustering_loss:  0.5610, train_error: 0.4490
class 0: acc 0.5, correct 5/10
class 1: acc 0.6875, correct 11/16
class 2: acc 0.375, correct 3/8
class 3: acc 0.5333333333333333, correct 8/15

Val Set, val_loss: 1.1611, val_error: 0.6364, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.5209, instance_loss: 0.5184, weighted_loss: 0.5202, label: 3, bag_size: 28883
batch 39, loss: 0.2896, instance_loss: 0.2845, weighted_loss: 0.2881, label: 2, bag_size: 22416


class 0 clustering acc 0.9968112244897959: correct 1563/1568
class 1 clustering acc 0.09438775510204081: correct 37/392
Epoch: 35, train_loss: 0.6949, train_clustering_loss:  0.4566, train_error: 0.2449
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.75, correct 6/8
class 2: acc 0.7619047619047619, correct 16/21
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.1512, val_error: 0.5455, auc: 0.7708
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.2171, instance_loss: 0.1893, weighted_loss: 0.2088, label: 2, bag_size: 158432
batch 39, loss: 0.9439, instance_loss: 0.5467, weighted_loss: 0.8247, label: 2, bag_size: 22130


class 0 clustering acc 0.9802295918367347: correct 1537/1568
class 1 clustering acc 0.11989795918367346: correct 47/392
Epoch: 36, train_loss: 0.7769, train_clustering_loss:  0.4976, train_error: 0.3265
class 0: acc 0.25, correct 2/8
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.0762, val_error: 0.4545, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.146722 --> 1.076177).  Saving model ...


batch 19, loss: 1.8861, instance_loss: 0.6008, weighted_loss: 1.5005, label: 1, bag_size: 445537
batch 39, loss: 0.6470, instance_loss: 0.5761, weighted_loss: 0.6257, label: 0, bag_size: 453871


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.0663265306122449: correct 26/392
Epoch: 37, train_loss: 0.8081, train_clustering_loss:  0.5108, train_error: 0.2653
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.1293, val_error: 0.6364, auc: 0.7604
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7900, instance_loss: 0.5342, weighted_loss: 0.7133, label: 0, bag_size: 13999
batch 39, loss: 0.8078, instance_loss: 0.5366, weighted_loss: 0.7264, label: 0, bag_size: 70920


class 0 clustering acc 0.9885204081632653: correct 1550/1568
class 1 clustering acc 0.07908163265306123: correct 31/392
Epoch: 38, train_loss: 0.7974, train_clustering_loss:  0.5082, train_error: 0.3673
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.8823529411764706, correct 15/17
class 2: acc 0.5, correct 5/10
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.1015, val_error: 0.5455, auc: 0.7465
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6542, instance_loss: 0.5949, weighted_loss: 1.3364, label: 1, bag_size: 445537
batch 39, loss: 0.3146, instance_loss: 0.2565, weighted_loss: 0.2972, label: 2, bag_size: 525276


class 0 clustering acc 0.9948979591836735: correct 1560/1568
class 1 clustering acc 0.03316326530612245: correct 13/392
Epoch: 39, train_loss: 0.7784, train_clustering_loss:  0.5187, train_error: 0.3469
class 0: acc 0.375, correct 3/8
class 1: acc 0.6111111111111112, correct 11/18
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.1779, val_error: 0.6364, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.1217, instance_loss: 0.5715, weighted_loss: 0.9567, label: 2, bag_size: 22130
batch 39, loss: 0.4616, instance_loss: 0.5071, weighted_loss: 0.4752, label: 0, bag_size: 222326


class 0 clustering acc 0.9948979591836735: correct 1560/1568
class 1 clustering acc 0.03571428571428571: correct 14/392
Epoch: 40, train_loss: 0.8935, train_clustering_loss:  0.5312, train_error: 0.4286
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.75, correct 9/12
class 2: acc 0.45454545454545453, correct 5/11
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.0836, val_error: 0.3636, auc: 0.8021
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3427, instance_loss: 0.3897, weighted_loss: 0.3568, label: 2, bag_size: 209612
batch 39, loss: 2.8331, instance_loss: 0.7994, weighted_loss: 2.2230, label: 3, bag_size: 22057


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.03316326530612245: correct 13/392
Epoch: 41, train_loss: 0.7167, train_clustering_loss:  0.4894, train_error: 0.2449
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.9473684210526315, correct 18/19
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.1179, val_error: 0.4545, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.2930, instance_loss: 0.3246, weighted_loss: 0.3025, label: 1, bag_size: 16373
batch 39, loss: 0.6653, instance_loss: 0.4941, weighted_loss: 0.6139, label: 3, bag_size: 4963


class 0 clustering acc 0.9942602040816326: correct 1559/1568
class 1 clustering acc 0.13520408163265307: correct 53/392
Epoch: 42, train_loss: 0.6559, train_clustering_loss:  0.4541, train_error: 0.3265
class 0: acc 0.2727272727272727, correct 3/11
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.8, correct 12/15
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.1216, val_error: 0.2727, auc: 0.8021
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.4086, instance_loss: 0.5005, weighted_loss: 0.4362, label: 0, bag_size: 46742
batch 39, loss: 0.5533, instance_loss: 0.4878, weighted_loss: 0.5336, label: 0, bag_size: 222326


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.16581632653061223: correct 65/392
Epoch: 43, train_loss: 0.6195, train_clustering_loss:  0.4381, train_error: 0.2653
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.8, correct 12/15
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.0895, val_error: 0.4545, auc: 0.8125
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.3851, instance_loss: 0.3013, weighted_loss: 0.3600, label: 1, bag_size: 81420
batch 39, loss: 0.4203, instance_loss: 0.3410, weighted_loss: 0.3965, label: 1, bag_size: 64834


class 0 clustering acc 0.985969387755102: correct 1546/1568
class 1 clustering acc 0.21683673469387754: correct 85/392
Epoch: 44, train_loss: 0.5261, train_clustering_loss:  0.4592, train_error: 0.1429
class 0: acc 0.8, correct 4/5
class 1: acc 1.0, correct 14/14
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.7222222222222222, correct 13/18

Val Set, val_loss: 1.0807, val_error: 0.4545, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.5319, instance_loss: 0.5234, weighted_loss: 0.5293, label: 0, bag_size: 222326
batch 39, loss: 0.3051, instance_loss: 0.4821, weighted_loss: 0.3582, label: 0, bag_size: 222326


class 0 clustering acc 0.9968112244897959: correct 1563/1568
class 1 clustering acc 0.10714285714285714: correct 42/392
Epoch: 45, train_loss: 0.5991, train_clustering_loss:  0.4717, train_error: 0.1837
class 0: acc 0.8, correct 12/15
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.75, correct 6/8
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.0816, val_error: 0.6364, auc: 0.7917
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5760, instance_loss: 0.4563, weighted_loss: 0.5401, label: 1, bag_size: 23122
batch 39, loss: 0.4526, instance_loss: 0.3537, weighted_loss: 0.4229, label: 1, bag_size: 64834


class 0 clustering acc 0.985969387755102: correct 1546/1568
class 1 clustering acc 0.12755102040816327: correct 50/392
Epoch: 46, train_loss: 0.7634, train_clustering_loss:  0.4813, train_error: 0.3265
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.6875, correct 11/16
class 3: acc 0.5714285714285714, correct 4/7

Val Set, val_loss: 1.0846, val_error: 0.4545, auc: 0.8125
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.8745, instance_loss: 0.5544, weighted_loss: 0.7785, label: 0, bag_size: 65047
batch 39, loss: 0.3138, instance_loss: 0.2430, weighted_loss: 0.2925, label: 2, bag_size: 22416


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.08928571428571429: correct 35/392
Epoch: 47, train_loss: 0.8051, train_clustering_loss:  0.5336, train_error: 0.2449
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.7, correct 7/10
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.0400, val_error: 0.5455, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.076177 --> 1.040048).  Saving model ...


batch 19, loss: 0.4909, instance_loss: 0.4703, weighted_loss: 0.4847, label: 0, bag_size: 65047
batch 39, loss: 0.0987, instance_loss: 0.1416, weighted_loss: 0.1116, label: 2, bag_size: 278757


class 0 clustering acc 0.9904336734693877: correct 1553/1568
class 1 clustering acc 0.125: correct 49/392
Epoch: 48, train_loss: 0.7804, train_clustering_loss:  0.4985, train_error: 0.3265
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.3, correct 3/10
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.1400, val_error: 0.5455, auc: 0.7917
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4497, instance_loss: 0.4199, weighted_loss: 0.4408, label: 1, bag_size: 20030
batch 39, loss: 0.1410, instance_loss: 0.1379, weighted_loss: 0.1401, label: 2, bag_size: 113492


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.2066326530612245: correct 81/392
Epoch: 49, train_loss: 0.5834, train_clustering_loss:  0.4361, train_error: 0.1224
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.875, correct 14/16
class 2: acc 1.0, correct 12/12
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.0559, val_error: 0.4545, auc: 0.8229
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5299, instance_loss: 0.4764, weighted_loss: 0.5138, label: 0, bag_size: 59141
batch 39, loss: 0.7413, instance_loss: 0.4583, weighted_loss: 0.6564, label: 2, bag_size: 149988


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.10459183673469388: correct 41/392
Epoch: 50, train_loss: 0.7168, train_clustering_loss:  0.4864, train_error: 0.3469
class 0: acc 0.6875, correct 11/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.0434, val_error: 0.5455, auc: 0.7812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.3609, instance_loss: 0.4854, weighted_loss: 0.3982, label: 3, bag_size: 152150
batch 39, loss: 0.2012, instance_loss: 0.5325, weighted_loss: 0.3006, label: 3, bag_size: 152150


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.11734693877551021: correct 46/392
Epoch: 51, train_loss: 0.6706, train_clustering_loss:  0.4773, train_error: 0.3061
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6, correct 6/10
class 2: acc 0.75, correct 9/12
class 3: acc 0.5625, correct 9/16

Val Set, val_loss: 1.0099, val_error: 0.3636, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.040048 --> 1.009946).  Saving model ...


batch 19, loss: 0.9634, instance_loss: 0.4607, weighted_loss: 0.8126, label: 2, bag_size: 103108
batch 39, loss: 0.6554, instance_loss: 0.6317, weighted_loss: 0.6483, label: 3, bag_size: 113328


class 0 clustering acc 0.9872448979591837: correct 1548/1568
class 1 clustering acc 0.13010204081632654: correct 51/392
Epoch: 52, train_loss: 0.6560, train_clustering_loss:  0.4784, train_error: 0.2857
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.1867, val_error: 0.4545, auc: 0.7604
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5171, instance_loss: 0.6225, weighted_loss: 1.2487, label: 2, bag_size: 103108
batch 39, loss: 0.3597, instance_loss: 0.3399, weighted_loss: 0.3538, label: 1, bag_size: 81420


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.10459183673469388: correct 41/392
Epoch: 53, train_loss: 0.7220, train_clustering_loss:  0.4757, train_error: 0.3265
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7058823529411765, correct 12/17
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.1332, val_error: 0.5455, auc: 0.8229
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2439, instance_loss: 0.2844, weighted_loss: 0.2561, label: 1, bag_size: 20030
batch 39, loss: 0.1381, instance_loss: 0.1461, weighted_loss: 0.1405, label: 2, bag_size: 22416


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.22959183673469388: correct 90/392
Epoch: 54, train_loss: 0.5391, train_clustering_loss:  0.4285, train_error: 0.2245
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 1.0, correct 18/18
class 3: acc 0.375, correct 3/8

Val Set, val_loss: 1.1208, val_error: 0.5455, auc: 0.7812
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.8580, instance_loss: 0.7409, weighted_loss: 1.5229, label: 1, bag_size: 445537
batch 39, loss: 0.6102, instance_loss: 0.4542, weighted_loss: 0.5634, label: 3, bag_size: 189694


class 0 clustering acc 0.9942602040816326: correct 1559/1568
class 1 clustering acc 0.2066326530612245: correct 81/392
Epoch: 55, train_loss: 0.5943, train_clustering_loss:  0.4235, train_error: 0.2245
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 1.0, correct 12/12
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.0583, val_error: 0.3636, auc: 0.7917
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3090, instance_loss: 0.3919, weighted_loss: 0.3338, label: 0, bag_size: 59141
batch 39, loss: 0.6270, instance_loss: 0.4552, weighted_loss: 0.5755, label: 1, bag_size: 23122


class 0 clustering acc 0.9897959183673469: correct 1552/1568
class 1 clustering acc 0.09438775510204081: correct 37/392
Epoch: 56, train_loss: 0.7049, train_clustering_loss:  0.5048, train_error: 0.2857
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.8, correct 12/15
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.1623, val_error: 0.4545, auc: 0.7500
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.5193, instance_loss: 0.3791, weighted_loss: 0.4772, label: 1, bag_size: 77634
batch 39, loss: 0.3768, instance_loss: 0.4699, weighted_loss: 0.4047, label: 0, bag_size: 59141


class 0 clustering acc 0.9885204081632653: correct 1550/1568
class 1 clustering acc 0.10714285714285714: correct 42/392
Epoch: 57, train_loss: 0.5729, train_clustering_loss:  0.4513, train_error: 0.2041
class 0: acc 0.875, correct 14/16
class 1: acc 0.875, correct 7/8
class 2: acc 0.6, correct 6/10
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.0571, val_error: 0.5455, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.5735, instance_loss: 0.4306, weighted_loss: 0.5306, label: 1, bag_size: 58270
batch 39, loss: 0.3588, instance_loss: 0.3968, weighted_loss: 0.3702, label: 1, bag_size: 69073


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.10459183673469388: correct 41/392
Epoch: 58, train_loss: 0.5234, train_clustering_loss:  0.4435, train_error: 0.2041
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.75, correct 6/8
class 3: acc 0.75, correct 12/16

Val Set, val_loss: 1.0105, val_error: 0.4545, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.3853, instance_loss: 0.5625, weighted_loss: 1.1385, label: 2, bag_size: 17501
batch 39, loss: 1.3325, instance_loss: 0.6519, weighted_loss: 1.1283, label: 1, bag_size: 445537


class 0 clustering acc 0.9891581632653061: correct 1551/1568
class 1 clustering acc 0.29081632653061223: correct 114/392
Epoch: 59, train_loss: 0.4503, train_clustering_loss:  0.3891, train_error: 0.1633
class 0: acc 0.75, correct 3/4
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.0787, val_error: 0.4545, auc: 0.7604
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.4019, instance_loss: 0.4640, weighted_loss: 0.4205, label: 0, bag_size: 222326
batch 39, loss: 1.3177, instance_loss: 0.7598, weighted_loss: 1.1503, label: 1, bag_size: 445537


class 0 clustering acc 0.9846938775510204: correct 1544/1568
class 1 clustering acc 0.12244897959183673: correct 48/392
Epoch: 60, train_loss: 0.6861, train_clustering_loss:  0.4893, train_error: 0.3469
class 0: acc 0.5714285714285714, correct 8/14
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.375, correct 3/8
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.0554, val_error: 0.3636, auc: 0.7812
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.3341, instance_loss: 0.2990, weighted_loss: 0.3236, label: 1, bag_size: 57038
batch 39, loss: 0.1709, instance_loss: 0.2157, weighted_loss: 0.1843, label: 2, bag_size: 23349


class 0 clustering acc 0.9878826530612245: correct 1549/1568
class 1 clustering acc 0.288265306122449: correct 113/392
Epoch: 61, train_loss: 0.5596, train_clustering_loss:  0.4118, train_error: 0.2653
class 0: acc 0.5384615384615384, correct 7/13
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 0.9, correct 9/10
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.0464, val_error: 0.5455, auc: 0.7604
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2610, instance_loss: 0.2221, weighted_loss: 0.2494, label: 2, bag_size: 158432
batch 39, loss: 0.4771, instance_loss: 0.4728, weighted_loss: 0.4758, label: 3, bag_size: 231301


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.24489795918367346: correct 96/392
Epoch: 62, train_loss: 0.4633, train_clustering_loss:  0.3933, train_error: 0.1837
class 0: acc 0.875, correct 7/8
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.875, correct 14/16

Val Set, val_loss: 1.0147, val_error: 0.3636, auc: 0.7708
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.3230, instance_loss: 0.2367, weighted_loss: 0.2971, label: 2, bag_size: 158432
batch 39, loss: 0.2504, instance_loss: 0.4078, weighted_loss: 0.2976, label: 3, bag_size: 4963


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.3163265306122449: correct 124/392
Epoch: 63, train_loss: 0.4536, train_clustering_loss:  0.4024, train_error: 0.1429
class 0: acc 0.625, correct 5/8
class 1: acc 0.8823529411764706, correct 15/17
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.0844, val_error: 0.5455, auc: 0.7812
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1768, instance_loss: 0.1142, weighted_loss: 0.1580, label: 2, bag_size: 158432
batch 39, loss: 0.1666, instance_loss: 0.3607, weighted_loss: 0.2248, label: 3, bag_size: 189694


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.3903061224489796: correct 153/392
Epoch: 64, train_loss: 0.4747, train_clustering_loss:  0.3679, train_error: 0.2245
class 0: acc 0.4, correct 4/10
class 1: acc 0.9090909090909091, correct 20/22
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.8, correct 4/5

Val Set, val_loss: 1.2226, val_error: 0.5455, auc: 0.7604
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.5772, instance_loss: 0.5841, weighted_loss: 0.5793, label: 0, bag_size: 47775
batch 39, loss: 0.7390, instance_loss: 0.3860, weighted_loss: 0.6331, label: 1, bag_size: 57038


class 0 clustering acc 0.9719387755102041: correct 1524/1568
class 1 clustering acc 0.27040816326530615: correct 106/392
Epoch: 65, train_loss: 0.5857, train_clustering_loss:  0.4461, train_error: 0.2857
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.0397, val_error: 0.3636, auc: 0.7396
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.4206, instance_loss: 0.3080, weighted_loss: 0.3868, label: 1, bag_size: 20030
batch 39, loss: 0.6099, instance_loss: 0.4874, weighted_loss: 0.5731, label: 0, bag_size: 41829


class 0 clustering acc 0.9878826530612245: correct 1549/1568
class 1 clustering acc 0.1377551020408163: correct 54/392
Epoch: 66, train_loss: 0.5343, train_clustering_loss:  0.4476, train_error: 0.1429
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.0633, val_error: 0.4545, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.2057, instance_loss: 0.3591, weighted_loss: 0.2517, label: 3, bag_size: 4963
batch 39, loss: 0.5144, instance_loss: 0.4627, weighted_loss: 0.4989, label: 0, bag_size: 13999


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.17091836734693877: correct 67/392
Epoch: 67, train_loss: 0.4969, train_clustering_loss:  0.3978, train_error: 0.2857
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.0841, val_error: 0.4545, auc: 0.7917
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.5575, instance_loss: 0.4458, weighted_loss: 0.5240, label: 0, bag_size: 108548
batch 39, loss: 0.3090, instance_loss: 0.3283, weighted_loss: 0.3148, label: 1, bag_size: 77634


class 0 clustering acc 0.982780612244898: correct 1541/1568
class 1 clustering acc 0.18112244897959184: correct 71/392
Epoch: 68, train_loss: 0.5954, train_clustering_loss:  0.4450, train_error: 0.2449
class 0: acc 1.0, correct 14/14
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.8674, val_error: 0.8182, auc: 0.6875
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.9058, instance_loss: 0.7629, weighted_loss: 0.8629, label: 3, bag_size: 231301
batch 39, loss: 1.6127, instance_loss: 0.8218, weighted_loss: 1.3754, label: 1, bag_size: 445537


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.07653061224489796: correct 30/392
Epoch: 69, train_loss: 0.7180, train_clustering_loss:  0.4760, train_error: 0.3469
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.75, correct 9/12
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.1753, val_error: 0.4545, auc: 0.7500
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.5668, instance_loss: 0.4749, weighted_loss: 0.5392, label: 0, bag_size: 18551
batch 39, loss: 0.9485, instance_loss: 0.6392, weighted_loss: 0.8557, label: 3, bag_size: 40869


class 0 clustering acc 0.9885204081632653: correct 1550/1568
class 1 clustering acc 0.18877551020408162: correct 74/392
Epoch: 70, train_loss: 0.5133, train_clustering_loss:  0.4288, train_error: 0.1837
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.0919, val_error: 0.5455, auc: 0.7812
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0475, instance_loss: 0.0787, weighted_loss: 0.0568, label: 2, bag_size: 525276
batch 39, loss: 0.4389, instance_loss: 0.4125, weighted_loss: 0.4310, label: 1, bag_size: 104549


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.22448979591836735: correct 88/392
Epoch: 71, train_loss: 0.4433, train_clustering_loss:  0.3901, train_error: 0.1224
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 9/9
class 2: acc 0.8125, correct 13/16
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.0394, val_error: 0.5455, auc: 0.7812
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.3636, ROC AUC: 0.7604
Test error: 0.7273, ROC AUC: 0.5660
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3

Training Fold 5!

Init train/val/test splits... 
Done!
Training on 49 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.0677, instance_loss: 0.9755, weighted_loss: 1.0401, label: 3, bag_size: 25448
batch 39, loss: 1.7810, instance_loss: 0.9216, weighted_loss: 1.5231, label: 1, bag_size: 16373


class 0 clustering acc 0.9591836734693877: correct 1504/1568
class 1 clustering acc 0.05612244897959184: correct 22/392
Epoch: 0, train_loss: 1.3830, train_clustering_loss:  1.0031, train_error: 0.6531
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/9
class 2: acc 0.5, correct 6/12
class 3: acc 0.6111111111111112, correct 11/18

Val Set, val_loss: 1.4211, val_error: 0.7273, auc: 0.5278
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.421110).  Saving model ...


batch 19, loss: 1.8423, instance_loss: 0.7517, weighted_loss: 1.5151, label: 1, bag_size: 66789
batch 39, loss: 1.7216, instance_loss: 0.6808, weighted_loss: 1.4094, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 1, train_loss: 1.3908, train_clustering_loss:  0.6968, train_error: 0.7143
class 0: acc 0.0, correct 0/11
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/12
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.3829, val_error: 0.8182, auc: 0.6215
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.421110 --> 1.382943).  Saving model ...


batch 19, loss: 1.3708, instance_loss: 0.6365, weighted_loss: 1.1505, label: 2, bag_size: 163352
batch 39, loss: 1.0077, instance_loss: 0.6119, weighted_loss: 0.8889, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 2, train_loss: 1.3791, train_clustering_loss:  0.6338, train_error: 0.7551
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.07692307692307693, correct 1/13
class 2: acc 0.4117647058823529, correct 7/17
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4663, val_error: 0.8182, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.7688, instance_loss: 0.6618, weighted_loss: 1.4367, label: 3, bag_size: 240896
batch 39, loss: 1.2992, instance_loss: 0.6355, weighted_loss: 1.1001, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 3, train_loss: 1.3733, train_clustering_loss:  0.6234, train_error: 0.7347
class 0: acc 0.0, correct 0/10
class 1: acc 0.1, correct 1/10
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.14285714285714285, correct 2/14

Val Set, val_loss: 1.4261, val_error: 0.7273, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6392, instance_loss: 0.6538, weighted_loss: 1.3436, label: 1, bag_size: 18329
batch 39, loss: 1.1766, instance_loss: 0.5830, weighted_loss: 0.9985, label: 2, bag_size: 22130


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 4, train_loss: 1.3812, train_clustering_loss:  0.6222, train_error: 0.7347
class 0: acc 0.0, correct 0/7
class 1: acc 0.125, correct 2/16
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.16666666666666666, correct 2/12

Val Set, val_loss: 1.4161, val_error: 0.7273, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3076, instance_loss: 0.6336, weighted_loss: 1.1054, label: 1, bag_size: 23122
batch 39, loss: 1.1548, instance_loss: 0.6217, weighted_loss: 0.9948, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 5, train_loss: 1.3730, train_clustering_loss:  0.6400, train_error: 0.7347
class 0: acc 0.5, correct 7/14
class 1: acc 0.2, correct 2/10
class 2: acc 0.125, correct 1/8
class 3: acc 0.17647058823529413, correct 3/17

Val Set, val_loss: 1.3915, val_error: 0.7273, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.3756, instance_loss: 0.6122, weighted_loss: 1.1465, label: 3, bag_size: 48489
batch 39, loss: 1.2672, instance_loss: 0.6264, weighted_loss: 1.0750, label: 1, bag_size: 49894


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 6, train_loss: 1.4089, train_clustering_loss:  0.6273, train_error: 0.7347
class 0: acc 0.15384615384615385, correct 2/13
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.07692307692307693, correct 1/13
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.3643, val_error: 0.7273, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.382943 --> 1.364325).  Saving model ...


batch 19, loss: 1.5847, instance_loss: 0.6025, weighted_loss: 1.2900, label: 2, bag_size: 22416
batch 39, loss: 1.4801, instance_loss: 0.6148, weighted_loss: 1.2205, label: 2, bag_size: 17501


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 7, train_loss: 1.3182, train_clustering_loss:  0.6122, train_error: 0.5306
class 0: acc 0.125, correct 1/8
class 1: acc 0.9375, correct 15/16
class 2: acc 0.0, correct 0/13
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.3931, val_error: 0.7273, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0100, instance_loss: 0.5896, weighted_loss: 0.8839, label: 1, bag_size: 58270
batch 39, loss: 1.2465, instance_loss: 0.6185, weighted_loss: 1.0581, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 8, train_loss: 1.3367, train_clustering_loss:  0.6123, train_error: 0.6327
class 0: acc 0.14285714285714285, correct 2/14
class 1: acc 1.0, correct 11/11
class 2: acc 0.3076923076923077, correct 4/13
class 3: acc 0.09090909090909091, correct 1/11

Val Set, val_loss: 1.3639, val_error: 0.8182, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.364325 --> 1.363894).  Saving model ...


batch 19, loss: 1.4813, instance_loss: 0.6061, weighted_loss: 1.2187, label: 3, bag_size: 56291
batch 39, loss: 0.8741, instance_loss: 0.6005, weighted_loss: 0.7920, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 9, train_loss: 1.3240, train_clustering_loss:  0.6132, train_error: 0.6531
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/11
class 2: acc 0.3076923076923077, correct 4/13
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.3588, val_error: 0.7273, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.363894 --> 1.358802).  Saving model ...


batch 19, loss: 1.6780, instance_loss: 0.6189, weighted_loss: 1.3603, label: 1, bag_size: 66789
batch 39, loss: 1.8267, instance_loss: 0.6436, weighted_loss: 1.4718, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 10, train_loss: 1.3261, train_clustering_loss:  0.6150, train_error: 0.6939
class 0: acc 0.16666666666666666, correct 1/6
class 1: acc 0.26666666666666666, correct 4/15
class 2: acc 0.3333333333333333, correct 4/12
class 3: acc 0.375, correct 6/16

Val Set, val_loss: 1.3995, val_error: 0.7273, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8512, instance_loss: 0.5955, weighted_loss: 0.7745, label: 1, bag_size: 36943
batch 39, loss: 0.9034, instance_loss: 0.5585, weighted_loss: 0.7999, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 11, train_loss: 1.2320, train_clustering_loss:  0.5962, train_error: 0.4898
class 0: acc 0.125, correct 1/8
class 1: acc 1.0, correct 13/13
class 2: acc 0.3333333333333333, correct 6/18
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.3858, val_error: 0.7273, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.6069, instance_loss: 0.5883, weighted_loss: 0.6013, label: 0, bag_size: 41829
batch 39, loss: 1.4521, instance_loss: 0.6481, weighted_loss: 1.2109, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 12, train_loss: 1.2255, train_clustering_loss:  0.5971, train_error: 0.4898
class 0: acc 0.7894736842105263, correct 15/19
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.6, correct 6/10
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.3659, val_error: 0.6364, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3990, instance_loss: 0.6234, weighted_loss: 1.1663, label: 3, bag_size: 56291
batch 39, loss: 0.9534, instance_loss: 0.5537, weighted_loss: 0.8335, label: 2, bag_size: 22416


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 13, train_loss: 1.2321, train_clustering_loss:  0.5886, train_error: 0.5714
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.0, correct 0/9
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.3447, val_error: 0.5455, auc: 0.7187
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.358802 --> 1.344667).  Saving model ...


batch 19, loss: 1.4046, instance_loss: 0.5989, weighted_loss: 1.1629, label: 1, bag_size: 49894
batch 39, loss: 1.8426, instance_loss: 0.6380, weighted_loss: 1.4812, label: 3, bag_size: 25448


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 14, train_loss: 1.2111, train_clustering_loss:  0.5874, train_error: 0.4490
class 0: acc 0.3, correct 3/10
class 1: acc 0.6, correct 9/15
class 2: acc 0.9, correct 9/10
class 3: acc 0.42857142857142855, correct 6/14

Val Set, val_loss: 1.2945, val_error: 0.5455, auc: 0.7396
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.344667 --> 1.294478).  Saving model ...


batch 19, loss: 1.5742, instance_loss: 0.6310, weighted_loss: 1.2913, label: 1, bag_size: 57038
batch 39, loss: 0.7921, instance_loss: 0.4308, weighted_loss: 0.6837, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 15, train_loss: 1.1560, train_clustering_loss:  0.5760, train_error: 0.4694
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.25, correct 2/8
class 2: acc 0.15384615384615385, correct 2/13
class 3: acc 1.0, correct 21/21

Val Set, val_loss: 1.3343, val_error: 0.5455, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9924, instance_loss: 0.5864, weighted_loss: 0.8706, label: 2, bag_size: 163352
batch 39, loss: 0.9936, instance_loss: 0.5992, weighted_loss: 0.8753, label: 2, bag_size: 163352


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 16, train_loss: 1.1333, train_clustering_loss:  0.5902, train_error: 0.4082
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.125, correct 1/8

Val Set, val_loss: 1.3754, val_error: 0.8182, auc: 0.7396
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0117, instance_loss: 0.5469, weighted_loss: 0.8723, label: 0, bag_size: 18551
batch 39, loss: 0.3304, instance_loss: 0.4736, weighted_loss: 0.3733, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 17, train_loss: 1.0604, train_clustering_loss:  0.5729, train_error: 0.4694
class 0: acc 0.5294117647058824, correct 9/17
class 1: acc 0.14285714285714285, correct 1/7
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.2727272727272727, correct 3/11

Val Set, val_loss: 1.2630, val_error: 0.5455, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.294478 --> 1.262996).  Saving model ...


batch 19, loss: 1.6208, instance_loss: 0.6202, weighted_loss: 1.3206, label: 0, bag_size: 6353
batch 39, loss: 1.3630, instance_loss: 0.5831, weighted_loss: 1.1290, label: 0, bag_size: 54249


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 18, train_loss: 1.1336, train_clustering_loss:  0.5727, train_error: 0.5306
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.5, correct 7/14
class 2: acc 0.7, correct 7/10
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.2085, val_error: 0.5455, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.262996 --> 1.208532).  Saving model ...


batch 19, loss: 1.2308, instance_loss: 0.5657, weighted_loss: 1.0313, label: 0, bag_size: 19277
batch 39, loss: 0.9659, instance_loss: 0.5431, weighted_loss: 0.8390, label: 0, bag_size: 222326


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 19, train_loss: 1.0194, train_clustering_loss:  0.5552, train_error: 0.4286
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.6, correct 9/15
class 2: acc 0.36363636363636365, correct 4/11
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.1822, val_error: 0.4545, auc: 0.8229
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.208532 --> 1.182208).  Saving model ...


batch 19, loss: 0.9749, instance_loss: 0.5473, weighted_loss: 0.8467, label: 1, bag_size: 58270
batch 39, loss: 0.5577, instance_loss: 0.4608, weighted_loss: 0.5287, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 20, train_loss: 0.8793, train_clustering_loss:  0.5273, train_error: 0.4082
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.7777777777777778, correct 14/18
class 2: acc 0.3333333333333333, correct 3/9
class 3: acc 0.375, correct 3/8

Val Set, val_loss: 1.3101, val_error: 0.7273, auc: 0.8194
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1876, instance_loss: 0.4230, weighted_loss: 0.2583, label: 3, bag_size: 181076
batch 39, loss: 0.3067, instance_loss: 0.4295, weighted_loss: 0.3435, label: 0, bag_size: 453871


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 21, train_loss: 0.9130, train_clustering_loss:  0.5353, train_error: 0.4082
class 0: acc 0.5333333333333333, correct 8/15
class 1: acc 1.0, correct 11/11
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.1611, val_error: 0.4545, auc: 0.8125
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.182208 --> 1.161107).  Saving model ...


batch 19, loss: 1.8482, instance_loss: 0.6500, weighted_loss: 1.4887, label: 3, bag_size: 22057
batch 39, loss: 0.3819, instance_loss: 0.4545, weighted_loss: 0.4037, label: 2, bag_size: 22416


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 22, train_loss: 0.9368, train_clustering_loss:  0.5369, train_error: 0.3265
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.2874, val_error: 0.6364, auc: 0.8403
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5735, instance_loss: 0.5771, weighted_loss: 1.2746, label: 3, bag_size: 189694
batch 39, loss: 0.7070, instance_loss: 0.5759, weighted_loss: 0.6677, label: 2, bag_size: 176020


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 23, train_loss: 0.8410, train_clustering_loss:  0.5147, train_error: 0.2857
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.75, correct 12/16
class 3: acc 0.2857142857142857, correct 2/7

Val Set, val_loss: 1.2183, val_error: 0.6364, auc: 0.7500
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1782, instance_loss: 0.4250, weighted_loss: 0.2523, label: 3, bag_size: 181076
batch 39, loss: 0.2452, instance_loss: 0.3677, weighted_loss: 0.2820, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 24, train_loss: 0.9363, train_clustering_loss:  0.5336, train_error: 0.2857
class 0: acc 0.6, correct 6/10
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.1547, val_error: 0.5455, auc: 0.8646
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.161107 --> 1.154677).  Saving model ...


batch 19, loss: 0.8602, instance_loss: 0.5842, weighted_loss: 0.7774, label: 2, bag_size: 163352
batch 39, loss: 1.0081, instance_loss: 0.5816, weighted_loss: 0.8802, label: 3, bag_size: 240896


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.007653061224489796: correct 3/392
Epoch: 25, train_loss: 0.8946, train_clustering_loss:  0.5354, train_error: 0.2245
class 0: acc 0.9, correct 9/10
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.2470, val_error: 0.5455, auc: 0.8507
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5813, instance_loss: 0.6565, weighted_loss: 1.3038, label: 1, bag_size: 445537
batch 39, loss: 0.5660, instance_loss: 0.4464, weighted_loss: 0.5301, label: 3, bag_size: 189694


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 26, train_loss: 1.0529, train_clustering_loss:  0.5488, train_error: 0.4694
class 0: acc 0.5, correct 6/12
class 1: acc 0.8, correct 8/10
class 2: acc 0.5, correct 6/12
class 3: acc 0.4, correct 6/15

Val Set, val_loss: 1.1141, val_error: 0.5455, auc: 0.8646
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.154677 --> 1.114079).  Saving model ...


batch 19, loss: 0.9126, instance_loss: 0.5093, weighted_loss: 0.7916, label: 1, bag_size: 57038
batch 39, loss: 1.2932, instance_loss: 0.5485, weighted_loss: 1.0698, label: 3, bag_size: 28883


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.01020408163265306: correct 4/392
Epoch: 27, train_loss: 0.8310, train_clustering_loss:  0.4996, train_error: 0.3469
class 0: acc 0.25, correct 2/8
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.8888888888888888, correct 16/18

Val Set, val_loss: 1.2711, val_error: 0.6364, auc: 0.8542
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3428, instance_loss: 0.3811, weighted_loss: 0.3543, label: 1, bag_size: 57038
batch 39, loss: 1.0705, instance_loss: 0.5315, weighted_loss: 0.9088, label: 3, bag_size: 25448


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.007653061224489796: correct 3/392
Epoch: 28, train_loss: 0.9562, train_clustering_loss:  0.5168, train_error: 0.3878
class 0: acc 0.25, correct 3/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.8235294117647058, correct 14/17

Val Set, val_loss: 1.0477, val_error: 0.4545, auc: 0.8646
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.114079 --> 1.047736).  Saving model ...


batch 19, loss: 0.0742, instance_loss: 0.2975, weighted_loss: 0.1412, label: 0, bag_size: 41829
batch 39, loss: 0.4224, instance_loss: 0.3795, weighted_loss: 0.4095, label: 3, bag_size: 56291


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.017857142857142856: correct 7/392
Epoch: 29, train_loss: 0.6927, train_clustering_loss:  0.4746, train_error: 0.1633
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.4, correct 2/5
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.8666666666666667, correct 13/15

Val Set, val_loss: 1.0695, val_error: 0.2727, auc: 0.8438
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2142, instance_loss: 0.6012, weighted_loss: 1.0303, label: 2, bag_size: 54449
batch 39, loss: 1.0999, instance_loss: 0.4982, weighted_loss: 0.9194, label: 3, bag_size: 231301


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.02295918367346939: correct 9/392
Epoch: 30, train_loss: 0.7641, train_clustering_loss:  0.4873, train_error: 0.3061
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.8, correct 12/15
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.0674, val_error: 0.5455, auc: 0.8229
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0724, instance_loss: 0.5725, weighted_loss: 0.9224, label: 1, bag_size: 132271
batch 39, loss: 0.8354, instance_loss: 0.5296, weighted_loss: 0.7436, label: 1, bag_size: 49894


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.07908163265306123: correct 31/392
Epoch: 31, train_loss: 0.7861, train_clustering_loss:  0.4827, train_error: 0.3265
class 0: acc 0.7368421052631579, correct 14/19
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.16666666666666666, correct 1/6
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.0651, val_error: 0.2727, auc: 0.8542
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.5299, instance_loss: 0.5953, weighted_loss: 1.2495, label: 3, bag_size: 28883
batch 39, loss: 0.3372, instance_loss: 0.4233, weighted_loss: 0.3630, label: 2, bag_size: 393657


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.002551020408163265: correct 1/392
Epoch: 32, train_loss: 0.8543, train_clustering_loss:  0.5008, train_error: 0.4286
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.0378, val_error: 0.3636, auc: 0.8229
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.047736 --> 1.037807).  Saving model ...


batch 19, loss: 0.7150, instance_loss: 0.4534, weighted_loss: 0.6365, label: 1, bag_size: 77634
batch 39, loss: 0.8531, instance_loss: 0.5682, weighted_loss: 0.7676, label: 2, bag_size: 17501


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.030612244897959183: correct 12/392
Epoch: 33, train_loss: 0.6094, train_clustering_loss:  0.4544, train_error: 0.1633
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.9375, correct 15/16
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 1.2420, val_error: 0.6364, auc: 0.8229
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4789, instance_loss: 0.3860, weighted_loss: 0.4510, label: 1, bag_size: 18329
batch 39, loss: 0.6339, instance_loss: 0.4586, weighted_loss: 0.5813, label: 1, bag_size: 66789


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.04081632653061224: correct 16/392
Epoch: 34, train_loss: 0.7670, train_clustering_loss:  0.4761, train_error: 0.3265
class 0: acc 0.5, correct 6/12
class 1: acc 0.8, correct 12/15
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.1416, val_error: 0.4545, auc: 0.8542
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1449, instance_loss: 0.5952, weighted_loss: 0.9800, label: 2, bag_size: 17501
batch 39, loss: 0.6857, instance_loss: 0.4251, weighted_loss: 0.6075, label: 2, bag_size: 59749


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.06887755102040816: correct 27/392
Epoch: 35, train_loss: 0.6361, train_clustering_loss:  0.4389, train_error: 0.1837
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 1.0, correct 11/11
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.0964, val_error: 0.2727, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7915, instance_loss: 0.5140, weighted_loss: 0.7083, label: 0, bag_size: 46742
batch 39, loss: 0.2577, instance_loss: 0.3273, weighted_loss: 0.2785, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.1096938775510204: correct 43/392
Epoch: 36, train_loss: 0.6096, train_clustering_loss:  0.4347, train_error: 0.2653
class 0: acc 1.0, correct 11/11
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.75, correct 12/16
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.2288, val_error: 0.6364, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.5623, instance_loss: 0.7376, weighted_loss: 1.3149, label: 1, bag_size: 445537
batch 39, loss: 0.5081, instance_loss: 0.4475, weighted_loss: 0.4899, label: 0, bag_size: 453871


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.08673469387755102: correct 34/392
Epoch: 37, train_loss: 0.6376, train_clustering_loss:  0.4502, train_error: 0.2449
class 0: acc 0.5, correct 5/10
class 1: acc 0.8, correct 12/15
class 2: acc 1.0, correct 13/13
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.1919, val_error: 0.4545, auc: 0.8438
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.8498, instance_loss: 0.5033, weighted_loss: 0.7459, label: 0, bag_size: 13999
batch 39, loss: 1.0496, instance_loss: 0.4580, weighted_loss: 0.8722, label: 0, bag_size: 54249


class 0 clustering acc 0.9968112244897959: correct 1563/1568
class 1 clustering acc 0.07908163265306123: correct 31/392
Epoch: 38, train_loss: 0.6288, train_clustering_loss:  0.4365, train_error: 0.2653
class 0: acc 0.6, correct 9/15
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.0922, val_error: 0.3636, auc: 0.8333
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.6196, instance_loss: 0.6231, weighted_loss: 1.3206, label: 1, bag_size: 445537
batch 39, loss: 0.2546, instance_loss: 0.3322, weighted_loss: 0.2779, label: 2, bag_size: 525276


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.10714285714285714: correct 42/392
Epoch: 39, train_loss: 0.5403, train_clustering_loss:  0.4068, train_error: 0.1837
class 0: acc 0.75, correct 6/8
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.2887, val_error: 0.4545, auc: 0.8125
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.1035, instance_loss: 0.2643, weighted_loss: 0.1517, label: 3, bag_size: 99257
batch 39, loss: 0.9304, instance_loss: 0.5577, weighted_loss: 0.8186, label: 0, bag_size: 222326


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.15306122448979592: correct 60/392
Epoch: 40, train_loss: 0.5503, train_clustering_loss:  0.4047, train_error: 0.2245
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.8, correct 8/10
class 2: acc 1.0, correct 13/13
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.0813, val_error: 0.3636, auc: 0.8333
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1084, instance_loss: 0.2537, weighted_loss: 0.1520, label: 3, bag_size: 56291
batch 39, loss: 0.1239, instance_loss: 0.2225, weighted_loss: 0.1535, label: 2, bag_size: 113492


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.25510204081632654: correct 100/392
Epoch: 41, train_loss: 0.4432, train_clustering_loss:  0.3685, train_error: 0.1633
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.3030, val_error: 0.5455, auc: 0.8021
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1980, instance_loss: 0.2548, weighted_loss: 0.2151, label: 1, bag_size: 36943
batch 39, loss: 0.1896, instance_loss: 0.2429, weighted_loss: 0.2056, label: 1, bag_size: 77634


class 0 clustering acc 0.9955357142857143: correct 1561/1568
class 1 clustering acc 0.22193877551020408: correct 87/392
Epoch: 42, train_loss: 0.5231, train_clustering_loss:  0.3990, train_error: 0.1837
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.4971, val_error: 0.5455, auc: 0.7500
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.4233, instance_loss: 0.3637, weighted_loss: 0.4054, label: 2, bag_size: 22416
batch 39, loss: 0.7475, instance_loss: 0.4750, weighted_loss: 0.6657, label: 0, bag_size: 222326


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.2729591836734694: correct 107/392
Epoch: 43, train_loss: 0.4879, train_clustering_loss:  0.3708, train_error: 0.2041
class 0: acc 0.7, correct 7/10
class 1: acc 0.9375, correct 15/16
class 2: acc 1.0, correct 12/12
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.1668, val_error: 0.4545, auc: 0.8090
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1978, instance_loss: 0.3238, weighted_loss: 0.2356, label: 1, bag_size: 69073
batch 39, loss: 0.4505, instance_loss: 0.4044, weighted_loss: 0.4367, label: 1, bag_size: 66789


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.29336734693877553: correct 115/392
Epoch: 44, train_loss: 0.4461, train_clustering_loss:  0.3625, train_error: 0.1020
class 0: acc 0.6, correct 3/5
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 1.0, correct 17/17
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.3707, val_error: 0.6364, auc: 0.7292
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.3745, instance_loss: 0.3764, weighted_loss: 0.3750, label: 0, bag_size: 222326
batch 39, loss: 0.3152, instance_loss: 0.3716, weighted_loss: 0.3321, label: 0, bag_size: 222326


class 0 clustering acc 0.9948979591836735: correct 1560/1568
class 1 clustering acc 0.22959183673469388: correct 90/392
Epoch: 45, train_loss: 0.6199, train_clustering_loss:  0.4205, train_error: 0.2449
class 0: acc 0.6875, correct 11/16
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.2739, val_error: 0.5455, auc: 0.7500
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.1495, instance_loss: 0.2101, weighted_loss: 0.1677, label: 1, bag_size: 36943
batch 39, loss: 0.2437, instance_loss: 0.2142, weighted_loss: 0.2348, label: 1, bag_size: 66789


class 0 clustering acc 0.9955357142857143: correct 1561/1568
class 1 clustering acc 0.3596938775510204: correct 141/392
Epoch: 46, train_loss: 0.4739, train_clustering_loss:  0.3529, train_error: 0.1429
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.8, correct 8/10
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.1797, val_error: 0.3636, auc: 0.7917
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.7574, instance_loss: 0.5480, weighted_loss: 0.6946, label: 0, bag_size: 19277
batch 39, loss: 1.7011, instance_loss: 0.7165, weighted_loss: 1.4057, label: 2, bag_size: 59749


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.2602040816326531: correct 102/392
Epoch: 47, train_loss: 0.6776, train_clustering_loss:  0.4275, train_error: 0.2449
class 0: acc 0.625, correct 10/16
class 1: acc 0.6666666666666666, correct 4/6
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.8888888888888888, correct 16/18

Val Set, val_loss: 1.4327, val_error: 0.4545, auc: 0.7396
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.2657, instance_loss: 0.4439, weighted_loss: 0.3192, label: 0, bag_size: 19277
batch 39, loss: 0.1331, instance_loss: 0.3288, weighted_loss: 0.1918, label: 2, bag_size: 163352


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.3112244897959184: correct 122/392
Epoch: 48, train_loss: 0.3910, train_clustering_loss:  0.3593, train_error: 0.1224
class 0: acc 0.9375, correct 15/16
class 1: acc 0.9, correct 9/10
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.4722, val_error: 0.5455, auc: 0.7153
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1232, instance_loss: 0.2752, weighted_loss: 0.1688, label: 2, bag_size: 54449
batch 39, loss: 0.2568, instance_loss: 0.2792, weighted_loss: 0.2635, label: 1, bag_size: 132271


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.4744897959183674: correct 186/392
Epoch: 49, train_loss: 0.3693, train_clustering_loss:  0.3123, train_error: 0.1429
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 1.0, correct 18/18
class 2: acc 0.875, correct 7/8
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.6421, val_error: 0.6364, auc: 0.6979
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0415, instance_loss: 0.1096, weighted_loss: 0.0619, label: 0, bag_size: 41829
batch 39, loss: 0.2133, instance_loss: 0.3420, weighted_loss: 0.2519, label: 2, bag_size: 22130


class 0 clustering acc 0.9853316326530612: correct 1545/1568
class 1 clustering acc 0.3520408163265306: correct 138/392
Epoch: 50, train_loss: 0.4977, train_clustering_loss:  0.3833, train_error: 0.2245
class 0: acc 0.75, correct 15/20
class 1: acc 1.0, correct 13/13
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.5714285714285714, correct 4/7

Val Set, val_loss: 1.4378, val_error: 0.4545, auc: 0.6840
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.3239, instance_loss: 0.2898, weighted_loss: 0.3136, label: 1, bag_size: 132271
batch 39, loss: 0.2540, instance_loss: 0.2744, weighted_loss: 0.2601, label: 3, bag_size: 48489


class 0 clustering acc 0.9980867346938775: correct 1565/1568
class 1 clustering acc 0.42346938775510207: correct 166/392
Epoch: 51, train_loss: 0.3721, train_clustering_loss:  0.3204, train_error: 0.1633
class 0: acc 1.0, correct 14/14
class 1: acc 0.9, correct 9/10
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.4235, val_error: 0.4545, auc: 0.7708
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0204, instance_loss: 0.0859, weighted_loss: 0.0401, label: 3, bag_size: 181076
batch 39, loss: 0.0308, instance_loss: 0.1209, weighted_loss: 0.0578, label: 3, bag_size: 181076


class 0 clustering acc 0.9897959183673469: correct 1552/1568
class 1 clustering acc 0.4489795918367347: correct 176/392
Epoch: 52, train_loss: 0.3938, train_clustering_loss:  0.3250, train_error: 0.1429
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 1.0, correct 11/11
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.1765, val_error: 0.4545, auc: 0.8021
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.3636, ROC AUC: 0.8229
Test error: 0.8182, ROC AUC: 0.5278
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3

Training Fold 6!

Init train/val/test splits... 
Done!
Training on 49 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.0860, instance_loss: 1.0092, weighted_loss: 1.0630, label: 2, bag_size: 113492
batch 39, loss: 2.3754, instance_loss: 0.9444, weighted_loss: 1.9461, label: 1, bag_size: 81420


class 0 clustering acc 0.9610969387755102: correct 1507/1568
class 1 clustering acc 0.058673469387755105: correct 23/392
Epoch: 0, train_loss: 1.3978, train_clustering_loss:  1.0032, train_error: 0.6531
class 0: acc 0.0, correct 0/12
class 1: acc 0.0, correct 0/7
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.25, correct 4/16

Val Set, val_loss: 1.4580, val_error: 0.6364, auc: 0.6181
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.458031).  Saving model ...


batch 19, loss: 1.6229, instance_loss: 0.7973, weighted_loss: 1.3752, label: 1, bag_size: 104549
batch 39, loss: 1.3664, instance_loss: 0.6993, weighted_loss: 1.1663, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 1, train_loss: 1.4008, train_clustering_loss:  0.7269, train_error: 0.6939
class 0: acc 0.0, correct 0/7
class 1: acc 0.1111111111111111, correct 2/18
class 2: acc 0.0, correct 0/11
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.4012, val_error: 0.7273, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.458031 --> 1.401249).  Saving model ...


batch 19, loss: 1.3395, instance_loss: 0.6443, weighted_loss: 1.1309, label: 2, bag_size: 163352
batch 39, loss: 1.5598, instance_loss: 0.6692, weighted_loss: 1.2926, label: 3, bag_size: 16626


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 2, train_loss: 1.4259, train_clustering_loss:  0.6513, train_error: 0.8367
class 0: acc 0.0, correct 0/12
class 1: acc 0.42857142857142855, correct 6/14
class 2: acc 0.16666666666666666, correct 2/12
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.3782, val_error: 0.6364, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.401249 --> 1.378228).  Saving model ...


batch 19, loss: 1.7323, instance_loss: 0.6343, weighted_loss: 1.4029, label: 2, bag_size: 278757
batch 39, loss: 1.7990, instance_loss: 0.6365, weighted_loss: 1.4502, label: 0, bag_size: 46742


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 3, train_loss: 1.3773, train_clustering_loss:  0.6206, train_error: 0.6939
class 0: acc 0.08333333333333333, correct 1/12
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.0, correct 0/10
class 3: acc 0.5555555555555556, correct 10/18

Val Set, val_loss: 1.4046, val_error: 0.7273, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.7823, instance_loss: 0.6410, weighted_loss: 1.4399, label: 1, bag_size: 58270
batch 39, loss: 1.2644, instance_loss: 0.6225, weighted_loss: 1.0719, label: 2, bag_size: 103108


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 4, train_loss: 1.3834, train_clustering_loss:  0.6153, train_error: 0.7347
class 0: acc 0.0, correct 0/7
class 1: acc 0.1875, correct 3/16
class 2: acc 0.07692307692307693, correct 1/13
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.3945, val_error: 0.7273, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0921, instance_loss: 0.5924, weighted_loss: 0.9422, label: 1, bag_size: 23122
batch 39, loss: 1.1787, instance_loss: 0.5731, weighted_loss: 0.9970, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 5, train_loss: 1.3409, train_clustering_loss:  0.6086, train_error: 0.5510
class 0: acc 0.0, correct 0/12
class 1: acc 1.0, correct 14/14
class 2: acc 0.0, correct 0/7
class 3: acc 0.5, correct 8/16

Val Set, val_loss: 1.3570, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.378228 --> 1.356975).  Saving model ...


batch 19, loss: 1.2501, instance_loss: 0.5941, weighted_loss: 1.0533, label: 3, bag_size: 22057
batch 39, loss: 1.1679, instance_loss: 0.6192, weighted_loss: 1.0033, label: 0, bag_size: 6353


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 6, train_loss: 1.3527, train_clustering_loss:  0.6207, train_error: 0.6939
class 0: acc 0.5333333333333333, correct 8/15
class 1: acc 0.25, correct 3/12
class 2: acc 0.0, correct 0/14
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.3975, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8205, instance_loss: 0.5888, weighted_loss: 0.7509, label: 0, bag_size: 59350
batch 39, loss: 1.1048, instance_loss: 0.6241, weighted_loss: 0.9606, label: 2, bag_size: 176020


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 7, train_loss: 1.2317, train_clustering_loss:  0.6098, train_error: 0.4082
class 0: acc 0.9444444444444444, correct 17/18
class 1: acc 0.0, correct 0/8
class 2: acc 0.75, correct 12/16
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.4828, val_error: 0.6364, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6702, instance_loss: 0.6605, weighted_loss: 1.3673, label: 1, bag_size: 57038
batch 39, loss: 1.1139, instance_loss: 0.6214, weighted_loss: 0.9662, label: 3, bag_size: 16626


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 8, train_loss: 1.3282, train_clustering_loss:  0.6129, train_error: 0.6327
class 0: acc 0.4444444444444444, correct 4/9
class 1: acc 0.0, correct 0/11
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.21428571428571427, correct 3/14

Val Set, val_loss: 1.3954, val_error: 0.7273, auc: 0.6389
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.1954, instance_loss: 0.6333, weighted_loss: 1.0268, label: 3, bag_size: 56291
batch 39, loss: 1.1851, instance_loss: 0.6392, weighted_loss: 1.0213, label: 0, bag_size: 130978


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 9, train_loss: 1.2790, train_clustering_loss:  0.6015, train_error: 0.5918
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.3076923076923077, correct 4/13
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.3405, val_error: 0.6364, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.356975 --> 1.340547).  Saving model ...


batch 19, loss: 1.6565, instance_loss: 0.6190, weighted_loss: 1.3452, label: 1, bag_size: 104549
batch 39, loss: 1.8766, instance_loss: 0.6508, weighted_loss: 1.5089, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 10, train_loss: 1.2773, train_clustering_loss:  0.6086, train_error: 0.5714
class 0: acc 0.0, correct 0/9
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.4157, val_error: 0.7273, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4902, instance_loss: 0.6492, weighted_loss: 1.2379, label: 0, bag_size: 10671
batch 39, loss: 0.6940, instance_loss: 0.5405, weighted_loss: 0.6479, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 11, train_loss: 1.2789, train_clustering_loss:  0.6019, train_error: 0.6735
class 0: acc 0.3076923076923077, correct 4/13
class 1: acc 0.2, correct 2/10
class 2: acc 0.46153846153846156, correct 6/13
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.3320, val_error: 0.6364, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.340547 --> 1.331976).  Saving model ...


batch 19, loss: 1.8562, instance_loss: 0.6768, weighted_loss: 1.5024, label: 3, bag_size: 25448
batch 39, loss: 1.1237, instance_loss: 0.5932, weighted_loss: 0.9645, label: 0, bag_size: 47775


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 12, train_loss: 1.2046, train_clustering_loss:  0.5932, train_error: 0.4694
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.0, correct 0/10
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.3734, val_error: 0.8182, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9673, instance_loss: 0.6107, weighted_loss: 0.8604, label: 3, bag_size: 56291
batch 39, loss: 1.2515, instance_loss: 0.6707, weighted_loss: 1.0772, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 13, train_loss: 1.2048, train_clustering_loss:  0.5941, train_error: 0.5306
class 0: acc 0.16666666666666666, correct 1/6
class 1: acc 0.15384615384615385, correct 2/13
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.4491, val_error: 0.7273, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6906, instance_loss: 0.6513, weighted_loss: 1.3788, label: 0, bag_size: 6353
batch 39, loss: 1.5885, instance_loss: 0.6460, weighted_loss: 1.3057, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 14, train_loss: 1.1658, train_clustering_loss:  0.5792, train_error: 0.4490
class 0: acc 0.3, correct 3/10
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.8, correct 8/10
class 3: acc 0.35714285714285715, correct 5/14

Val Set, val_loss: 1.2854, val_error: 0.5455, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.331976 --> 1.285355).  Saving model ...


batch 19, loss: 1.0545, instance_loss: 0.5770, weighted_loss: 0.9113, label: 1, bag_size: 57038
batch 39, loss: 0.8422, instance_loss: 0.5414, weighted_loss: 0.7519, label: 3, bag_size: 22057


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 15, train_loss: 1.0544, train_clustering_loss:  0.5734, train_error: 0.4286
class 0: acc 0.0, correct 0/6
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.3076923076923077, correct 4/13
class 3: acc 0.8421052631578947, correct 16/19

Val Set, val_loss: 1.4474, val_error: 0.6364, auc: 0.6875
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6931, instance_loss: 0.5222, weighted_loss: 0.6418, label: 2, bag_size: 209612
batch 39, loss: 0.6412, instance_loss: 0.5298, weighted_loss: 0.6078, label: 2, bag_size: 209612


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 16, train_loss: 1.1276, train_clustering_loss:  0.5699, train_error: 0.5102
class 0: acc 0.0, correct 0/8
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.3904, val_error: 0.7273, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.6050, instance_loss: 0.6354, weighted_loss: 0.6141, label: 0, bag_size: 130978
batch 39, loss: 0.5016, instance_loss: 0.5077, weighted_loss: 0.5034, label: 3, bag_size: 99257


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 17, train_loss: 1.0373, train_clustering_loss:  0.5673, train_error: 0.4490
class 0: acc 0.5625, correct 9/16
class 1: acc 0.2, correct 2/10
class 2: acc 0.8, correct 12/15
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.3814, val_error: 0.7273, auc: 0.6875
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6488, instance_loss: 0.5046, weighted_loss: 0.6055, label: 1, bag_size: 20030
batch 39, loss: 0.8017, instance_loss: 0.5079, weighted_loss: 0.7136, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 18, train_loss: 1.1108, train_clustering_loss:  0.5699, train_error: 0.5102
class 0: acc 0.3333333333333333, correct 5/15
class 1: acc 0.5, correct 7/14
class 2: acc 1.0, correct 9/9
class 3: acc 0.2727272727272727, correct 3/11

Val Set, val_loss: 1.2688, val_error: 0.7273, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.285355 --> 1.268761).  Saving model ...


batch 19, loss: 1.0238, instance_loss: 0.5286, weighted_loss: 0.8752, label: 1, bag_size: 20030
batch 39, loss: 0.9880, instance_loss: 0.5197, weighted_loss: 0.8475, label: 3, bag_size: 189694


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 19, train_loss: 1.0206, train_clustering_loss:  0.5506, train_error: 0.3878
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.42857142857142855, correct 6/14
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.2986, val_error: 0.4545, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7302, instance_loss: 0.5015, weighted_loss: 0.6616, label: 1, bag_size: 64834
batch 39, loss: 0.7332, instance_loss: 0.4837, weighted_loss: 0.6584, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 20, train_loss: 1.0242, train_clustering_loss:  0.5519, train_error: 0.3469
class 0: acc 0.0, correct 0/10
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.2656, val_error: 0.3636, auc: 0.7639
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.268761 --> 1.265605).  Saving model ...


batch 19, loss: 0.2314, instance_loss: 0.3988, weighted_loss: 0.2816, label: 3, bag_size: 181076
batch 39, loss: 1.9859, instance_loss: 0.6532, weighted_loss: 1.5861, label: 1, bag_size: 445537


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 21, train_loss: 0.9278, train_clustering_loss:  0.5376, train_error: 0.3673
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.75, correct 9/12
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.3167, val_error: 0.5455, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1156, instance_loss: 0.5215, weighted_loss: 0.9374, label: 1, bag_size: 77634
batch 39, loss: 0.4048, instance_loss: 0.4851, weighted_loss: 0.4289, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 22, train_loss: 0.8658, train_clustering_loss:  0.5347, train_error: 0.2653
class 0: acc 0.9090909090909091, correct 20/22
class 1: acc 0.4, correct 4/10
class 2: acc 0.75, correct 6/8
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.3926, val_error: 0.7273, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.9348, instance_loss: 0.6652, weighted_loss: 1.5539, label: 3, bag_size: 28883
batch 39, loss: 0.8481, instance_loss: 0.4691, weighted_loss: 0.7344, label: 2, bag_size: 163352


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 23, train_loss: 0.9234, train_clustering_loss:  0.5203, train_error: 0.3469
class 0: acc 1.0, correct 17/17
class 1: acc 0.0, correct 0/9
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.3843, val_error: 0.7273, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1596, instance_loss: 0.3092, weighted_loss: 0.2045, label: 3, bag_size: 181076
batch 39, loss: 0.6326, instance_loss: 0.4101, weighted_loss: 0.5659, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 24, train_loss: 0.9200, train_clustering_loss:  0.5203, train_error: 0.3878
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.2, correct 2/10
class 2: acc 0.875, correct 14/16
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.3846, val_error: 0.6364, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.4660, instance_loss: 0.3861, weighted_loss: 0.4420, label: 2, bag_size: 163352
batch 39, loss: 0.2231, instance_loss: 0.3007, weighted_loss: 0.2464, label: 2, bag_size: 278757


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.002551020408163265: correct 1/392
Epoch: 25, train_loss: 0.8785, train_clustering_loss:  0.5133, train_error: 0.3673
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.25, correct 3/12
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.5070, val_error: 0.8182, auc: 0.5938
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.4248, instance_loss: 0.3698, weighted_loss: 0.4083, label: 2, bag_size: 17501
batch 39, loss: 1.4692, instance_loss: 0.6286, weighted_loss: 1.2170, label: 0, bag_size: 222491


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.01020408163265306: correct 4/392
Epoch: 26, train_loss: 0.8582, train_clustering_loss:  0.4986, train_error: 0.4286
class 0: acc 0.3, correct 3/10
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.9411764705882353, correct 16/17
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.5206, val_error: 0.6364, auc: 0.5938
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.7554, instance_loss: 0.5415, weighted_loss: 0.6912, label: 1, bag_size: 57038
batch 39, loss: 0.3135, instance_loss: 0.3545, weighted_loss: 0.3258, label: 3, bag_size: 240896


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.007653061224489796: correct 3/392
Epoch: 27, train_loss: 0.6595, train_clustering_loss:  0.4781, train_error: 0.2449
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.8125, correct 13/16

Val Set, val_loss: 1.4259, val_error: 0.4545, auc: 0.6319
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.2173, instance_loss: 0.3366, weighted_loss: 0.2531, label: 3, bag_size: 181076
batch 39, loss: 0.3816, instance_loss: 0.4610, weighted_loss: 0.4054, label: 1, bag_size: 132271


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.015306122448979591: correct 6/392
Epoch: 28, train_loss: 0.7793, train_clustering_loss:  0.4872, train_error: 0.3061
class 0: acc 0.1111111111111111, correct 1/9
class 1: acc 0.7058823529411765, correct 12/17
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.4865, val_error: 0.5455, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.8284, instance_loss: 0.6685, weighted_loss: 1.4804, label: 3, bag_size: 25448
batch 39, loss: 0.8323, instance_loss: 0.4134, weighted_loss: 0.7066, label: 2, bag_size: 103108


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.08673469387755102: correct 34/392
Epoch: 29, train_loss: 0.6848, train_clustering_loss:  0.4556, train_error: 0.3469
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.16666666666666666, correct 1/6
class 2: acc 0.8888888888888888, correct 16/18
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.6010, val_error: 0.8182, auc: 0.6389
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 2.4041, instance_loss: 0.7990, weighted_loss: 1.9226, label: 2, bag_size: 54449
batch 39, loss: 0.4227, instance_loss: 0.4212, weighted_loss: 0.4222, label: 3, bag_size: 40869


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.0663265306122449: correct 26/392
Epoch: 30, train_loss: 0.7495, train_clustering_loss:  0.4809, train_error: 0.3265
class 0: acc 0.42857142857142855, correct 6/14
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.5334, val_error: 0.6364, auc: 0.6667
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2256, instance_loss: 0.2542, weighted_loss: 0.2342, label: 2, bag_size: 113492
batch 39, loss: 0.8314, instance_loss: 0.5597, weighted_loss: 0.7499, label: 0, bag_size: 6353


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.1326530612244898: correct 52/392
Epoch: 31, train_loss: 0.6414, train_clustering_loss:  0.4338, train_error: 0.1837
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.7222222222222222, correct 13/18
class 2: acc 1.0, correct 14/14
class 3: acc 0.6, correct 3/5

Val Set, val_loss: 1.7995, val_error: 0.6364, auc: 0.5729
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.3327, instance_loss: 0.3933, weighted_loss: 0.3509, label: 3, bag_size: 240896
batch 39, loss: 0.1250, instance_loss: 0.2375, weighted_loss: 0.1588, label: 2, bag_size: 525276


class 0 clustering acc 0.9968112244897959: correct 1563/1568
class 1 clustering acc 0.1836734693877551: correct 72/392
Epoch: 32, train_loss: 0.6071, train_clustering_loss:  0.4290, train_error: 0.1837
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.8888888888888888, correct 16/18
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.7774, val_error: 0.7273, auc: 0.6319
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.7036, instance_loss: 0.4738, weighted_loss: 0.6347, label: 1, bag_size: 49894
batch 39, loss: 0.1879, instance_loss: 0.2966, weighted_loss: 0.2205, label: 2, bag_size: 176020


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.1326530612244898: correct 52/392
Epoch: 33, train_loss: 0.5567, train_clustering_loss:  0.4347, train_error: 0.1837
class 0: acc 0.6, correct 9/15
class 1: acc 0.75, correct 9/12
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.6737, val_error: 0.6364, auc: 0.5903
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.8695, instance_loss: 0.4989, weighted_loss: 0.7583, label: 1, bag_size: 58270
batch 39, loss: 0.5104, instance_loss: 0.5219, weighted_loss: 0.5139, label: 1, bag_size: 104549


class 0 clustering acc 0.9968112244897959: correct 1563/1568
class 1 clustering acc 0.058673469387755105: correct 23/392
Epoch: 34, train_loss: 0.7173, train_clustering_loss:  0.4676, train_error: 0.2857
class 0: acc 0.75, correct 12/16
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.9966, val_error: 0.8182, auc: 0.5000
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.2072, instance_loss: 0.2686, weighted_loss: 0.2256, label: 2, bag_size: 176020
batch 39, loss: 0.1694, instance_loss: 0.2665, weighted_loss: 0.1986, label: 0, bag_size: 41829


class 0 clustering acc 0.9948979591836735: correct 1560/1568
class 1 clustering acc 0.125: correct 49/392
Epoch: 35, train_loss: 0.5513, train_clustering_loss:  0.4287, train_error: 0.2041
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.6, correct 6/10
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 2.0885, val_error: 0.9091, auc: 0.4792
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0979, instance_loss: 0.1635, weighted_loss: 0.1176, label: 2, bag_size: 22416
batch 39, loss: 0.0522, instance_loss: 0.2045, weighted_loss: 0.0979, label: 3, bag_size: 56291


class 0 clustering acc 0.9853316326530612: correct 1545/1568
class 1 clustering acc 0.1683673469387755: correct 66/392
Epoch: 36, train_loss: 0.8457, train_clustering_loss:  0.4685, train_error: 0.2857
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.8, correct 8/10
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.7438, val_error: 0.9091, auc: 0.5278
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.2155, instance_loss: 0.2986, weighted_loss: 0.2404, label: 2, bag_size: 17501
batch 39, loss: 2.6668, instance_loss: 0.8457, weighted_loss: 2.1205, label: 1, bag_size: 445537


class 0 clustering acc 0.9942602040816326: correct 1559/1568
class 1 clustering acc 0.1683673469387755: correct 66/392
Epoch: 37, train_loss: 0.7618, train_clustering_loss:  0.4625, train_error: 0.2857
class 0: acc 0.6, correct 6/10
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.875, correct 14/16
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.6522, val_error: 0.7273, auc: 0.5347
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.2074, instance_loss: 0.3005, weighted_loss: 0.2353, label: 0, bag_size: 41829
batch 39, loss: 0.0996, instance_loss: 0.1524, weighted_loss: 0.1154, label: 2, bag_size: 23349


class 0 clustering acc 0.9968112244897959: correct 1563/1568
class 1 clustering acc 0.14030612244897958: correct 55/392
Epoch: 38, train_loss: 0.6301, train_clustering_loss:  0.4292, train_error: 0.2449
class 0: acc 0.6875, correct 11/16
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 1.0, correct 5/5

Val Set, val_loss: 1.7134, val_error: 0.5455, auc: 0.6042
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.2023, instance_loss: 0.2547, weighted_loss: 0.2180, label: 2, bag_size: 17501
batch 39, loss: 0.2819, instance_loss: 0.3977, weighted_loss: 0.3166, label: 3, bag_size: 262536


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.13010204081632654: correct 51/392
Epoch: 39, train_loss: 0.7436, train_clustering_loss:  0.4534, train_error: 0.2653
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.8666666666666667, correct 13/15

Val Set, val_loss: 1.8523, val_error: 0.7273, auc: 0.5243
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2743, instance_loss: 0.3968, weighted_loss: 0.3111, label: 3, bag_size: 56291
batch 39, loss: 0.3696, instance_loss: 0.3530, weighted_loss: 0.3646, label: 3, bag_size: 189694


class 0 clustering acc 0.9968112244897959: correct 1563/1568
class 1 clustering acc 0.25: correct 98/392
Epoch: 40, train_loss: 0.5410, train_clustering_loss:  0.3916, train_error: 0.2653
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.5, correct 5/10
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.7001, val_error: 0.7273, auc: 0.5278
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0912, instance_loss: 0.2364, weighted_loss: 0.1347, label: 3, bag_size: 56291
batch 39, loss: 0.2514, instance_loss: 0.3613, weighted_loss: 0.2843, label: 3, bag_size: 16626


class 0 clustering acc 0.9980867346938775: correct 1565/1568
class 1 clustering acc 0.15051020408163265: correct 59/392
Epoch: 41, train_loss: 0.5250, train_clustering_loss:  0.4051, train_error: 0.2041
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 0.625, correct 5/8
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.7611, val_error: 0.6364, auc: 0.5521
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.1180, instance_loss: 0.5896, weighted_loss: 0.9595, label: 0, bag_size: 10671
batch 39, loss: 0.3670, instance_loss: 0.4512, weighted_loss: 0.3922, label: 0, bag_size: 22124


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.336734693877551: correct 132/392
Epoch: 42, train_loss: 0.5085, train_clustering_loss:  0.3775, train_error: 0.2245
class 0: acc 0.5714285714285714, correct 8/14
class 1: acc 0.9, correct 9/10
class 2: acc 0.8421052631578947, correct 16/19
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 2.0023, val_error: 0.8182, auc: 0.5104
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.2825, instance_loss: 0.3127, weighted_loss: 0.2916, label: 0, bag_size: 59350
batch 39, loss: 0.6296, instance_loss: 0.3763, weighted_loss: 0.5536, label: 3, bag_size: 189694


class 0 clustering acc 0.9878826530612245: correct 1549/1568
class 1 clustering acc 0.15816326530612246: correct 62/392
Epoch: 43, train_loss: 0.5755, train_clustering_loss:  0.4337, train_error: 0.1633
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.9364, val_error: 0.8182, auc: 0.5590
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.2485, instance_loss: 0.3443, weighted_loss: 0.2772, label: 1, bag_size: 36943
batch 39, loss: 0.2806, instance_loss: 0.4119, weighted_loss: 0.3200, label: 1, bag_size: 104549


class 0 clustering acc 0.9948979591836735: correct 1560/1568
class 1 clustering acc 0.2755102040816326: correct 108/392
Epoch: 44, train_loss: 0.5614, train_clustering_loss:  0.3882, train_error: 0.1633
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 1.0, correct 14/14
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.8255, val_error: 0.6364, auc: 0.5903
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.2811, instance_loss: 0.2972, weighted_loss: 0.2860, label: 3, bag_size: 189694
batch 39, loss: 0.1752, instance_loss: 0.2625, weighted_loss: 0.2013, label: 3, bag_size: 189694


class 0 clustering acc 0.9789540816326531: correct 1535/1568
class 1 clustering acc 0.21428571428571427: correct 84/392
Epoch: 45, train_loss: 0.6608, train_clustering_loss:  0.4480, train_error: 0.2653
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 2.0770, val_error: 0.8182, auc: 0.5104
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.9077, instance_loss: 0.5352, weighted_loss: 0.7960, label: 0, bag_size: 10671
batch 39, loss: 0.1659, instance_loss: 0.2863, weighted_loss: 0.2020, label: 1, bag_size: 64834


class 0 clustering acc 0.9980867346938775: correct 1565/1568
class 1 clustering acc 0.2627551020408163: correct 103/392
Epoch: 46, train_loss: 0.5886, train_clustering_loss:  0.3955, train_error: 0.2857
class 0: acc 0.5, correct 7/14
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.8990, val_error: 0.6364, auc: 0.5312
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.2089, instance_loss: 0.2671, weighted_loss: 0.2264, label: 1, bag_size: 20030
batch 39, loss: 1.4920, instance_loss: 0.6409, weighted_loss: 1.2367, label: 0, bag_size: 13999


class 0 clustering acc 0.9897959183673469: correct 1552/1568
class 1 clustering acc 0.29846938775510207: correct 117/392
Epoch: 47, train_loss: 0.5418, train_clustering_loss:  0.3754, train_error: 0.1837
class 0: acc 0.6, correct 6/10
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.8, correct 8/10
class 3: acc 0.8888888888888888, correct 16/18

Val Set, val_loss: 2.2348, val_error: 0.8182, auc: 0.4479
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.5687, instance_loss: 0.4077, weighted_loss: 0.5204, label: 1, bag_size: 20030
batch 39, loss: 0.0358, instance_loss: 0.0802, weighted_loss: 0.0491, label: 2, bag_size: 209612


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.32653061224489793: correct 128/392
Epoch: 48, train_loss: 0.4910, train_clustering_loss:  0.3684, train_error: 0.2245
class 0: acc 0.5, correct 6/12
class 1: acc 0.75, correct 9/12
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.7755, val_error: 0.7273, auc: 0.5625
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 2.0288, instance_loss: 0.7701, weighted_loss: 1.6512, label: 2, bag_size: 54449
batch 39, loss: 0.3905, instance_loss: 0.4095, weighted_loss: 0.3962, label: 0, bag_size: 47775


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.31887755102040816: correct 125/392
Epoch: 49, train_loss: 0.4689, train_clustering_loss:  0.3796, train_error: 0.1837
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 2.3809, val_error: 0.7273, auc: 0.5104
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 1.2897, instance_loss: 0.6212, weighted_loss: 1.0892, label: 3, bag_size: 25448
batch 39, loss: 0.3069, instance_loss: 0.2309, weighted_loss: 0.2841, label: 2, bag_size: 103108


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.28316326530612246: correct 111/392
Epoch: 50, train_loss: 0.4227, train_clustering_loss:  0.3646, train_error: 0.1020
class 0: acc 0.8888888888888888, correct 16/18
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 1.0, correct 7/7
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.9983, val_error: 0.7273, auc: 0.5903
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.6008, instance_loss: 0.4609, weighted_loss: 0.5588, label: 0, bag_size: 47775
batch 39, loss: 0.6675, instance_loss: 0.4259, weighted_loss: 0.5950, label: 3, bag_size: 22057


class 0 clustering acc 0.9929846938775511: correct 1557/1568
class 1 clustering acc 0.37244897959183676: correct 146/392
Epoch: 51, train_loss: 0.3863, train_clustering_loss:  0.3286, train_error: 0.1429
class 0: acc 0.5384615384615384, correct 7/13
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 13/13
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 2.2373, val_error: 0.7273, auc: 0.5660
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 31 out of 20
Early stopping
Val error: 0.3636, ROC AUC: 0.7639
Test error: 0.5455, ROC AUC: 0.7083
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3

Training Fold 7!

Init train/val/test splits... 
Done!
Training on 49 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6657, instance_loss: 1.0595, weighted_loss: 1.4838, label: 2, bag_size: 113492
batch 39, loss: 2.2738, instance_loss: 0.9528, weighted_loss: 1.8775, label: 1, bag_size: 47433


class 0 clustering acc 0.9170918367346939: correct 1438/1568
class 1 clustering acc 0.13520408163265307: correct 53/392
Epoch: 0, train_loss: 1.3852, train_clustering_loss:  1.0010, train_error: 0.5918
class 0: acc 0.0, correct 0/12
class 1: acc 0.0, correct 0/6
class 2: acc 0.0, correct 0/11
class 3: acc 1.0, correct 20/20

Val Set, val_loss: 1.4539, val_error: 0.7273, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.453852).  Saving model ...


batch 19, loss: 1.8272, instance_loss: 0.7555, weighted_loss: 1.5057, label: 1, bag_size: 104549
batch 39, loss: 1.4943, instance_loss: 0.6810, weighted_loss: 1.2503, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 1, train_loss: 1.3857, train_clustering_loss:  0.6960, train_error: 0.6939
class 0: acc 0.0, correct 0/8
class 1: acc 0.0, correct 0/16
class 2: acc 0.0, correct 0/10
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.3826, val_error: 0.6364, auc: 0.6181
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.453852 --> 1.382570).  Saving model ...


batch 19, loss: 1.8621, instance_loss: 0.6681, weighted_loss: 1.5039, label: 2, bag_size: 149988
batch 39, loss: 1.2367, instance_loss: 0.6393, weighted_loss: 1.0575, label: 3, bag_size: 16626


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 2, train_loss: 1.4494, train_clustering_loss:  0.6398, train_error: 0.7347
class 0: acc 0.0, correct 0/9
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.0, correct 0/13
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.3785, val_error: 0.6364, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.382570 --> 1.378515).  Saving model ...


batch 19, loss: 1.3195, instance_loss: 0.6000, weighted_loss: 1.1037, label: 3, bag_size: 231301
batch 39, loss: 1.4546, instance_loss: 0.6411, weighted_loss: 1.2105, label: 2, bag_size: 22416


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 3, train_loss: 1.3921, train_clustering_loss:  0.6273, train_error: 0.7143
class 0: acc 0.0, correct 0/13
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.0, correct 0/14
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.3885, val_error: 0.7273, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.9247, instance_loss: 0.6310, weighted_loss: 1.5366, label: 1, bag_size: 18329
batch 39, loss: 1.4758, instance_loss: 0.6237, weighted_loss: 1.2201, label: 2, bag_size: 22130


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 4, train_loss: 1.3965, train_clustering_loss:  0.6098, train_error: 0.6939
class 0: acc 0.0, correct 0/6
class 1: acc 0.29411764705882354, correct 5/17
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.23076923076923078, correct 3/13

Val Set, val_loss: 1.3779, val_error: 0.7273, auc: 0.8264
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.378515 --> 1.377863).  Saving model ...


batch 19, loss: 1.1900, instance_loss: 0.6010, weighted_loss: 1.0133, label: 1, bag_size: 23122
batch 39, loss: 1.1799, instance_loss: 0.5860, weighted_loss: 1.0017, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 5, train_loss: 1.3663, train_clustering_loss:  0.6088, train_error: 0.6531
class 0: acc 0.0, correct 0/12
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.0, correct 0/7
class 3: acc 0.5294117647058824, correct 9/17

Val Set, val_loss: 1.3372, val_error: 0.6364, auc: 0.8021
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.377863 --> 1.337182).  Saving model ...


batch 19, loss: 1.1133, instance_loss: 0.5835, weighted_loss: 0.9543, label: 3, bag_size: 22057
batch 39, loss: 1.3493, instance_loss: 0.6496, weighted_loss: 1.1394, label: 0, bag_size: 22124


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 6, train_loss: 1.3758, train_clustering_loss:  0.6223, train_error: 0.6939
class 0: acc 0.06666666666666667, correct 1/15
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.0, correct 0/10
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.3160, val_error: 0.6364, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.337182 --> 1.316040).  Saving model ...


batch 19, loss: 1.6845, instance_loss: 0.6502, weighted_loss: 1.3742, label: 2, bag_size: 59749
batch 39, loss: 1.4693, instance_loss: 0.6231, weighted_loss: 1.2155, label: 3, bag_size: 240896


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 7, train_loss: 1.3222, train_clustering_loss:  0.6281, train_error: 0.5918
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.0, correct 0/8
class 2: acc 0.0, correct 0/14
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.3634, val_error: 0.7273, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6167, instance_loss: 0.6658, weighted_loss: 1.3315, label: 1, bag_size: 64834
batch 39, loss: 1.7499, instance_loss: 0.6676, weighted_loss: 1.4252, label: 3, bag_size: 16626


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 8, train_loss: 1.3053, train_clustering_loss:  0.6289, train_error: 0.6939
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.0, correct 0/13
class 2: acc 0.3125, correct 5/16
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.3904, val_error: 0.8182, auc: 0.8264
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6477, instance_loss: 0.6902, weighted_loss: 1.3604, label: 3, bag_size: 56291
batch 39, loss: 1.5819, instance_loss: 0.6300, weighted_loss: 1.2963, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 9, train_loss: 1.3237, train_clustering_loss:  0.6202, train_error: 0.6939
class 0: acc 0.0, correct 0/10
class 1: acc 0.21428571428571427, correct 3/14
class 2: acc 0.8, correct 12/15
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3295, val_error: 0.5455, auc: 0.8299
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.6109, instance_loss: 0.6332, weighted_loss: 1.3176, label: 1, bag_size: 104549
batch 39, loss: 1.8310, instance_loss: 0.6640, weighted_loss: 1.4809, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 10, train_loss: 1.3249, train_clustering_loss:  0.6179, train_error: 0.6735
class 0: acc 0.0, correct 0/10
class 1: acc 0.21428571428571427, correct 3/14
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.09090909090909091, correct 1/11

Val Set, val_loss: 1.3286, val_error: 0.7273, auc: 0.8194
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.0126, instance_loss: 0.6370, weighted_loss: 0.8999, label: 0, bag_size: 18551
batch 39, loss: 0.9393, instance_loss: 0.6149, weighted_loss: 0.8420, label: 3, bag_size: 113328


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 11, train_loss: 1.3294, train_clustering_loss:  0.6168, train_error: 0.6327
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.0, correct 0/13
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.2802, val_error: 0.7273, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.316040 --> 1.280227).  Saving model ...


batch 19, loss: 1.5638, instance_loss: 0.6456, weighted_loss: 1.2883, label: 0, bag_size: 108548
batch 39, loss: 1.0429, instance_loss: 0.5753, weighted_loss: 0.9026, label: 0, bag_size: 47775


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 12, train_loss: 1.2875, train_clustering_loss:  0.6080, train_error: 0.6531
class 0: acc 0.5333333333333333, correct 8/15
class 1: acc 0.0, correct 0/10
class 2: acc 0.5714285714285714, correct 8/14
class 3: acc 0.1, correct 1/10

Val Set, val_loss: 1.3319, val_error: 0.7273, auc: 0.7639
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8828, instance_loss: 0.5955, weighted_loss: 0.7966, label: 3, bag_size: 56291
batch 39, loss: 0.8898, instance_loss: 0.5754, weighted_loss: 0.7955, label: 2, bag_size: 59749


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 13, train_loss: 1.2485, train_clustering_loss:  0.6021, train_error: 0.5510
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 0.0, correct 0/11
class 2: acc 0.5625, correct 9/16
class 3: acc 0.6666666666666666, correct 10/15

Val Set, val_loss: 1.3428, val_error: 0.7273, auc: 0.7812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.5421, instance_loss: 0.6507, weighted_loss: 1.2747, label: 0, bag_size: 22124
batch 39, loss: 1.4742, instance_loss: 0.5797, weighted_loss: 1.2058, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 14, train_loss: 1.2478, train_clustering_loss:  0.6014, train_error: 0.6327
class 0: acc 0.38461538461538464, correct 5/13
class 1: acc 0.25, correct 4/16
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.36363636363636365, correct 4/11

Val Set, val_loss: 1.3124, val_error: 0.7273, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.9041, instance_loss: 0.5405, weighted_loss: 0.7950, label: 1, bag_size: 57038
batch 39, loss: 0.6294, instance_loss: 0.5253, weighted_loss: 0.5982, label: 3, bag_size: 22057


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 15, train_loss: 1.2075, train_clustering_loss:  0.5955, train_error: 0.5306
class 0: acc 0.0, correct 0/8
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.0, correct 0/10
class 3: acc 0.8421052631578947, correct 16/19

Val Set, val_loss: 1.3147, val_error: 0.5455, auc: 0.7812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.2534, instance_loss: 0.5984, weighted_loss: 1.0569, label: 2, bag_size: 149988
batch 39, loss: 0.9087, instance_loss: 0.5565, weighted_loss: 0.8031, label: 2, bag_size: 149988


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 16, train_loss: 1.2669, train_clustering_loss:  0.5985, train_error: 0.5918
class 0: acc 0.5714285714285714, correct 8/14
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.4666666666666667, correct 7/15
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.3372, val_error: 0.7273, auc: 0.8264
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.6372, instance_loss: 0.6397, weighted_loss: 1.3379, label: 0, bag_size: 10671
batch 39, loss: 0.8677, instance_loss: 0.5468, weighted_loss: 0.7714, label: 3, bag_size: 113328


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 17, train_loss: 1.1716, train_clustering_loss:  0.5852, train_error: 0.5306
class 0: acc 0.1, correct 1/10
class 1: acc 0.0, correct 0/9
class 2: acc 1.0, correct 19/19
class 3: acc 0.2727272727272727, correct 3/11

Val Set, val_loss: 1.2364, val_error: 0.7273, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.280227 --> 1.236417).  Saving model ...


batch 19, loss: 0.8861, instance_loss: 0.5591, weighted_loss: 0.7880, label: 1, bag_size: 20030
batch 39, loss: 1.4813, instance_loss: 0.6538, weighted_loss: 1.2330, label: 0, bag_size: 46742


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 18, train_loss: 1.1697, train_clustering_loss:  0.5866, train_error: 0.4082
class 0: acc 0.0, correct 0/11
class 1: acc 0.7894736842105263, correct 15/19
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.2414, val_error: 0.6364, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0424, instance_loss: 0.5383, weighted_loss: 0.8912, label: 1, bag_size: 20030
batch 39, loss: 0.3471, instance_loss: 0.4765, weighted_loss: 0.3859, label: 0, bag_size: 453871


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 19, train_loss: 1.1380, train_clustering_loss:  0.5803, train_error: 0.4898
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.625, correct 10/16
class 2: acc 0.3, correct 3/10
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.2233, val_error: 0.6364, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.236417 --> 1.223308).  Saving model ...


batch 19, loss: 1.1258, instance_loss: 0.5406, weighted_loss: 0.9502, label: 1, bag_size: 64834
batch 39, loss: 1.1050, instance_loss: 0.5347, weighted_loss: 0.9339, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 20, train_loss: 1.0806, train_clustering_loss:  0.5674, train_error: 0.3878
class 0: acc 0.7777777777777778, correct 14/18
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.7142857142857143, correct 5/7
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.1981, val_error: 0.6364, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.223308 --> 1.198093).  Saving model ...


batch 19, loss: 0.8982, instance_loss: 0.5524, weighted_loss: 0.7944, label: 3, bag_size: 113328
batch 39, loss: 0.6324, instance_loss: 0.5191, weighted_loss: 0.5984, label: 3, bag_size: 262536


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 21, train_loss: 1.0995, train_clustering_loss:  0.5754, train_error: 0.4898
class 0: acc 0.2857142857142857, correct 4/14
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.5, correct 6/12
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.2141, val_error: 0.6364, auc: 0.7326
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1360, instance_loss: 0.5642, weighted_loss: 0.9644, label: 1, bag_size: 77634
batch 39, loss: 0.4340, instance_loss: 0.4620, weighted_loss: 0.4424, label: 2, bag_size: 59749


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 22, train_loss: 1.0696, train_clustering_loss:  0.5679, train_error: 0.3878
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.3, correct 3/10
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.1425, val_error: 0.6364, auc: 0.8090
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.198093 --> 1.142477).  Saving model ...


batch 19, loss: 1.6190, instance_loss: 0.6519, weighted_loss: 1.3288, label: 1, bag_size: 445537
batch 39, loss: 0.9539, instance_loss: 0.5403, weighted_loss: 0.8298, label: 2, bag_size: 278757


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 23, train_loss: 0.9818, train_clustering_loss:  0.5455, train_error: 0.3265
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.5714285714285714, correct 8/14
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.1724, val_error: 0.6364, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7110, instance_loss: 0.5159, weighted_loss: 0.6524, label: 3, bag_size: 113328
batch 39, loss: 1.0602, instance_loss: 0.5091, weighted_loss: 0.8948, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 24, train_loss: 1.0592, train_clustering_loss:  0.5612, train_error: 0.4898
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.1399, val_error: 0.6364, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.142477 --> 1.139869).  Saving model ...


batch 19, loss: 0.9824, instance_loss: 0.5365, weighted_loss: 0.8486, label: 2, bag_size: 149988
batch 39, loss: 0.8095, instance_loss: 0.5052, weighted_loss: 0.7182, label: 3, bag_size: 231301


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 25, train_loss: 0.8690, train_clustering_loss:  0.5296, train_error: 0.1837
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.625, correct 5/8
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 1.0, correct 18/18

Val Set, val_loss: 1.1223, val_error: 0.6364, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.139869 --> 1.122270).  Saving model ...


batch 19, loss: 1.1795, instance_loss: 0.5113, weighted_loss: 0.9790, label: 3, bag_size: 28883
batch 39, loss: 0.2224, instance_loss: 0.3823, weighted_loss: 0.2704, label: 3, bag_size: 189694


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 26, train_loss: 0.9925, train_clustering_loss:  0.5419, train_error: 0.4286
class 0: acc 0.2, correct 2/10
class 1: acc 0.6875, correct 11/16
class 2: acc 0.5, correct 5/10
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.1402, val_error: 0.6364, auc: 0.8021
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7139, instance_loss: 0.4656, weighted_loss: 0.6394, label: 1, bag_size: 57038
batch 39, loss: 1.3546, instance_loss: 0.5617, weighted_loss: 1.1168, label: 2, bag_size: 17501


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 27, train_loss: 0.9066, train_clustering_loss:  0.5148, train_error: 0.3673
class 0: acc 0.2, correct 2/10
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.8125, correct 13/16

Val Set, val_loss: 1.0972, val_error: 0.5455, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.122270 --> 1.097162).  Saving model ...


batch 19, loss: 0.4492, instance_loss: 0.3896, weighted_loss: 0.4313, label: 1, bag_size: 57038
batch 39, loss: 0.8372, instance_loss: 0.5270, weighted_loss: 0.7441, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 28, train_loss: 0.8555, train_clustering_loss:  0.5078, train_error: 0.2857
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.0586, val_error: 0.4545, auc: 0.8507
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.097162 --> 1.058574).  Saving model ...


batch 19, loss: 0.9300, instance_loss: 0.5588, weighted_loss: 0.8187, label: 0, bag_size: 108548
batch 39, loss: 0.2485, instance_loss: 0.3164, weighted_loss: 0.2689, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 29, train_loss: 0.8156, train_clustering_loss:  0.5078, train_error: 0.3469
class 0: acc 0.6470588235294118, correct 11/17
class 1: acc 0.2, correct 1/5
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.1232, val_error: 0.4545, auc: 0.8299
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0817, instance_loss: 0.5430, weighted_loss: 0.9201, label: 2, bag_size: 54449
batch 39, loss: 0.8185, instance_loss: 0.4869, weighted_loss: 0.7190, label: 2, bag_size: 176020


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 30, train_loss: 0.8558, train_clustering_loss:  0.5051, train_error: 0.3878
class 0: acc 0.625, correct 10/16
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.1270, val_error: 0.5455, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.6150, instance_loss: 0.4525, weighted_loss: 0.5663, label: 0, bag_size: 47775
batch 39, loss: 0.9500, instance_loss: 0.5143, weighted_loss: 0.8193, label: 0, bag_size: 22124


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.002551020408163265: correct 1/392
Epoch: 31, train_loss: 0.6689, train_clustering_loss:  0.4671, train_error: 0.2449
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.75, correct 6/8
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.1886, val_error: 0.5455, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5958, instance_loss: 0.4607, weighted_loss: 0.5553, label: 2, bag_size: 17501
batch 39, loss: 0.4272, instance_loss: 0.4091, weighted_loss: 0.4217, label: 2, bag_size: 525276


class 0 clustering acc 0.9968112244897959: correct 1563/1568
class 1 clustering acc 0.01020408163265306: correct 4/392
Epoch: 32, train_loss: 0.8536, train_clustering_loss:  0.4988, train_error: 0.4082
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.625, correct 10/16
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.0916, val_error: 0.5455, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7899, instance_loss: 0.5485, weighted_loss: 0.7175, label: 1, bag_size: 49894
batch 39, loss: 0.1890, instance_loss: 0.2822, weighted_loss: 0.2170, label: 3, bag_size: 240896


class 0 clustering acc 0.9980867346938775: correct 1565/1568
class 1 clustering acc 0.04081632653061224: correct 16/392
Epoch: 33, train_loss: 0.6540, train_clustering_loss:  0.4662, train_error: 0.2653
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.1628, val_error: 0.6364, auc: 0.7361
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.5230, instance_loss: 0.4318, weighted_loss: 0.4956, label: 1, bag_size: 18329
batch 39, loss: 0.8035, instance_loss: 0.5001, weighted_loss: 0.7125, label: 1, bag_size: 104549


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.02040816326530612: correct 8/392
Epoch: 34, train_loss: 0.7521, train_clustering_loss:  0.4801, train_error: 0.2857
class 0: acc 0.5, correct 6/12
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.6153846153846154, correct 8/13
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.3121, val_error: 0.5455, auc: 0.7396
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1939, instance_loss: 0.3581, weighted_loss: 0.2432, label: 3, bag_size: 240896
batch 39, loss: 1.1220, instance_loss: 0.5304, weighted_loss: 0.9445, label: 0, bag_size: 59141


class 0 clustering acc 0.9968112244897959: correct 1563/1568
class 1 clustering acc 0.007653061224489796: correct 3/392
Epoch: 35, train_loss: 0.7506, train_clustering_loss:  0.4780, train_error: 0.3673
class 0: acc 0.7, correct 14/20
class 1: acc 0.4, correct 4/10
class 2: acc 0.7, correct 7/10
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.1556, val_error: 0.6364, auc: 0.8160
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.1387, instance_loss: 0.2464, weighted_loss: 0.1710, label: 0, bag_size: 59350
batch 39, loss: 0.7448, instance_loss: 0.3900, weighted_loss: 0.6384, label: 3, bag_size: 56291


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.017857142857142856: correct 7/392
Epoch: 36, train_loss: 0.8204, train_clustering_loss:  0.4951, train_error: 0.4286
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.3076923076923077, correct 4/13
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.1098, val_error: 0.5455, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.8916, instance_loss: 0.6978, weighted_loss: 1.5334, label: 3, bag_size: 28883
batch 39, loss: 0.1566, instance_loss: 0.2672, weighted_loss: 0.1898, label: 3, bag_size: 262536


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.03571428571428571: correct 14/392
Epoch: 37, train_loss: 0.8100, train_clustering_loss:  0.4947, train_error: 0.3878
class 0: acc 0.1, correct 1/10
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.8, correct 8/10
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.0767, val_error: 0.5455, auc: 0.7812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.0235, instance_loss: 0.5240, weighted_loss: 0.8737, label: 0, bag_size: 59141
batch 39, loss: 0.8451, instance_loss: 0.5721, weighted_loss: 0.7632, label: 0, bag_size: 46742


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.02295918367346939: correct 9/392
Epoch: 38, train_loss: 0.6776, train_clustering_loss:  0.4637, train_error: 0.2449
class 0: acc 0.7777777777777778, correct 14/18
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.1282, val_error: 0.5455, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.8182, instance_loss: 0.6563, weighted_loss: 1.4696, label: 3, bag_size: 28883
batch 39, loss: 1.2125, instance_loss: 0.6494, weighted_loss: 1.0435, label: 0, bag_size: 222326


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.13010204081632654: correct 51/392
Epoch: 39, train_loss: 0.6292, train_clustering_loss:  0.4351, train_error: 0.2449
class 0: acc 0.5, correct 4/8
class 1: acc 0.9, correct 9/10
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.1897, val_error: 0.4545, auc: 0.7569
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.2687, instance_loss: 0.3247, weighted_loss: 0.2855, label: 3, bag_size: 99257
batch 39, loss: 0.1116, instance_loss: 0.2976, weighted_loss: 0.1674, label: 0, bag_size: 453871


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.08928571428571429: correct 35/392
Epoch: 40, train_loss: 0.5293, train_clustering_loss:  0.4315, train_error: 0.1429
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.9, correct 9/10
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.1323, val_error: 0.6364, auc: 0.7778
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.2389, instance_loss: 0.2822, weighted_loss: 0.2519, label: 3, bag_size: 56291
batch 39, loss: 0.3129, instance_loss: 0.4688, weighted_loss: 0.3597, label: 3, bag_size: 16626


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.09948979591836735: correct 39/392
Epoch: 41, train_loss: 0.5025, train_clustering_loss:  0.4166, train_error: 0.1633
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.75, correct 9/12
class 3: acc 0.8666666666666667, correct 13/15

Val Set, val_loss: 1.1036, val_error: 0.5455, auc: 0.7951
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.5386, instance_loss: 0.4946, weighted_loss: 0.5254, label: 0, bag_size: 18551
batch 39, loss: 0.7804, instance_loss: 0.4575, weighted_loss: 0.6835, label: 1, bag_size: 49894


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.14030612244897958: correct 55/392
Epoch: 42, train_loss: 0.6632, train_clustering_loss:  0.4322, train_error: 0.2245
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.0675, val_error: 0.5455, auc: 0.8194
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1210, instance_loss: 0.1728, weighted_loss: 0.1365, label: 2, bag_size: 59749
batch 39, loss: 0.1914, instance_loss: 0.3159, weighted_loss: 0.2287, label: 0, bag_size: 453871


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.1556122448979592: correct 61/392
Epoch: 43, train_loss: 0.5758, train_clustering_loss:  0.4270, train_error: 0.2449
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.8125, correct 13/16
class 2: acc 0.75, correct 9/12
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.0817, val_error: 0.4545, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.4178, instance_loss: 0.3637, weighted_loss: 0.4016, label: 1, bag_size: 69073
batch 39, loss: 0.3465, instance_loss: 0.5431, weighted_loss: 0.4055, label: 1, bag_size: 104549


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.17346938775510204: correct 68/392
Epoch: 44, train_loss: 0.4291, train_clustering_loss:  0.3900, train_error: 0.0612
class 0: acc 0.8, correct 8/10
class 1: acc 1.0, correct 14/14
class 2: acc 0.9411764705882353, correct 16/17
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.1490, val_error: 0.5455, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1335, instance_loss: 0.2460, weighted_loss: 0.1673, label: 0, bag_size: 453871
batch 39, loss: 0.1345, instance_loss: 0.2514, weighted_loss: 0.1696, label: 0, bag_size: 453871


class 0 clustering acc 0.9834183673469388: correct 1542/1568
class 1 clustering acc 0.19387755102040816: correct 76/392
Epoch: 45, train_loss: 0.6744, train_clustering_loss:  0.4428, train_error: 0.3265
class 0: acc 0.38461538461538464, correct 5/13
class 1: acc 0.8125, correct 13/16
class 2: acc 0.875, correct 7/8
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.1723, val_error: 0.5455, auc: 0.7882
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1780, instance_loss: 0.4420, weighted_loss: 0.2572, label: 0, bag_size: 10671
batch 39, loss: 0.1652, instance_loss: 0.4439, weighted_loss: 0.2488, label: 1, bag_size: 104549


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.19387755102040816: correct 76/392
Epoch: 46, train_loss: 0.4827, train_clustering_loss:  0.4024, train_error: 0.1633
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.625, correct 5/8
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.2127, val_error: 0.4545, auc: 0.7535
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.4539, instance_loss: 0.3405, weighted_loss: 0.4199, label: 1, bag_size: 20030
batch 39, loss: 0.7136, instance_loss: 0.4975, weighted_loss: 0.6487, label: 0, bag_size: 13999


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.2755102040816326: correct 108/392
Epoch: 47, train_loss: 0.5003, train_clustering_loss:  0.3853, train_error: 0.2041
class 0: acc 0.8, correct 8/10
class 1: acc 0.7, correct 7/10
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.9444444444444444, correct 17/18

Val Set, val_loss: 1.3334, val_error: 0.4545, auc: 0.7222
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.3466, instance_loss: 0.3282, weighted_loss: 0.3410, label: 1, bag_size: 20030
batch 39, loss: 0.3729, instance_loss: 0.3771, weighted_loss: 0.3742, label: 2, bag_size: 149988


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.22448979591836735: correct 88/392
Epoch: 48, train_loss: 0.4809, train_clustering_loss:  0.3892, train_error: 0.1224
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 1.0, correct 16/16
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.2935, val_error: 0.5455, auc: 0.7639
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 1.9767, instance_loss: 0.8093, weighted_loss: 1.6265, label: 2, bag_size: 54449
batch 39, loss: 0.1671, instance_loss: 0.2645, weighted_loss: 0.1963, label: 0, bag_size: 47775


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.3673469387755102: correct 144/392
Epoch: 49, train_loss: 0.4280, train_clustering_loss:  0.3749, train_error: 0.1020
class 0: acc 0.9545454545454546, correct 21/22
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.875, correct 7/8
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.3725, val_error: 0.5455, auc: 0.7222
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.0398, instance_loss: 0.5180, weighted_loss: 0.8832, label: 0, bag_size: 108548
batch 39, loss: 0.9417, instance_loss: 0.5533, weighted_loss: 0.8251, label: 2, bag_size: 22130


class 0 clustering acc 0.9955357142857143: correct 1561/1568
class 1 clustering acc 0.29846938775510207: correct 117/392
Epoch: 50, train_loss: 0.4419, train_clustering_loss:  0.3741, train_error: 0.1633
class 0: acc 0.8125, correct 13/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.75, correct 6/8
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.4124, val_error: 0.4545, auc: 0.7118
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.2463, instance_loss: 0.3507, weighted_loss: 0.2776, label: 3, bag_size: 22057
batch 39, loss: 0.2286, instance_loss: 0.3110, weighted_loss: 0.2533, label: 3, bag_size: 22057


class 0 clustering acc 0.9904336734693877: correct 1553/1568
class 1 clustering acc 0.1989795918367347: correct 78/392
Epoch: 51, train_loss: 0.5158, train_clustering_loss:  0.4200, train_error: 0.1837
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.9, correct 9/10
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.3222, val_error: 0.5455, auc: 0.7431
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 23 out of 20
Early stopping
Val error: 0.4545, ROC AUC: 0.8507
Test error: 0.5455, ROC AUC: 0.7604
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3

Training Fold 8!

Init train/val/test splits... 
Done!
Training on 49 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.8513, instance_loss: 0.9923, weighted_loss: 0.8936, label: 3, bag_size: 48489
batch 39, loss: 2.0067, instance_loss: 0.9342, weighted_loss: 1.6850, label: 1, bag_size: 58270


class 0 clustering acc 0.9272959183673469: correct 1454/1568
class 1 clustering acc 0.10204081632653061: correct 40/392
Epoch: 0, train_loss: 1.3797, train_clustering_loss:  1.0099, train_error: 0.5918
class 0: acc 0.0, correct 0/12
class 1: acc 0.0, correct 0/7
class 2: acc 0.0, correct 0/10
class 3: acc 1.0, correct 20/20

Val Set, val_loss: 1.4260, val_error: 0.7273, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.426030).  Saving model ...


batch 19, loss: 1.7807, instance_loss: 0.7626, weighted_loss: 1.4752, label: 1, bag_size: 57038
batch 39, loss: 1.3984, instance_loss: 0.7177, weighted_loss: 1.1942, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 1, train_loss: 1.4077, train_clustering_loss:  0.7128, train_error: 0.6735
class 0: acc 0.0, correct 0/10
class 1: acc 0.125, correct 2/16
class 2: acc 0.0, correct 0/9
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.3782, val_error: 0.7273, auc: 0.5278
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.426030 --> 1.378172).  Saving model ...


batch 19, loss: 1.6873, instance_loss: 0.6607, weighted_loss: 1.3793, label: 2, bag_size: 278757
batch 39, loss: 1.7138, instance_loss: 0.6201, weighted_loss: 1.3857, label: 3, bag_size: 4963


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 2, train_loss: 1.4204, train_clustering_loss:  0.6387, train_error: 0.7959
class 0: acc 0.0, correct 0/13
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.35294117647058826, correct 6/17
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.4336, val_error: 0.8182, auc: 0.5278
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6812, instance_loss: 0.6167, weighted_loss: 1.3618, label: 3, bag_size: 231301
batch 39, loss: 1.4433, instance_loss: 0.6096, weighted_loss: 1.1932, label: 0, bag_size: 46742


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 3, train_loss: 1.3750, train_clustering_loss:  0.6142, train_error: 0.7551
class 0: acc 0.07142857142857142, correct 1/14
class 1: acc 0.0, correct 0/8
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.07142857142857142, correct 1/14

Val Set, val_loss: 1.4002, val_error: 0.7273, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.7984, instance_loss: 0.6701, weighted_loss: 1.4599, label: 1, bag_size: 58270
batch 39, loss: 1.4861, instance_loss: 0.6197, weighted_loss: 1.2261, label: 2, bag_size: 163352


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 4, train_loss: 1.4149, train_clustering_loss:  0.6174, train_error: 0.7347
class 0: acc 0.1, correct 1/10
class 1: acc 0.125, correct 2/16
class 2: acc 0.36363636363636365, correct 4/11
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.3864, val_error: 0.7273, auc: 0.5729
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2421, instance_loss: 0.6124, weighted_loss: 1.0532, label: 1, bag_size: 66789
batch 39, loss: 1.5953, instance_loss: 0.6342, weighted_loss: 1.3070, label: 2, bag_size: 209612


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 5, train_loss: 1.3697, train_clustering_loss:  0.6099, train_error: 0.7551
class 0: acc 0.3333333333333333, correct 5/15
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.0, correct 0/8
class 3: acc 0.0, correct 0/14

Val Set, val_loss: 1.3706, val_error: 0.7273, auc: 0.5694
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.378172 --> 1.370630).  Saving model ...


batch 19, loss: 1.1291, instance_loss: 0.6321, weighted_loss: 0.9800, label: 3, bag_size: 152150
batch 39, loss: 1.1718, instance_loss: 0.6017, weighted_loss: 1.0008, label: 0, bag_size: 19277


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 6, train_loss: 1.3106, train_clustering_loss:  0.6145, train_error: 0.5510
class 0: acc 0.9375, correct 15/16
class 1: acc 0.0, correct 0/8
class 2: acc 0.0, correct 0/11
class 3: acc 0.5, correct 7/14

Val Set, val_loss: 1.3849, val_error: 0.9091, auc: 0.6007
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.8207, instance_loss: 0.6644, weighted_loss: 1.4738, label: 2, bag_size: 59749
batch 39, loss: 0.9295, instance_loss: 0.5583, weighted_loss: 0.8181, label: 3, bag_size: 240896


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 7, train_loss: 1.2926, train_clustering_loss:  0.6174, train_error: 0.5510
class 0: acc 0.75, correct 12/16
class 1: acc 0.0, correct 0/9
class 2: acc 0.0, correct 0/8
class 3: acc 0.625, correct 10/16

Val Set, val_loss: 1.3951, val_error: 0.7273, auc: 0.6389
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4821, instance_loss: 0.6599, weighted_loss: 1.2355, label: 1, bag_size: 57038
batch 39, loss: 1.1109, instance_loss: 0.5900, weighted_loss: 0.9547, label: 3, bag_size: 4963


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 8, train_loss: 1.3046, train_clustering_loss:  0.6189, train_error: 0.5510
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.09090909090909091, correct 1/11
class 2: acc 0.0, correct 0/13
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.3794, val_error: 0.7273, auc: 0.5903
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3699, instance_loss: 0.6452, weighted_loss: 1.1525, label: 2, bag_size: 209612
batch 39, loss: 1.0496, instance_loss: 0.6073, weighted_loss: 0.9169, label: 1, bag_size: 69073


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 9, train_loss: 1.3092, train_clustering_loss:  0.6097, train_error: 0.6735
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.2857142857142857, correct 4/14
class 2: acc 0.0, correct 0/11
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.3749, val_error: 0.7273, auc: 0.5417
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.3720, instance_loss: 0.5900, weighted_loss: 1.1374, label: 1, bag_size: 57038
batch 39, loss: 1.7818, instance_loss: 0.6647, weighted_loss: 1.4467, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 10, train_loss: 1.2376, train_clustering_loss:  0.5994, train_error: 0.4490
class 0: acc 0.0, correct 0/7
class 1: acc 0.6875, correct 11/16
class 2: acc 0.375, correct 3/8
class 3: acc 0.7222222222222222, correct 13/18

Val Set, val_loss: 1.4071, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.2218, instance_loss: 0.6168, weighted_loss: 1.0403, label: 1, bag_size: 81420
batch 39, loss: 1.5053, instance_loss: 0.6012, weighted_loss: 1.2340, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 11, train_loss: 1.3241, train_clustering_loss:  0.6124, train_error: 0.7143
class 0: acc 0.07692307692307693, correct 1/13
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.07692307692307693, correct 1/13
class 3: acc 0.36363636363636365, correct 4/11

Val Set, val_loss: 1.3445, val_error: 0.4545, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.370630 --> 1.344507).  Saving model ...


batch 19, loss: 1.0478, instance_loss: 0.6243, weighted_loss: 0.9207, label: 0, bag_size: 41829
batch 39, loss: 1.1556, instance_loss: 0.6175, weighted_loss: 0.9942, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 12, train_loss: 1.2491, train_clustering_loss:  0.6064, train_error: 0.6122
class 0: acc 0.35714285714285715, correct 5/14
class 1: acc 0.23076923076923078, correct 3/13
class 2: acc 0.6875, correct 11/16
class 3: acc 0.0, correct 0/6

Val Set, val_loss: 1.4089, val_error: 0.6364, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1687, instance_loss: 0.5937, weighted_loss: 0.9962, label: 2, bag_size: 209612
batch 39, loss: 1.2992, instance_loss: 0.5749, weighted_loss: 1.0819, label: 2, bag_size: 59749


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 13, train_loss: 1.2319, train_clustering_loss:  0.5945, train_error: 0.5714
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.09090909090909091, correct 1/11
class 2: acc 0.46153846153846156, correct 6/13
class 3: acc 0.5, correct 8/16

Val Set, val_loss: 1.3501, val_error: 0.8182, auc: 0.6076
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.7248, instance_loss: 0.6172, weighted_loss: 1.3925, label: 0, bag_size: 19277
batch 39, loss: 1.8933, instance_loss: 0.6301, weighted_loss: 1.5143, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 14, train_loss: 1.1339, train_clustering_loss:  0.5770, train_error: 0.4286
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.3696, val_error: 0.6364, auc: 0.5903
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5622, instance_loss: 0.4845, weighted_loss: 0.5389, label: 3, bag_size: 99257
batch 39, loss: 0.6458, instance_loss: 0.5497, weighted_loss: 0.6170, label: 3, bag_size: 152150


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 15, train_loss: 1.1497, train_clustering_loss:  0.5868, train_error: 0.5102
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.5, correct 6/12
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.7894736842105263, correct 15/19

Val Set, val_loss: 1.4444, val_error: 0.7273, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.1749, instance_loss: 0.5238, weighted_loss: 0.9796, label: 2, bag_size: 278757
batch 39, loss: 1.0360, instance_loss: 0.5049, weighted_loss: 0.8766, label: 2, bag_size: 278757


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 16, train_loss: 1.1180, train_clustering_loss:  0.5899, train_error: 0.4286
class 0: acc 0.6470588235294118, correct 11/17
class 1: acc 0.1, correct 1/10
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.3835, val_error: 0.7273, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.9447, instance_loss: 0.5190, weighted_loss: 0.8170, label: 1, bag_size: 69073
batch 39, loss: 1.1011, instance_loss: 0.6293, weighted_loss: 0.9596, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 17, train_loss: 1.0291, train_clustering_loss:  0.5575, train_error: 0.3673
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.75, correct 9/12
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.3328, val_error: 0.7273, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.344507 --> 1.332801).  Saving model ...


batch 19, loss: 0.5126, instance_loss: 0.4736, weighted_loss: 0.5009, label: 1, bag_size: 20030
batch 39, loss: 1.2856, instance_loss: 0.6788, weighted_loss: 1.1036, label: 2, bag_size: 158432


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 18, train_loss: 1.0717, train_clustering_loss:  0.5599, train_error: 0.4082
class 0: acc 0.25, correct 3/12
class 1: acc 0.75, correct 12/16
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.3094, val_error: 0.7273, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.332801 --> 1.309384).  Saving model ...


batch 19, loss: 0.5497, instance_loss: 0.4698, weighted_loss: 0.5257, label: 1, bag_size: 20030
batch 39, loss: 1.5427, instance_loss: 0.6785, weighted_loss: 1.2834, label: 0, bag_size: 222326


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 19, train_loss: 1.0110, train_clustering_loss:  0.5549, train_error: 0.4082
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.5882352941176471, correct 10/17
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.4142, val_error: 0.7273, auc: 0.5868
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8032, instance_loss: 0.4873, weighted_loss: 0.7084, label: 1, bag_size: 57038
batch 39, loss: 1.3403, instance_loss: 0.6410, weighted_loss: 1.1305, label: 1, bag_size: 104549


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 20, train_loss: 0.9570, train_clustering_loss:  0.5494, train_error: 0.3673
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.5294117647058824, correct 9/17
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.3780, val_error: 0.6364, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9197, instance_loss: 0.5724, weighted_loss: 0.8156, label: 3, bag_size: 56291
batch 39, loss: 0.6625, instance_loss: 0.4959, weighted_loss: 0.6125, label: 0, bag_size: 453871


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 21, train_loss: 0.9835, train_clustering_loss:  0.5464, train_error: 0.4082
class 0: acc 0.35294117647058826, correct 6/17
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.3045, val_error: 0.7273, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.309384 --> 1.304513).  Saving model ...


batch 19, loss: 0.9940, instance_loss: 0.5118, weighted_loss: 0.8494, label: 1, bag_size: 77634
batch 39, loss: 0.3706, instance_loss: 0.4331, weighted_loss: 0.3893, label: 2, bag_size: 59749


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 22, train_loss: 0.8680, train_clustering_loss:  0.5185, train_error: 0.3265
class 0: acc 0.75, correct 12/16
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.75, correct 12/16
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.4741, val_error: 0.6364, auc: 0.5764
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.0707, instance_loss: 0.7459, weighted_loss: 1.6733, label: 1, bag_size: 445537
batch 39, loss: 0.5043, instance_loss: 0.3046, weighted_loss: 0.4444, label: 2, bag_size: 176020


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.030612244897959183: correct 12/392
Epoch: 23, train_loss: 0.8571, train_clustering_loss:  0.4984, train_error: 0.3673
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.0, correct 0/8
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.4560, val_error: 0.6364, auc: 0.6111
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0018, instance_loss: 0.6144, weighted_loss: 0.8856, label: 3, bag_size: 56291
batch 39, loss: 0.4071, instance_loss: 0.3973, weighted_loss: 0.4041, label: 0, bag_size: 43538


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.05357142857142857: correct 21/392
Epoch: 24, train_loss: 0.8681, train_clustering_loss:  0.5110, train_error: 0.3265
class 0: acc 0.75, correct 9/12
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.3331, val_error: 0.6364, auc: 0.6493
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5025, instance_loss: 0.2683, weighted_loss: 0.4322, label: 2, bag_size: 278757
batch 39, loss: 0.7205, instance_loss: 0.6377, weighted_loss: 0.6957, label: 3, bag_size: 231301


class 0 clustering acc 0.9980867346938775: correct 1565/1568
class 1 clustering acc 0.058673469387755105: correct 23/392
Epoch: 25, train_loss: 0.8689, train_clustering_loss:  0.4989, train_error: 0.3878
class 0: acc 0.4666666666666667, correct 7/15
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.4740, val_error: 0.7273, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3058, instance_loss: 0.4769, weighted_loss: 0.3571, label: 3, bag_size: 28883
batch 39, loss: 1.3763, instance_loss: 0.6249, weighted_loss: 1.1509, label: 1, bag_size: 445537


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.02040816326530612: correct 8/392
Epoch: 26, train_loss: 0.7735, train_clustering_loss:  0.4891, train_error: 0.3265
class 0: acc 0.4, correct 4/10
class 1: acc 0.6, correct 9/15
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.7632, val_error: 0.7273, auc: 0.4444
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.1550, instance_loss: 0.2940, weighted_loss: 0.1967, label: 3, bag_size: 99257
batch 39, loss: 0.2262, instance_loss: 0.3515, weighted_loss: 0.2638, label: 3, bag_size: 28883


class 0 clustering acc 0.9929846938775511: correct 1557/1568
class 1 clustering acc 0.11989795918367346: correct 47/392
Epoch: 27, train_loss: 0.6352, train_clustering_loss:  0.4442, train_error: 0.2449
class 0: acc 0.2, correct 2/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 1.0, correct 13/13
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.3903, val_error: 0.7273, auc: 0.5868
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.4106, instance_loss: 0.3160, weighted_loss: 0.3822, label: 3, bag_size: 99257
batch 39, loss: 0.1987, instance_loss: 0.3344, weighted_loss: 0.2394, label: 3, bag_size: 48489


class 0 clustering acc 0.9987244897959183: correct 1566/1568
class 1 clustering acc 0.06377551020408163: correct 25/392
Epoch: 28, train_loss: 0.8626, train_clustering_loss:  0.4796, train_error: 0.3265
class 0: acc 0.5, correct 5/10
class 1: acc 0.5, correct 4/8
class 2: acc 0.6153846153846154, correct 8/13
class 3: acc 0.8888888888888888, correct 16/18

Val Set, val_loss: 1.7969, val_error: 0.8182, auc: 0.4375
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.1815, instance_loss: 0.4002, weighted_loss: 0.2471, label: 0, bag_size: 41829
batch 39, loss: 0.3620, instance_loss: 0.3127, weighted_loss: 0.3472, label: 2, bag_size: 209612


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.1989795918367347: correct 78/392
Epoch: 29, train_loss: 0.4987, train_clustering_loss:  0.3966, train_error: 0.1224
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.4467, val_error: 0.7273, auc: 0.6181
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 2.2044, instance_loss: 0.7256, weighted_loss: 1.7608, label: 2, bag_size: 54449
batch 39, loss: 0.5843, instance_loss: 0.5379, weighted_loss: 0.5704, label: 3, bag_size: 196107


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.16071428571428573: correct 63/392
Epoch: 30, train_loss: 0.8491, train_clustering_loss:  0.4856, train_error: 0.3469
class 0: acc 0.5, correct 5/10
class 1: acc 0.625, correct 10/16
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.6147, val_error: 0.8182, auc: 0.5243
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.3285, instance_loss: 0.2150, weighted_loss: 0.2944, label: 2, bag_size: 113492
batch 39, loss: 1.1247, instance_loss: 0.6271, weighted_loss: 0.9754, label: 0, bag_size: 19277


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.10204081632653061: correct 40/392
Epoch: 31, train_loss: 0.5960, train_clustering_loss:  0.4374, train_error: 0.2041
class 0: acc 0.5384615384615384, correct 7/13
class 1: acc 0.8235294117647058, correct 14/17
class 2: acc 0.6666666666666666, correct 2/3
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.5207, val_error: 0.7273, auc: 0.5521
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.1795, instance_loss: 0.3457, weighted_loss: 0.2294, label: 3, bag_size: 28883
batch 39, loss: 0.1130, instance_loss: 0.1434, weighted_loss: 0.1221, label: 2, bag_size: 393657


class 0 clustering acc 0.9917091836734694: correct 1555/1568
class 1 clustering acc 0.13520408163265307: correct 53/392
Epoch: 32, train_loss: 0.8070, train_clustering_loss:  0.4602, train_error: 0.3265
class 0: acc 0.3, correct 3/10
class 1: acc 0.6, correct 6/10
class 2: acc 0.6875, correct 11/16
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.5976, val_error: 0.9091, auc: 0.5451
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.4313, instance_loss: 0.3093, weighted_loss: 0.3947, label: 1, bag_size: 49894
batch 39, loss: 0.1781, instance_loss: 0.2291, weighted_loss: 0.1934, label: 3, bag_size: 240896


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.2372448979591837: correct 93/392
Epoch: 33, train_loss: 0.5782, train_clustering_loss:  0.4063, train_error: 0.2857
class 0: acc 0.0, correct 0/10
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.8, correct 8/10
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.8129, val_error: 0.9091, auc: 0.4653
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 2.5417, instance_loss: 1.0119, weighted_loss: 2.0828, label: 1, bag_size: 104549
batch 39, loss: 0.4443, instance_loss: 0.3029, weighted_loss: 0.4019, label: 1, bag_size: 57038


class 0 clustering acc 0.985969387755102: correct 1546/1568
class 1 clustering acc 0.22193877551020408: correct 87/392
Epoch: 34, train_loss: 0.6925, train_clustering_loss:  0.4395, train_error: 0.3061
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 0.8125, correct 13/16
class 2: acc 0.75, correct 9/12
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.7081, val_error: 0.9091, auc: 0.5278
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.2748, instance_loss: 0.2802, weighted_loss: 0.2765, label: 3, bag_size: 240896
batch 39, loss: 1.2794, instance_loss: 0.6401, weighted_loss: 1.0876, label: 0, bag_size: 13999


class 0 clustering acc 0.9929846938775511: correct 1557/1568
class 1 clustering acc 0.3673469387755102: correct 144/392
Epoch: 35, train_loss: 0.4987, train_clustering_loss:  0.3499, train_error: 0.1429
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8, correct 8/10
class 2: acc 0.9523809523809523, correct 20/21
class 3: acc 0.8571428571428571, correct 6/7

Val Set, val_loss: 1.6818, val_error: 0.8182, auc: 0.5347
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.2665, instance_loss: 0.3635, weighted_loss: 0.2956, label: 0, bag_size: 59350
batch 39, loss: 1.5789, instance_loss: 0.6832, weighted_loss: 1.3102, label: 2, bag_size: 103108


class 0 clustering acc 0.9955357142857143: correct 1561/1568
class 1 clustering acc 0.15816326530612246: correct 62/392
Epoch: 36, train_loss: 0.8196, train_clustering_loss:  0.4613, train_error: 0.3673
class 0: acc 0.5, correct 7/14
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.7554, val_error: 0.6364, auc: 0.5799
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.1888, instance_loss: 0.3278, weighted_loss: 0.2305, label: 3, bag_size: 28883
batch 39, loss: 0.3679, instance_loss: 0.4421, weighted_loss: 0.3901, label: 0, bag_size: 453871


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.15051020408163265: correct 59/392
Epoch: 37, train_loss: 0.6936, train_clustering_loss:  0.4372, train_error: 0.2449
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.7, correct 7/10
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.7653, val_error: 0.7273, auc: 0.5035
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.3312, instance_loss: 0.6543, weighted_loss: 1.1281, label: 0, bag_size: 59141
batch 39, loss: 0.0667, instance_loss: 0.1365, weighted_loss: 0.0877, label: 2, bag_size: 158432


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.28316326530612246: correct 111/392
Epoch: 38, train_loss: 0.7404, train_clustering_loss:  0.4201, train_error: 0.3469
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.7647058823529411, correct 13/17
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.7214, val_error: 0.8182, auc: 0.5833
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.6816, instance_loss: 0.5850, weighted_loss: 0.6527, label: 0, bag_size: 222491
batch 39, loss: 0.1332, instance_loss: 0.1152, weighted_loss: 0.1278, label: 2, bag_size: 525276


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.11479591836734694: correct 45/392
Epoch: 39, train_loss: 0.7659, train_clustering_loss:  0.4629, train_error: 0.1837
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.8, correct 8/10
class 2: acc 0.5, correct 5/10
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.5656, val_error: 0.8182, auc: 0.6181
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.8193, instance_loss: 0.6783, weighted_loss: 1.4770, label: 2, bag_size: 103108
batch 39, loss: 0.5931, instance_loss: 0.5202, weighted_loss: 0.5712, label: 0, bag_size: 222326


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.2372448979591837: correct 93/392
Epoch: 40, train_loss: 0.6288, train_clustering_loss:  0.4106, train_error: 0.2653
class 0: acc 0.5, correct 6/12
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.8291, val_error: 0.8182, auc: 0.5104
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.1185, instance_loss: 0.1311, weighted_loss: 0.1222, label: 2, bag_size: 209612
batch 39, loss: 0.2922, instance_loss: 0.4106, weighted_loss: 0.3277, label: 3, bag_size: 4963


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.3112244897959184: correct 122/392
Epoch: 41, train_loss: 0.5708, train_clustering_loss:  0.3814, train_error: 0.2041
class 0: acc 0.16666666666666666, correct 1/6
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 1.8895, val_error: 0.8182, auc: 0.5000
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.4612, instance_loss: 0.2596, weighted_loss: 0.4007, label: 1, bag_size: 81420
batch 39, loss: 1.0333, instance_loss: 0.6905, weighted_loss: 0.9305, label: 0, bag_size: 6353


class 0 clustering acc 0.9878826530612245: correct 1549/1568
class 1 clustering acc 0.3520408163265306: correct 138/392
Epoch: 42, train_loss: 0.6622, train_clustering_loss:  0.4071, train_error: 0.2245
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 1.0, correct 11/11
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.9116, val_error: 0.7273, auc: 0.5556
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.5987, instance_loss: 0.4241, weighted_loss: 0.5464, label: 2, bag_size: 59749
batch 39, loss: 0.9155, instance_loss: 0.6416, weighted_loss: 0.8333, label: 0, bag_size: 222326


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.39540816326530615: correct 155/392
Epoch: 43, train_loss: 0.6701, train_clustering_loss:  0.3847, train_error: 0.2857
class 0: acc 0.2222222222222222, correct 2/9
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.5999, val_error: 0.8182, auc: 0.5799
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.7809, instance_loss: 0.3827, weighted_loss: 0.6614, label: 1, bag_size: 18329
batch 39, loss: 0.3126, instance_loss: 0.2522, weighted_loss: 0.2945, label: 1, bag_size: 57038


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.461734693877551: correct 181/392
Epoch: 44, train_loss: 0.4366, train_clustering_loss:  0.3309, train_error: 0.1224
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.7973, val_error: 0.9091, auc: 0.5208
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.5055, instance_loss: 0.5762, weighted_loss: 0.5267, label: 0, bag_size: 222326
batch 39, loss: 0.3265, instance_loss: 0.5141, weighted_loss: 0.3828, label: 0, bag_size: 222326


class 0 clustering acc 0.9795918367346939: correct 1536/1568
class 1 clustering acc 0.3596938775510204: correct 141/392
Epoch: 45, train_loss: 0.6833, train_clustering_loss:  0.4272, train_error: 0.3061
class 0: acc 0.5, correct 9/18
class 1: acc 0.75, correct 9/12
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.7007, val_error: 0.7273, auc: 0.5556
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.4278, instance_loss: 0.3045, weighted_loss: 0.3908, label: 1, bag_size: 69073
batch 39, loss: 0.4141, instance_loss: 0.3055, weighted_loss: 0.3815, label: 1, bag_size: 57038


class 0 clustering acc 0.9872448979591837: correct 1548/1568
class 1 clustering acc 0.18112244897959184: correct 71/392
Epoch: 46, train_loss: 0.6721, train_clustering_loss:  0.4312, train_error: 0.2449
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.5, correct 6/12
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.8222, val_error: 0.6364, auc: 0.5799
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.2248, instance_loss: 0.2374, weighted_loss: 0.2286, label: 1, bag_size: 20030
batch 39, loss: 1.0063, instance_loss: 0.5574, weighted_loss: 0.8716, label: 2, bag_size: 59749


class 0 clustering acc 0.9872448979591837: correct 1548/1568
class 1 clustering acc 0.29846938775510207: correct 117/392
Epoch: 47, train_loss: 0.5607, train_clustering_loss:  0.3882, train_error: 0.2653
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.7950, val_error: 0.8182, auc: 0.5278
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.3052, instance_loss: 0.2440, weighted_loss: 0.2868, label: 1, bag_size: 20030
batch 39, loss: 0.0951, instance_loss: 0.0740, weighted_loss: 0.0888, label: 2, bag_size: 278757


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.35714285714285715: correct 140/392
Epoch: 48, train_loss: 0.5170, train_clustering_loss:  0.3637, train_error: 0.2041
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.875, correct 14/16
class 2: acc 0.75, correct 9/12
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 2.1988, val_error: 0.7273, auc: 0.5208
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 2.1020, instance_loss: 0.8039, weighted_loss: 1.7126, label: 2, bag_size: 54449
batch 39, loss: 0.1028, instance_loss: 0.0611, weighted_loss: 0.0903, label: 2, bag_size: 113492


class 0 clustering acc 0.9872448979591837: correct 1548/1568
class 1 clustering acc 0.3239795918367347: correct 127/392
Epoch: 49, train_loss: 0.5292, train_clustering_loss:  0.3717, train_error: 0.2449
class 0: acc 0.6470588235294118, correct 11/17
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.9, correct 9/10
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 2.0186, val_error: 0.9091, auc: 0.5104
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.7187, instance_loss: 0.5576, weighted_loss: 0.6703, label: 0, bag_size: 41829
batch 39, loss: 0.1446, instance_loss: 0.2342, weighted_loss: 0.1715, label: 2, bag_size: 163352


class 0 clustering acc 0.9904336734693877: correct 1553/1568
class 1 clustering acc 0.461734693877551: correct 181/392
Epoch: 50, train_loss: 0.4337, train_clustering_loss:  0.3384, train_error: 0.1837
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.875, correct 14/16
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.8, correct 4/5

Val Set, val_loss: 1.8779, val_error: 0.9091, auc: 0.5208
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0455, instance_loss: 0.0385, weighted_loss: 0.0434, label: 2, bag_size: 113492
batch 39, loss: 0.1859, instance_loss: 0.3111, weighted_loss: 0.2234, label: 3, bag_size: 152150


class 0 clustering acc 0.9872448979591837: correct 1548/1568
class 1 clustering acc 0.4005102040816326: correct 157/392
Epoch: 51, train_loss: 0.4497, train_clustering_loss:  0.3354, train_error: 0.1020
class 0: acc 0.75, correct 6/8
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.9375, correct 15/16
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 2.0238, val_error: 0.7273, auc: 0.5243
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20
Early stopping
Val error: 0.7273, ROC AUC: 0.6250
Test error: 0.4545, ROC AUC: 0.7674
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3

Training Fold 9!

Init train/val/test splits... 
Done!
Training on 49 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7707, instance_loss: 1.0756, weighted_loss: 1.5622, label: 0, bag_size: 108548
batch 39, loss: 1.8997, instance_loss: 0.9408, weighted_loss: 1.6121, label: 1, bag_size: 18329


class 0 clustering acc 0.9228316326530612: correct 1447/1568
class 1 clustering acc 0.14030612244897958: correct 55/392
Epoch: 0, train_loss: 1.3958, train_clustering_loss:  1.0211, train_error: 0.6327
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/8
class 2: acc 0.0, correct 0/13
class 3: acc 1.0, correct 18/18

Val Set, val_loss: 1.4355, val_error: 0.7273, auc: 0.3819
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.435470).  Saving model ...


batch 19, loss: 1.7484, instance_loss: 0.7410, weighted_loss: 1.4461, label: 1, bag_size: 58270
batch 39, loss: 1.8196, instance_loss: 0.7103, weighted_loss: 1.4868, label: 1, bag_size: 66789


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 1, train_loss: 1.3966, train_clustering_loss:  0.7025, train_error: 0.6735
class 0: acc 0.0, correct 0/12
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/9
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.3937, val_error: 0.7273, auc: 0.4861
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.435470 --> 1.393749).  Saving model ...


batch 19, loss: 1.5850, instance_loss: 0.6211, weighted_loss: 1.2958, label: 3, bag_size: 40869
batch 39, loss: 0.9678, instance_loss: 0.5879, weighted_loss: 0.8538, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 2, train_loss: 1.4394, train_clustering_loss:  0.6414, train_error: 0.8163
class 0: acc 0.07692307692307693, correct 1/13
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.375, correct 6/16
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4226, val_error: 0.8182, auc: 0.5833
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6051, instance_loss: 0.6556, weighted_loss: 1.3202, label: 3, bag_size: 196107
batch 39, loss: 1.3708, instance_loss: 0.6013, weighted_loss: 1.1399, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 3, train_loss: 1.3742, train_clustering_loss:  0.6224, train_error: 0.7347
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.0, correct 0/10
class 2: acc 0.3333333333333333, correct 5/15
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.4065, val_error: 0.8182, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6224, instance_loss: 0.6348, weighted_loss: 1.3261, label: 1, bag_size: 66789
batch 39, loss: 1.1383, instance_loss: 0.5766, weighted_loss: 0.9698, label: 2, bag_size: 149988


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 4, train_loss: 1.3604, train_clustering_loss:  0.6254, train_error: 0.6122
class 0: acc 0.0, correct 0/10
class 1: acc 0.13333333333333333, correct 2/15
class 2: acc 1.0, correct 17/17
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.4301, val_error: 0.7273, auc: 0.6528
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3232, instance_loss: 0.6367, weighted_loss: 1.1173, label: 1, bag_size: 47433
batch 39, loss: 1.6133, instance_loss: 0.6359, weighted_loss: 1.3201, label: 2, bag_size: 103108


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 5, train_loss: 1.3832, train_clustering_loss:  0.6423, train_error: 0.6939
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/11
class 2: acc 0.5, correct 5/10
class 3: acc 0.0, correct 0/12

Val Set, val_loss: 1.3842, val_error: 0.7273, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.393749 --> 1.384198).  Saving model ...


batch 19, loss: 1.4129, instance_loss: 0.6454, weighted_loss: 1.1827, label: 1, bag_size: 132271
batch 39, loss: 1.5900, instance_loss: 0.6688, weighted_loss: 1.3136, label: 3, bag_size: 16626


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 6, train_loss: 1.3686, train_clustering_loss:  0.6317, train_error: 0.7551
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 0.0, correct 0/9
class 2: acc 0.5, correct 7/14
class 3: acc 0.07142857142857142, correct 1/14

Val Set, val_loss: 1.3867, val_error: 0.7273, auc: 0.6215
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2407, instance_loss: 0.6252, weighted_loss: 1.0560, label: 0, bag_size: 46742
batch 39, loss: 1.1070, instance_loss: 0.6216, weighted_loss: 0.9614, label: 3, bag_size: 231301


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 7, train_loss: 1.3198, train_clustering_loss:  0.6243, train_error: 0.5918
class 0: acc 0.6, correct 9/15
class 1: acc 0.0, correct 0/10
class 2: acc 0.0, correct 0/12
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.3672, val_error: 0.6364, auc: 0.6389
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.384198 --> 1.367244).  Saving model ...


batch 19, loss: 1.3408, instance_loss: 0.6422, weighted_loss: 1.1312, label: 1, bag_size: 57038
batch 39, loss: 1.2024, instance_loss: 0.6057, weighted_loss: 1.0234, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 8, train_loss: 1.3132, train_clustering_loss:  0.6161, train_error: 0.6327
class 0: acc 0.5714285714285714, correct 8/14
class 1: acc 0.0, correct 0/11
class 2: acc 0.5714285714285714, correct 8/14
class 3: acc 0.2, correct 2/10

Val Set, val_loss: 1.3887, val_error: 0.6364, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0649, instance_loss: 0.6062, weighted_loss: 0.9273, label: 2, bag_size: 103108
batch 39, loss: 1.3908, instance_loss: 0.6355, weighted_loss: 1.1642, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 9, train_loss: 1.2926, train_clustering_loss:  0.6147, train_error: 0.5306
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3962, val_error: 0.7273, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9006, instance_loss: 0.5983, weighted_loss: 0.8099, label: 1, bag_size: 58270
batch 39, loss: 1.9050, instance_loss: 0.6543, weighted_loss: 1.5298, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 10, train_loss: 1.2270, train_clustering_loss:  0.6003, train_error: 0.5102
class 0: acc 0.0, correct 0/10
class 1: acc 0.9523809523809523, correct 20/21
class 2: acc 0.4, correct 4/10
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4580, val_error: 0.7273, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.9252, instance_loss: 0.5174, weighted_loss: 0.8029, label: 1, bag_size: 69073
batch 39, loss: 1.2696, instance_loss: 0.6426, weighted_loss: 1.0815, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 11, train_loss: 1.3156, train_clustering_loss:  0.6035, train_error: 0.6122
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.06666666666666667, correct 1/15
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.3732, val_error: 0.5455, auc: 0.6458
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.4923, instance_loss: 0.6184, weighted_loss: 1.2301, label: 2, bag_size: 59749
batch 39, loss: 1.2464, instance_loss: 0.6324, weighted_loss: 1.0622, label: 3, bag_size: 25448


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 12, train_loss: 1.2694, train_clustering_loss:  0.6072, train_error: 0.6327
class 0: acc 0.2, correct 3/15
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.16666666666666666, correct 2/12
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.4190, val_error: 0.7273, auc: 0.6528
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.0360, instance_loss: 0.5872, weighted_loss: 0.9014, label: 2, bag_size: 103108
batch 39, loss: 1.1290, instance_loss: 0.5524, weighted_loss: 0.9560, label: 2, bag_size: 158432


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 13, train_loss: 1.2263, train_clustering_loss:  0.5896, train_error: 0.3878
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.0, correct 0/9
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.3817, val_error: 0.6364, auc: 0.6458
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.0580, instance_loss: 0.5866, weighted_loss: 0.9166, label: 0, bag_size: 22124
batch 39, loss: 1.3091, instance_loss: 0.5870, weighted_loss: 1.0925, label: 0, bag_size: 108548


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 14, train_loss: 1.2263, train_clustering_loss:  0.5909, train_error: 0.6735
class 0: acc 0.5333333333333333, correct 8/15
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.3371, val_error: 0.6364, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.367244 --> 1.337077).  Saving model ...


batch 19, loss: 0.9022, instance_loss: 0.5713, weighted_loss: 0.8029, label: 1, bag_size: 57038
batch 39, loss: 0.8980, instance_loss: 0.5556, weighted_loss: 0.7953, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 15, train_loss: 1.2143, train_clustering_loss:  0.5841, train_error: 0.5714
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.2, correct 3/15
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3998, val_error: 0.7273, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2200, instance_loss: 0.5726, weighted_loss: 1.0258, label: 3, bag_size: 40869
batch 39, loss: 0.8447, instance_loss: 0.5509, weighted_loss: 0.7566, label: 3, bag_size: 40869


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 16, train_loss: 1.2036, train_clustering_loss:  0.5804, train_error: 0.5102
class 0: acc 0.4, correct 4/10
class 1: acc 0.0, correct 0/10
class 2: acc 0.9375, correct 15/16
class 3: acc 0.38461538461538464, correct 5/13

Val Set, val_loss: 1.3883, val_error: 0.9091, auc: 0.6458
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1167, instance_loss: 0.5875, weighted_loss: 0.9579, label: 1, bag_size: 36943
batch 39, loss: 1.0503, instance_loss: 0.5475, weighted_loss: 0.8995, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 17, train_loss: 1.1151, train_clustering_loss:  0.5719, train_error: 0.3469
class 0: acc 0.9375, correct 15/16
class 1: acc 0.375, correct 3/8
class 2: acc 0.8, correct 12/15
class 3: acc 0.2, correct 2/10

Val Set, val_loss: 1.3928, val_error: 0.7273, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3049, instance_loss: 0.6163, weighted_loss: 1.0983, label: 0, bag_size: 6353
batch 39, loss: 1.0106, instance_loss: 0.5143, weighted_loss: 0.8617, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 18, train_loss: 1.1675, train_clustering_loss:  0.5803, train_error: 0.4082
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.47058823529411764, correct 8/17
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.3368, val_error: 0.8182, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.337077 --> 1.336782).  Saving model ...


batch 19, loss: 0.7908, instance_loss: 0.5351, weighted_loss: 0.7141, label: 0, bag_size: 19277
batch 39, loss: 0.4645, instance_loss: 0.4562, weighted_loss: 0.4620, label: 0, bag_size: 453871


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 19, train_loss: 1.1659, train_clustering_loss:  0.5694, train_error: 0.5102
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.5, correct 7/14
class 2: acc 0.5333333333333333, correct 8/15
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.3763, val_error: 0.5455, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7768, instance_loss: 0.5218, weighted_loss: 0.7003, label: 1, bag_size: 57038
batch 39, loss: 0.6466, instance_loss: 0.4913, weighted_loss: 0.6000, label: 1, bag_size: 66789


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 20, train_loss: 0.9930, train_clustering_loss:  0.5494, train_error: 0.3265
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.9047619047619048, correct 19/21
class 2: acc 0.5, correct 4/8
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.4320, val_error: 0.7273, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3854, instance_loss: 0.5011, weighted_loss: 0.4201, label: 3, bag_size: 181076
batch 39, loss: 0.6280, instance_loss: 0.4884, weighted_loss: 0.5861, label: 3, bag_size: 262536


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 21, train_loss: 1.0556, train_clustering_loss:  0.5713, train_error: 0.4286
class 0: acc 0.5, correct 7/14
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.3227, val_error: 0.7273, auc: 0.6389
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.336782 --> 1.322714).  Saving model ...


batch 19, loss: 1.3747, instance_loss: 0.6209, weighted_loss: 1.1486, label: 3, bag_size: 152150
batch 39, loss: 0.8767, instance_loss: 0.4865, weighted_loss: 0.7596, label: 0, bag_size: 46742


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 22, train_loss: 0.9908, train_clustering_loss:  0.5474, train_error: 0.4286
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.2727272727272727, correct 3/11
class 3: acc 0.5625, correct 9/16

Val Set, val_loss: 1.3653, val_error: 0.6364, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.0125, instance_loss: 0.7460, weighted_loss: 1.6326, label: 1, bag_size: 445537
batch 39, loss: 0.5616, instance_loss: 0.5047, weighted_loss: 0.5445, label: 2, bag_size: 278757


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 23, train_loss: 0.9852, train_clustering_loss:  0.5532, train_error: 0.4694
class 0: acc 0.5384615384615384, correct 7/13
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.3310, val_error: 0.4545, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5309, instance_loss: 0.4894, weighted_loss: 0.5185, label: 3, bag_size: 181076
batch 39, loss: 1.1334, instance_loss: 0.5983, weighted_loss: 0.9729, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 24, train_loss: 0.9882, train_clustering_loss:  0.5457, train_error: 0.3469
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.2537, val_error: 0.6364, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.322714 --> 1.253723).  Saving model ...


batch 19, loss: 0.9718, instance_loss: 0.5469, weighted_loss: 0.8443, label: 3, bag_size: 40869
batch 39, loss: 1.0937, instance_loss: 0.5482, weighted_loss: 0.9300, label: 3, bag_size: 196107


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 25, train_loss: 0.9068, train_clustering_loss:  0.5320, train_error: 0.2857
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.3425, val_error: 0.7273, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6016, instance_loss: 0.4992, weighted_loss: 0.5709, label: 2, bag_size: 17501
batch 39, loss: 0.4527, instance_loss: 0.4150, weighted_loss: 0.4414, label: 3, bag_size: 189694


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 26, train_loss: 0.8705, train_clustering_loss:  0.5152, train_error: 0.2245
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.3945, val_error: 0.6364, auc: 0.6632
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9652, instance_loss: 0.5884, weighted_loss: 0.8522, label: 1, bag_size: 57038
batch 39, loss: 0.8445, instance_loss: 0.5709, weighted_loss: 0.7624, label: 3, bag_size: 240896


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 27, train_loss: 0.7852, train_clustering_loss:  0.5214, train_error: 0.2857
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.3904, val_error: 0.6364, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.3117, instance_loss: 0.4072, weighted_loss: 0.3404, label: 1, bag_size: 57038
batch 39, loss: 0.7891, instance_loss: 0.4742, weighted_loss: 0.6946, label: 0, bag_size: 59141


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 28, train_loss: 0.7614, train_clustering_loss:  0.5022, train_error: 0.1837
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.625, correct 5/8
class 3: acc 0.8125, correct 13/16

Val Set, val_loss: 1.3382, val_error: 0.5455, auc: 0.6389
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.2669, instance_loss: 0.6332, weighted_loss: 1.0768, label: 2, bag_size: 59749
batch 39, loss: 0.3617, instance_loss: 0.6081, weighted_loss: 0.4356, label: 2, bag_size: 103108


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.00510204081632653: correct 2/392
Epoch: 29, train_loss: 0.8456, train_clustering_loss:  0.5306, train_error: 0.3878
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.5053, val_error: 0.6364, auc: 0.6528
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.0916, instance_loss: 0.5834, weighted_loss: 0.9391, label: 1, bag_size: 20030
batch 39, loss: 0.6536, instance_loss: 0.5049, weighted_loss: 0.6090, label: 2, bag_size: 176020


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 30, train_loss: 0.7408, train_clustering_loss:  0.5042, train_error: 0.2449
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.5294117647058824, correct 9/17
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.5815, val_error: 0.6364, auc: 0.6910
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.6913, instance_loss: 0.7262, weighted_loss: 1.4017, label: 0, bag_size: 108548
batch 39, loss: 0.3944, instance_loss: 0.5227, weighted_loss: 0.4329, label: 3, bag_size: 16626


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.00510204081632653: correct 2/392
Epoch: 31, train_loss: 0.8209, train_clustering_loss:  0.5096, train_error: 0.3265
class 0: acc 0.6, correct 9/15
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.625, correct 5/8
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.3181, val_error: 0.5455, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.6247, instance_loss: 0.5038, weighted_loss: 0.5885, label: 3, bag_size: 240896
batch 39, loss: 0.9611, instance_loss: 0.5222, weighted_loss: 0.8294, label: 2, bag_size: 393657


class 0 clustering acc 0.9993622448979592: correct 1567/1568
class 1 clustering acc 0.0: correct 0/392
Epoch: 32, train_loss: 0.7946, train_clustering_loss:  0.4987, train_error: 0.3061
class 0: acc 0.25, correct 2/8
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.4754, val_error: 0.6364, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.7684, instance_loss: 0.5516, weighted_loss: 0.7033, label: 3, bag_size: 16626
batch 39, loss: 0.6281, instance_loss: 0.5445, weighted_loss: 0.6030, label: 3, bag_size: 231301


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.00510204081632653: correct 2/392
Epoch: 33, train_loss: 0.5141, train_clustering_loss:  0.4415, train_error: 0.0408
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 12/12
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.3597, val_error: 0.4545, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.2726, instance_loss: 0.5930, weighted_loss: 1.0687, label: 1, bag_size: 66789
batch 39, loss: 0.3007, instance_loss: 0.3776, weighted_loss: 0.3237, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.015306122448979591: correct 6/392
Epoch: 34, train_loss: 0.6199, train_clustering_loss:  0.4648, train_error: 0.2653
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.36363636363636365, correct 4/11
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.3985, val_error: 0.6364, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.8693, instance_loss: 0.5458, weighted_loss: 0.7723, label: 3, bag_size: 231301
batch 39, loss: 0.6444, instance_loss: 0.4762, weighted_loss: 0.5939, label: 2, bag_size: 22416


class 0 clustering acc 1.0: correct 1568/1568
class 1 clustering acc 0.025510204081632654: correct 10/392
Epoch: 35, train_loss: 0.7054, train_clustering_loss:  0.4629, train_error: 0.2449
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.4313, val_error: 0.4545, auc: 0.6910
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.8518, instance_loss: 0.5422, weighted_loss: 0.7589, label: 2, bag_size: 158432
batch 39, loss: 0.3500, instance_loss: 0.3160, weighted_loss: 0.3398, label: 2, bag_size: 103108


class 0 clustering acc 0.9929846938775511: correct 1557/1568
class 1 clustering acc 0.08928571428571429: correct 35/392
Epoch: 36, train_loss: 0.6031, train_clustering_loss:  0.4398, train_error: 0.2245
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.42857142857142855, correct 3/7

Val Set, val_loss: 1.4138, val_error: 0.4545, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.4641, instance_loss: 0.4429, weighted_loss: 0.4577, label: 2, bag_size: 17501
batch 39, loss: 0.8213, instance_loss: 0.4969, weighted_loss: 0.7240, label: 3, bag_size: 262536


class 0 clustering acc 0.9961734693877551: correct 1562/1568
class 1 clustering acc 0.03826530612244898: correct 15/392
Epoch: 37, train_loss: 0.5828, train_clustering_loss:  0.4493, train_error: 0.1429
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.4165, val_error: 0.5455, auc: 0.6840
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.1498, instance_loss: 0.2973, weighted_loss: 0.1941, label: 0, bag_size: 59350
batch 39, loss: 1.2660, instance_loss: 0.5266, weighted_loss: 1.0442, label: 0, bag_size: 70920


class 0 clustering acc 0.9948979591836735: correct 1560/1568
class 1 clustering acc 0.12244897959183673: correct 48/392
Epoch: 38, train_loss: 0.6127, train_clustering_loss:  0.4309, train_error: 0.2857
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.625, correct 5/8
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.4481, val_error: 0.5455, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.1697, instance_loss: 0.5077, weighted_loss: 0.9711, label: 2, bag_size: 17501
batch 39, loss: 0.9124, instance_loss: 0.4994, weighted_loss: 0.7885, label: 0, bag_size: 222326


class 0 clustering acc 0.9974489795918368: correct 1564/1568
class 1 clustering acc 0.04846938775510204: correct 19/392
Epoch: 39, train_loss: 0.5536, train_clustering_loss:  0.4343, train_error: 0.2245
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.9375, correct 15/16
class 2: acc 0.5789473684210527, correct 11/19
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.5820, val_error: 0.5455, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.7457, instance_loss: 0.5649, weighted_loss: 0.6915, label: 3, bag_size: 56291
batch 39, loss: 0.1331, instance_loss: 0.2239, weighted_loss: 0.1603, label: 0, bag_size: 453871


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.10459183673469388: correct 41/392
Epoch: 40, train_loss: 0.4422, train_clustering_loss:  0.4079, train_error: 0.1224
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.5685, val_error: 0.5455, auc: 0.7118
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.7244, instance_loss: 0.4861, weighted_loss: 0.6529, label: 2, bag_size: 103108
batch 39, loss: 0.2504, instance_loss: 0.3216, weighted_loss: 0.2717, label: 2, bag_size: 113492


class 0 clustering acc 0.9942602040816326: correct 1559/1568
class 1 clustering acc 0.23469387755102042: correct 92/392
Epoch: 41, train_loss: 0.4547, train_clustering_loss:  0.3807, train_error: 0.1224
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 1.0, correct 21/21
class 2: acc 0.7, correct 7/10
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.4387, val_error: 0.6364, auc: 0.7014
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 1.7350, instance_loss: 0.7278, weighted_loss: 1.4328, label: 1, bag_size: 69073
batch 39, loss: 0.2217, instance_loss: 0.3661, weighted_loss: 0.2650, label: 3, bag_size: 16626


class 0 clustering acc 0.9936224489795918: correct 1558/1568
class 1 clustering acc 0.16326530612244897: correct 64/392
Epoch: 42, train_loss: 0.4823, train_clustering_loss:  0.4161, train_error: 0.1224
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.4717, val_error: 0.4545, auc: 0.7222
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.3312, instance_loss: 0.3874, weighted_loss: 0.3481, label: 0, bag_size: 46742
batch 39, loss: 0.2339, instance_loss: 0.3677, weighted_loss: 0.2740, label: 0, bag_size: 453871


class 0 clustering acc 0.9910714285714286: correct 1554/1568
class 1 clustering acc 0.29336734693877553: correct 115/392
Epoch: 43, train_loss: 0.4272, train_clustering_loss:  0.3836, train_error: 0.1224
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.25, correct 1/4
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.4242, val_error: 0.6364, auc: 0.6910
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.6863, instance_loss: 0.4371, weighted_loss: 0.6115, label: 1, bag_size: 23122
batch 39, loss: 0.1816, instance_loss: 0.2387, weighted_loss: 0.1987, label: 1, bag_size: 58270


class 0 clustering acc 0.9929846938775511: correct 1557/1568
class 1 clustering acc 0.19387755102040816: correct 76/392
Epoch: 44, train_loss: 0.4931, train_clustering_loss:  0.4105, train_error: 0.1837
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 1.0, correct 11/11
class 2: acc 0.7647058823529411, correct 13/17
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.7164, val_error: 0.5455, auc: 0.7153
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.26136363636363635: correct 23/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0654, instance_loss: 0.1425, weighted_loss: 0.0885, label: 0, bag_size: 453871
batch 39, loss: 0.0672, instance_loss: 0.1454, weighted_loss: 0.0906, label: 0, bag_size: 453871


class 0 clustering acc 0.9929846938775511: correct 1557/1568
class 1 clustering acc 0.3494897959183674: correct 137/392
Epoch: 45, train_loss: 0.4706, train_clustering_loss:  0.3737, train_error: 0.1224
class 0: acc 1.0, correct 16/16
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 1.0, correct 11/11
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.6361, val_error: 0.5455, auc: 0.6840
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.1331, instance_loss: 0.2264, weighted_loss: 0.1611, label: 1, bag_size: 69073
batch 39, loss: 0.1078, instance_loss: 0.2239, weighted_loss: 0.1426, label: 1, bag_size: 58270


class 0 clustering acc 0.9891581632653061: correct 1551/1568
class 1 clustering acc 0.21173469387755103: correct 83/392
Epoch: 46, train_loss: 0.3722, train_clustering_loss:  0.4002, train_error: 0.0612
class 0: acc 1.0, correct 13/13
class 1: acc 0.9, correct 9/10
class 2: acc 1.0, correct 12/12
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.4861, val_error: 0.5455, auc: 0.6493
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0783, instance_loss: 0.1494, weighted_loss: 0.0996, label: 0, bag_size: 19277
batch 39, loss: 0.2803, instance_loss: 0.2648, weighted_loss: 0.2756, label: 0, bag_size: 46742


class 0 clustering acc 0.9904336734693877: correct 1553/1568
class 1 clustering acc 0.2066326530612245: correct 81/392
Epoch: 47, train_loss: 0.5549, train_clustering_loss:  0.4155, train_error: 0.2245
class 0: acc 0.8, correct 12/15
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.6413, val_error: 0.6364, auc: 0.6528
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.1111, instance_loss: 0.2477, weighted_loss: 0.1521, label: 0, bag_size: 19277
batch 39, loss: 0.1088, instance_loss: 0.3608, weighted_loss: 0.1844, label: 3, bag_size: 40869


class 0 clustering acc 0.9923469387755102: correct 1556/1568
class 1 clustering acc 0.15816326530612246: correct 62/392
Epoch: 48, train_loss: 0.5215, train_clustering_loss:  0.4220, train_error: 0.1837
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.5707, val_error: 0.4545, auc: 0.7153
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.29545454545454547: correct 26/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.2823, instance_loss: 0.4175, weighted_loss: 0.3228, label: 1, bag_size: 20030
batch 39, loss: 0.8860, instance_loss: 0.6100, weighted_loss: 0.8032, label: 3, bag_size: 25448


class 0 clustering acc 0.9929846938775511: correct 1557/1568
class 1 clustering acc 0.24489795918367346: correct 96/392
Epoch: 49, train_loss: 0.4542, train_clustering_loss:  0.3982, train_error: 0.1633
class 0: acc 0.75, correct 12/16
class 1: acc 0.9375, correct 15/16
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.3985, val_error: 0.5455, auc: 0.6910
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.5525, instance_loss: 0.4968, weighted_loss: 0.5358, label: 2, bag_size: 59749
batch 39, loss: 0.7840, instance_loss: 0.6196, weighted_loss: 0.7347, label: 2, bag_size: 149988


class 0 clustering acc 0.9891581632653061: correct 1551/1568
class 1 clustering acc 0.2729591836734694: correct 107/392
Epoch: 50, train_loss: 0.4185, train_clustering_loss:  0.3796, train_error: 0.1224
class 0: acc 0.9444444444444444, correct 17/18
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.5151, val_error: 0.4545, auc: 0.7014
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.2727272727272727: correct 24/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 1.9231, instance_loss: 0.6565, weighted_loss: 1.5431, label: 3, bag_size: 25448
batch 39, loss: 0.5260, instance_loss: 0.3967, weighted_loss: 0.4872, label: 1, bag_size: 132271


class 0 clustering acc 0.9891581632653061: correct 1551/1568
class 1 clustering acc 0.29336734693877553: correct 115/392
Epoch: 51, train_loss: 0.4258, train_clustering_loss:  0.3766, train_error: 0.1224
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.8, correct 8/10
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.5408, val_error: 0.4545, auc: 0.7118
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.2840909090909091: correct 25/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20
Early stopping
Val error: 0.6364, ROC AUC: 0.7153
Test error: 0.6364, ROC AUC: 0.4826
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
finished!
end script
Completed: Sat Feb 19 05:48:04 EST 2022
