Started: Tue Apr 26 22:19:08 EDT 2022
[+] Loading zlib 1.2.11  ... 
[+] Loading gcc  10.2.0  ... 
[+] Loading libpng 1.6.37  ... 
[+] Loading libjpeg-turbo 2.0.6  ... 
[-] Unloading gcc  10.2.0  ... 
[+] Loading gcc  7.2.0  ... 
[+] Loading libtiff libraries v 4.0.9  ... 
[+] Loading openjpeg  2.3.1  ... 
[+] Loading SQLite 3.34.1  for gcc 4.8.5  ... 

Load Dataset
label column: label
label dictionary: {'pole': 0, 'msi': 1, 'lcn': 2, 'p53': 3}
number of classes: 4
slide-level counts:  
 0    20
1    17
2    15
3    17
Name: label, dtype: int64
Patient-LVL; Number of samples registered in class 0: 20
Slide-LVL; Number of samples registered in class 0: 20
Patient-LVL; Number of samples registered in class 1: 17
Slide-LVL; Number of samples registered in class 1: 17
Patient-LVL; Number of samples registered in class 2: 15
Slide-LVL; Number of samples registered in class 2: 15
Patient-LVL; Number of samples registered in class 3: 17
Slide-LVL; Number of samples registered in class 3: 17
split_dir:  splits/idibell_100
################# Settings ###################
num_splits:  10
k_start:  -1
k_end:  -1
task:  idibell
max_epochs:  200
results_dir:  /home/weismanal/projects/idibell/repo/results/41x/bwh_resection/training
lr:  0.0002
experiment:  2022-04-26
reg:  1e-05
label_frac:  1.0
bag_loss:  ce
seed:  1
model_type:  clam_sb
model_size:  small
use_drop_out:  True
weighted_sample:  True
opt:  adam
bag_weight:  0.7
inst_loss:  svm
B:  8
split_dir:  splits/idibell_100

Training Fold 0!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.9092, instance_loss: 1.0231, weighted_loss: 0.9433, label: 2, bag_size: 113492
batch 39, loss: 1.8537, instance_loss: 0.9303, weighted_loss: 1.5767, label: 1, bag_size: 23122


class 0 clustering acc 0.9534574468085106: correct 1434/1504
class 1 clustering acc 0.03723404255319149: correct 14/376
Epoch: 0, train_loss: 1.4040, train_clustering_loss:  1.0297, train_error: 0.6596
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/9
class 2: acc 1.0, correct 16/16
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.4476, val_error: 0.8182, auc: 0.6910
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.447559).  Saving model ...


batch 19, loss: 1.3315, instance_loss: 0.6949, weighted_loss: 1.1405, label: 2, bag_size: 44015
batch 39, loss: 1.2080, instance_loss: 0.7239, weighted_loss: 1.0628, label: 1, bag_size: 47433


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3991, train_clustering_loss:  0.7489, train_error: 0.6809
class 0: acc 0.0, correct 0/11
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.1, correct 1/10
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.3705, val_error: 0.7273, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.447559 --> 1.370536).  Saving model ...


batch 19, loss: 1.5428, instance_loss: 0.6625, weighted_loss: 1.2787, label: 2, bag_size: 75088
batch 39, loss: 1.4896, instance_loss: 0.6597, weighted_loss: 1.2406, label: 2, bag_size: 54449


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3899, train_clustering_loss:  0.6419, train_error: 0.7021
class 0: acc 0.0, correct 0/11
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.0, correct 0/10
class 3: acc 0.16666666666666666, correct 2/12

Val Set, val_loss: 1.3683, val_error: 0.5455, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.370536 --> 1.368294).  Saving model ...


batch 19, loss: 1.3747, instance_loss: 0.6321, weighted_loss: 1.1519, label: 0, bag_size: 6353
batch 39, loss: 1.9764, instance_loss: 0.6700, weighted_loss: 1.5845, label: 2, bag_size: 118767


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3702, train_clustering_loss:  0.6112, train_error: 0.6383
class 0: acc 0.0, correct 0/14
class 1: acc 1.0, correct 15/15
class 2: acc 0.0, correct 0/7
class 3: acc 0.18181818181818182, correct 2/11

Val Set, val_loss: 1.3692, val_error: 0.6364, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6435, instance_loss: 0.6466, weighted_loss: 1.3444, label: 2, bag_size: 9530
batch 39, loss: 1.6807, instance_loss: 0.6072, weighted_loss: 1.3587, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.4036, train_clustering_loss:  0.6081, train_error: 0.6809
class 0: acc 1.0, correct 14/14
class 1: acc 0.0, correct 0/10
class 2: acc 0.0, correct 0/11
class 3: acc 0.08333333333333333, correct 1/12

Val Set, val_loss: 1.3724, val_error: 0.7273, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6306, instance_loss: 0.5871, weighted_loss: 1.3176, label: 0, bag_size: 70920
batch 39, loss: 1.6539, instance_loss: 0.6025, weighted_loss: 1.3385, label: 0, bag_size: 13999


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3488, train_clustering_loss:  0.6078, train_error: 0.7021
class 0: acc 0.0, correct 0/8
class 1: acc 0.6875, correct 11/16
class 2: acc 0.2, correct 3/15
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4129, val_error: 0.7273, auc: 0.5972
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2622, instance_loss: 0.6037, weighted_loss: 1.0647, label: 2, bag_size: 9530
batch 39, loss: 1.5316, instance_loss: 0.6056, weighted_loss: 1.2538, label: 2, bag_size: 44015


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3473, train_clustering_loss:  0.6019, train_error: 0.7021
class 0: acc 0.0, correct 0/13
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.125, correct 1/8
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.3862, val_error: 0.7273, auc: 0.5069
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.0550, instance_loss: 0.6249, weighted_loss: 0.9260, label: 0, bag_size: 6353
batch 39, loss: 1.0966, instance_loss: 0.6210, weighted_loss: 0.9539, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3090, train_clustering_loss:  0.6120, train_error: 0.5957
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.0, correct 0/12
class 3: acc 0.14285714285714285, correct 1/7

Val Set, val_loss: 1.4116, val_error: 0.7273, auc: 0.5556
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.7528, instance_loss: 0.6019, weighted_loss: 0.7075, label: 0, bag_size: 59350
batch 39, loss: 1.9883, instance_loss: 0.7045, weighted_loss: 1.6031, label: 3, bag_size: 66523


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2556, train_clustering_loss:  0.6060, train_error: 0.5957
class 0: acc 1.0, correct 18/18
class 1: acc 0.0, correct 0/11
class 2: acc 0.08333333333333333, correct 1/12
class 3: acc 0.0, correct 0/6

Val Set, val_loss: 1.4604, val_error: 0.7273, auc: 0.4549
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.0328, instance_loss: 0.5897, weighted_loss: 0.8999, label: 1, bag_size: 58270
batch 39, loss: 1.3142, instance_loss: 0.6179, weighted_loss: 1.1053, label: 1, bag_size: 23122


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2297, train_clustering_loss:  0.5968, train_error: 0.5745
class 0: acc 0.125, correct 1/8
class 1: acc 0.26666666666666666, correct 4/15
class 2: acc 0.7894736842105263, correct 15/19
class 3: acc 0.0, correct 0/5

Val Set, val_loss: 1.5381, val_error: 0.6364, auc: 0.4167
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.7413, instance_loss: 0.5201, weighted_loss: 0.6749, label: 2, bag_size: 44015
batch 39, loss: 1.7158, instance_loss: 0.6166, weighted_loss: 1.3860, label: 1, bag_size: 47433


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2953, train_clustering_loss:  0.6059, train_error: 0.5745
class 0: acc 0.0, correct 0/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 0.16666666666666666, correct 2/12

Val Set, val_loss: 1.5091, val_error: 0.8182, auc: 0.4201
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.0115, instance_loss: 0.6196, weighted_loss: 0.8940, label: 0, bag_size: 18551
batch 39, loss: 0.8100, instance_loss: 0.5884, weighted_loss: 0.7435, label: 3, bag_size: 77542


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2659, train_clustering_loss:  0.6058, train_error: 0.5957
class 0: acc 0.6875, correct 11/16
class 1: acc 0.26666666666666666, correct 4/15
class 2: acc 0.25, correct 2/8
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.4610, val_error: 0.8182, auc: 0.3785
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.1715, instance_loss: 0.6194, weighted_loss: 1.0058, label: 3, bag_size: 24102
batch 39, loss: 1.3950, instance_loss: 0.6169, weighted_loss: 1.1616, label: 2, bag_size: 9530


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2824, train_clustering_loss:  0.5976, train_error: 0.5745
class 0: acc 0.2, correct 2/10
class 1: acc 0.8125, correct 13/16
class 2: acc 0.0, correct 0/9
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.4766, val_error: 0.8182, auc: 0.4201
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.6479, instance_loss: 0.6497, weighted_loss: 1.3485, label: 2, bag_size: 75088
batch 39, loss: 1.4816, instance_loss: 0.6321, weighted_loss: 1.2268, label: 2, bag_size: 9530


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2522, train_clustering_loss:  0.5945, train_error: 0.6170
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.4, correct 4/10
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.4556, val_error: 0.9091, auc: 0.4826
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.5796, instance_loss: 0.6137, weighted_loss: 1.2899, label: 0, bag_size: 6353
batch 39, loss: 0.9237, instance_loss: 0.5712, weighted_loss: 0.8180, label: 3, bag_size: 102779


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1762, train_clustering_loss:  0.5886, train_error: 0.5319
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.0, correct 0/9
class 2: acc 0.8888888888888888, correct 16/18
class 3: acc 0.38461538461538464, correct 5/13

Val Set, val_loss: 1.5151, val_error: 0.9091, auc: 0.4618
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.3494, instance_loss: 0.6313, weighted_loss: 1.1339, label: 0, bag_size: 22124
batch 39, loss: 1.1419, instance_loss: 0.5668, weighted_loss: 0.9694, label: 3, bag_size: 152150


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.1211, train_clustering_loss:  0.5775, train_error: 0.5532
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.1, correct 1/10
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.4396, val_error: 0.6364, auc: 0.5347
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.9473, instance_loss: 0.5679, weighted_loss: 0.8335, label: 2, bag_size: 9530
batch 39, loss: 1.2573, instance_loss: 0.6529, weighted_loss: 1.0760, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.0952, train_clustering_loss:  0.5739, train_error: 0.4043
class 0: acc 0.2, correct 2/10
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.4514, val_error: 0.9091, auc: 0.4931
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3653, instance_loss: 0.4227, weighted_loss: 0.3825, label: 3, bag_size: 42569
batch 39, loss: 1.3423, instance_loss: 0.6246, weighted_loss: 1.1270, label: 0, bag_size: 54249


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 0.9977, train_clustering_loss:  0.5686, train_error: 0.2766
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.7, correct 7/10
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 0.5714285714285714, correct 4/7

Val Set, val_loss: 1.5140, val_error: 0.9091, auc: 0.5035
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.3612, instance_loss: 0.6018, weighted_loss: 1.1334, label: 3, bag_size: 102779
batch 39, loss: 0.2685, instance_loss: 0.4114, weighted_loss: 0.3114, label: 3, bag_size: 42569


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.9446, train_clustering_loss:  0.5576, train_error: 0.3191
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.42857142857142855, correct 6/14
class 2: acc 1.0, correct 9/9
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.5014, val_error: 0.7273, auc: 0.5417
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.5484, instance_loss: 0.6061, weighted_loss: 1.2657, label: 0, bag_size: 70920
batch 39, loss: 0.4342, instance_loss: 0.4607, weighted_loss: 0.4421, label: 3, bag_size: 83890


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 1.0251, train_clustering_loss:  0.5666, train_error: 0.4255
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 0.8, correct 8/10
class 2: acc 0.5714285714285714, correct 8/14
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.6093, val_error: 0.8182, auc: 0.5139
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 2.2956, instance_loss: 0.6770, weighted_loss: 1.8100, label: 3, bag_size: 25448
batch 39, loss: 1.4868, instance_loss: 0.6393, weighted_loss: 1.2326, label: 0, bag_size: 56983


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 1.0432, train_clustering_loss:  0.5550, train_error: 0.4894
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.25, correct 3/12

Val Set, val_loss: 1.5578, val_error: 0.6364, auc: 0.5139
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.5162, instance_loss: 0.6136, weighted_loss: 1.2454, label: 3, bag_size: 16626
batch 39, loss: 0.6271, instance_loss: 0.5743, weighted_loss: 0.6113, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 0.8664, train_clustering_loss:  0.5283, train_error: 0.2766
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.8888888888888888, correct 16/18
class 2: acc 0.8, correct 8/10
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.5235, val_error: 0.7273, auc: 0.5660
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.1772, instance_loss: 0.5502, weighted_loss: 0.9891, label: 3, bag_size: 24102
batch 39, loss: 0.5224, instance_loss: 0.4698, weighted_loss: 0.5066, label: 2, bag_size: 158432


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 22, train_loss: 0.9161, train_clustering_loss:  0.5300, train_error: 0.3830
class 0: acc 0.3076923076923077, correct 4/13
class 1: acc 1.0, correct 15/15
class 2: acc 0.75, correct 6/8
class 3: acc 0.36363636363636365, correct 4/11

Val Set, val_loss: 1.6166, val_error: 0.7273, auc: 0.5069
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 1.0098, instance_loss: 0.5467, weighted_loss: 0.8709, label: 3, bag_size: 24102
batch 39, loss: 1.7382, instance_loss: 0.7408, weighted_loss: 1.4389, label: 0, bag_size: 56348


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 0.9009, train_clustering_loss:  0.5274, train_error: 0.3191
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 1.0, correct 11/11
class 3: acc 0.5, correct 7/14

Val Set, val_loss: 1.6896, val_error: 0.6364, auc: 0.5278
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.9661, instance_loss: 0.5590, weighted_loss: 0.8440, label: 2, bag_size: 9530
batch 39, loss: 0.7646, instance_loss: 0.5383, weighted_loss: 0.6967, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 0.8207, train_clustering_loss:  0.5162, train_error: 0.2128
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.5, correct 4/8
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.5885, val_error: 0.7273, auc: 0.5486
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.2213, instance_loss: 0.3984, weighted_loss: 0.2744, label: 0, bag_size: 18551
batch 39, loss: 0.6811, instance_loss: 0.5038, weighted_loss: 0.6279, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 25, train_loss: 0.7772, train_clustering_loss:  0.5022, train_error: 0.3191
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 1.0, correct 13/13
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.6063, val_error: 0.7273, auc: 0.5729
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.6171, instance_loss: 0.4759, weighted_loss: 0.5747, label: 1, bag_size: 23122
batch 39, loss: 0.7314, instance_loss: 0.5380, weighted_loss: 0.6734, label: 1, bag_size: 69073


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 26, train_loss: 0.8481, train_clustering_loss:  0.5070, train_error: 0.3617
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 1.0, correct 14/14
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.6772, val_error: 0.6364, auc: 0.5278
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.4704, instance_loss: 0.4026, weighted_loss: 0.4500, label: 2, bag_size: 54449
batch 39, loss: 1.2327, instance_loss: 0.6209, weighted_loss: 1.0492, label: 3, bag_size: 4963


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 27, train_loss: 0.7284, train_clustering_loss:  0.4862, train_error: 0.2340
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 1.0, correct 13/13
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.7660, val_error: 0.6364, auc: 0.5833
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 1.3053, instance_loss: 0.5324, weighted_loss: 1.0734, label: 0, bag_size: 65047
batch 39, loss: 1.3440, instance_loss: 0.6775, weighted_loss: 1.1441, label: 0, bag_size: 54249


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.023936170212765957: correct 9/376
Epoch: 28, train_loss: 0.6774, train_clustering_loss:  0.4601, train_error: 0.1915
class 0: acc 0.5, correct 6/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.5378, val_error: 0.7273, auc: 0.6181
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.5478, instance_loss: 0.3608, weighted_loss: 0.4917, label: 3, bag_size: 83890
batch 39, loss: 0.7428, instance_loss: 0.4711, weighted_loss: 0.6613, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.023936170212765957: correct 9/376
Epoch: 29, train_loss: 0.6705, train_clustering_loss:  0.4555, train_error: 0.2340
class 0: acc 0.6, correct 6/10
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.875, correct 7/8
class 3: acc 0.6875, correct 11/16

Val Set, val_loss: 1.7770, val_error: 0.6364, auc: 0.5833
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.6312, instance_loss: 0.4523, weighted_loss: 0.5775, label: 2, bag_size: 75088
batch 39, loss: 0.4855, instance_loss: 0.4392, weighted_loss: 0.4716, label: 0, bag_size: 56983


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.02127659574468085: correct 8/376
Epoch: 30, train_loss: 0.6036, train_clustering_loss:  0.4566, train_error: 0.1277
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 4/4
class 2: acc 1.0, correct 12/12
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 2.0119, val_error: 0.7273, auc: 0.5903
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.6230, instance_loss: 0.5115, weighted_loss: 0.5896, label: 1, bag_size: 47433
batch 39, loss: 0.4269, instance_loss: 0.4214, weighted_loss: 0.4253, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.08244680851063829: correct 31/376
Epoch: 31, train_loss: 0.4964, train_clustering_loss:  0.4104, train_error: 0.1064
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 15/15
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.6416, val_error: 0.7273, auc: 0.5938
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.7007, instance_loss: 0.5140, weighted_loss: 0.6447, label: 3, bag_size: 16626
batch 39, loss: 0.6451, instance_loss: 0.5008, weighted_loss: 0.6018, label: 3, bag_size: 16626


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.02925531914893617: correct 11/376
Epoch: 32, train_loss: 0.8621, train_clustering_loss:  0.4856, train_error: 0.3191
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.7126, val_error: 0.8182, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 2.5391, instance_loss: 0.6575, weighted_loss: 1.9746, label: 0, bag_size: 10671
batch 39, loss: 0.3596, instance_loss: 0.3290, weighted_loss: 0.3504, label: 3, bag_size: 77542


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.0797872340425532: correct 30/376
Epoch: 33, train_loss: 1.0396, train_clustering_loss:  0.5051, train_error: 0.4894
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.5, correct 4/8
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.3774, val_error: 0.6364, auc: 0.5972
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.4689, instance_loss: 0.4781, weighted_loss: 0.4717, label: 3, bag_size: 4963
batch 39, loss: 0.4710, instance_loss: 0.4542, weighted_loss: 0.4660, label: 0, bag_size: 56983


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.061170212765957445: correct 23/376
Epoch: 34, train_loss: 0.7034, train_clustering_loss:  0.4632, train_error: 0.2553
class 0: acc 0.5, correct 7/14
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.6247, val_error: 0.6364, auc: 0.5625
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 1.2548, instance_loss: 0.5687, weighted_loss: 1.0490, label: 1, bag_size: 77634
batch 39, loss: 1.2282, instance_loss: 0.6234, weighted_loss: 1.0467, label: 0, bag_size: 54249


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0398936170212766: correct 15/376
Epoch: 35, train_loss: 0.5796, train_clustering_loss:  0.4295, train_error: 0.1915
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.8, correct 8/10
class 2: acc 1.0, correct 14/14
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.8295, val_error: 0.6364, auc: 0.5451
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.2093, instance_loss: 0.3342, weighted_loss: 0.2468, label: 1, bag_size: 20030
batch 39, loss: 0.4757, instance_loss: 0.4741, weighted_loss: 0.4752, label: 0, bag_size: 56983


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.14095744680851063: correct 53/376
Epoch: 36, train_loss: 0.4124, train_clustering_loss:  0.3784, train_error: 0.0213
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.9257, val_error: 0.6364, auc: 0.5590
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.3446, instance_loss: 0.4660, weighted_loss: 0.3810, label: 1, bag_size: 20030
batch 39, loss: 0.2276, instance_loss: 0.2819, weighted_loss: 0.2439, label: 1, bag_size: 58270


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.2712765957446808: correct 102/376
Epoch: 37, train_loss: 0.4253, train_clustering_loss:  0.3700, train_error: 0.0851
class 0: acc 0.75, correct 9/12
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 9/9
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.7408, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.3696, instance_loss: 0.4377, weighted_loss: 0.3901, label: 0, bag_size: 22124
batch 39, loss: 0.1556, instance_loss: 0.2691, weighted_loss: 0.1897, label: 2, bag_size: 75088


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.18085106382978725: correct 68/376
Epoch: 38, train_loss: 0.3891, train_clustering_loss:  0.3604, train_error: 0.0426
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 1.0, correct 9/9
class 2: acc 1.0, correct 14/14
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.8228, val_error: 0.6364, auc: 0.5833
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.4562, instance_loss: 0.4531, weighted_loss: 0.4553, label: 3, bag_size: 16626
batch 39, loss: 0.4220, instance_loss: 0.3983, weighted_loss: 0.4149, label: 2, bag_size: 23349


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.19946808510638298: correct 75/376
Epoch: 39, train_loss: 0.4726, train_clustering_loss:  0.3913, train_error: 0.1277
class 0: acc 0.8125, correct 13/16
class 1: acc 1.0, correct 9/9
class 2: acc 1.0, correct 11/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.8844, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.4546, instance_loss: 0.3662, weighted_loss: 0.4281, label: 1, bag_size: 132271
batch 39, loss: 0.1097, instance_loss: 0.2373, weighted_loss: 0.1479, label: 2, bag_size: 75088


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.2393617021276596: correct 90/376
Epoch: 40, train_loss: 0.3769, train_clustering_loss:  0.3509, train_error: 0.1064
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 1.0, correct 15/15
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.6264, val_error: 0.5455, auc: 0.6285
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.0367, instance_loss: 0.1032, weighted_loss: 0.0566, label: 3, bag_size: 66523
batch 39, loss: 0.2182, instance_loss: 0.3409, weighted_loss: 0.2550, label: 3, bag_size: 24102


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.3271276595744681: correct 123/376
Epoch: 41, train_loss: 0.3654, train_clustering_loss:  0.3409, train_error: 0.1064
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.8823529411764706, correct 15/17

Val Set, val_loss: 2.1027, val_error: 0.6364, auc: 0.5590
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.3081, instance_loss: 0.3361, weighted_loss: 0.3165, label: 1, bag_size: 77634
batch 39, loss: 1.0278, instance_loss: 0.5771, weighted_loss: 0.8926, label: 3, bag_size: 4963


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.2925531914893617: correct 110/376
Epoch: 42, train_loss: 0.3677, train_clustering_loss:  0.3547, train_error: 0.0426
class 0: acc 1.0, correct 10/10
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 12/12
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 2.0237, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.1815, instance_loss: 0.2080, weighted_loss: 0.1894, label: 1, bag_size: 81420
batch 39, loss: 0.0569, instance_loss: 0.0925, weighted_loss: 0.0676, label: 3, bag_size: 77542


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.4122340425531915: correct 155/376
Epoch: 43, train_loss: 0.3521, train_clustering_loss:  0.3368, train_error: 0.0426
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 8/8
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 2.0642, val_error: 0.6364, auc: 0.5833
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.2913, instance_loss: 0.3948, weighted_loss: 0.3224, label: 3, bag_size: 12412
batch 39, loss: 0.5452, instance_loss: 0.4003, weighted_loss: 0.5017, label: 0, bag_size: 6353


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.3803191489361702: correct 143/376
Epoch: 44, train_loss: 0.3354, train_clustering_loss:  0.3305, train_error: 0.0638
class 0: acc 0.8947368421052632, correct 17/19
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 12/12
class 3: acc 0.8, correct 4/5

Val Set, val_loss: 1.8547, val_error: 0.7273, auc: 0.5938
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.1996, instance_loss: 0.2689, weighted_loss: 0.2204, label: 0, bag_size: 18551
batch 39, loss: 0.1142, instance_loss: 0.1679, weighted_loss: 0.1303, label: 0, bag_size: 19277


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.4654255319148936: correct 175/376
Epoch: 45, train_loss: 0.3539, train_clustering_loss:  0.3098, train_error: 0.0851
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 10/10
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 2.0142, val_error: 0.6364, auc: 0.5938
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.2400, instance_loss: 0.2484, weighted_loss: 0.2425, label: 1, bag_size: 69073
batch 39, loss: 0.8478, instance_loss: 0.6200, weighted_loss: 0.7795, label: 3, bag_size: 4963


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.4787234042553192: correct 180/376
Epoch: 46, train_loss: 0.2885, train_clustering_loss:  0.2988, train_error: 0.0638
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.9435, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 44 out of 20


batch 19, loss: 0.0718, instance_loss: 0.1548, weighted_loss: 0.0967, label: 2, bag_size: 44015
batch 39, loss: 1.6470, instance_loss: 0.8048, weighted_loss: 1.3943, label: 0, bag_size: 56348


class 0 clustering acc 0.9820478723404256: correct 1477/1504
class 1 clustering acc 0.43882978723404253: correct 165/376
Epoch: 47, train_loss: 0.4178, train_clustering_loss:  0.3241, train_error: 0.1489
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 11/11
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.9218, val_error: 0.6364, auc: 0.6285
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 45 out of 20


batch 19, loss: 0.4606, instance_loss: 0.4327, weighted_loss: 0.4523, label: 2, bag_size: 22416
batch 39, loss: 0.0573, instance_loss: 0.0969, weighted_loss: 0.0692, label: 1, bag_size: 47433


class 0 clustering acc 0.9787234042553191: correct 1472/1504
class 1 clustering acc 0.48936170212765956: correct 184/376
Epoch: 48, train_loss: 0.4156, train_clustering_loss:  0.3528, train_error: 0.1489
class 0: acc 0.8, correct 8/10
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 8/8
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.9436, val_error: 0.6364, auc: 0.5938
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.25: correct 22/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 46 out of 20


batch 19, loss: 0.5893, instance_loss: 0.4864, weighted_loss: 0.5584, label: 2, bag_size: 23349
batch 39, loss: 0.9161, instance_loss: 0.6771, weighted_loss: 0.8444, label: 3, bag_size: 25448


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.38563829787234044: correct 145/376
Epoch: 49, train_loss: 0.3603, train_clustering_loss:  0.3478, train_error: 0.1064
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 1.0, correct 7/7
class 2: acc 1.0, correct 9/9
class 3: acc 0.8888888888888888, correct 16/18

Val Set, val_loss: 2.3798, val_error: 0.5455, auc: 0.5903
class 0 clustering acc 0.9204545454545454: correct 324/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 47 out of 20


batch 19, loss: 0.2520, instance_loss: 0.3562, weighted_loss: 0.2833, label: 3, bag_size: 24102
batch 39, loss: 0.2026, instance_loss: 0.2391, weighted_loss: 0.2136, label: 1, bag_size: 23122


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.523936170212766: correct 197/376
Epoch: 50, train_loss: 0.3256, train_clustering_loss:  0.3150, train_error: 0.0638
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 12/12
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 2.1517, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.25: correct 22/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 48 out of 20


batch 19, loss: 0.1088, instance_loss: 0.1834, weighted_loss: 0.1312, label: 2, bag_size: 54449
batch 39, loss: 0.0672, instance_loss: 0.1414, weighted_loss: 0.0895, label: 3, bag_size: 152150


class 0 clustering acc 0.9847074468085106: correct 1481/1504
class 1 clustering acc 0.43351063829787234: correct 163/376
Epoch: 51, train_loss: 0.3945, train_clustering_loss:  0.3505, train_error: 0.1489
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 9/9
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 2.1692, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.2727272727272727: correct 24/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 49 out of 20
Early stopping
Val error: 0.5455, ROC AUC: 0.6771
Test error: 0.5455, ROC AUC: 0.8229
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3

Training Fold 1!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6424, instance_loss: 1.0794, weighted_loss: 1.4735, label: 0, bag_size: 41829
batch 39, loss: 1.5148, instance_loss: 0.9729, weighted_loss: 1.3522, label: 1, bag_size: 23122


class 0 clustering acc 0.9381648936170213: correct 1411/1504
class 1 clustering acc 0.07180851063829788: correct 27/376
Epoch: 0, train_loss: 1.4068, train_clustering_loss:  1.0629, train_error: 0.7660
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/13
class 2: acc 0.35714285714285715, correct 5/14
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.4201, val_error: 0.8182, auc: 0.4722
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.420086).  Saving model ...


batch 19, loss: 1.2052, instance_loss: 0.8249, weighted_loss: 1.0911, label: 2, bag_size: 64035
batch 39, loss: 1.1133, instance_loss: 0.6541, weighted_loss: 0.9756, label: 1, bag_size: 81420


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3861, train_clustering_loss:  0.7746, train_error: 0.6809
class 0: acc 0.0, correct 0/7
class 1: acc 0.875, correct 14/16
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.4189, val_error: 0.7273, auc: 0.5625
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.420086 --> 1.418868).  Saving model ...


batch 19, loss: 1.2820, instance_loss: 0.6573, weighted_loss: 1.0946, label: 3, bag_size: 83890
batch 39, loss: 1.3333, instance_loss: 0.6290, weighted_loss: 1.1220, label: 2, bag_size: 54449


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.4044, train_clustering_loss:  0.6346, train_error: 0.7021
class 0: acc 0.0, correct 0/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.0, correct 0/13
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.4093, val_error: 0.9091, auc: 0.5833
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.418868 --> 1.409289).  Saving model ...


batch 19, loss: 0.9491, instance_loss: 0.5618, weighted_loss: 0.8329, label: 1, bag_size: 77634
batch 39, loss: 1.2936, instance_loss: 0.6327, weighted_loss: 1.0953, label: 2, bag_size: 75088


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3938, train_clustering_loss:  0.6078, train_error: 0.7021
class 0: acc 0.0, correct 0/8
class 1: acc 0.8235294117647058, correct 14/17
class 2: acc 0.0, correct 0/12
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.4073, val_error: 0.7273, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.409289 --> 1.407340).  Saving model ...


batch 19, loss: 1.1940, instance_loss: 0.5866, weighted_loss: 1.0118, label: 3, bag_size: 17590
batch 39, loss: 1.3272, instance_loss: 0.6079, weighted_loss: 1.1114, label: 0, bag_size: 65047


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3729, train_clustering_loss:  0.6029, train_error: 0.6809
class 0: acc 0.0, correct 0/13
class 1: acc 0.0, correct 0/9
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.3333333333333333, correct 4/12

Val Set, val_loss: 1.4080, val_error: 0.9091, auc: 0.6111
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3387, instance_loss: 0.6147, weighted_loss: 1.1215, label: 0, bag_size: 10671
batch 39, loss: 1.6621, instance_loss: 0.6166, weighted_loss: 1.3484, label: 2, bag_size: 22416


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3179, train_clustering_loss:  0.5918, train_error: 0.6383
class 0: acc 0.5, correct 9/18
class 1: acc 0.0, correct 0/8
class 2: acc 0.0, correct 0/11
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.4255, val_error: 0.7273, auc: 0.5938
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9843, instance_loss: 0.4871, weighted_loss: 0.8352, label: 3, bag_size: 17590
batch 39, loss: 0.9848, instance_loss: 0.4983, weighted_loss: 0.8389, label: 3, bag_size: 17590


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3193, train_clustering_loss:  0.5875, train_error: 0.5957
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.0, correct 0/9
class 3: acc 0.5, correct 7/14

Val Set, val_loss: 1.4218, val_error: 0.9091, auc: 0.4965
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2100, instance_loss: 0.5638, weighted_loss: 1.0161, label: 1, bag_size: 77634
batch 39, loss: 1.1327, instance_loss: 0.5721, weighted_loss: 0.9645, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2777, train_clustering_loss:  0.5802, train_error: 0.6383
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.0, correct 0/9
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.5345, val_error: 0.9091, auc: 0.4653
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.1803, instance_loss: 0.5893, weighted_loss: 1.0030, label: 2, bag_size: 158432
batch 39, loss: 1.1971, instance_loss: 0.5585, weighted_loss: 1.0055, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2864, train_clustering_loss:  0.5870, train_error: 0.5532
class 0: acc 0.5, correct 6/12
class 1: acc 0.0, correct 0/7
class 2: acc 0.6, correct 12/20
class 3: acc 0.375, correct 3/8

Val Set, val_loss: 1.6271, val_error: 0.8182, auc: 0.5660
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.4732, instance_loss: 0.6007, weighted_loss: 1.2114, label: 1, bag_size: 57038
batch 39, loss: 1.4528, instance_loss: 0.6050, weighted_loss: 1.1985, label: 1, bag_size: 23122


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2591, train_clustering_loss:  0.5677, train_error: 0.5319
class 0: acc 0.42857142857142855, correct 6/14
class 1: acc 0.0, correct 0/9
class 2: acc 1.0, correct 15/15
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.6208, val_error: 0.7273, auc: 0.5347
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.1535, instance_loss: 0.5128, weighted_loss: 0.9613, label: 2, bag_size: 64035
batch 39, loss: 1.7023, instance_loss: 0.6545, weighted_loss: 1.3879, label: 1, bag_size: 81420


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2491, train_clustering_loss:  0.5929, train_error: 0.5106
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.0, correct 0/9
class 2: acc 0.5714285714285714, correct 8/14
class 3: acc 0.38461538461538464, correct 5/13

Val Set, val_loss: 1.6245, val_error: 0.7273, auc: 0.5451
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.9180, instance_loss: 0.5963, weighted_loss: 0.8215, label: 1, bag_size: 36943
batch 39, loss: 0.3675, instance_loss: 0.4445, weighted_loss: 0.3906, label: 3, bag_size: 77542


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.1683, train_clustering_loss:  0.5657, train_error: 0.4894
class 0: acc 0.3076923076923077, correct 4/13
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.5697, val_error: 0.8182, auc: 0.5972
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.2154, instance_loss: 0.5322, weighted_loss: 1.0105, label: 2, bag_size: 64035
batch 39, loss: 1.5279, instance_loss: 0.6252, weighted_loss: 1.2571, label: 2, bag_size: 118767


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.1116, train_clustering_loss:  0.5604, train_error: 0.4043
class 0: acc 0.375, correct 3/8
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.6666666666666666, correct 10/15

Val Set, val_loss: 1.6750, val_error: 0.7273, auc: 0.5972
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1512, instance_loss: 0.3724, weighted_loss: 0.2176, label: 3, bag_size: 83890
batch 39, loss: 0.2401, instance_loss: 0.3651, weighted_loss: 0.2776, label: 3, bag_size: 17590


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.0488, train_clustering_loss:  0.5372, train_error: 0.4681
class 0: acc 0.5, correct 6/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.3333333333333333, correct 3/9
class 3: acc 0.7333333333333333, correct 11/15

Val Set, val_loss: 1.7154, val_error: 0.8182, auc: 0.5972
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.1681, instance_loss: 0.5792, weighted_loss: 0.9914, label: 1, bag_size: 77634
batch 39, loss: 0.2638, instance_loss: 0.3462, weighted_loss: 0.2885, label: 3, bag_size: 102779


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 14, train_loss: 1.0179, train_clustering_loss:  0.5338, train_error: 0.4255
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.25, correct 2/8
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.8125, correct 13/16

Val Set, val_loss: 1.6553, val_error: 0.8182, auc: 0.5972
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.9399, instance_loss: 0.5085, weighted_loss: 0.8105, label: 0, bag_size: 47775
batch 39, loss: 1.3422, instance_loss: 0.5715, weighted_loss: 1.1110, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.010638297872340425: correct 4/376
Epoch: 15, train_loss: 0.8403, train_clustering_loss:  0.5056, train_error: 0.2340
class 0: acc 1.0, correct 14/14
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.75, correct 6/8
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.9440, val_error: 0.9091, auc: 0.5243
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1217, instance_loss: 0.2718, weighted_loss: 0.1667, label: 3, bag_size: 17590
batch 39, loss: 0.4569, instance_loss: 0.5079, weighted_loss: 0.4722, label: 2, bag_size: 158432


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.04521276595744681: correct 17/376
Epoch: 16, train_loss: 0.8158, train_clustering_loss:  0.5071, train_error: 0.2766
class 0: acc 1.0, correct 6/6
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.9712, val_error: 0.5455, auc: 0.5556
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.2177, instance_loss: 0.2792, weighted_loss: 0.2362, label: 3, bag_size: 42569
batch 39, loss: 1.9234, instance_loss: 0.8906, weighted_loss: 1.6135, label: 0, bag_size: 130978


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.026595744680851064: correct 10/376
Epoch: 17, train_loss: 0.8577, train_clustering_loss:  0.5085, train_error: 0.2979
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 1.0, correct 8/8
class 2: acc 0.8125, correct 13/16
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.5628, val_error: 0.8182, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.2179, instance_loss: 0.2754, weighted_loss: 0.2351, label: 3, bag_size: 102779
batch 39, loss: 0.4062, instance_loss: 0.4229, weighted_loss: 0.4112, label: 3, bag_size: 24102


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.06914893617021277: correct 26/376
Epoch: 18, train_loss: 0.9784, train_clustering_loss:  0.5163, train_error: 0.4043
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 2.1702, val_error: 0.8182, auc: 0.5972
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.9717, instance_loss: 0.4683, weighted_loss: 0.8207, label: 0, bag_size: 18551
batch 39, loss: 0.6857, instance_loss: 0.4598, weighted_loss: 0.6179, label: 3, bag_size: 98956


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.02925531914893617: correct 11/376
Epoch: 19, train_loss: 0.7892, train_clustering_loss:  0.4925, train_error: 0.2979
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5333333333333333, correct 8/15
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 2.0442, val_error: 0.6364, auc: 0.5868
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1733, instance_loss: 0.3161, weighted_loss: 0.2162, label: 2, bag_size: 59749
batch 39, loss: 1.5522, instance_loss: 0.6777, weighted_loss: 1.2898, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.023936170212765957: correct 9/376
Epoch: 20, train_loss: 0.7474, train_clustering_loss:  0.4708, train_error: 0.2979
class 0: acc 0.9, correct 9/10
class 1: acc 0.3076923076923077, correct 4/13
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 2.0783, val_error: 0.6364, auc: 0.5868
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.5777, instance_loss: 0.4285, weighted_loss: 0.5330, label: 3, bag_size: 48489
batch 39, loss: 0.4705, instance_loss: 0.4517, weighted_loss: 0.4648, label: 1, bag_size: 57038


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.047872340425531915: correct 18/376
Epoch: 21, train_loss: 0.7625, train_clustering_loss:  0.4785, train_error: 0.2979
class 0: acc 0.3, correct 3/10
class 1: acc 0.9, correct 18/20
class 2: acc 0.6666666666666666, correct 4/6
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 2.1496, val_error: 0.7273, auc: 0.5868
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.3104, instance_loss: 0.6795, weighted_loss: 1.1212, label: 2, bag_size: 64035
batch 39, loss: 0.8414, instance_loss: 0.4614, weighted_loss: 0.7274, label: 0, bag_size: 54249


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.07712765957446809: correct 29/376
Epoch: 22, train_loss: 0.7141, train_clustering_loss:  0.4718, train_error: 0.3404
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.75, correct 9/12
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 2.0243, val_error: 0.5455, auc: 0.5868
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.3764, instance_loss: 0.3929, weighted_loss: 0.3813, label: 3, bag_size: 24102
batch 39, loss: 1.1618, instance_loss: 0.5681, weighted_loss: 0.9837, label: 1, bag_size: 112135


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.06914893617021277: correct 26/376
Epoch: 23, train_loss: 0.7976, train_clustering_loss:  0.4693, train_error: 0.3191
class 0: acc 1.0, correct 12/12
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.75, correct 6/8
class 3: acc 0.6875, correct 11/16

Val Set, val_loss: 1.5268, val_error: 0.5455, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 1.4640, instance_loss: 0.6554, weighted_loss: 1.2214, label: 2, bag_size: 118767
batch 39, loss: 0.9955, instance_loss: 0.5283, weighted_loss: 0.8554, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.09308510638297872: correct 35/376
Epoch: 24, train_loss: 0.8483, train_clustering_loss:  0.4836, train_error: 0.3617
class 0: acc 1.0, correct 14/14
class 1: acc 0.4, correct 4/10
class 2: acc 0.3, correct 3/10
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 2.2127, val_error: 0.9091, auc: 0.5972
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.8297, instance_loss: 0.5610, weighted_loss: 0.7491, label: 1, bag_size: 36943
batch 39, loss: 0.5803, instance_loss: 0.3703, weighted_loss: 0.5173, label: 0, bag_size: 65047


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.10638297872340426: correct 40/376
Epoch: 25, train_loss: 0.7245, train_clustering_loss:  0.4515, train_error: 0.2128
class 0: acc 1.0, correct 12/12
class 1: acc 0.6, correct 6/10
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.8125, val_error: 0.6364, auc: 0.6597
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.5699, instance_loss: 0.4970, weighted_loss: 0.5480, label: 1, bag_size: 23122
batch 39, loss: 0.8815, instance_loss: 0.5508, weighted_loss: 0.7823, label: 1, bag_size: 69073


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.14627659574468085: correct 55/376
Epoch: 26, train_loss: 0.6913, train_clustering_loss:  0.4445, train_error: 0.2766
class 0: acc 1.0, correct 12/12
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 2.1773, val_error: 0.7273, auc: 0.5972
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 2.6304, instance_loss: 0.8802, weighted_loss: 2.1053, label: 2, bag_size: 54449
batch 39, loss: 0.2585, instance_loss: 0.3467, weighted_loss: 0.2850, label: 2, bag_size: 113492


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.06648936170212766: correct 25/376
Epoch: 27, train_loss: 0.7375, train_clustering_loss:  0.4692, train_error: 0.3191
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.8125, correct 13/16
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.4580, val_error: 0.4545, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 2.4742, instance_loss: 0.8848, weighted_loss: 1.9974, label: 0, bag_size: 6353
batch 39, loss: 0.5207, instance_loss: 0.3885, weighted_loss: 0.4810, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.1276595744680851: correct 48/376
Epoch: 28, train_loss: 0.7503, train_clustering_loss:  0.4816, train_error: 0.2766
class 0: acc 0.9, correct 9/10
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.7333333333333333, correct 11/15

Val Set, val_loss: 2.1166, val_error: 0.5455, auc: 0.5972
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 1.0595, instance_loss: 0.5204, weighted_loss: 0.8978, label: 3, bag_size: 98956
batch 39, loss: 0.9008, instance_loss: 0.4518, weighted_loss: 0.7661, label: 0, bag_size: 13999


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.10638297872340426: correct 40/376
Epoch: 29, train_loss: 0.6594, train_clustering_loss:  0.4383, train_error: 0.2553
class 0: acc 0.5, correct 5/10
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 2.1599, val_error: 0.5455, auc: 0.6215
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.1272, instance_loss: 0.1422, weighted_loss: 0.1317, label: 3, bag_size: 83890
batch 39, loss: 0.4183, instance_loss: 0.4297, weighted_loss: 0.4218, label: 2, bag_size: 99232


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.22340425531914893: correct 84/376
Epoch: 30, train_loss: 0.4420, train_clustering_loss:  0.3586, train_error: 0.1064
class 0: acc 0.9411764705882353, correct 16/17
class 1: acc 0.4, correct 2/5
class 2: acc 1.0, correct 13/13
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 2.4139, val_error: 0.7273, auc: 0.5972
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 1.4403, instance_loss: 0.6840, weighted_loss: 1.2134, label: 1, bag_size: 81420
batch 39, loss: 0.3878, instance_loss: 0.2903, weighted_loss: 0.3585, label: 0, bag_size: 65047


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.22340425531914893: correct 84/376
Epoch: 31, train_loss: 0.6072, train_clustering_loss:  0.4082, train_error: 0.2340
class 0: acc 1.0, correct 13/13
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 2.4340, val_error: 0.6364, auc: 0.5972
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.2525, instance_loss: 0.3362, weighted_loss: 0.2776, label: 3, bag_size: 48489
batch 39, loss: 0.1917, instance_loss: 0.3010, weighted_loss: 0.2245, label: 3, bag_size: 48489


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.22340425531914893: correct 84/376
Epoch: 32, train_loss: 0.6306, train_clustering_loss:  0.4032, train_error: 0.2553
class 0: acc 0.9411764705882353, correct 16/17
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 2.5407, val_error: 0.8182, auc: 0.5972
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.8117, instance_loss: 0.5936, weighted_loss: 0.7463, label: 1, bag_size: 36943
batch 39, loss: 0.0196, instance_loss: 0.0845, weighted_loss: 0.0391, label: 3, bag_size: 42569


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.2154255319148936: correct 81/376
Epoch: 33, train_loss: 0.6583, train_clustering_loss:  0.4149, train_error: 0.2766
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.5, correct 6/12
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 2.4248, val_error: 0.6364, auc: 0.5347
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.6227, instance_loss: 0.3413, weighted_loss: 0.5383, label: 2, bag_size: 113492
batch 39, loss: 0.3591, instance_loss: 0.3533, weighted_loss: 0.3574, label: 2, bag_size: 99232


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.13297872340425532: correct 50/376
Epoch: 34, train_loss: 0.7788, train_clustering_loss:  0.4568, train_error: 0.2340
class 0: acc 0.7, correct 7/10
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.875, correct 14/16
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 2.2471, val_error: 0.5455, auc: 0.5972
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 1.7016, instance_loss: 0.7510, weighted_loss: 1.4164, label: 3, bag_size: 152150
batch 39, loss: 0.3247, instance_loss: 0.4203, weighted_loss: 0.3534, label: 0, bag_size: 130978


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.2074468085106383: correct 78/376
Epoch: 35, train_loss: 0.5227, train_clustering_loss:  0.3947, train_error: 0.1489
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 9/9
class 2: acc 0.8, correct 8/10
class 3: acc 0.7368421052631579, correct 14/19

Val Set, val_loss: 2.3640, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.3036, instance_loss: 0.3243, weighted_loss: 0.3098, label: 0, bag_size: 65047
batch 39, loss: 0.4203, instance_loss: 0.4015, weighted_loss: 0.4147, label: 2, bag_size: 99232


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.13829787234042554: correct 52/376
Epoch: 36, train_loss: 0.5342, train_clustering_loss:  0.3955, train_error: 0.1915
class 0: acc 1.0, correct 16/16
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 2.3282, val_error: 0.6364, auc: 0.6215
class 0 clustering acc 0.9176136363636364: correct 323/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.4481, instance_loss: 0.2919, weighted_loss: 0.4012, label: 0, bag_size: 65047
batch 39, loss: 0.0096, instance_loss: 0.0565, weighted_loss: 0.0237, label: 3, bag_size: 77542


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.24202127659574468: correct 91/376
Epoch: 37, train_loss: 0.6774, train_clustering_loss:  0.3987, train_error: 0.2766
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.4, correct 4/10
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 2.3076, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.5886, instance_loss: 0.3689, weighted_loss: 0.5227, label: 0, bag_size: 47775
batch 39, loss: 0.0457, instance_loss: 0.1083, weighted_loss: 0.0645, label: 3, bag_size: 83890


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.21808510638297873: correct 82/376
Epoch: 38, train_loss: 0.5911, train_clustering_loss:  0.3960, train_error: 0.2340
class 0: acc 1.0, correct 10/10
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 2.3665, val_error: 0.5455, auc: 0.6424
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.1817, instance_loss: 0.2330, weighted_loss: 0.1971, label: 3, bag_size: 48489
batch 39, loss: 0.2843, instance_loss: 0.2608, weighted_loss: 0.2772, label: 0, bag_size: 70920


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.18882978723404256: correct 71/376
Epoch: 39, train_loss: 0.6441, train_clustering_loss:  0.4065, train_error: 0.1915
class 0: acc 0.9375, correct 15/16
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.7, correct 7/10
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.5188, val_error: 0.4545, auc: 0.6910
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.8929, instance_loss: 0.4138, weighted_loss: 0.7492, label: 0, bag_size: 13999
batch 39, loss: 0.0653, instance_loss: 0.1537, weighted_loss: 0.0918, label: 3, bag_size: 83890


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.19414893617021275: correct 73/376
Epoch: 40, train_loss: 0.7408, train_clustering_loss:  0.4461, train_error: 0.2766
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.7, correct 7/10
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 2.4170, val_error: 0.6364, auc: 0.6215
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.3335, instance_loss: 0.2654, weighted_loss: 0.3131, label: 0, bag_size: 56983
batch 39, loss: 0.1128, instance_loss: 0.2159, weighted_loss: 0.1438, label: 3, bag_size: 24102


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.2074468085106383: correct 78/376
Epoch: 41, train_loss: 0.5139, train_clustering_loss:  0.3826, train_error: 0.1489
class 0: acc 1.0, correct 11/11
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 2.3899, val_error: 0.5455, auc: 0.6181
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.7407, instance_loss: 0.4490, weighted_loss: 0.6532, label: 3, bag_size: 152150
batch 39, loss: 0.3232, instance_loss: 0.2895, weighted_loss: 0.3131, label: 2, bag_size: 113492


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.2925531914893617: correct 110/376
Epoch: 42, train_loss: 0.3800, train_clustering_loss:  0.3232, train_error: 0.1064
class 0: acc 1.0, correct 12/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 2.6460, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 0.9119318181818182: correct 321/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.6598, instance_loss: 0.5520, weighted_loss: 0.6275, label: 1, bag_size: 66789
batch 39, loss: 0.0070, instance_loss: 0.0244, weighted_loss: 0.0123, label: 3, bag_size: 77542


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.24202127659574468: correct 91/376
Epoch: 43, train_loss: 0.6073, train_clustering_loss:  0.4003, train_error: 0.2766
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.6470588235294118, correct 11/17
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 2.3976, val_error: 0.5455, auc: 0.6285
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.8587, instance_loss: 0.4821, weighted_loss: 0.7457, label: 3, bag_size: 12412
batch 39, loss: 0.1651, instance_loss: 0.2746, weighted_loss: 0.1979, label: 1, bag_size: 77634


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.23138297872340424: correct 87/376
Epoch: 44, train_loss: 0.4895, train_clustering_loss:  0.3702, train_error: 0.2128
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 2.4948, val_error: 0.5455, auc: 0.6181
class 0 clustering acc 0.9119318181818182: correct 321/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.8871, instance_loss: 0.4814, weighted_loss: 0.7654, label: 1, bag_size: 36943
batch 39, loss: 0.3804, instance_loss: 0.3267, weighted_loss: 0.3643, label: 0, bag_size: 22124


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.1702127659574468: correct 64/376
Epoch: 45, train_loss: 0.6140, train_clustering_loss:  0.4119, train_error: 0.3404
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 2.7556, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.6739, instance_loss: 0.4778, weighted_loss: 0.6151, label: 1, bag_size: 69073
batch 39, loss: 0.3586, instance_loss: 0.2224, weighted_loss: 0.3177, label: 2, bag_size: 113492


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.2632978723404255: correct 99/376
Epoch: 46, train_loss: 0.5644, train_clustering_loss:  0.3885, train_error: 0.2766
class 0: acc 0.875, correct 7/8
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 2.5779, val_error: 0.5455, auc: 0.6319
class 0 clustering acc 0.9204545454545454: correct 324/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.0120, instance_loss: 0.0446, weighted_loss: 0.0218, label: 3, bag_size: 17590
batch 39, loss: 0.7057, instance_loss: 0.5043, weighted_loss: 0.6453, label: 1, bag_size: 112135


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.32180851063829785: correct 121/376
Epoch: 47, train_loss: 0.4460, train_clustering_loss:  0.3446, train_error: 0.1489
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 1.0, correct 12/12
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 2.1082, val_error: 0.8182, auc: 0.6528
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 44 out of 20


batch 19, loss: 0.5561, instance_loss: 0.2973, weighted_loss: 0.4785, label: 2, bag_size: 158432
batch 39, loss: 0.7325, instance_loss: 0.5928, weighted_loss: 0.6906, label: 1, bag_size: 81420


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.4175531914893617: correct 157/376
Epoch: 48, train_loss: 0.4640, train_clustering_loss:  0.3325, train_error: 0.1915
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.8333333333333334, correct 5/6
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 2.6072, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 45 out of 20


batch 19, loss: 0.2178, instance_loss: 0.2316, weighted_loss: 0.2219, label: 0, bag_size: 70920
batch 39, loss: 0.4322, instance_loss: 0.2612, weighted_loss: 0.3809, label: 2, bag_size: 59749


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.34574468085106386: correct 130/376
Epoch: 49, train_loss: 0.4869, train_clustering_loss:  0.3613, train_error: 0.1277
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 1.0, correct 5/5
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 2.6892, val_error: 0.6364, auc: 0.6424
class 0 clustering acc 0.8920454545454546: correct 314/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 46 out of 20


batch 19, loss: 0.1779, instance_loss: 0.2017, weighted_loss: 0.1851, label: 3, bag_size: 24102
batch 39, loss: 0.1716, instance_loss: 0.3292, weighted_loss: 0.2189, label: 1, bag_size: 23122


class 0 clustering acc 0.9787234042553191: correct 1472/1504
class 1 clustering acc 0.3351063829787234: correct 126/376
Epoch: 50, train_loss: 0.5597, train_clustering_loss:  0.3760, train_error: 0.2128
class 0: acc 1.0, correct 14/14
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.9, correct 9/10
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 2.7929, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 0.8863636363636364: correct 312/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 47 out of 20


batch 19, loss: 1.1538, instance_loss: 0.6646, weighted_loss: 1.0070, label: 2, bag_size: 54449
batch 39, loss: 1.1211, instance_loss: 0.8379, weighted_loss: 1.0361, label: 1, bag_size: 132271


class 0 clustering acc 0.9773936170212766: correct 1470/1504
class 1 clustering acc 0.40425531914893614: correct 152/376
Epoch: 51, train_loss: 0.5055, train_clustering_loss:  0.3801, train_error: 0.2128
class 0: acc 1.0, correct 16/16
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.9, correct 9/10
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 2.6906, val_error: 0.6364, auc: 0.6319
class 0 clustering acc 0.8948863636363636: correct 315/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 48 out of 20
Early stopping
Val error: 0.7273, ROC AUC: 0.6806
Test error: 0.7273, ROC AUC: 0.6528
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3

Training Fold 2!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.3224, instance_loss: 1.0638, weighted_loss: 1.2448, label: 2, bag_size: 113492
batch 39, loss: 2.0517, instance_loss: 0.9160, weighted_loss: 1.7110, label: 1, bag_size: 58270


class 0 clustering acc 0.9275265957446809: correct 1395/1504
class 1 clustering acc 0.0851063829787234: correct 32/376
Epoch: 0, train_loss: 1.3909, train_clustering_loss:  1.0246, train_error: 0.6383
class 0: acc 0.0, correct 0/8
class 1: acc 0.0, correct 0/8
class 2: acc 0.0, correct 0/14
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 1.4645, val_error: 0.7273, auc: 0.6007
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.464492).  Saving model ...


batch 19, loss: 1.1882, instance_loss: 0.7605, weighted_loss: 1.0599, label: 2, bag_size: 69807
batch 39, loss: 1.4641, instance_loss: 0.6860, weighted_loss: 1.2307, label: 1, bag_size: 104549


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4112, train_clustering_loss:  0.7215, train_error: 0.7447
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/14
class 2: acc 0.0, correct 0/12
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.3827, val_error: 0.7273, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.464492 --> 1.382734).  Saving model ...


batch 19, loss: 1.5384, instance_loss: 0.6279, weighted_loss: 1.2653, label: 3, bag_size: 102779
batch 39, loss: 1.5801, instance_loss: 0.6656, weighted_loss: 1.3057, label: 2, bag_size: 54449


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3882, train_clustering_loss:  0.6347, train_error: 0.7234
class 0: acc 0.0, correct 0/9
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.0, correct 0/9
class 3: acc 0.26666666666666666, correct 4/15

Val Set, val_loss: 1.3955, val_error: 0.7273, auc: 0.5521
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.8634, instance_loss: 0.6697, weighted_loss: 1.5053, label: 0, bag_size: 22124
batch 39, loss: 1.7056, instance_loss: 0.6663, weighted_loss: 1.3938, label: 2, bag_size: 118767


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3989, train_clustering_loss:  0.6159, train_error: 0.7447
class 0: acc 0.0, correct 0/9
class 1: acc 0.625, correct 10/16
class 2: acc 0.0, correct 0/11
class 3: acc 0.18181818181818182, correct 2/11

Val Set, val_loss: 1.3724, val_error: 0.6364, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.382734 --> 1.372379).  Saving model ...


batch 19, loss: 1.0104, instance_loss: 0.6076, weighted_loss: 0.8896, label: 2, bag_size: 69807
batch 39, loss: 1.2436, instance_loss: 0.5816, weighted_loss: 1.0450, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3699, train_clustering_loss:  0.6163, train_error: 0.6383
class 0: acc 0.0, correct 0/11
class 1: acc 0.5, correct 8/16
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3704, val_error: 0.7273, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.372379 --> 1.370423).  Saving model ...


batch 19, loss: 0.8334, instance_loss: 0.5636, weighted_loss: 0.7525, label: 1, bag_size: 69073
batch 39, loss: 1.7454, instance_loss: 0.6696, weighted_loss: 1.4227, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3325, train_clustering_loss:  0.6083, train_error: 0.6596
class 0: acc 0.0, correct 0/9
class 1: acc 1.0, correct 16/16
class 2: acc 0.0, correct 0/9
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.3800, val_error: 0.7273, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0813, instance_loss: 0.6024, weighted_loss: 0.9376, label: 3, bag_size: 17590
batch 39, loss: 1.3225, instance_loss: 0.6261, weighted_loss: 1.1136, label: 2, bag_size: 69807


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3272, train_clustering_loss:  0.6204, train_error: 0.7234
class 0: acc 0.2857142857142857, correct 4/14
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.3569, val_error: 0.6364, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.370423 --> 1.356937).  Saving model ...


batch 19, loss: 1.0260, instance_loss: 0.6309, weighted_loss: 0.9075, label: 0, bag_size: 22124
batch 39, loss: 1.3630, instance_loss: 0.6183, weighted_loss: 1.1396, label: 1, bag_size: 69073


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2955, train_clustering_loss:  0.6235, train_error: 0.6596
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.3, correct 3/10
class 2: acc 0.0, correct 0/10
class 3: acc 0.0, correct 0/12

Val Set, val_loss: 1.3479, val_error: 0.7273, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.356937 --> 1.347899).  Saving model ...


batch 19, loss: 1.4041, instance_loss: 0.6500, weighted_loss: 1.1778, label: 2, bag_size: 23349
batch 39, loss: 1.2157, instance_loss: 0.6115, weighted_loss: 1.0344, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2524, train_clustering_loss:  0.6164, train_error: 0.4255
class 0: acc 0.8, correct 12/15
class 1: acc 0.0, correct 0/8
class 2: acc 0.6, correct 9/15
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.4087, val_error: 0.6364, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3482, instance_loss: 0.6327, weighted_loss: 1.1336, label: 3, bag_size: 24102
batch 39, loss: 1.0234, instance_loss: 0.6034, weighted_loss: 0.8974, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2373, train_clustering_loss:  0.6100, train_error: 0.4894
class 0: acc 0.3, correct 3/10
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.2727272727272727, correct 3/11

Val Set, val_loss: 1.3430, val_error: 0.8182, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.347899 --> 1.343008).  Saving model ...


batch 19, loss: 0.8158, instance_loss: 0.5937, weighted_loss: 0.7492, label: 2, bag_size: 69807
batch 39, loss: 1.3697, instance_loss: 0.6572, weighted_loss: 1.1559, label: 1, bag_size: 64834


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.1981, train_clustering_loss:  0.6068, train_error: 0.4894
class 0: acc 0.0, correct 0/7
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.6875, correct 11/16
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.4146, val_error: 0.7273, auc: 0.6736
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8380, instance_loss: 0.5464, weighted_loss: 0.7505, label: 1, bag_size: 81420
batch 39, loss: 0.8958, instance_loss: 0.5669, weighted_loss: 0.7971, label: 2, bag_size: 44015


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.1608, train_clustering_loss:  0.5981, train_error: 0.4681
class 0: acc 0.0, correct 0/12
class 1: acc 0.75, correct 12/16
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.3735, val_error: 0.5455, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8018, instance_loss: 0.5557, weighted_loss: 0.7280, label: 2, bag_size: 89905
batch 39, loss: 0.7700, instance_loss: 0.5275, weighted_loss: 0.6972, label: 3, bag_size: 17590


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2006, train_clustering_loss:  0.5966, train_error: 0.5319
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.6, correct 6/10
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.3178, val_error: 0.6364, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.343008 --> 1.317813).  Saving model ...


batch 19, loss: 0.6463, instance_loss: 0.5108, weighted_loss: 0.6056, label: 3, bag_size: 102779
batch 39, loss: 0.2552, instance_loss: 0.4326, weighted_loss: 0.3084, label: 3, bag_size: 17590


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2513, train_clustering_loss:  0.5973, train_error: 0.6596
class 0: acc 0.5, correct 4/8
class 1: acc 0.2, correct 2/10
class 2: acc 0.16666666666666666, correct 2/12
class 3: acc 0.47058823529411764, correct 8/17

Val Set, val_loss: 1.3551, val_error: 0.7273, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4819, instance_loss: 0.6278, weighted_loss: 1.2257, label: 0, bag_size: 22124
batch 39, loss: 0.7853, instance_loss: 0.5251, weighted_loss: 0.7073, label: 2, bag_size: 7532


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1374, train_clustering_loss:  0.5863, train_error: 0.4894
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.3983, val_error: 0.8182, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8480, instance_loss: 0.5530, weighted_loss: 0.7595, label: 1, bag_size: 77634
batch 39, loss: 2.2517, instance_loss: 0.7249, weighted_loss: 1.7937, label: 3, bag_size: 152150


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.0698, train_clustering_loss:  0.5792, train_error: 0.4468
class 0: acc 0.3125, correct 5/16
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.7, correct 7/10
class 3: acc 0.42857142857142855, correct 3/7

Val Set, val_loss: 1.3411, val_error: 0.5455, auc: 0.6736
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1311, instance_loss: 0.4013, weighted_loss: 0.2121, label: 3, bag_size: 17590
batch 39, loss: 1.3506, instance_loss: 0.6210, weighted_loss: 1.1317, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.1483, train_clustering_loss:  0.5782, train_error: 0.5106
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.38461538461538464, correct 5/13
class 3: acc 0.625, correct 10/16

Val Set, val_loss: 1.4524, val_error: 0.6364, auc: 0.6528
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8763, instance_loss: 0.5454, weighted_loss: 0.7771, label: 2, bag_size: 9530
batch 39, loss: 0.5324, instance_loss: 0.5052, weighted_loss: 0.5242, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.1178, train_clustering_loss:  0.5728, train_error: 0.4681
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.8125, correct 13/16
class 2: acc 0.75, correct 9/12
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.2833, val_error: 0.7273, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.317813 --> 1.283297).  Saving model ...


batch 19, loss: 1.6511, instance_loss: 0.6495, weighted_loss: 1.3507, label: 3, bag_size: 12412
batch 39, loss: 1.0012, instance_loss: 0.5164, weighted_loss: 0.8557, label: 2, bag_size: 9530


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 1.0889, train_clustering_loss:  0.5654, train_error: 0.3191
class 0: acc 0.3, correct 3/10
class 1: acc 1.0, correct 14/14
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.2730, val_error: 0.6364, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.283297 --> 1.273004).  Saving model ...


batch 19, loss: 0.9422, instance_loss: 0.5170, weighted_loss: 0.8147, label: 1, bag_size: 23122
batch 39, loss: 1.2735, instance_loss: 0.5567, weighted_loss: 1.0585, label: 2, bag_size: 7532


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 1.0886, train_clustering_loss:  0.5638, train_error: 0.4468
class 0: acc 0.21428571428571427, correct 3/14
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.5, correct 4/8
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.2719, val_error: 0.5455, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.273004 --> 1.271923).  Saving model ...


batch 19, loss: 1.3409, instance_loss: 0.6044, weighted_loss: 1.1200, label: 0, bag_size: 108548
batch 39, loss: 1.1071, instance_loss: 0.6028, weighted_loss: 0.9558, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 1.1175, train_clustering_loss:  0.5712, train_error: 0.4255
class 0: acc 0.3076923076923077, correct 4/13
class 1: acc 0.8, correct 8/10
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.3274, val_error: 0.5455, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9221, instance_loss: 0.5545, weighted_loss: 0.8119, label: 0, bag_size: 47775
batch 39, loss: 0.6628, instance_loss: 0.4992, weighted_loss: 0.6137, label: 3, bag_size: 24102


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 1.0767, train_clustering_loss:  0.5494, train_error: 0.4043
class 0: acc 0.4, correct 4/10
class 1: acc 0.7777777777777778, correct 14/18
class 2: acc 0.25, correct 2/8
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.2911, val_error: 0.6364, auc: 0.7326
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4820, instance_loss: 0.4821, weighted_loss: 0.4820, label: 2, bag_size: 89905
batch 39, loss: 1.1101, instance_loss: 0.6175, weighted_loss: 0.9623, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 22, train_loss: 0.9200, train_clustering_loss:  0.5360, train_error: 0.3617
class 0: acc 0.14285714285714285, correct 2/14
class 1: acc 1.0, correct 12/12
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.3018, val_error: 0.5455, auc: 0.7187
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5262, instance_loss: 0.4413, weighted_loss: 0.5008, label: 2, bag_size: 89905
batch 39, loss: 1.2342, instance_loss: 0.6379, weighted_loss: 1.0553, label: 3, bag_size: 66523


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 0.9660, train_clustering_loss:  0.5355, train_error: 0.3830
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.75, correct 6/8
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.2896, val_error: 0.5455, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3311, instance_loss: 0.4277, weighted_loss: 0.3600, label: 3, bag_size: 17590
batch 39, loss: 1.2263, instance_loss: 0.5344, weighted_loss: 1.0187, label: 1, bag_size: 23122


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 0.8854, train_clustering_loss:  0.5177, train_error: 0.2553
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.8, correct 8/10
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.2650, val_error: 0.6364, auc: 0.7326
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.271923 --> 1.265019).  Saving model ...


batch 19, loss: 0.7423, instance_loss: 0.4828, weighted_loss: 0.6644, label: 1, bag_size: 81420
batch 39, loss: 0.4324, instance_loss: 0.4205, weighted_loss: 0.4288, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 25, train_loss: 0.8731, train_clustering_loss:  0.5042, train_error: 0.2979
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.8, correct 8/10
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.3154, val_error: 0.6364, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3818, instance_loss: 0.4174, weighted_loss: 0.3925, label: 1, bag_size: 58270
batch 39, loss: 0.8977, instance_loss: 0.4963, weighted_loss: 0.7773, label: 1, bag_size: 18329


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.007978723404255319: correct 3/376
Epoch: 26, train_loss: 0.8378, train_clustering_loss:  0.4979, train_error: 0.3404
class 0: acc 0.0, correct 0/7
class 1: acc 1.0, correct 14/14
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.4142, val_error: 0.7273, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.7863, instance_loss: 0.6371, weighted_loss: 1.4415, label: 2, bag_size: 54449
batch 39, loss: 0.7239, instance_loss: 0.5002, weighted_loss: 0.6568, label: 3, bag_size: 22057


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.007978723404255319: correct 3/376
Epoch: 27, train_loss: 0.9546, train_clustering_loss:  0.5156, train_error: 0.3830
class 0: acc 0.2, correct 2/10
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.2422, val_error: 0.6364, auc: 0.7326
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.265019 --> 1.242175).  Saving model ...


batch 19, loss: 1.2100, instance_loss: 0.6229, weighted_loss: 1.0339, label: 0, bag_size: 19277
batch 39, loss: 0.6233, instance_loss: 0.4115, weighted_loss: 0.5597, label: 1, bag_size: 69073


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.06914893617021277: correct 26/376
Epoch: 28, train_loss: 0.7865, train_clustering_loss:  0.4741, train_error: 0.3617
class 0: acc 0.3076923076923077, correct 4/13
class 1: acc 0.75, correct 6/8
class 2: acc 0.875, correct 14/16
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.2968, val_error: 0.5455, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3802, instance_loss: 0.3481, weighted_loss: 0.3706, label: 2, bag_size: 7532
batch 39, loss: 0.5112, instance_loss: 0.3555, weighted_loss: 0.4645, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.02127659574468085: correct 8/376
Epoch: 29, train_loss: 0.8316, train_clustering_loss:  0.4876, train_error: 0.2766
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.875, correct 7/8
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.4035, val_error: 0.5455, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1967, instance_loss: 0.2850, weighted_loss: 0.2232, label: 2, bag_size: 75088
batch 39, loss: 0.5492, instance_loss: 0.3322, weighted_loss: 0.4841, label: 2, bag_size: 99232


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.09308510638297872: correct 35/376
Epoch: 30, train_loss: 0.6656, train_clustering_loss:  0.4404, train_error: 0.2553
class 0: acc 0.4, correct 4/10
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 1.0, correct 15/15
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.3616, val_error: 0.6364, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.1381, instance_loss: 0.4465, weighted_loss: 0.9306, label: 1, bag_size: 104549
batch 39, loss: 0.5874, instance_loss: 0.4140, weighted_loss: 0.5353, label: 1, bag_size: 20030


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.11702127659574468: correct 44/376
Epoch: 31, train_loss: 0.7537, train_clustering_loss:  0.4687, train_error: 0.2979
class 0: acc 0.6111111111111112, correct 11/18
class 1: acc 0.75, correct 9/12
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.5039, val_error: 0.6364, auc: 0.6424
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.5778, instance_loss: 0.4899, weighted_loss: 0.5515, label: 0, bag_size: 47775
batch 39, loss: 0.5881, instance_loss: 0.4997, weighted_loss: 0.5616, label: 0, bag_size: 47775


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.10372340425531915: correct 39/376
Epoch: 32, train_loss: 0.8396, train_clustering_loss:  0.4645, train_error: 0.2553
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 1.0, correct 18/18
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.125, correct 1/8

Val Set, val_loss: 1.3182, val_error: 0.5455, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.1968, instance_loss: 0.5257, weighted_loss: 0.9955, label: 1, bag_size: 23122
batch 39, loss: 0.0758, instance_loss: 0.1755, weighted_loss: 0.1057, label: 2, bag_size: 44015


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.23404255319148937: correct 88/376
Epoch: 33, train_loss: 0.7026, train_clustering_loss:  0.4250, train_error: 0.2979
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.7647058823529411, correct 13/17
class 3: acc 0.7333333333333333, correct 11/15

Val Set, val_loss: 1.5027, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.3284, instance_loss: 0.4109, weighted_loss: 0.3532, label: 3, bag_size: 22057
batch 39, loss: 0.5277, instance_loss: 0.4720, weighted_loss: 0.5110, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.18085106382978725: correct 68/376
Epoch: 34, train_loss: 0.7088, train_clustering_loss:  0.4348, train_error: 0.2553
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.4040, val_error: 0.5455, auc: 0.6042
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 2.1531, instance_loss: 0.6982, weighted_loss: 1.7166, label: 3, bag_size: 16626
batch 39, loss: 0.4151, instance_loss: 0.4028, weighted_loss: 0.4114, label: 1, bag_size: 36943


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.23670212765957446: correct 89/376
Epoch: 35, train_loss: 0.6489, train_clustering_loss:  0.4292, train_error: 0.2340
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.6, correct 6/10
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.4233, val_error: 0.6364, auc: 0.6736
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.3343, instance_loss: 0.3098, weighted_loss: 0.3270, label: 1, bag_size: 20030
batch 39, loss: 0.3155, instance_loss: 0.2914, weighted_loss: 0.3083, label: 2, bag_size: 99232


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.15691489361702127: correct 59/376
Epoch: 36, train_loss: 0.5595, train_clustering_loss:  0.4001, train_error: 0.2340
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.8823529411764706, correct 15/17
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.5, correct 3/6

Val Set, val_loss: 1.6093, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.3088, instance_loss: 0.2793, weighted_loss: 0.2999, label: 1, bag_size: 20030
batch 39, loss: 0.4288, instance_loss: 0.4706, weighted_loss: 0.4414, label: 3, bag_size: 24102


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.1622340425531915: correct 61/376
Epoch: 37, train_loss: 0.6789, train_clustering_loss:  0.4410, train_error: 0.2340
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.5359, val_error: 0.6364, auc: 0.6493
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 2.0281, instance_loss: 0.5259, weighted_loss: 1.5775, label: 1, bag_size: 77634
batch 39, loss: 0.1005, instance_loss: 0.1984, weighted_loss: 0.1299, label: 3, bag_size: 102779


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.30319148936170215: correct 114/376
Epoch: 38, train_loss: 0.6742, train_clustering_loss:  0.4058, train_error: 0.3191
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.8, correct 12/15
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.2721, val_error: 0.5455, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.5789, instance_loss: 0.5254, weighted_loss: 0.5628, label: 0, bag_size: 47775
batch 39, loss: 0.3683, instance_loss: 0.3016, weighted_loss: 0.3483, label: 1, bag_size: 36943


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.1595744680851064: correct 60/376
Epoch: 39, train_loss: 0.6351, train_clustering_loss:  0.4394, train_error: 0.1702
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.4439, val_error: 0.6364, auc: 0.6701
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.3618, instance_loss: 0.3937, weighted_loss: 0.3713, label: 1, bag_size: 132271
batch 39, loss: 0.0686, instance_loss: 0.1627, weighted_loss: 0.0969, label: 3, bag_size: 102779


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.1702127659574468: correct 64/376
Epoch: 40, train_loss: 0.7205, train_clustering_loss:  0.4342, train_error: 0.2340
class 0: acc 0.625, correct 5/8
class 1: acc 0.8, correct 12/15
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.3424, val_error: 0.6364, auc: 0.7292
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.7180, instance_loss: 0.5551, weighted_loss: 0.6691, label: 0, bag_size: 56983
batch 39, loss: 0.1539, instance_loss: 0.3148, weighted_loss: 0.2021, label: 2, bag_size: 89905


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.2393617021276596: correct 90/376
Epoch: 41, train_loss: 0.6046, train_clustering_loss:  0.4117, train_error: 0.1915
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.4017, val_error: 0.7273, auc: 0.7083
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 2.5864, instance_loss: 0.8552, weighted_loss: 2.0670, label: 3, bag_size: 16626
batch 39, loss: 0.6238, instance_loss: 0.4453, weighted_loss: 0.5702, label: 3, bag_size: 22057


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.29521276595744683: correct 111/376
Epoch: 42, train_loss: 0.5902, train_clustering_loss:  0.3839, train_error: 0.2340
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 1.0, correct 14/14
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.4625, val_error: 0.6364, auc: 0.6632
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0374, instance_loss: 0.1188, weighted_loss: 0.0618, label: 3, bag_size: 77542
batch 39, loss: 0.0614, instance_loss: 0.1110, weighted_loss: 0.0763, label: 2, bag_size: 44015


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.30851063829787234: correct 116/376
Epoch: 43, train_loss: 0.4766, train_clustering_loss:  0.3594, train_error: 0.1064
class 0: acc 0.625, correct 5/8
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 1.0, correct 10/10
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.3205, val_error: 0.5455, auc: 0.7083
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.3777, instance_loss: 0.3711, weighted_loss: 0.3757, label: 3, bag_size: 48624
batch 39, loss: 0.2961, instance_loss: 0.4348, weighted_loss: 0.3377, label: 0, bag_size: 22124


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.2978723404255319: correct 112/376
Epoch: 44, train_loss: 0.4671, train_clustering_loss:  0.3905, train_error: 0.0851
class 0: acc 0.875, correct 14/16
class 1: acc 1.0, correct 12/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.5239, val_error: 0.6364, auc: 0.6736
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1910, instance_loss: 0.2387, weighted_loss: 0.2053, label: 1, bag_size: 81420
batch 39, loss: 0.7421, instance_loss: 0.5411, weighted_loss: 0.6818, label: 0, bag_size: 6353


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.28191489361702127: correct 106/376
Epoch: 45, train_loss: 0.4997, train_clustering_loss:  0.3745, train_error: 0.1489
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.4525, val_error: 0.6364, auc: 0.6736
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.5388, instance_loss: 0.5273, weighted_loss: 1.2354, label: 1, bag_size: 18329
batch 39, loss: 1.1684, instance_loss: 0.5262, weighted_loss: 0.9758, label: 3, bag_size: 22057


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.2553191489361702: correct 96/376
Epoch: 46, train_loss: 0.6134, train_clustering_loss:  0.3933, train_error: 0.2128
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.4956, val_error: 0.7273, auc: 0.6736
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0163, instance_loss: 0.0623, weighted_loss: 0.0301, label: 2, bag_size: 69807
batch 39, loss: 0.7343, instance_loss: 0.4969, weighted_loss: 0.6631, label: 3, bag_size: 66523


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.27925531914893614: correct 105/376
Epoch: 47, train_loss: 0.5365, train_clustering_loss:  0.3960, train_error: 0.1277
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 1.0, correct 9/9
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.4430, val_error: 0.6364, auc: 0.6840
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 1.0801, instance_loss: 0.6164, weighted_loss: 0.9410, label: 2, bag_size: 23349
batch 39, loss: 0.1697, instance_loss: 0.2340, weighted_loss: 0.1890, label: 1, bag_size: 104549


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.3404255319148936: correct 128/376
Epoch: 48, train_loss: 0.5020, train_clustering_loss:  0.3594, train_error: 0.2128
class 0: acc 0.4444444444444444, correct 4/9
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.3474, val_error: 0.7273, auc: 0.7153
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.4127, instance_loss: 0.6603, weighted_loss: 1.1870, label: 0, bag_size: 10671
batch 39, loss: 1.3637, instance_loss: 0.7450, weighted_loss: 1.1781, label: 0, bag_size: 108548


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.2765957446808511: correct 104/376
Epoch: 49, train_loss: 0.5228, train_clustering_loss:  0.3992, train_error: 0.1915
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.5513, val_error: 0.6364, auc: 0.6146
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.1016, instance_loss: 0.2386, weighted_loss: 0.1427, label: 2, bag_size: 89905
batch 39, loss: 0.2130, instance_loss: 0.2170, weighted_loss: 0.2142, label: 1, bag_size: 58270


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.4015957446808511: correct 151/376
Epoch: 50, train_loss: 0.4880, train_clustering_loss:  0.3572, train_error: 0.1702
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.5552, val_error: 0.6364, auc: 0.6597
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.1148, instance_loss: 0.1931, weighted_loss: 0.1383, label: 2, bag_size: 54449
batch 39, loss: 0.5143, instance_loss: 0.3696, weighted_loss: 0.4709, label: 3, bag_size: 152150


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.24468085106382978: correct 92/376
Epoch: 51, train_loss: 0.6012, train_clustering_loss:  0.4228, train_error: 0.1489
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.5958, val_error: 0.6364, auc: 0.6424
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20
Early stopping
Val error: 0.6364, ROC AUC: 0.7326
Test error: 0.5455, ROC AUC: 0.6042
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3

Training Fold 3!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.9415, instance_loss: 1.0954, weighted_loss: 1.6877, label: 1, bag_size: 132271
batch 39, loss: 1.9465, instance_loss: 0.9322, weighted_loss: 1.6422, label: 1, bag_size: 18329


class 0 clustering acc 0.956781914893617: correct 1439/1504
class 1 clustering acc 0.05851063829787234: correct 22/376
Epoch: 0, train_loss: 1.4354, train_clustering_loss:  1.0327, train_error: 0.7234
class 0: acc 0.0, correct 0/11
class 1: acc 0.0, correct 0/10
class 2: acc 1.0, correct 13/13
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.4238, val_error: 0.7273, auc: 0.4410
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.423832).  Saving model ...


batch 19, loss: 1.3601, instance_loss: 0.8300, weighted_loss: 1.2011, label: 2, bag_size: 89905
batch 39, loss: 1.2306, instance_loss: 0.6924, weighted_loss: 1.0691, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3843, train_clustering_loss:  0.7945, train_error: 0.7021
class 0: acc 0.0, correct 0/5
class 1: acc 0.125, correct 2/16
class 2: acc 0.07692307692307693, correct 1/13
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.4481, val_error: 0.7273, auc: 0.4097
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4121, instance_loss: 0.6645, weighted_loss: 1.1878, label: 2, bag_size: 118767
batch 39, loss: 1.0917, instance_loss: 0.6155, weighted_loss: 0.9489, label: 2, bag_size: 54449


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3944, train_clustering_loss:  0.6521, train_error: 0.6809
class 0: acc 0.0, correct 0/10
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.2857142857142857, correct 4/14
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4403, val_error: 0.8182, auc: 0.5000
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1194, instance_loss: 0.5563, weighted_loss: 0.9505, label: 1, bag_size: 49894
batch 39, loss: 1.1990, instance_loss: 0.5914, weighted_loss: 1.0167, label: 3, bag_size: 17590


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3667, train_clustering_loss:  0.6123, train_error: 0.7021
class 0: acc 0.0, correct 0/8
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.16666666666666666, correct 2/12
class 3: acc 0.2857142857142857, correct 4/14

Val Set, val_loss: 1.4057, val_error: 0.7273, auc: 0.5104
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.423832 --> 1.405734).  Saving model ...


batch 19, loss: 1.3128, instance_loss: 0.6089, weighted_loss: 1.1017, label: 2, bag_size: 64035
batch 39, loss: 1.4035, instance_loss: 0.5806, weighted_loss: 1.1567, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.4176, train_clustering_loss:  0.6111, train_error: 0.7872
class 0: acc 0.15384615384615385, correct 2/13
class 1: acc 0.0, correct 0/14
class 2: acc 0.5, correct 6/12
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.4086, val_error: 0.8182, auc: 0.5486
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5831, instance_loss: 0.6258, weighted_loss: 1.2959, label: 0, bag_size: 18551
batch 39, loss: 1.4291, instance_loss: 0.6280, weighted_loss: 1.1887, label: 0, bag_size: 46742


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3796, train_clustering_loss:  0.6054, train_error: 0.6596
class 0: acc 0.0, correct 0/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.7, correct 7/10
class 3: acc 0.0, correct 0/14

Val Set, val_loss: 1.3701, val_error: 0.7273, auc: 0.5556
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.405734 --> 1.370090).  Saving model ...


batch 19, loss: 1.8168, instance_loss: 0.6302, weighted_loss: 1.4608, label: 2, bag_size: 64035
batch 39, loss: 1.3043, instance_loss: 0.6027, weighted_loss: 1.0938, label: 2, bag_size: 89905


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.4003, train_clustering_loss:  0.6097, train_error: 0.7447
class 0: acc 0.0, correct 0/12
class 1: acc 0.23076923076923078, correct 3/13
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3926, val_error: 0.7273, auc: 0.5694
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2067, instance_loss: 0.5999, weighted_loss: 1.0246, label: 1, bag_size: 49894
batch 39, loss: 0.9793, instance_loss: 0.5925, weighted_loss: 0.8632, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3097, train_clustering_loss:  0.6010, train_error: 0.6596
class 0: acc 0.16666666666666666, correct 2/12
class 1: acc 0.8, correct 12/15
class 2: acc 0.2, correct 2/10
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3786, val_error: 0.7273, auc: 0.6215
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1852, instance_loss: 0.5864, weighted_loss: 1.0055, label: 2, bag_size: 158432
batch 39, loss: 1.2054, instance_loss: 0.5903, weighted_loss: 1.0209, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2947, train_clustering_loss:  0.5990, train_error: 0.5319
class 0: acc 0.5, correct 6/12
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4079, val_error: 0.8182, auc: 0.5694
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3429, instance_loss: 0.6483, weighted_loss: 1.1345, label: 3, bag_size: 48518
batch 39, loss: 1.6032, instance_loss: 0.6066, weighted_loss: 1.3042, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2727, train_clustering_loss:  0.5984, train_error: 0.6809
class 0: acc 0.25, correct 3/12
class 1: acc 0.1, correct 1/10
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.3726, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8872, instance_loss: 0.5120, weighted_loss: 0.7747, label: 2, bag_size: 89905
batch 39, loss: 1.4325, instance_loss: 0.6488, weighted_loss: 1.1974, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2764, train_clustering_loss:  0.5896, train_error: 0.6383
class 0: acc 0.2, correct 2/10
class 1: acc 0.1, correct 1/10
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.4239, val_error: 0.8182, auc: 0.5243
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.1124, instance_loss: 0.6194, weighted_loss: 0.9645, label: 1, bag_size: 23122
batch 39, loss: 1.0167, instance_loss: 0.6055, weighted_loss: 0.8934, label: 3, bag_size: 24102


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.3321, train_clustering_loss:  0.6062, train_error: 0.6170
class 0: acc 0.21428571428571427, correct 3/14
class 1: acc 0.42857142857142855, correct 6/14
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.3589, val_error: 0.6364, auc: 0.6215
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.370090 --> 1.358913).  Saving model ...


batch 19, loss: 1.5419, instance_loss: 0.5948, weighted_loss: 1.2577, label: 2, bag_size: 9530
batch 39, loss: 1.1201, instance_loss: 0.5566, weighted_loss: 0.9510, label: 2, bag_size: 64035


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.3208, train_clustering_loss:  0.6042, train_error: 0.6383
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.3, correct 3/10
class 3: acc 0.16666666666666666, correct 2/12

Val Set, val_loss: 1.3480, val_error: 0.6364, auc: 0.6215
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.358913 --> 1.348031).  Saving model ...


batch 19, loss: 1.2917, instance_loss: 0.5877, weighted_loss: 1.0805, label: 2, bag_size: 118767
batch 39, loss: 0.9856, instance_loss: 0.5374, weighted_loss: 0.8512, label: 2, bag_size: 64035


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2955, train_clustering_loss:  0.5990, train_error: 0.6170
class 0: acc 0.0, correct 0/11
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.35714285714285715, correct 5/14
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.3725, val_error: 0.7273, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5798, instance_loss: 0.6249, weighted_loss: 1.2933, label: 1, bag_size: 49894
batch 39, loss: 1.3475, instance_loss: 0.6140, weighted_loss: 1.1275, label: 3, bag_size: 98956


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.2263, train_clustering_loss:  0.5863, train_error: 0.5957
class 0: acc 0.1, correct 1/10
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.75, correct 12/16
class 3: acc 0.3333333333333333, correct 4/12

Val Set, val_loss: 1.3512, val_error: 0.8182, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.5127, instance_loss: 0.6017, weighted_loss: 1.2394, label: 3, bag_size: 16626
batch 39, loss: 1.1456, instance_loss: 0.6032, weighted_loss: 0.9829, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.1870, train_clustering_loss:  0.5921, train_error: 0.4255
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.7368421052631579, correct 14/19

Val Set, val_loss: 1.4178, val_error: 0.7273, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.1117, instance_loss: 0.5617, weighted_loss: 0.9467, label: 2, bag_size: 64035
batch 39, loss: 0.9087, instance_loss: 0.5004, weighted_loss: 0.7862, label: 2, bag_size: 158432


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.2857, train_clustering_loss:  0.5948, train_error: 0.6596
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/10
class 2: acc 0.4375, correct 7/16
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.4248, val_error: 0.8182, auc: 0.6076
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8824, instance_loss: 0.5054, weighted_loss: 0.7693, label: 2, bag_size: 44015
batch 39, loss: 1.2531, instance_loss: 0.6384, weighted_loss: 1.0687, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.1507, train_clustering_loss:  0.5892, train_error: 0.5106
class 0: acc 0.4375, correct 7/16
class 1: acc 0.3, correct 3/10
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.0, correct 0/6

Val Set, val_loss: 1.4051, val_error: 0.8182, auc: 0.6181
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.7135, instance_loss: 0.6467, weighted_loss: 1.3935, label: 3, bag_size: 98956
batch 39, loss: 0.8931, instance_loss: 0.5167, weighted_loss: 0.7802, label: 2, bag_size: 44015


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 1.2393, train_clustering_loss:  0.5864, train_error: 0.4894
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.23076923076923078, correct 3/13
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3407, val_error: 0.6364, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.348031 --> 1.340713).  Saving model ...


batch 19, loss: 0.7949, instance_loss: 0.5649, weighted_loss: 0.7259, label: 1, bag_size: 36943
batch 39, loss: 1.3297, instance_loss: 0.5868, weighted_loss: 1.1068, label: 2, bag_size: 75088


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 1.1440, train_clustering_loss:  0.5805, train_error: 0.5106
class 0: acc 0.5294117647058824, correct 9/17
class 1: acc 0.6, correct 6/10
class 2: acc 0.6, correct 6/10
class 3: acc 0.2, correct 2/10

Val Set, val_loss: 1.3531, val_error: 0.5455, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4973, instance_loss: 0.4878, weighted_loss: 0.4945, label: 0, bag_size: 41829
batch 39, loss: 2.2797, instance_loss: 0.7749, weighted_loss: 1.8283, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 1.0600, train_clustering_loss:  0.5710, train_error: 0.3404
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 0.8888888888888888, correct 16/18

Val Set, val_loss: 1.3322, val_error: 0.5455, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.340713 --> 1.332166).  Saving model ...


batch 19, loss: 2.1470, instance_loss: 0.7286, weighted_loss: 1.7215, label: 2, bag_size: 113492
batch 39, loss: 0.6342, instance_loss: 0.4865, weighted_loss: 0.5899, label: 3, bag_size: 48518


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 1.0279, train_clustering_loss:  0.5560, train_error: 0.3404
class 0: acc 0.125, correct 1/8
class 1: acc 0.95, correct 19/20
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.3239, val_error: 0.4545, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.332166 --> 1.323940).  Saving model ...


batch 19, loss: 1.4754, instance_loss: 0.6359, weighted_loss: 1.2235, label: 2, bag_size: 9530
batch 39, loss: 0.4309, instance_loss: 0.5493, weighted_loss: 0.4664, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 22, train_loss: 1.0643, train_clustering_loss:  0.5645, train_error: 0.3404
class 0: acc 0.2857142857142857, correct 4/14
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.5, correct 4/8
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.3081, val_error: 0.5455, auc: 0.6910
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.323940 --> 1.308143).  Saving model ...


batch 19, loss: 1.0833, instance_loss: 0.5542, weighted_loss: 0.9246, label: 2, bag_size: 9530
batch 39, loss: 1.8953, instance_loss: 0.6217, weighted_loss: 1.5132, label: 1, bag_size: 112135


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 1.1834, train_clustering_loss:  0.5807, train_error: 0.4468
class 0: acc 0.8, correct 12/15
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.5, correct 6/12
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.4589, val_error: 0.8182, auc: 0.5556
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5548, instance_loss: 0.4400, weighted_loss: 0.5203, label: 2, bag_size: 64035
batch 39, loss: 0.8710, instance_loss: 0.5565, weighted_loss: 0.7766, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 0.9512, train_clustering_loss:  0.5408, train_error: 0.3617
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.6153846153846154, correct 8/13
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.4175, val_error: 0.7273, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2449, instance_loss: 0.5933, weighted_loss: 1.0494, label: 1, bag_size: 23122
batch 39, loss: 0.7064, instance_loss: 0.5126, weighted_loss: 0.6483, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 25, train_loss: 1.0296, train_clustering_loss:  0.5400, train_error: 0.4043
class 0: acc 0.5, correct 7/14
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.3832, val_error: 0.9091, auc: 0.5938
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3639, instance_loss: 0.5872, weighted_loss: 1.1309, label: 1, bag_size: 18329
batch 39, loss: 0.5048, instance_loss: 0.5039, weighted_loss: 0.5046, label: 1, bag_size: 47433


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 26, train_loss: 1.0993, train_clustering_loss:  0.5672, train_error: 0.4681
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.23076923076923078, correct 3/13
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.3019, val_error: 0.7273, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.308143 --> 1.301887).  Saving model ...


batch 19, loss: 1.5052, instance_loss: 0.5972, weighted_loss: 1.2328, label: 2, bag_size: 54449
batch 39, loss: 1.0379, instance_loss: 0.5952, weighted_loss: 0.9051, label: 3, bag_size: 152150


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 27, train_loss: 1.0138, train_clustering_loss:  0.5487, train_error: 0.4468
class 0: acc 0.25, correct 3/12
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.36363636363636365, correct 4/11

Val Set, val_loss: 1.3378, val_error: 0.6364, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2292, instance_loss: 0.5941, weighted_loss: 1.0386, label: 0, bag_size: 19277
batch 39, loss: 0.6510, instance_loss: 0.5419, weighted_loss: 0.6183, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 28, train_loss: 0.9541, train_clustering_loss:  0.5380, train_error: 0.3617
class 0: acc 0.7, correct 7/10
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.75, correct 12/16
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.2752, val_error: 0.5455, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.301887 --> 1.275169).  Saving model ...


batch 19, loss: 0.3750, instance_loss: 0.3791, weighted_loss: 0.3762, label: 2, bag_size: 75088
batch 39, loss: 0.6299, instance_loss: 0.4947, weighted_loss: 0.5893, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 29, train_loss: 0.9829, train_clustering_loss:  0.5320, train_error: 0.3617
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.7647058823529411, correct 13/17
class 2: acc 0.7, correct 7/10
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.3632, val_error: 0.5455, auc: 0.6319
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4658, instance_loss: 0.3895, weighted_loss: 0.4429, label: 2, bag_size: 118767
batch 39, loss: 1.1458, instance_loss: 0.5192, weighted_loss: 0.9578, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 30, train_loss: 0.8417, train_clustering_loss:  0.5111, train_error: 0.3830
class 0: acc 0.4375, correct 7/16
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.4032, val_error: 0.8182, auc: 0.6111
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.4188, instance_loss: 0.7574, weighted_loss: 1.9204, label: 1, bag_size: 58270
batch 39, loss: 0.8261, instance_loss: 0.5069, weighted_loss: 0.7304, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 31, train_loss: 0.8347, train_clustering_loss:  0.4998, train_error: 0.3404
class 0: acc 0.8, correct 12/15
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.2411, val_error: 0.5455, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.275169 --> 1.241088).  Saving model ...


batch 19, loss: 0.2779, instance_loss: 0.4293, weighted_loss: 0.3233, label: 3, bag_size: 152150
batch 39, loss: 0.7426, instance_loss: 0.5014, weighted_loss: 0.6702, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 32, train_loss: 0.7172, train_clustering_loss:  0.4866, train_error: 0.1702
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.8, correct 8/10
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.2806, val_error: 0.6364, auc: 0.6736
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3582, instance_loss: 0.4246, weighted_loss: 0.3781, label: 1, bag_size: 36943
batch 39, loss: 0.1617, instance_loss: 0.3276, weighted_loss: 0.2115, label: 3, bag_size: 24102


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 33, train_loss: 0.7345, train_clustering_loss:  0.4738, train_error: 0.2766
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.75, correct 9/12
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.3978, val_error: 0.6364, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2263, instance_loss: 0.3321, weighted_loss: 0.2580, label: 3, bag_size: 22057
batch 39, loss: 1.0684, instance_loss: 0.5154, weighted_loss: 0.9025, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.010638297872340425: correct 4/376
Epoch: 34, train_loss: 0.6745, train_clustering_loss:  0.4632, train_error: 0.2340
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 1.0, correct 12/12
class 2: acc 0.5, correct 5/10
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.1246, val_error: 0.5455, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.241088 --> 1.124592).  Saving model ...


batch 19, loss: 0.4535, instance_loss: 0.3705, weighted_loss: 0.4286, label: 3, bag_size: 22057
batch 39, loss: 0.1889, instance_loss: 0.3699, weighted_loss: 0.2432, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.023936170212765957: correct 9/376
Epoch: 35, train_loss: 0.6267, train_clustering_loss:  0.4534, train_error: 0.1702
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.9, correct 9/10
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.5438, val_error: 0.7273, auc: 0.6354
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3588, instance_loss: 0.3737, weighted_loss: 0.3633, label: 1, bag_size: 20030
batch 39, loss: 0.8599, instance_loss: 0.5387, weighted_loss: 0.7635, label: 2, bag_size: 99232


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.05319148936170213: correct 20/376
Epoch: 36, train_loss: 0.5577, train_clustering_loss:  0.4346, train_error: 0.1277
class 0: acc 0.8, correct 8/10
class 1: acc 0.9375, correct 15/16
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.5494, val_error: 0.6364, auc: 0.6111
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5424, instance_loss: 0.4350, weighted_loss: 0.5102, label: 1, bag_size: 20030
batch 39, loss: 0.5603, instance_loss: 0.3947, weighted_loss: 0.5106, label: 3, bag_size: 48518


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.08244680851063829: correct 31/376
Epoch: 37, train_loss: 0.6443, train_clustering_loss:  0.4439, train_error: 0.2128
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.6666666666666666, correct 4/6

Val Set, val_loss: 1.5093, val_error: 0.7273, auc: 0.6875
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4151, instance_loss: 0.4096, weighted_loss: 0.4135, label: 3, bag_size: 16626
batch 39, loss: 0.1366, instance_loss: 0.2433, weighted_loss: 0.1686, label: 2, bag_size: 118767


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.09574468085106383: correct 36/376
Epoch: 38, train_loss: 0.6577, train_clustering_loss:  0.4358, train_error: 0.1915
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.9375, correct 15/16
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.3494, val_error: 0.4545, auc: 0.6806
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2144, instance_loss: 0.3139, weighted_loss: 0.2442, label: 3, bag_size: 152150
batch 39, loss: 0.0870, instance_loss: 0.1963, weighted_loss: 0.1198, label: 0, bag_size: 130978


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.1276595744680851: correct 48/376
Epoch: 39, train_loss: 0.6261, train_clustering_loss:  0.4258, train_error: 0.1702
class 0: acc 0.6470588235294118, correct 11/17
class 1: acc 1.0, correct 14/14
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.9109, val_error: 0.9091, auc: 0.6076
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.1205, instance_loss: 0.5114, weighted_loss: 0.9378, label: 1, bag_size: 132271
batch 39, loss: 0.5103, instance_loss: 0.5022, weighted_loss: 0.5078, label: 2, bag_size: 118767


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.05851063829787234: correct 22/376
Epoch: 40, train_loss: 0.7128, train_clustering_loss:  0.4616, train_error: 0.2766
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.75, correct 9/12
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.4696, val_error: 0.6364, auc: 0.6840
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0351, instance_loss: 0.1220, weighted_loss: 0.0611, label: 0, bag_size: 114704
batch 39, loss: 0.5392, instance_loss: 0.4058, weighted_loss: 0.4992, label: 2, bag_size: 9530


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.13297872340425532: correct 50/376
Epoch: 41, train_loss: 0.6474, train_clustering_loss:  0.4227, train_error: 0.1702
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.9, correct 9/10
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.1331, val_error: 0.4545, auc: 0.7604
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.1281, instance_loss: 0.2503, weighted_loss: 0.1648, label: 3, bag_size: 22057
batch 39, loss: 0.1348, instance_loss: 0.2240, weighted_loss: 0.1615, label: 3, bag_size: 22057


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.26595744680851063: correct 100/376
Epoch: 42, train_loss: 0.3961, train_clustering_loss:  0.3465, train_error: 0.0851
class 0: acc 1.0, correct 9/9
class 1: acc 0.6, correct 6/10
class 2: acc 1.0, correct 14/14
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.7038, val_error: 0.7273, auc: 0.6493
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1682, instance_loss: 0.2366, weighted_loss: 0.1887, label: 1, bag_size: 104549
batch 39, loss: 0.0590, instance_loss: 0.1746, weighted_loss: 0.0937, label: 3, bag_size: 24102


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.2978723404255319: correct 112/376
Epoch: 43, train_loss: 0.4450, train_clustering_loss:  0.3687, train_error: 0.1277
class 0: acc 0.5, correct 4/8
class 1: acc 1.0, correct 15/15
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.8235, val_error: 0.6364, auc: 0.6146
class 0 clustering acc 0.9034090909090909: correct 318/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.2577, instance_loss: 0.9012, weighted_loss: 1.1507, label: 0, bag_size: 56348
batch 39, loss: 0.2171, instance_loss: 0.2594, weighted_loss: 0.2297, label: 1, bag_size: 49894


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.21010638297872342: correct 79/376
Epoch: 44, train_loss: 0.6115, train_clustering_loss:  0.4261, train_error: 0.1915
class 0: acc 0.6, correct 6/10
class 1: acc 1.0, correct 17/17
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.8233, val_error: 0.6364, auc: 0.6111
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.5351, instance_loss: 0.3367, weighted_loss: 0.4756, label: 1, bag_size: 23122
batch 39, loss: 0.3588, instance_loss: 0.4778, weighted_loss: 0.3945, label: 0, bag_size: 6353


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.27393617021276595: correct 103/376
Epoch: 45, train_loss: 0.4897, train_clustering_loss:  0.3893, train_error: 0.1489
class 0: acc 0.6470588235294118, correct 11/17
class 1: acc 1.0, correct 13/13
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.2467, val_error: 0.4545, auc: 0.7292
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.5406, instance_loss: 0.3900, weighted_loss: 0.4954, label: 1, bag_size: 47433
batch 39, loss: 0.0811, instance_loss: 0.2373, weighted_loss: 0.1279, label: 3, bag_size: 152150


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.19946808510638298: correct 75/376
Epoch: 46, train_loss: 0.6260, train_clustering_loss:  0.4315, train_error: 0.2340
class 0: acc 0.5, correct 6/12
class 1: acc 0.75, correct 9/12
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.2264, val_error: 0.4545, auc: 0.6701
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1327, instance_loss: 0.1992, weighted_loss: 0.1527, label: 2, bag_size: 89905
batch 39, loss: 0.7807, instance_loss: 0.5404, weighted_loss: 0.7086, label: 1, bag_size: 112135


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.25: correct 94/376
Epoch: 47, train_loss: 0.4656, train_clustering_loss:  0.3782, train_error: 0.1064
class 0: acc 0.8125, correct 13/16
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 8/8
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.6489, val_error: 0.7273, auc: 0.6389
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.8085, instance_loss: 0.9004, weighted_loss: 1.5361, label: 2, bag_size: 158432
batch 39, loss: 0.7740, instance_loss: 0.5545, weighted_loss: 0.7082, label: 1, bag_size: 58270


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.3882978723404255: correct 146/376
Epoch: 48, train_loss: 0.4238, train_clustering_loss:  0.3491, train_error: 0.1064
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.6635, val_error: 0.6364, auc: 0.6806
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0928, instance_loss: 0.1830, weighted_loss: 0.1198, label: 0, bag_size: 130978
batch 39, loss: 0.0432, instance_loss: 0.1231, weighted_loss: 0.0671, label: 0, bag_size: 41829


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.38563829787234044: correct 145/376
Epoch: 49, train_loss: 0.5086, train_clustering_loss:  0.3790, train_error: 0.1915
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.875, correct 14/16

Val Set, val_loss: 1.8580, val_error: 0.7273, auc: 0.6285
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.2698, instance_loss: 0.5354, weighted_loss: 0.3495, label: 2, bag_size: 9530
batch 39, loss: 0.4049, instance_loss: 0.3784, weighted_loss: 0.3970, label: 1, bag_size: 18329


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.2978723404255319: correct 112/376
Epoch: 50, train_loss: 0.4451, train_clustering_loss:  0.3749, train_error: 0.0851
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.5500, val_error: 0.4545, auc: 0.6701
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.25: correct 22/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.3614, instance_loss: 0.4353, weighted_loss: 0.3836, label: 2, bag_size: 54449
batch 39, loss: 0.3023, instance_loss: 0.3829, weighted_loss: 0.3265, label: 2, bag_size: 113492


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.4228723404255319: correct 159/376
Epoch: 51, train_loss: 0.3954, train_clustering_loss:  0.3393, train_error: 0.0851
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 1.0, correct 8/8
class 2: acc 1.0, correct 9/9
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.4933, val_error: 0.5455, auc: 0.6944
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1679, instance_loss: 0.2042, weighted_loss: 0.1788, label: 1, bag_size: 36943
batch 39, loss: 0.3377, instance_loss: 0.4543, weighted_loss: 0.3727, label: 2, bag_size: 118767


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.425531914893617: correct 160/376
Epoch: 52, train_loss: 0.4149, train_clustering_loss:  0.3431, train_error: 0.0851
class 0: acc 0.8421052631578947, correct 16/19
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 7/7
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.7521, val_error: 0.7273, auc: 0.6493
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0892, instance_loss: 0.2132, weighted_loss: 0.1264, label: 3, bag_size: 48624
batch 39, loss: 0.2129, instance_loss: 0.1982, weighted_loss: 0.2085, label: 3, bag_size: 16626


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.4946808510638298: correct 186/376
Epoch: 53, train_loss: 0.3904, train_clustering_loss:  0.3178, train_error: 0.1277
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 1.0, correct 8/8
class 2: acc 0.8, correct 8/10
class 3: acc 1.0, correct 18/18

Val Set, val_loss: 1.6135, val_error: 0.6364, auc: 0.6424
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2897, instance_loss: 0.2890, weighted_loss: 0.2895, label: 1, bag_size: 20030
batch 39, loss: 0.3134, instance_loss: 0.3069, weighted_loss: 0.3114, label: 2, bag_size: 44015


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.39361702127659576: correct 148/376
Epoch: 54, train_loss: 0.4001, train_clustering_loss:  0.3504, train_error: 0.0638
class 0: acc 0.9411764705882353, correct 16/17
class 1: acc 0.9, correct 9/10
class 2: acc 1.0, correct 8/8
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.9553, val_error: 0.7273, auc: 0.6354
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.5455, ROC AUC: 0.7083
Test error: 0.4545, ROC AUC: 0.8299
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3

Training Fold 4!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.1472, instance_loss: 1.0112, weighted_loss: 1.1064, label: 2, bag_size: 113492
batch 39, loss: 2.2891, instance_loss: 0.9132, weighted_loss: 1.8764, label: 1, bag_size: 81420


class 0 clustering acc 0.9594414893617021: correct 1443/1504
class 1 clustering acc 0.06648936170212766: correct 25/376
Epoch: 0, train_loss: 1.4354, train_clustering_loss:  1.0092, train_error: 0.6809
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/9
class 2: acc 0.5333333333333333, correct 8/15
class 3: acc 0.5, correct 7/14

Val Set, val_loss: 1.4800, val_error: 0.8182, auc: 0.5903
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.480037).  Saving model ...


batch 19, loss: 1.0861, instance_loss: 0.8182, weighted_loss: 1.0057, label: 2, bag_size: 9530
batch 39, loss: 1.2011, instance_loss: 0.7181, weighted_loss: 1.0562, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3827, train_clustering_loss:  0.7909, train_error: 0.6809
class 0: acc 0.0, correct 0/5
class 1: acc 0.25, correct 4/16
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.4289, val_error: 0.7273, auc: 0.6007
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.480037 --> 1.428941).  Saving model ...


batch 19, loss: 1.0367, instance_loss: 0.5954, weighted_loss: 0.9043, label: 3, bag_size: 17590
batch 39, loss: 1.4338, instance_loss: 0.6369, weighted_loss: 1.1948, label: 2, bag_size: 54449


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.4092, train_clustering_loss:  0.6429, train_error: 0.7021
class 0: acc 0.0, correct 0/10
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.5, correct 7/14

Val Set, val_loss: 1.3988, val_error: 0.7273, auc: 0.6389
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.428941 --> 1.398797).  Saving model ...


batch 19, loss: 1.6336, instance_loss: 0.6602, weighted_loss: 1.3416, label: 0, bag_size: 6353
batch 39, loss: 1.5245, instance_loss: 0.6297, weighted_loss: 1.2561, label: 2, bag_size: 69807


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3796, train_clustering_loss:  0.6168, train_error: 0.6596
class 0: acc 0.0, correct 0/13
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.1111111111111111, correct 1/9
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.3556, val_error: 0.7273, auc: 0.7326
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.398797 --> 1.355634).  Saving model ...


batch 19, loss: 1.1161, instance_loss: 0.5937, weighted_loss: 0.9594, label: 2, bag_size: 89905
batch 39, loss: 1.4594, instance_loss: 0.5881, weighted_loss: 1.1980, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.4132, train_clustering_loss:  0.6040, train_error: 0.7660
class 0: acc 0.4, correct 4/10
class 1: acc 0.0, correct 0/13
class 2: acc 0.2727272727272727, correct 3/11
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.3606, val_error: 0.7273, auc: 0.7326
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2137, instance_loss: 0.6068, weighted_loss: 1.0316, label: 1, bag_size: 36943
batch 39, loss: 1.6959, instance_loss: 0.6094, weighted_loss: 1.3700, label: 2, bag_size: 22416


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3639, train_clustering_loss:  0.6000, train_error: 0.7234
class 0: acc 0.0, correct 0/12
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.3444, val_error: 0.5455, auc: 0.6910
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.355634 --> 1.344409).  Saving model ...


batch 19, loss: 1.6586, instance_loss: 0.6285, weighted_loss: 1.3496, label: 2, bag_size: 89905
batch 39, loss: 1.4915, instance_loss: 0.6288, weighted_loss: 1.2327, label: 2, bag_size: 89905


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3437, train_clustering_loss:  0.5945, train_error: 0.7021
class 0: acc 0.3333333333333333, correct 5/15
class 1: acc 0.09090909090909091, correct 1/11
class 2: acc 0.0, correct 0/10
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3466, val_error: 0.7273, auc: 0.7187
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0098, instance_loss: 0.5370, weighted_loss: 0.8680, label: 0, bag_size: 6353
batch 39, loss: 1.1214, instance_loss: 0.6006, weighted_loss: 0.9652, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2621, train_clustering_loss:  0.5869, train_error: 0.5319
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.3076923076923077, correct 4/13
class 2: acc 0.1, correct 1/10
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.3514, val_error: 0.6364, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1372, instance_loss: 0.5787, weighted_loss: 0.9697, label: 2, bag_size: 158432
batch 39, loss: 1.1810, instance_loss: 0.5661, weighted_loss: 0.9966, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2876, train_clustering_loss:  0.6035, train_error: 0.5106
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.4128, val_error: 0.8182, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7273, instance_loss: 0.5386, weighted_loss: 0.6707, label: 3, bag_size: 77542
batch 39, loss: 1.5726, instance_loss: 0.6351, weighted_loss: 1.2913, label: 1, bag_size: 81420


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2568, train_clustering_loss:  0.5969, train_error: 0.5745
class 0: acc 0.0, correct 0/10
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 1.0, correct 14/14
class 3: acc 0.36363636363636365, correct 4/11

Val Set, val_loss: 1.3385, val_error: 0.7273, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.344409 --> 1.338525).  Saving model ...


batch 19, loss: 1.0542, instance_loss: 0.5691, weighted_loss: 0.9087, label: 2, bag_size: 9530
batch 39, loss: 1.2705, instance_loss: 0.5968, weighted_loss: 1.0684, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2742, train_clustering_loss:  0.5906, train_error: 0.5957
class 0: acc 0.0, correct 0/10
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.7894736842105263, correct 15/19
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.4413, val_error: 0.8182, auc: 0.6458
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0482, instance_loss: 0.5754, weighted_loss: 0.9063, label: 1, bag_size: 23122
batch 39, loss: 1.6230, instance_loss: 0.6785, weighted_loss: 1.3396, label: 3, bag_size: 48518


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2532, train_clustering_loss:  0.5951, train_error: 0.5957
class 0: acc 0.2857142857142857, correct 4/14
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.45454545454545453, correct 5/11
class 3: acc 0.2857142857142857, correct 2/7

Val Set, val_loss: 1.3238, val_error: 0.7273, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.338525 --> 1.323762).  Saving model ...


batch 19, loss: 1.3883, instance_loss: 0.5759, weighted_loss: 1.1446, label: 2, bag_size: 9530
batch 39, loss: 1.0471, instance_loss: 0.5500, weighted_loss: 0.8980, label: 2, bag_size: 64035


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2663, train_clustering_loss:  0.5969, train_error: 0.5319
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.3333333333333333, correct 4/12
class 3: acc 0.25, correct 3/12

Val Set, val_loss: 1.3061, val_error: 0.5455, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.323762 --> 1.306123).  Saving model ...


batch 19, loss: 0.7271, instance_loss: 0.5628, weighted_loss: 0.6778, label: 3, bag_size: 17590
batch 39, loss: 1.1695, instance_loss: 0.5439, weighted_loss: 0.9818, label: 2, bag_size: 89905


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2234, train_clustering_loss:  0.5858, train_error: 0.5319
class 0: acc 0.1111111111111111, correct 1/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.35714285714285715, correct 5/14
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.2981, val_error: 0.6364, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.306123 --> 1.298126).  Saving model ...


batch 19, loss: 1.5166, instance_loss: 0.6351, weighted_loss: 1.2521, label: 0, bag_size: 6353
batch 39, loss: 1.3560, instance_loss: 0.5785, weighted_loss: 1.1227, label: 2, bag_size: 7532


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.2178, train_clustering_loss:  0.5813, train_error: 0.5532
class 0: acc 0.1, correct 1/10
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.6, correct 9/15
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.2694, val_error: 0.8182, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.298126 --> 1.269445).  Saving model ...


batch 19, loss: 1.3739, instance_loss: 0.6051, weighted_loss: 1.1432, label: 0, bag_size: 22124
batch 39, loss: 1.4139, instance_loss: 0.5901, weighted_loss: 1.1667, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.1243, train_clustering_loss:  0.5754, train_error: 0.4894
class 0: acc 0.21428571428571427, correct 3/14
class 1: acc 0.7, correct 7/10
class 2: acc 0.14285714285714285, correct 1/7
class 3: acc 0.8125, correct 13/16

Val Set, val_loss: 1.2301, val_error: 0.5455, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.269445 --> 1.230050).  Saving model ...


batch 19, loss: 0.9132, instance_loss: 0.5531, weighted_loss: 0.8052, label: 2, bag_size: 89905
batch 39, loss: 0.8717, instance_loss: 0.5699, weighted_loss: 0.7812, label: 2, bag_size: 158432


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.0772, train_clustering_loss:  0.5644, train_error: 0.4255
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.375, correct 3/8
class 2: acc 0.5555555555555556, correct 10/18
class 3: acc 0.6666666666666666, correct 10/15

Val Set, val_loss: 1.3010, val_error: 0.6364, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2240, instance_loss: 0.3806, weighted_loss: 0.2709, label: 3, bag_size: 42569
batch 39, loss: 1.0532, instance_loss: 0.6283, weighted_loss: 0.9257, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.0675, train_clustering_loss:  0.5676, train_error: 0.3404
class 0: acc 0.3333333333333333, correct 5/15
class 1: acc 0.625, correct 5/8
class 2: acc 1.0, correct 14/14
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.2176, val_error: 0.5455, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.230050 --> 1.217554).  Saving model ...


batch 19, loss: 1.1961, instance_loss: 0.5691, weighted_loss: 1.0080, label: 2, bag_size: 7532
batch 39, loss: 0.9646, instance_loss: 0.5293, weighted_loss: 0.8340, label: 3, bag_size: 24102


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.9926, train_clustering_loss:  0.5530, train_error: 0.4043
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.42857142857142855, correct 3/7
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.2123, val_error: 0.6364, auc: 0.7639
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.217554 --> 1.212271).  Saving model ...


batch 19, loss: 0.5301, instance_loss: 0.4875, weighted_loss: 0.5173, label: 1, bag_size: 36943
batch 39, loss: 1.5935, instance_loss: 0.6300, weighted_loss: 1.3045, label: 2, bag_size: 118767


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 1.0952, train_clustering_loss:  0.5708, train_error: 0.4681
class 0: acc 0.7058823529411765, correct 12/17
class 1: acc 0.6, correct 6/10
class 2: acc 0.2727272727272727, correct 3/11
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.1709, val_error: 0.5455, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.212271 --> 1.170898).  Saving model ...


batch 19, loss: 2.1081, instance_loss: 0.6741, weighted_loss: 1.6779, label: 0, bag_size: 108548
batch 39, loss: 1.3320, instance_loss: 0.6074, weighted_loss: 1.1146, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 1.1029, train_clustering_loss:  0.5619, train_error: 0.4255
class 0: acc 0.5, correct 4/8
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.1772, val_error: 0.6364, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.7241, instance_loss: 0.6062, weighted_loss: 1.3887, label: 0, bag_size: 47775
batch 39, loss: 0.1742, instance_loss: 0.3784, weighted_loss: 0.2354, label: 3, bag_size: 77542


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 0.9007, train_clustering_loss:  0.5248, train_error: 0.2979
class 0: acc 0.1111111111111111, correct 1/9
class 1: acc 1.0, correct 20/20
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.6666666666666666, correct 4/6

Val Set, val_loss: 1.2868, val_error: 0.5455, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0502, instance_loss: 0.5514, weighted_loss: 0.9006, label: 2, bag_size: 9530
batch 39, loss: 0.9625, instance_loss: 0.5977, weighted_loss: 0.8531, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 22, train_loss: 0.9385, train_clustering_loss:  0.5373, train_error: 0.2553
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.1654, val_error: 0.6364, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.170898 --> 1.165434).  Saving model ...


batch 19, loss: 1.2813, instance_loss: 0.6079, weighted_loss: 1.0793, label: 3, bag_size: 24102
batch 39, loss: 0.6277, instance_loss: 0.4562, weighted_loss: 0.5762, label: 3, bag_size: 48624


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 1.0356, train_clustering_loss:  0.5548, train_error: 0.4043
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.5, correct 5/10
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 0.38461538461538464, correct 5/13

Val Set, val_loss: 1.0803, val_error: 0.4545, auc: 0.8021
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.165434 --> 1.080315).  Saving model ...


batch 19, loss: 0.7023, instance_loss: 0.5292, weighted_loss: 0.6504, label: 2, bag_size: 64035
batch 39, loss: 1.2056, instance_loss: 0.6170, weighted_loss: 1.0290, label: 1, bag_size: 23122


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 24, train_loss: 0.9760, train_clustering_loss:  0.5358, train_error: 0.3191
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.5, correct 5/10
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.1288, val_error: 0.4545, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6081, instance_loss: 0.6343, weighted_loss: 1.3159, label: 1, bag_size: 23122
batch 39, loss: 0.4608, instance_loss: 0.4491, weighted_loss: 0.4573, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.013297872340425532: correct 5/376
Epoch: 25, train_loss: 0.8747, train_clustering_loss:  0.5187, train_error: 0.2766
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.5, correct 5/10
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.4086, val_error: 0.5455, auc: 0.7361
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4754, instance_loss: 0.4434, weighted_loss: 0.4658, label: 1, bag_size: 81420
batch 39, loss: 0.5415, instance_loss: 0.4840, weighted_loss: 0.5243, label: 1, bag_size: 16373


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.013297872340425532: correct 5/376
Epoch: 26, train_loss: 0.9776, train_clustering_loss:  0.5154, train_error: 0.3830
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.0345, val_error: 0.4545, auc: 0.8611
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.080315 --> 1.034511).  Saving model ...


batch 19, loss: 1.5683, instance_loss: 0.6203, weighted_loss: 1.2839, label: 2, bag_size: 54449
batch 39, loss: 1.0788, instance_loss: 0.6349, weighted_loss: 0.9456, label: 3, bag_size: 4963


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 27, train_loss: 0.9486, train_clustering_loss:  0.5335, train_error: 0.3617
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.1411, val_error: 0.5455, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6087, instance_loss: 0.4499, weighted_loss: 0.5610, label: 0, bag_size: 65047
batch 39, loss: 0.7714, instance_loss: 0.5234, weighted_loss: 0.6970, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.09574468085106383: correct 36/376
Epoch: 28, train_loss: 0.7974, train_clustering_loss:  0.4818, train_error: 0.2553
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.4, correct 4/10
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.3454, val_error: 0.4545, auc: 0.7500
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3903, instance_loss: 0.4047, weighted_loss: 0.3946, label: 2, bag_size: 118767
batch 39, loss: 0.3034, instance_loss: 0.3222, weighted_loss: 0.3091, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.031914893617021274: correct 12/376
Epoch: 29, train_loss: 0.9010, train_clustering_loss:  0.4927, train_error: 0.2979
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.0251, val_error: 0.4545, auc: 0.8403
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.034511 --> 1.025087).  Saving model ...


batch 19, loss: 0.1783, instance_loss: 0.2807, weighted_loss: 0.2090, label: 3, bag_size: 17590
batch 39, loss: 1.1621, instance_loss: 0.5319, weighted_loss: 0.9730, label: 2, bag_size: 99232


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.08244680851063829: correct 31/376
Epoch: 30, train_loss: 0.6957, train_clustering_loss:  0.4683, train_error: 0.1489
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.8333333333333334, correct 5/6
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.0640, val_error: 0.6364, auc: 0.8715
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7987, instance_loss: 0.4975, weighted_loss: 0.7084, label: 1, bag_size: 58270
batch 39, loss: 0.3412, instance_loss: 0.3918, weighted_loss: 0.3564, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.11436170212765957: correct 43/376
Epoch: 31, train_loss: 0.7497, train_clustering_loss:  0.4597, train_error: 0.3617
class 0: acc 0.75, correct 6/8
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.2225, val_error: 0.4545, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8473, instance_loss: 0.5038, weighted_loss: 0.7442, label: 0, bag_size: 47775
batch 39, loss: 0.6635, instance_loss: 0.4717, weighted_loss: 0.6059, label: 3, bag_size: 152150


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.15425531914893617: correct 58/376
Epoch: 32, train_loss: 0.6259, train_clustering_loss:  0.4216, train_error: 0.1277
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 0.9975, val_error: 0.4545, auc: 0.8090
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.025087 --> 0.997499).  Saving model ...


batch 19, loss: 0.5341, instance_loss: 0.3846, weighted_loss: 0.4892, label: 1, bag_size: 23122
batch 39, loss: 0.0744, instance_loss: 0.1803, weighted_loss: 0.1062, label: 3, bag_size: 42569


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.09574468085106383: correct 36/376
Epoch: 33, train_loss: 0.7330, train_clustering_loss:  0.4505, train_error: 0.1915
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.2253, val_error: 0.5455, auc: 0.7951
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5672, instance_loss: 0.6918, weighted_loss: 1.3046, label: 3, bag_size: 4963
batch 39, loss: 0.7627, instance_loss: 0.4881, weighted_loss: 0.6803, label: 2, bag_size: 99232


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.14095744680851063: correct 53/376
Epoch: 34, train_loss: 0.7468, train_clustering_loss:  0.4592, train_error: 0.2128
class 0: acc 0.5, correct 6/12
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.0364, val_error: 0.4545, auc: 0.8194
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0899, instance_loss: 0.4643, weighted_loss: 0.9022, label: 1, bag_size: 49894
batch 39, loss: 0.8119, instance_loss: 0.5179, weighted_loss: 0.7237, label: 0, bag_size: 18551


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.11170212765957446: correct 42/376
Epoch: 35, train_loss: 0.7118, train_clustering_loss:  0.4578, train_error: 0.2340
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.0900, val_error: 0.4545, auc: 0.8194
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2619, instance_loss: 0.2861, weighted_loss: 0.2692, label: 1, bag_size: 20030
batch 39, loss: 0.6824, instance_loss: 0.4562, weighted_loss: 0.6145, label: 2, bag_size: 99232


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.1276595744680851: correct 48/376
Epoch: 36, train_loss: 0.6227, train_clustering_loss:  0.4254, train_error: 0.1064
class 0: acc 0.6, correct 6/10
class 1: acc 1.0, correct 15/15
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.0606, val_error: 0.3636, auc: 0.8090
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3679, instance_loss: 0.2991, weighted_loss: 0.3473, label: 1, bag_size: 20030
batch 39, loss: 0.9223, instance_loss: 0.5416, weighted_loss: 0.8081, label: 3, bag_size: 48518


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.17819148936170212: correct 67/376
Epoch: 37, train_loss: 0.7382, train_clustering_loss:  0.4349, train_error: 0.2553
class 0: acc 0.5, correct 5/10
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.6, correct 6/10
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.0223, val_error: 0.4545, auc: 0.8507
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.7996, instance_loss: 0.5340, weighted_loss: 0.7199, label: 0, bag_size: 22124
batch 39, loss: 0.1411, instance_loss: 0.1851, weighted_loss: 0.1543, label: 3, bag_size: 17590


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.20212765957446807: correct 76/376
Epoch: 38, train_loss: 0.5820, train_clustering_loss:  0.4219, train_error: 0.1064
class 0: acc 0.75, correct 9/12
class 1: acc 1.0, correct 7/7
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.1791, val_error: 0.5455, auc: 0.8403
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.8575, instance_loss: 0.5679, weighted_loss: 0.7706, label: 0, bag_size: 47775
batch 39, loss: 0.6191, instance_loss: 0.5048, weighted_loss: 0.5848, label: 0, bag_size: 10671


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.19680851063829788: correct 74/376
Epoch: 39, train_loss: 0.6982, train_clustering_loss:  0.4406, train_error: 0.2128
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.75, correct 9/12
class 2: acc 0.7, correct 7/10
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.1121, val_error: 0.4545, auc: 0.8090
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.1797, instance_loss: 0.1899, weighted_loss: 0.1827, label: 3, bag_size: 48489
batch 39, loss: 0.1425, instance_loss: 0.2954, weighted_loss: 0.1884, label: 3, bag_size: 17590


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.20212765957446807: correct 76/376
Epoch: 40, train_loss: 0.6257, train_clustering_loss:  0.4168, train_error: 0.1702
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.0189, val_error: 0.3636, auc: 0.8299
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.3084, instance_loss: 0.3199, weighted_loss: 0.3119, label: 3, bag_size: 66523
batch 39, loss: 0.4231, instance_loss: 0.3827, weighted_loss: 0.4110, label: 3, bag_size: 24102


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.1675531914893617: correct 63/376
Epoch: 41, train_loss: 0.6788, train_clustering_loss:  0.4257, train_error: 0.1915
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.75, correct 9/12
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.2363, val_error: 0.4545, auc: 0.8403
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.2609, instance_loss: 0.5133, weighted_loss: 1.0366, label: 1, bag_size: 49894
batch 39, loss: 0.6445, instance_loss: 0.5050, weighted_loss: 0.6026, label: 3, bag_size: 4963


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.1356382978723404: correct 51/376
Epoch: 42, train_loss: 0.6094, train_clustering_loss:  0.4286, train_error: 0.1915
class 0: acc 0.75, correct 9/12
class 1: acc 0.7, correct 7/10
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.0377, val_error: 0.4545, auc: 0.8681
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2920, instance_loss: 0.3297, weighted_loss: 0.3033, label: 1, bag_size: 64834
batch 39, loss: 0.3608, instance_loss: 0.3282, weighted_loss: 0.3510, label: 3, bag_size: 48518


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.18351063829787234: correct 69/376
Epoch: 43, train_loss: 0.6648, train_clustering_loss:  0.4367, train_error: 0.2340
class 0: acc 0.4, correct 4/10
class 1: acc 1.0, correct 17/17
class 2: acc 0.6, correct 6/10
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.0399, val_error: 0.4545, auc: 0.8472
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.1920, instance_loss: 0.6576, weighted_loss: 1.0317, label: 0, bag_size: 56348
batch 39, loss: 0.3095, instance_loss: 0.3938, weighted_loss: 0.3348, label: 0, bag_size: 6353


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.26861702127659576: correct 101/376
Epoch: 44, train_loss: 0.4821, train_clustering_loss:  0.3789, train_error: 0.1277
class 0: acc 0.875, correct 14/16
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.1529, val_error: 0.3636, auc: 0.8681
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.2758, instance_loss: 0.2595, weighted_loss: 0.2709, label: 1, bag_size: 23122
batch 39, loss: 0.4131, instance_loss: 0.4481, weighted_loss: 0.4236, label: 0, bag_size: 19277


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.2898936170212766: correct 109/376
Epoch: 45, train_loss: 0.5218, train_clustering_loss:  0.3803, train_error: 0.1277
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.0076, val_error: 0.4545, auc: 0.8611
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3093, instance_loss: 0.3045, weighted_loss: 0.3079, label: 1, bag_size: 16373
batch 39, loss: 0.8303, instance_loss: 0.5321, weighted_loss: 0.7409, label: 3, bag_size: 4963


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.3271276595744681: correct 123/376
Epoch: 46, train_loss: 0.4827, train_clustering_loss:  0.3602, train_error: 0.1064
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.0848, val_error: 0.4545, auc: 0.8472
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0814, instance_loss: 0.1631, weighted_loss: 0.1059, label: 2, bag_size: 89905
batch 39, loss: 1.9875, instance_loss: 0.7013, weighted_loss: 1.6016, label: 1, bag_size: 112135


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.2632978723404255: correct 99/376
Epoch: 47, train_loss: 0.5155, train_clustering_loss:  0.3789, train_error: 0.1064
class 0: acc 1.0, correct 14/14
class 1: acc 0.8, correct 8/10
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.1289, val_error: 0.3636, auc: 0.8160
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0957, instance_loss: 0.2525, weighted_loss: 0.1428, label: 2, bag_size: 158432
batch 39, loss: 0.1288, instance_loss: 0.2251, weighted_loss: 0.1577, label: 1, bag_size: 58270


class 0 clustering acc 0.9840425531914894: correct 1480/1504
class 1 clustering acc 0.32180851063829785: correct 121/376
Epoch: 48, train_loss: 0.5308, train_clustering_loss:  0.3823, train_error: 0.1489
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.7142857142857143, correct 5/7
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 0.9763, val_error: 0.3636, auc: 0.8611
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (0.997499 --> 0.976275).  Saving model ...


batch 19, loss: 0.6366, instance_loss: 0.7230, weighted_loss: 0.6625, label: 0, bag_size: 130978
batch 39, loss: 0.6016, instance_loss: 0.5138, weighted_loss: 0.5753, label: 0, bag_size: 108548


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.2632978723404255: correct 99/376
Epoch: 49, train_loss: 0.4595, train_clustering_loss:  0.3863, train_error: 0.0851
class 0: acc 1.0, correct 13/13
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.0346, val_error: 0.4545, auc: 0.8160
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0691, instance_loss: 0.2420, weighted_loss: 0.1210, label: 3, bag_size: 24102
batch 39, loss: 0.1944, instance_loss: 0.2363, weighted_loss: 0.2070, label: 1, bag_size: 81420


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.39095744680851063: correct 147/376
Epoch: 50, train_loss: 0.2980, train_clustering_loss:  0.2948, train_error: 0.0213
class 0: acc 1.0, correct 8/8
class 1: acc 1.0, correct 13/13
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.1132, val_error: 0.4545, auc: 0.7917
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 3.3906, instance_loss: 1.0074, weighted_loss: 2.6756, label: 2, bag_size: 54449
batch 39, loss: 0.1169, instance_loss: 0.2327, weighted_loss: 0.1517, label: 3, bag_size: 152150


class 0 clustering acc 0.9840425531914894: correct 1480/1504
class 1 clustering acc 0.2978723404255319: correct 112/376
Epoch: 51, train_loss: 0.5018, train_clustering_loss:  0.3854, train_error: 0.1277
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.0939, val_error: 0.5455, auc: 0.7882
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2019, instance_loss: 0.2660, weighted_loss: 0.2211, label: 1, bag_size: 36943
batch 39, loss: 0.0618, instance_loss: 0.1369, weighted_loss: 0.0843, label: 3, bag_size: 17590


class 0 clustering acc 0.980718085106383: correct 1475/1504
class 1 clustering acc 0.35106382978723405: correct 132/376
Epoch: 52, train_loss: 0.3970, train_clustering_loss:  0.3464, train_error: 0.0851
class 0: acc 0.7777777777777778, correct 14/18
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 3/3
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.1656, val_error: 0.5455, auc: 0.8090
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3789, instance_loss: 0.2855, weighted_loss: 0.3509, label: 3, bag_size: 48624
batch 39, loss: 0.2169, instance_loss: 0.2304, weighted_loss: 0.2209, label: 1, bag_size: 49894


class 0 clustering acc 0.9860372340425532: correct 1483/1504
class 1 clustering acc 0.3324468085106383: correct 125/376
Epoch: 53, train_loss: 0.4152, train_clustering_loss:  0.3530, train_error: 0.1064
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.3345, val_error: 0.5455, auc: 0.7951
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.6598, instance_loss: 0.3924, weighted_loss: 0.5796, label: 1, bag_size: 20030
batch 39, loss: 0.0218, instance_loss: 0.0503, weighted_loss: 0.0304, label: 3, bag_size: 42569


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.4175531914893617: correct 157/376
Epoch: 54, train_loss: 0.3613, train_clustering_loss:  0.3040, train_error: 0.0426
class 0: acc 1.0, correct 15/15
class 1: acc 1.0, correct 9/9
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.4600, val_error: 0.5455, auc: 0.7639
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.3158, instance_loss: 0.3088, weighted_loss: 0.3137, label: 1, bag_size: 64834
batch 39, loss: 0.3760, instance_loss: 0.3330, weighted_loss: 0.3631, label: 1, bag_size: 57038


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.3670212765957447: correct 138/376
Epoch: 55, train_loss: 0.4673, train_clustering_loss:  0.3646, train_error: 0.1489
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 13/13
class 2: acc 0.6, correct 9/15
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.3196, val_error: 0.4545, auc: 0.7639
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0164, instance_loss: 0.0489, weighted_loss: 0.0262, label: 3, bag_size: 42569
batch 39, loss: 0.0629, instance_loss: 0.3130, weighted_loss: 0.1379, label: 3, bag_size: 77542


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.39893617021276595: correct 150/376
Epoch: 56, train_loss: 0.4165, train_clustering_loss:  0.3356, train_error: 0.1277
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.4638, val_error: 0.5455, auc: 0.7986
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.6944, instance_loss: 0.4147, weighted_loss: 0.6105, label: 0, bag_size: 10671
batch 39, loss: 0.1696, instance_loss: 0.1963, weighted_loss: 0.1776, label: 1, bag_size: 16373


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.40425531914893614: correct 152/376
Epoch: 57, train_loss: 0.4317, train_clustering_loss:  0.3416, train_error: 0.1277
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 1.0, correct 11/11
class 2: acc 0.8, correct 8/10
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.3914, val_error: 0.4545, auc: 0.7535
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1605, instance_loss: 0.3050, weighted_loss: 0.2039, label: 0, bag_size: 43538
batch 39, loss: 0.4472, instance_loss: 0.3325, weighted_loss: 0.4128, label: 2, bag_size: 69807


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.39095744680851063: correct 147/376
Epoch: 58, train_loss: 0.3581, train_clustering_loss:  0.3480, train_error: 0.0426
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 1.0, correct 16/16
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.7527, val_error: 0.4545, auc: 0.7743
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.2727272727272727: correct 24/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.0932, instance_loss: 0.4145, weighted_loss: 0.8896, label: 3, bag_size: 17590
batch 39, loss: 0.2041, instance_loss: 0.2682, weighted_loss: 0.2233, label: 0, bag_size: 22124


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.39361702127659576: correct 148/376
Epoch: 59, train_loss: 0.5456, train_clustering_loss:  0.3543, train_error: 0.1915
class 0: acc 0.8421052631578947, correct 16/19
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.875, correct 7/8
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.2521, val_error: 0.6364, auc: 0.8299
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0094, instance_loss: 0.0470, weighted_loss: 0.0207, label: 3, bag_size: 42569
batch 39, loss: 0.3233, instance_loss: 0.3466, weighted_loss: 0.3303, label: 2, bag_size: 118767


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.39361702127659576: correct 148/376
Epoch: 60, train_loss: 0.5166, train_clustering_loss:  0.3544, train_error: 0.1277
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.8823529411764706, correct 15/17
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.8571428571428571, correct 6/7

Val Set, val_loss: 1.4431, val_error: 0.4545, auc: 0.8021
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.2727272727272727: correct 24/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1209, instance_loss: 0.1541, weighted_loss: 0.1309, label: 1, bag_size: 112135
batch 39, loss: 0.2891, instance_loss: 0.2725, weighted_loss: 0.2841, label: 2, bag_size: 69807


class 0 clustering acc 0.9820478723404256: correct 1477/1504
class 1 clustering acc 0.4787234042553192: correct 180/376
Epoch: 61, train_loss: 0.4296, train_clustering_loss:  0.3406, train_error: 0.1489
class 0: acc 0.7, correct 7/10
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.4195, val_error: 0.3636, auc: 0.8021
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.3068181818181818: correct 27/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.0320, instance_loss: 0.8038, weighted_loss: 0.9635, label: 0, bag_size: 65047
batch 39, loss: 0.0079, instance_loss: 0.0420, weighted_loss: 0.0181, label: 2, bag_size: 113492


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.5851063829787234: correct 220/376
Epoch: 62, train_loss: 0.3410, train_clustering_loss:  0.2773, train_error: 0.1064
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 1.0, correct 18/18
class 2: acc 0.75, correct 6/8
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.2685, val_error: 0.5455, auc: 0.7847
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.29545454545454547: correct 26/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.9802, instance_loss: 0.6733, weighted_loss: 0.8881, label: 2, bag_size: 7532
batch 39, loss: 0.2860, instance_loss: 0.4865, weighted_loss: 0.3462, label: 0, bag_size: 65047


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.42819148936170215: correct 161/376
Epoch: 63, train_loss: 0.4153, train_clustering_loss:  0.3283, train_error: 0.1064
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.5456, val_error: 0.5455, auc: 0.7847
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.26136363636363635: correct 23/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.5269, instance_loss: 0.8077, weighted_loss: 1.3112, label: 0, bag_size: 13999
batch 39, loss: 0.2533, instance_loss: 0.2167, weighted_loss: 0.2423, label: 1, bag_size: 112135


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.5797872340425532: correct 218/376
Epoch: 64, train_loss: 0.3032, train_clustering_loss:  0.2863, train_error: 0.0851
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 1.0, correct 10/10
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.6868, val_error: 0.5455, auc: 0.7847
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.2727272727272727: correct 24/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.3666, instance_loss: 0.5106, weighted_loss: 0.4098, label: 0, bag_size: 46742
batch 39, loss: 0.0349, instance_loss: 0.0776, weighted_loss: 0.0477, label: 2, bag_size: 64035


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.5611702127659575: correct 211/376
Epoch: 65, train_loss: 0.2450, train_clustering_loss:  0.2805, train_error: 0.0213
class 0: acc 1.0, correct 10/10
class 1: acc 1.0, correct 10/10
class 2: acc 0.9375, correct 15/16
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.7882, val_error: 0.4545, auc: 0.8056
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.2840909090909091: correct 25/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1487, instance_loss: 0.1930, weighted_loss: 0.1620, label: 1, bag_size: 58270
batch 39, loss: 0.1979, instance_loss: 0.4011, weighted_loss: 0.2589, label: 0, bag_size: 46742


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.6835106382978723: correct 257/376
Epoch: 66, train_loss: 0.2060, train_clustering_loss:  0.2494, train_error: 0.0213
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 18/18
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.7408, val_error: 0.5455, auc: 0.7951
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.32954545454545453: correct 29/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0264, instance_loss: 0.2084, weighted_loss: 0.0810, label: 3, bag_size: 77542
batch 39, loss: 0.4702, instance_loss: 0.3652, weighted_loss: 0.4387, label: 1, bag_size: 36943


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.6170212765957447: correct 232/376
Epoch: 67, train_loss: 0.2587, train_clustering_loss:  0.2672, train_error: 0.0638
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 1.0, correct 18/18
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.4302, val_error: 0.7273, auc: 0.7604
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.1047, instance_loss: 0.2162, weighted_loss: 0.1382, label: 2, bag_size: 64035
batch 39, loss: 0.5049, instance_loss: 0.4071, weighted_loss: 0.4755, label: 3, bag_size: 12412


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.4973404255319149: correct 187/376
Epoch: 68, train_loss: 0.3455, train_clustering_loss:  0.3178, train_error: 0.0426
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 1.0, correct 13/13
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.2599, val_error: 0.6364, auc: 0.7708
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.3636, ROC AUC: 0.8611
Test error: 0.8182, ROC AUC: 0.6875
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3

Training Fold 5!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 2.0849, instance_loss: 1.0902, weighted_loss: 1.7865, label: 1, bag_size: 132271
batch 39, loss: 1.9889, instance_loss: 0.9425, weighted_loss: 1.6750, label: 1, bag_size: 23122


class 0 clustering acc 0.9601063829787234: correct 1444/1504
class 1 clustering acc 0.06382978723404255: correct 24/376
Epoch: 0, train_loss: 1.4491, train_clustering_loss:  1.0256, train_error: 0.7021
class 0: acc 0.0, correct 0/11
class 1: acc 0.0, correct 0/10
class 2: acc 1.0, correct 12/12
class 3: acc 0.14285714285714285, correct 2/14

Val Set, val_loss: 1.4137, val_error: 0.7273, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.413684).  Saving model ...


batch 19, loss: 1.4340, instance_loss: 0.8196, weighted_loss: 1.2497, label: 2, bag_size: 9530
batch 39, loss: 1.3630, instance_loss: 0.7276, weighted_loss: 1.1724, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4198, train_clustering_loss:  0.7930, train_error: 0.7447
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/13
class 2: acc 0.0, correct 0/13
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.3722, val_error: 0.7273, auc: 0.7396
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.413684 --> 1.372155).  Saving model ...


batch 19, loss: 1.3503, instance_loss: 0.6604, weighted_loss: 1.1433, label: 2, bag_size: 118767
batch 39, loss: 1.1861, instance_loss: 0.6307, weighted_loss: 1.0195, label: 2, bag_size: 54449


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3901, train_clustering_loss:  0.6479, train_error: 0.7234
class 0: acc 0.0, correct 0/10
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.5714285714285714, correct 8/14
class 3: acc 0.0, correct 0/12

Val Set, val_loss: 1.4021, val_error: 0.8182, auc: 0.7639
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1342, instance_loss: 0.6050, weighted_loss: 0.9754, label: 1, bag_size: 49894
batch 39, loss: 1.2290, instance_loss: 0.5900, weighted_loss: 1.0373, label: 3, bag_size: 17590


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.4025, train_clustering_loss:  0.6144, train_error: 0.6809
class 0: acc 0.0, correct 0/10
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.25, correct 2/8
class 3: acc 0.3333333333333333, correct 5/15

Val Set, val_loss: 1.3646, val_error: 0.7273, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.372155 --> 1.364616).  Saving model ...


batch 19, loss: 1.4070, instance_loss: 0.5704, weighted_loss: 1.1560, label: 2, bag_size: 89905
batch 39, loss: 1.1270, instance_loss: 0.6057, weighted_loss: 0.9706, label: 0, bag_size: 65047


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.4137, train_clustering_loss:  0.6104, train_error: 0.7447
class 0: acc 0.4666666666666667, correct 7/15
class 1: acc 0.0, correct 0/12
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.3692, val_error: 0.7273, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2143, instance_loss: 0.6175, weighted_loss: 1.0352, label: 0, bag_size: 43538
batch 39, loss: 1.7491, instance_loss: 0.6004, weighted_loss: 1.4044, label: 2, bag_size: 59749


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3703, train_clustering_loss:  0.6039, train_error: 0.7021
class 0: acc 0.38461538461538464, correct 5/13
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.2, correct 2/10
class 3: acc 0.4, correct 6/15

Val Set, val_loss: 1.3334, val_error: 0.4545, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.364616 --> 1.333394).  Saving model ...


batch 19, loss: 1.5836, instance_loss: 0.5968, weighted_loss: 1.2875, label: 2, bag_size: 89905
batch 39, loss: 1.5980, instance_loss: 0.6353, weighted_loss: 1.3092, label: 2, bag_size: 9530


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3813, train_clustering_loss:  0.6115, train_error: 0.6596
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3531, val_error: 0.7273, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4319, instance_loss: 0.6353, weighted_loss: 1.1929, label: 1, bag_size: 49894
batch 39, loss: 0.8761, instance_loss: 0.5685, weighted_loss: 0.7838, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2968, train_clustering_loss:  0.6079, train_error: 0.6383
class 0: acc 1.0, correct 16/16
class 1: acc 0.09090909090909091, correct 1/11
class 2: acc 0.0, correct 0/8
class 3: acc 0.0, correct 0/12

Val Set, val_loss: 1.3349, val_error: 0.7273, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7564, instance_loss: 0.5392, weighted_loss: 0.6913, label: 0, bag_size: 59350
batch 39, loss: 1.5452, instance_loss: 0.6110, weighted_loss: 1.2649, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2683, train_clustering_loss:  0.6047, train_error: 0.6596
class 0: acc 1.0, correct 15/15
class 1: acc 0.0, correct 0/8
class 2: acc 0.06666666666666667, correct 1/15
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3584, val_error: 0.6364, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.4819, instance_loss: 0.6210, weighted_loss: 1.2236, label: 3, bag_size: 48518
batch 39, loss: 1.7448, instance_loss: 0.6533, weighted_loss: 1.4174, label: 1, bag_size: 23122


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2670, train_clustering_loss:  0.5967, train_error: 0.5745
class 0: acc 0.08333333333333333, correct 1/12
class 1: acc 0.0, correct 0/8
class 2: acc 1.0, correct 19/19
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4594, val_error: 0.8182, auc: 0.6736
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.0930, instance_loss: 0.5522, weighted_loss: 0.9308, label: 2, bag_size: 9530
batch 39, loss: 1.3232, instance_loss: 0.6448, weighted_loss: 1.1197, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2518, train_clustering_loss:  0.6028, train_error: 0.5319
class 0: acc 0.8, correct 8/10
class 1: acc 0.14285714285714285, correct 2/14
class 2: acc 0.75, correct 12/16
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.4072, val_error: 0.8182, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.6087, instance_loss: 0.5445, weighted_loss: 0.5895, label: 1, bag_size: 36943
batch 39, loss: 1.5840, instance_loss: 0.6815, weighted_loss: 1.3132, label: 3, bag_size: 42569


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2442, train_clustering_loss:  0.5958, train_error: 0.5745
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.8333333333333334, correct 15/18
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.0, correct 0/5

Val Set, val_loss: 1.3828, val_error: 0.8182, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.9497, instance_loss: 0.5901, weighted_loss: 0.8418, label: 2, bag_size: 44015
batch 39, loss: 0.7566, instance_loss: 0.4939, weighted_loss: 0.6778, label: 2, bag_size: 89905


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2653, train_clustering_loss:  0.5970, train_error: 0.5957
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.5333333333333333, correct 8/15
class 3: acc 0.0, correct 0/12

Val Set, val_loss: 1.3832, val_error: 0.8182, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.1539, instance_loss: 0.5128, weighted_loss: 0.9616, label: 2, bag_size: 118767
batch 39, loss: 1.2219, instance_loss: 0.5532, weighted_loss: 1.0213, label: 2, bag_size: 89905


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2404, train_clustering_loss:  0.5936, train_error: 0.5106
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.16666666666666666, correct 2/12
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.3532, val_error: 0.6364, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.4639, instance_loss: 0.5961, weighted_loss: 1.2036, label: 1, bag_size: 49894
batch 39, loss: 1.1684, instance_loss: 0.5955, weighted_loss: 0.9965, label: 3, bag_size: 102779


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.2284, train_clustering_loss:  0.5882, train_error: 0.5106
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.375, correct 3/8
class 2: acc 0.6, correct 9/15
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.3401, val_error: 0.8182, auc: 0.6910
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.3884, instance_loss: 0.6523, weighted_loss: 1.1676, label: 1, bag_size: 77634
batch 39, loss: 1.6674, instance_loss: 0.6353, weighted_loss: 1.3578, label: 3, bag_size: 152150


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.2439, train_clustering_loss:  0.5946, train_error: 0.5745
class 0: acc 0.5384615384615384, correct 7/13
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.45454545454545453, correct 5/11
class 3: acc 0.2, correct 2/10

Val Set, val_loss: 1.2673, val_error: 0.3636, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.333394 --> 1.267283).  Saving model ...


batch 19, loss: 0.7849, instance_loss: 0.5304, weighted_loss: 0.7086, label: 2, bag_size: 89905
batch 39, loss: 0.9959, instance_loss: 0.6761, weighted_loss: 0.8999, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.1743, train_clustering_loss:  0.5861, train_error: 0.4468
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.75, correct 9/12
class 2: acc 0.875, correct 14/16
class 3: acc 0.07692307692307693, correct 1/13

Val Set, val_loss: 1.3847, val_error: 0.8182, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8204, instance_loss: 0.5588, weighted_loss: 0.7419, label: 3, bag_size: 24102
batch 39, loss: 1.7662, instance_loss: 0.6729, weighted_loss: 1.4382, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.2507, train_clustering_loss:  0.5900, train_error: 0.5745
class 0: acc 0.08333333333333333, correct 1/12
class 1: acc 0.4, correct 4/10
class 2: acc 0.5882352941176471, correct 10/17
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.4159, val_error: 0.8182, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4398, instance_loss: 0.6493, weighted_loss: 1.2027, label: 3, bag_size: 102779
batch 39, loss: 1.3968, instance_loss: 0.6246, weighted_loss: 1.1651, label: 3, bag_size: 24102


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 1.1523, train_clustering_loss:  0.5867, train_error: 0.5106
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.16666666666666666, correct 2/12

Val Set, val_loss: 1.2489, val_error: 0.5455, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.267283 --> 1.248913).  Saving model ...


batch 19, loss: 1.0434, instance_loss: 0.5947, weighted_loss: 0.9088, label: 0, bag_size: 130978
batch 39, loss: 1.9478, instance_loss: 0.6344, weighted_loss: 1.5538, label: 3, bag_size: 83890


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 1.1749, train_clustering_loss:  0.5820, train_error: 0.4681
class 0: acc 0.42857142857142855, correct 6/14
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.0, correct 0/5

Val Set, val_loss: 1.3113, val_error: 0.5455, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6372, instance_loss: 0.5950, weighted_loss: 1.3245, label: 0, bag_size: 108548
batch 39, loss: 1.3431, instance_loss: 0.4830, weighted_loss: 1.0851, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 1.1693, train_clustering_loss:  0.5819, train_error: 0.5106
class 0: acc 0.5, correct 6/12
class 1: acc 0.5, correct 5/10
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.25, correct 3/12

Val Set, val_loss: 1.2351, val_error: 0.5455, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.248913 --> 1.235116).  Saving model ...


batch 19, loss: 0.5936, instance_loss: 0.5227, weighted_loss: 0.5723, label: 0, bag_size: 47775
batch 39, loss: 1.1165, instance_loss: 0.6175, weighted_loss: 0.9668, label: 3, bag_size: 48518


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 1.1284, train_clustering_loss:  0.5706, train_error: 0.4894
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.2, correct 2/10

Val Set, val_loss: 1.2106, val_error: 0.3636, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.235116 --> 1.210611).  Saving model ...


batch 19, loss: 1.2879, instance_loss: 0.6419, weighted_loss: 1.0941, label: 2, bag_size: 44015
batch 39, loss: 1.8557, instance_loss: 0.6838, weighted_loss: 1.5042, label: 2, bag_size: 158432


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 22, train_loss: 1.0562, train_clustering_loss:  0.5687, train_error: 0.4681
class 0: acc 0.6470588235294118, correct 11/17
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.0, correct 0/9
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.2402, val_error: 0.6364, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7855, instance_loss: 0.5591, weighted_loss: 0.7176, label: 2, bag_size: 44015
batch 39, loss: 1.2979, instance_loss: 0.6490, weighted_loss: 1.1032, label: 3, bag_size: 66523


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 1.0580, train_clustering_loss:  0.5726, train_error: 0.4255
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.3333333333333333, correct 4/12

Val Set, val_loss: 1.2094, val_error: 0.5455, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.210611 --> 1.209406).  Saving model ...


batch 19, loss: 0.5263, instance_loss: 0.4958, weighted_loss: 0.5172, label: 2, bag_size: 89905
batch 39, loss: 0.6846, instance_loss: 0.4843, weighted_loss: 0.6245, label: 0, bag_size: 130978


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 1.0093, train_clustering_loss:  0.5617, train_error: 0.3191
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.1614, val_error: 0.5455, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.209406 --> 1.161359).  Saving model ...


batch 19, loss: 0.6460, instance_loss: 0.5249, weighted_loss: 0.6097, label: 1, bag_size: 36943
batch 39, loss: 0.8050, instance_loss: 0.4833, weighted_loss: 0.7085, label: 0, bag_size: 65047


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 25, train_loss: 1.0848, train_clustering_loss:  0.5614, train_error: 0.3830
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.6153846153846154, correct 8/13
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.1436, val_error: 0.4545, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.161359 --> 1.143613).  Saving model ...


batch 19, loss: 1.3873, instance_loss: 0.5873, weighted_loss: 1.1473, label: 1, bag_size: 23122
batch 39, loss: 0.8437, instance_loss: 0.5501, weighted_loss: 0.7556, label: 1, bag_size: 69073


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 26, train_loss: 1.0225, train_clustering_loss:  0.5600, train_error: 0.4043
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.5, correct 6/12
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.1320, val_error: 0.4545, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.143613 --> 1.131961).  Saving model ...


batch 19, loss: 1.3142, instance_loss: 0.6346, weighted_loss: 1.1103, label: 2, bag_size: 54449
batch 39, loss: 1.4305, instance_loss: 0.6227, weighted_loss: 1.1882, label: 3, bag_size: 16626


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 27, train_loss: 1.0479, train_clustering_loss:  0.5590, train_error: 0.4468
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 0.5, correct 7/14
class 2: acc 0.875, correct 14/16
class 3: acc 0.2, correct 2/10

Val Set, val_loss: 1.1589, val_error: 0.5455, auc: 0.7812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0335, instance_loss: 0.5393, weighted_loss: 0.8852, label: 0, bag_size: 19277
batch 39, loss: 1.0870, instance_loss: 0.5705, weighted_loss: 0.9321, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 28, train_loss: 0.8796, train_clustering_loss:  0.5403, train_error: 0.2553
class 0: acc 0.5, correct 4/8
class 1: acc 1.0, correct 14/14
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.0814, val_error: 0.4545, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.131961 --> 1.081357).  Saving model ...


batch 19, loss: 0.9831, instance_loss: 0.5001, weighted_loss: 0.8382, label: 3, bag_size: 83890
batch 39, loss: 0.7051, instance_loss: 0.4648, weighted_loss: 0.6330, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 29, train_loss: 0.9867, train_clustering_loss:  0.5431, train_error: 0.2979
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.8125, correct 13/16
class 2: acc 0.7, correct 7/10
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.0956, val_error: 0.4545, auc: 0.8125
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6801, instance_loss: 0.5273, weighted_loss: 0.6343, label: 2, bag_size: 118767
batch 39, loss: 1.4918, instance_loss: 0.5982, weighted_loss: 1.2237, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 30, train_loss: 0.9125, train_clustering_loss:  0.5413, train_error: 0.3830
class 0: acc 0.5882352941176471, correct 10/17
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.0239, val_error: 0.4545, auc: 0.8403
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.081357 --> 1.023919).  Saving model ...


batch 19, loss: 1.2186, instance_loss: 0.5041, weighted_loss: 1.0043, label: 1, bag_size: 18329
batch 39, loss: 1.0588, instance_loss: 0.5367, weighted_loss: 0.9021, label: 0, bag_size: 65047


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 31, train_loss: 0.8275, train_clustering_loss:  0.5089, train_error: 0.3191
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.6, correct 3/5

Val Set, val_loss: 1.1228, val_error: 0.4545, auc: 0.8125
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2120, instance_loss: 0.3310, weighted_loss: 0.2477, label: 0, bag_size: 47775
batch 39, loss: 0.1253, instance_loss: 0.3435, weighted_loss: 0.1907, label: 0, bag_size: 47775


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 32, train_loss: 0.7509, train_clustering_loss:  0.4988, train_error: 0.2340
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.8, correct 8/10
class 2: acc 1.0, correct 10/10
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.0131, val_error: 0.3636, auc: 0.8472
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.023919 --> 1.013141).  Saving model ...


batch 19, loss: 0.5262, instance_loss: 0.4545, weighted_loss: 0.5047, label: 0, bag_size: 130978
batch 39, loss: 0.2395, instance_loss: 0.4006, weighted_loss: 0.2878, label: 3, bag_size: 42569


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 33, train_loss: 0.7213, train_clustering_loss:  0.4976, train_error: 0.1702
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.1229, val_error: 0.4545, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0640, instance_loss: 0.5483, weighted_loss: 0.9092, label: 3, bag_size: 16626
batch 39, loss: 1.3657, instance_loss: 0.6786, weighted_loss: 1.1596, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.007978723404255319: correct 3/376
Epoch: 34, train_loss: 0.7425, train_clustering_loss:  0.4962, train_error: 0.3191
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.6, correct 6/10
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 0.9968, val_error: 0.2727, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.013141 --> 0.996757).  Saving model ...


batch 19, loss: 1.5519, instance_loss: 0.6885, weighted_loss: 1.2929, label: 3, bag_size: 4963
batch 39, loss: 0.8139, instance_loss: 0.5102, weighted_loss: 0.7228, label: 0, bag_size: 70920


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 35, train_loss: 0.5732, train_clustering_loss:  0.4488, train_error: 0.1277
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 1.0, correct 13/13
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.1149, val_error: 0.3636, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4179, instance_loss: 0.4744, weighted_loss: 0.4349, label: 0, bag_size: 65047
batch 39, loss: 0.8537, instance_loss: 0.5457, weighted_loss: 0.7613, label: 2, bag_size: 99232


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.06382978723404255: correct 24/376
Epoch: 36, train_loss: 0.6349, train_clustering_loss:  0.4371, train_error: 0.2340
class 0: acc 0.7777777777777778, correct 14/18
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.5714285714285714, correct 4/7

Val Set, val_loss: 1.0421, val_error: 0.4545, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2598, instance_loss: 0.2861, weighted_loss: 0.2677, label: 0, bag_size: 65047
batch 39, loss: 0.4354, instance_loss: 0.4918, weighted_loss: 0.4523, label: 3, bag_size: 48518


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.10372340425531915: correct 39/376
Epoch: 37, train_loss: 0.6774, train_clustering_loss:  0.4584, train_error: 0.1915
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.625, correct 5/8
class 2: acc 1.0, correct 9/9
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.0533, val_error: 0.4545, auc: 0.7917
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3694, instance_loss: 0.6743, weighted_loss: 1.1609, label: 1, bag_size: 77634
batch 39, loss: 0.2497, instance_loss: 0.3017, weighted_loss: 0.2653, label: 2, bag_size: 118767


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.11170212765957446: correct 42/376
Epoch: 38, train_loss: 0.6440, train_clustering_loss:  0.4470, train_error: 0.2128
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.0649, val_error: 0.3636, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2440, instance_loss: 0.2829, weighted_loss: 0.2556, label: 0, bag_size: 47775
batch 39, loss: 0.9458, instance_loss: 0.4888, weighted_loss: 0.8087, label: 0, bag_size: 54249


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.07180851063829788: correct 27/376
Epoch: 39, train_loss: 0.6955, train_clustering_loss:  0.4574, train_error: 0.2128
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.0138, val_error: 0.3636, auc: 0.8021
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.9430, instance_loss: 0.5681, weighted_loss: 0.8305, label: 3, bag_size: 25448
batch 39, loss: 0.2085, instance_loss: 0.2913, weighted_loss: 0.2333, label: 2, bag_size: 118767


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.07446808510638298: correct 28/376
Epoch: 40, train_loss: 0.5931, train_clustering_loss:  0.4397, train_error: 0.1489
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.0934, val_error: 0.4545, auc: 0.7708
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1545, instance_loss: 0.2798, weighted_loss: 0.1921, label: 0, bag_size: 56983
batch 39, loss: 0.1749, instance_loss: 0.2592, weighted_loss: 0.2002, label: 2, bag_size: 44015


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.1276595744680851: correct 48/376
Epoch: 41, train_loss: 0.6172, train_clustering_loss:  0.4262, train_error: 0.2128
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9, correct 9/10
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.0665, val_error: 0.4545, auc: 0.8021
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.5299, instance_loss: 0.7141, weighted_loss: 1.2851, label: 3, bag_size: 4963
batch 39, loss: 0.8299, instance_loss: 0.5518, weighted_loss: 0.7464, label: 3, bag_size: 16626


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.15425531914893617: correct 58/376
Epoch: 42, train_loss: 0.6728, train_clustering_loss:  0.4390, train_error: 0.2128
class 0: acc 0.6, correct 6/10
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.0772, val_error: 0.3636, auc: 0.7847
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.3186, instance_loss: 0.2980, weighted_loss: 0.3124, label: 1, bag_size: 104549
batch 39, loss: 0.0363, instance_loss: 0.1680, weighted_loss: 0.0758, label: 3, bag_size: 42569


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.125: correct 47/376
Epoch: 43, train_loss: 0.5856, train_clustering_loss:  0.4279, train_error: 0.1915
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.75, correct 6/8
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.0724, val_error: 0.4545, auc: 0.7708
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.4653, instance_loss: 0.4383, weighted_loss: 0.4572, label: 1, bag_size: 112135
batch 39, loss: 0.7194, instance_loss: 0.5067, weighted_loss: 0.6556, label: 1, bag_size: 49894


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.2047872340425532: correct 77/376
Epoch: 44, train_loss: 0.4521, train_clustering_loss:  0.3886, train_error: 0.0851
class 0: acc 0.9473684210526315, correct 18/19
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.0653, val_error: 0.3636, auc: 0.7708
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.1379, instance_loss: 0.2725, weighted_loss: 0.1783, label: 1, bag_size: 36943
batch 39, loss: 0.6656, instance_loss: 0.4653, weighted_loss: 0.6055, label: 0, bag_size: 6353


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.31648936170212766: correct 119/376
Epoch: 45, train_loss: 0.5399, train_clustering_loss:  0.3882, train_error: 0.1702
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.5714285714285714, correct 4/7

Val Set, val_loss: 1.0758, val_error: 0.4545, auc: 0.8021
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.2352, instance_loss: 0.3301, weighted_loss: 0.2636, label: 1, bag_size: 69073
batch 39, loss: 1.1427, instance_loss: 0.6093, weighted_loss: 0.9827, label: 3, bag_size: 16626


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.2473404255319149: correct 93/376
Epoch: 46, train_loss: 0.5219, train_clustering_loss:  0.4127, train_error: 0.1702
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 1.0, correct 12/12
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.0887, val_error: 0.3636, auc: 0.7743
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1766, instance_loss: 0.2240, weighted_loss: 0.1908, label: 2, bag_size: 9530
batch 39, loss: 0.5124, instance_loss: 0.5805, weighted_loss: 0.5328, label: 3, bag_size: 66523


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.3058510638297872: correct 115/376
Epoch: 47, train_loss: 0.4873, train_clustering_loss:  0.3974, train_error: 0.1915
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 1.0, correct 9/9
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.0621, val_error: 0.3636, auc: 0.7778
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3541, instance_loss: 0.3585, weighted_loss: 0.3554, label: 2, bag_size: 22416
batch 39, loss: 0.5381, instance_loss: 0.4230, weighted_loss: 0.5036, label: 1, bag_size: 18329


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.19414893617021275: correct 73/376
Epoch: 48, train_loss: 0.4981, train_clustering_loss:  0.3966, train_error: 0.1702
class 0: acc 0.6, correct 9/15
class 1: acc 0.9, correct 9/10
class 2: acc 1.0, correct 7/7
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.0196, val_error: 0.4545, auc: 0.8160
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.6748, instance_loss: 0.5455, weighted_loss: 0.6360, label: 0, bag_size: 54249
batch 39, loss: 0.9284, instance_loss: 0.4980, weighted_loss: 0.7993, label: 0, bag_size: 108548


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.30319148936170215: correct 114/376
Epoch: 49, train_loss: 0.4360, train_clustering_loss:  0.3643, train_error: 0.1702
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6666666666666666, correct 4/6
class 2: acc 0.75, correct 6/8
class 3: acc 0.8636363636363636, correct 19/22

Val Set, val_loss: 1.0816, val_error: 0.2727, auc: 0.7743
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.1261, instance_loss: 0.2157, weighted_loss: 0.1530, label: 2, bag_size: 44015
batch 39, loss: 0.4237, instance_loss: 0.4150, weighted_loss: 0.4211, label: 1, bag_size: 23122


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.3377659574468085: correct 127/376
Epoch: 50, train_loss: 0.4049, train_clustering_loss:  0.3624, train_error: 0.0638
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.1220, val_error: 0.4545, auc: 0.7812
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0627, instance_loss: 0.1271, weighted_loss: 0.0820, label: 2, bag_size: 54449
batch 39, loss: 0.3480, instance_loss: 0.5188, weighted_loss: 0.3993, label: 3, bag_size: 152150


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.4015957446808511: correct 151/376
Epoch: 51, train_loss: 0.3881, train_clustering_loss:  0.3461, train_error: 0.1064
class 0: acc 0.9, correct 18/20
class 1: acc 1.0, correct 11/11
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 1.1744, val_error: 0.4545, auc: 0.7847
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0262, instance_loss: 0.0769, weighted_loss: 0.0414, label: 0, bag_size: 43538
batch 39, loss: 0.1511, instance_loss: 0.2031, weighted_loss: 0.1667, label: 2, bag_size: 118767


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.25: correct 94/376
Epoch: 52, train_loss: 0.6336, train_clustering_loss:  0.4261, train_error: 0.2340
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.0891, val_error: 0.3636, auc: 0.8125
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.1022, instance_loss: 0.2293, weighted_loss: 0.1403, label: 0, bag_size: 114704
batch 39, loss: 0.2644, instance_loss: 0.2991, weighted_loss: 0.2748, label: 1, bag_size: 77634


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.3191489361702128: correct 120/376
Epoch: 53, train_loss: 0.4718, train_clustering_loss:  0.3745, train_error: 0.1277
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 1.0, correct 14/14
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.4152, val_error: 0.4545, auc: 0.7222
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.4895, instance_loss: 0.3912, weighted_loss: 0.4600, label: 0, bag_size: 19277
batch 39, loss: 0.2417, instance_loss: 0.3914, weighted_loss: 0.2866, label: 3, bag_size: 24102


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.4148936170212766: correct 156/376
Epoch: 54, train_loss: 0.3597, train_clustering_loss:  0.3401, train_error: 0.0638
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 10/10
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.1343, val_error: 0.3636, auc: 0.7847
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.2727, ROC AUC: 0.7917
Test error: 0.5455, ROC AUC: 0.6806
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3

Training Fold 6!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7109, instance_loss: 1.0869, weighted_loss: 1.5237, label: 1, bag_size: 132271
batch 39, loss: 1.9035, instance_loss: 0.9382, weighted_loss: 1.6139, label: 1, bag_size: 58270


class 0 clustering acc 0.9514627659574468: correct 1431/1504
class 1 clustering acc 0.061170212765957445: correct 23/376
Epoch: 0, train_loss: 1.3912, train_clustering_loss:  1.0257, train_error: 0.7021
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/9
class 2: acc 0.0, correct 0/11
class 3: acc 0.8235294117647058, correct 14/17

Val Set, val_loss: 1.4054, val_error: 0.7273, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.405371).  Saving model ...


batch 19, loss: 1.4087, instance_loss: 0.7459, weighted_loss: 1.2099, label: 2, bag_size: 118767
batch 39, loss: 1.4156, instance_loss: 0.7314, weighted_loss: 1.2104, label: 1, bag_size: 104549


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4027, train_clustering_loss:  0.7369, train_error: 0.7234
class 0: acc 0.0, correct 0/7
class 1: acc 0.0, correct 0/14
class 2: acc 0.07142857142857142, correct 1/14
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.3987, val_error: 0.8182, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.405371 --> 1.398747).  Saving model ...


batch 19, loss: 1.5873, instance_loss: 0.6371, weighted_loss: 1.3022, label: 3, bag_size: 102779
batch 39, loss: 1.1064, instance_loss: 0.6115, weighted_loss: 0.9579, label: 2, bag_size: 54449


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.4134, train_clustering_loss:  0.6574, train_error: 0.7660
class 0: acc 0.0, correct 0/11
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.2857142857142857, correct 4/14
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4054, val_error: 0.8182, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.8598, instance_loss: 0.6582, weighted_loss: 1.4993, label: 0, bag_size: 22124
batch 39, loss: 1.2560, instance_loss: 0.6305, weighted_loss: 1.0684, label: 3, bag_size: 83890


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.4081, train_clustering_loss:  0.6181, train_error: 0.7234
class 0: acc 0.0, correct 0/10
class 1: acc 0.6, correct 9/15
class 2: acc 0.1, correct 1/10
class 3: acc 0.25, correct 3/12

Val Set, val_loss: 1.3544, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.398747 --> 1.354412).  Saving model ...


batch 19, loss: 1.2044, instance_loss: 0.6051, weighted_loss: 1.0246, label: 2, bag_size: 118767
batch 39, loss: 1.2208, instance_loss: 0.5816, weighted_loss: 1.0290, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3683, train_clustering_loss:  0.6055, train_error: 0.6596
class 0: acc 0.1, correct 1/10
class 1: acc 0.625, correct 10/16
class 2: acc 0.36363636363636365, correct 4/11
class 3: acc 0.1, correct 1/10

Val Set, val_loss: 1.3460, val_error: 0.5455, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.354412 --> 1.345966).  Saving model ...


batch 19, loss: 1.1138, instance_loss: 0.5792, weighted_loss: 0.9534, label: 1, bag_size: 23122
batch 39, loss: 1.6028, instance_loss: 0.6439, weighted_loss: 1.3151, label: 0, bag_size: 54249


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3525, train_clustering_loss:  0.6039, train_error: 0.6170
class 0: acc 0.0, correct 0/10
class 1: acc 1.0, correct 15/15
class 2: acc 0.0, correct 0/8
class 3: acc 0.21428571428571427, correct 3/14

Val Set, val_loss: 1.3604, val_error: 0.7273, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6182, instance_loss: 0.6323, weighted_loss: 1.3225, label: 2, bag_size: 75088
batch 39, loss: 1.2660, instance_loss: 0.6260, weighted_loss: 1.0740, label: 2, bag_size: 118767


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3456, train_clustering_loss:  0.6123, train_error: 0.6596
class 0: acc 0.0, correct 0/13
class 1: acc 0.75, correct 9/12
class 2: acc 0.25, correct 3/12
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.3403, val_error: 0.5455, auc: 0.6875
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.345966 --> 1.340314).  Saving model ...


batch 19, loss: 1.0801, instance_loss: 0.6290, weighted_loss: 0.9448, label: 0, bag_size: 22124
batch 39, loss: 1.4670, instance_loss: 0.5991, weighted_loss: 1.2066, label: 1, bag_size: 23122


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3143, train_clustering_loss:  0.6099, train_error: 0.5532
class 0: acc 1.0, correct 14/14
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.23076923076923078, correct 3/13

Val Set, val_loss: 1.3126, val_error: 0.6364, auc: 0.6875
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.340314 --> 1.312593).  Saving model ...


batch 19, loss: 1.1596, instance_loss: 0.6036, weighted_loss: 0.9928, label: 0, bag_size: 70920
batch 39, loss: 1.9242, instance_loss: 0.6440, weighted_loss: 1.5402, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2431, train_clustering_loss:  0.5982, train_error: 0.4255
class 0: acc 0.8888888888888888, correct 16/18
class 1: acc 0.0, correct 0/6
class 2: acc 0.0, correct 0/9
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.3457, val_error: 0.7273, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5793, instance_loss: 0.6544, weighted_loss: 1.3018, label: 2, bag_size: 44015
batch 39, loss: 1.0119, instance_loss: 0.5840, weighted_loss: 0.8835, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2369, train_clustering_loss:  0.5937, train_error: 0.5745
class 0: acc 1.0, correct 13/13
class 1: acc 0.14285714285714285, correct 2/14
class 2: acc 0.0, correct 0/7
class 3: acc 0.38461538461538464, correct 5/13

Val Set, val_loss: 1.2907, val_error: 0.6364, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.312593 --> 1.290744).  Saving model ...


batch 19, loss: 1.2187, instance_loss: 0.6470, weighted_loss: 1.0472, label: 2, bag_size: 118767
batch 39, loss: 1.2734, instance_loss: 0.6217, weighted_loss: 1.0779, label: 1, bag_size: 64834


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2493, train_clustering_loss:  0.6032, train_error: 0.5106
class 0: acc 0.0, correct 0/5
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.3125, correct 5/16
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.4142, val_error: 0.7273, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6859, instance_loss: 0.5393, weighted_loss: 0.6419, label: 1, bag_size: 81420
batch 39, loss: 1.2285, instance_loss: 0.6055, weighted_loss: 1.0416, label: 2, bag_size: 9530


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2388, train_clustering_loss:  0.5907, train_error: 0.5106
class 0: acc 0.0, correct 0/10
class 1: acc 0.8823529411764706, correct 15/17
class 2: acc 0.25, correct 3/12
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.3765, val_error: 0.8182, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7752, instance_loss: 0.5635, weighted_loss: 0.7117, label: 2, bag_size: 69807
batch 39, loss: 0.9683, instance_loss: 0.5729, weighted_loss: 0.8497, label: 2, bag_size: 75088


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.1784, train_clustering_loss:  0.5927, train_error: 0.5106
class 0: acc 0.375, correct 6/16
class 1: acc 0.6, correct 6/10
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.3631, val_error: 0.5455, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.9440, instance_loss: 0.5574, weighted_loss: 0.8280, label: 3, bag_size: 102779
batch 39, loss: 1.6562, instance_loss: 0.6526, weighted_loss: 1.3551, label: 2, bag_size: 75088


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2389, train_clustering_loss:  0.5916, train_error: 0.5957
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.0, correct 0/9
class 2: acc 0.1, correct 1/10
class 3: acc 0.6470588235294118, correct 11/17

Val Set, val_loss: 1.4001, val_error: 0.6364, auc: 0.5764
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.0229, instance_loss: 0.5692, weighted_loss: 0.8868, label: 0, bag_size: 22124
batch 39, loss: 1.0209, instance_loss: 0.5538, weighted_loss: 0.8808, label: 2, bag_size: 7532


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.0309, train_clustering_loss:  0.5601, train_error: 0.2979
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.625, correct 5/8
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.3995, val_error: 0.7273, auc: 0.5660
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.2621, instance_loss: 0.5913, weighted_loss: 1.0609, label: 1, bag_size: 49894
batch 39, loss: 1.0234, instance_loss: 0.5112, weighted_loss: 0.8697, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.0062, train_clustering_loss:  0.5557, train_error: 0.3830
class 0: acc 0.4375, correct 7/16
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 1.0, correct 4/4

Val Set, val_loss: 1.4916, val_error: 0.5455, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.3051, instance_loss: 0.6377, weighted_loss: 1.1049, label: 2, bag_size: 75088
batch 39, loss: 0.9057, instance_loss: 0.5457, weighted_loss: 0.7977, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.0557, train_clustering_loss:  0.5535, train_error: 0.3830
class 0: acc 0.5, correct 5/10
class 1: acc 0.625, correct 5/8
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.7222222222222222, correct 13/18

Val Set, val_loss: 1.4397, val_error: 0.7273, auc: 0.6076
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.7343, instance_loss: 0.4862, weighted_loss: 0.6599, label: 2, bag_size: 64035
batch 39, loss: 0.6004, instance_loss: 0.5118, weighted_loss: 0.5738, label: 1, bag_size: 69073


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 0.9941, train_clustering_loss:  0.5538, train_error: 0.4255
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.3333333333333333, correct 2/6

Val Set, val_loss: 1.3766, val_error: 0.6364, auc: 0.6528
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.3615, instance_loss: 0.6209, weighted_loss: 1.1393, label: 3, bag_size: 12412
batch 39, loss: 0.7402, instance_loss: 0.4811, weighted_loss: 0.6625, label: 2, bag_size: 64035


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.9006, train_clustering_loss:  0.5273, train_error: 0.3404
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 1.0, correct 14/14
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.3778, val_error: 0.5455, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.4679, instance_loss: 0.4183, weighted_loss: 0.4530, label: 1, bag_size: 47433
batch 39, loss: 0.8565, instance_loss: 0.5239, weighted_loss: 0.7568, label: 2, bag_size: 7532


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 0.9745, train_clustering_loss:  0.5361, train_error: 0.4468
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.4, correct 4/10
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.4814, val_error: 0.7273, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.9843, instance_loss: 0.6158, weighted_loss: 0.8737, label: 0, bag_size: 59350
batch 39, loss: 1.5572, instance_loss: 0.6414, weighted_loss: 1.2824, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 20, train_loss: 0.7405, train_clustering_loss:  0.4926, train_error: 0.2553
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.9, correct 9/10
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.4656, val_error: 0.6364, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.0687, instance_loss: 0.5916, weighted_loss: 0.9256, label: 2, bag_size: 113492
batch 39, loss: 0.4180, instance_loss: 0.4630, weighted_loss: 0.4315, label: 2, bag_size: 44015


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 21, train_loss: 0.6592, train_clustering_loss:  0.4714, train_error: 0.1915
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8888888888888888, correct 16/18
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.5508, val_error: 0.6364, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.3077, instance_loss: 0.4749, weighted_loss: 0.3579, label: 2, bag_size: 69807
batch 39, loss: 0.7995, instance_loss: 0.5807, weighted_loss: 0.7339, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.03723404255319149: correct 14/376
Epoch: 22, train_loss: 0.6356, train_clustering_loss:  0.4591, train_error: 0.2128
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9, correct 9/10
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.6252, val_error: 0.7273, auc: 0.6215
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3670, instance_loss: 0.4247, weighted_loss: 0.3843, label: 2, bag_size: 69807
batch 39, loss: 0.1446, instance_loss: 0.2258, weighted_loss: 0.1689, label: 3, bag_size: 66523


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.07180851063829788: correct 27/376
Epoch: 23, train_loss: 0.8183, train_clustering_loss:  0.4769, train_error: 0.3617
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.5627, val_error: 0.6364, auc: 0.6458
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.4861, instance_loss: 0.4040, weighted_loss: 0.4614, label: 2, bag_size: 75088
batch 39, loss: 0.5083, instance_loss: 0.4214, weighted_loss: 0.4822, label: 1, bag_size: 47433


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.06914893617021277: correct 26/376
Epoch: 24, train_loss: 0.7523, train_clustering_loss:  0.4755, train_error: 0.2766
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.6324, val_error: 0.6364, auc: 0.6215
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.4170, instance_loss: 0.4256, weighted_loss: 1.1196, label: 1, bag_size: 81420
batch 39, loss: 0.2267, instance_loss: 0.3176, weighted_loss: 0.2540, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0398936170212766: correct 15/376
Epoch: 25, train_loss: 0.6955, train_clustering_loss:  0.4556, train_error: 0.2766
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.7, correct 7/10
class 2: acc 0.8125, correct 13/16
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.6211, val_error: 0.6364, auc: 0.6667
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.3952, instance_loss: 0.3694, weighted_loss: 0.3875, label: 1, bag_size: 58270
batch 39, loss: 1.0658, instance_loss: 0.4720, weighted_loss: 0.8877, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.10106382978723404: correct 38/376
Epoch: 26, train_loss: 0.6333, train_clustering_loss:  0.4334, train_error: 0.2553
class 0: acc 0.75, correct 6/8
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.7, correct 7/10
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.6927, val_error: 0.6364, auc: 0.6111
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 1.1447, instance_loss: 0.6104, weighted_loss: 0.9844, label: 2, bag_size: 54449
batch 39, loss: 2.8826, instance_loss: 0.8688, weighted_loss: 2.2784, label: 3, bag_size: 152150


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.07712765957446809: correct 29/376
Epoch: 27, train_loss: 0.9000, train_clustering_loss:  0.5031, train_error: 0.4043
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.3733, val_error: 0.6364, auc: 0.6840
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.9694, instance_loss: 0.5872, weighted_loss: 0.8547, label: 0, bag_size: 19277
batch 39, loss: 1.2562, instance_loss: 0.5211, weighted_loss: 1.0357, label: 1, bag_size: 23122


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.1356382978723404: correct 51/376
Epoch: 28, train_loss: 0.7422, train_clustering_loss:  0.4640, train_error: 0.2979
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.6363, val_error: 0.6364, auc: 0.6910
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2781, instance_loss: 0.2962, weighted_loss: 0.2835, label: 2, bag_size: 7532
batch 39, loss: 0.7337, instance_loss: 0.4236, weighted_loss: 0.6406, label: 1, bag_size: 132271


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.17553191489361702: correct 66/376
Epoch: 29, train_loss: 0.6632, train_clustering_loss:  0.4281, train_error: 0.2766
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.9, correct 9/10
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.6841, val_error: 0.5455, auc: 0.6736
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.5365, instance_loss: 0.3362, weighted_loss: 0.4764, label: 3, bag_size: 98956
batch 39, loss: 1.4187, instance_loss: 0.6193, weighted_loss: 1.1789, label: 2, bag_size: 99232


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.10106382978723404: correct 38/376
Epoch: 30, train_loss: 0.6676, train_clustering_loss:  0.4326, train_error: 0.3191
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.7616, val_error: 0.6364, auc: 0.6632
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.1266, instance_loss: 0.5084, weighted_loss: 0.9411, label: 1, bag_size: 104549
batch 39, loss: 0.2472, instance_loss: 0.3639, weighted_loss: 0.2822, label: 1, bag_size: 20030


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.07180851063829788: correct 27/376
Epoch: 31, train_loss: 0.6619, train_clustering_loss:  0.4515, train_error: 0.2766
class 0: acc 0.875, correct 14/16
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.8, correct 4/5

Val Set, val_loss: 1.6546, val_error: 0.5455, auc: 0.6875
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.6202, instance_loss: 0.4775, weighted_loss: 0.5774, label: 2, bag_size: 113492
batch 39, loss: 0.5687, instance_loss: 0.4585, weighted_loss: 0.5356, label: 2, bag_size: 113492


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.2047872340425532: correct 77/376
Epoch: 32, train_loss: 0.6075, train_clustering_loss:  0.3998, train_error: 0.1702
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.9375, correct 15/16
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.7404, val_error: 0.6364, auc: 0.6701
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.1626, instance_loss: 0.2463, weighted_loss: 0.1877, label: 1, bag_size: 47433
batch 39, loss: 0.6302, instance_loss: 0.4733, weighted_loss: 0.5831, label: 2, bag_size: 9530


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.3191489361702128: correct 120/376
Epoch: 33, train_loss: 0.4638, train_clustering_loss:  0.3570, train_error: 0.1702
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 1.0, correct 9/9
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.8888888888888888, correct 16/18

Val Set, val_loss: 1.8292, val_error: 0.6364, auc: 0.6736
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.1009, instance_loss: 0.1722, weighted_loss: 0.1223, label: 3, bag_size: 152150
batch 39, loss: 0.5769, instance_loss: 0.4090, weighted_loss: 0.5265, label: 2, bag_size: 99232


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.3191489361702128: correct 120/376
Epoch: 34, train_loss: 0.5138, train_clustering_loss:  0.3739, train_error: 0.1702
class 0: acc 0.5, correct 5/10
class 1: acc 0.9, correct 9/10
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.6891, val_error: 0.6364, auc: 0.6840
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.2555, instance_loss: 0.2581, weighted_loss: 0.2562, label: 3, bag_size: 16626
batch 39, loss: 0.1570, instance_loss: 0.2241, weighted_loss: 0.1772, label: 1, bag_size: 69073


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.2632978723404255: correct 99/376
Epoch: 35, train_loss: 0.4895, train_clustering_loss:  0.3640, train_error: 0.1702
class 0: acc 1.0, correct 12/12
class 1: acc 0.6, correct 6/10
class 2: acc 0.9, correct 9/10
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.8917, val_error: 0.6364, auc: 0.6597
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0879, instance_loss: 0.1806, weighted_loss: 0.1157, label: 1, bag_size: 20030
batch 39, loss: 0.4101, instance_loss: 0.4680, weighted_loss: 0.4275, label: 2, bag_size: 99232


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.34574468085106386: correct 130/376
Epoch: 36, train_loss: 0.4577, train_clustering_loss:  0.3663, train_error: 0.1064
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 1.0, correct 16/16
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.8465, val_error: 0.6364, auc: 0.6597
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.1562, instance_loss: 0.2191, weighted_loss: 0.1751, label: 1, bag_size: 20030
batch 39, loss: 0.0934, instance_loss: 0.1639, weighted_loss: 0.1146, label: 2, bag_size: 44015


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.3962765957446808: correct 149/376
Epoch: 37, train_loss: 0.4793, train_clustering_loss:  0.3604, train_error: 0.1489
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.9803, val_error: 0.6364, auc: 0.6354
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.8735, instance_loss: 0.4598, weighted_loss: 0.7494, label: 1, bag_size: 49894
batch 39, loss: 0.3198, instance_loss: 0.3513, weighted_loss: 0.3292, label: 3, bag_size: 102779


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.2925531914893617: correct 110/376
Epoch: 38, train_loss: 0.4774, train_clustering_loss:  0.3828, train_error: 0.1702
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.9400, val_error: 0.5455, auc: 0.6354
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.3875, instance_loss: 0.4209, weighted_loss: 0.3975, label: 2, bag_size: 113492
batch 39, loss: 0.1637, instance_loss: 0.2220, weighted_loss: 0.1812, label: 1, bag_size: 69073


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.3271276595744681: correct 123/376
Epoch: 39, train_loss: 0.3827, train_clustering_loss:  0.3457, train_error: 0.0638
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 13/13
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.8916, val_error: 0.6364, auc: 0.6458
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.1275, instance_loss: 0.2088, weighted_loss: 0.1519, label: 1, bag_size: 132271
batch 39, loss: 0.1768, instance_loss: 0.2209, weighted_loss: 0.1900, label: 3, bag_size: 102779


class 0 clustering acc 0.9827127659574468: correct 1478/1504
class 1 clustering acc 0.3962765957446808: correct 149/376
Epoch: 40, train_loss: 0.4457, train_clustering_loss:  0.3352, train_error: 0.2128
class 0: acc 0.5, correct 5/10
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 2.0242, val_error: 0.6364, auc: 0.6458
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0477, instance_loss: 0.2445, weighted_loss: 0.1067, label: 0, bag_size: 56983
batch 39, loss: 0.1080, instance_loss: 0.1826, weighted_loss: 0.1304, label: 2, bag_size: 69807


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.3484042553191489: correct 131/376
Epoch: 41, train_loss: 0.4804, train_clustering_loss:  0.3584, train_error: 0.2128
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5, correct 5/10
class 2: acc 1.0, correct 13/13
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.5103, val_error: 0.5455, auc: 0.6285
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.2686, instance_loss: 0.3137, weighted_loss: 0.2821, label: 3, bag_size: 16626
batch 39, loss: 0.0669, instance_loss: 0.1309, weighted_loss: 0.0861, label: 3, bag_size: 152150


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.2978723404255319: correct 112/376
Epoch: 42, train_loss: 0.5778, train_clustering_loss:  0.3979, train_error: 0.2128
class 0: acc 0.625, correct 5/8
class 1: acc 0.75, correct 9/12
class 2: acc 0.875, correct 14/16
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.8869, val_error: 0.5455, auc: 0.6458
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0539, instance_loss: 0.0991, weighted_loss: 0.0674, label: 3, bag_size: 77542
batch 39, loss: 0.1640, instance_loss: 0.3060, weighted_loss: 0.2066, label: 2, bag_size: 9530


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.5345744680851063: correct 201/376
Epoch: 43, train_loss: 0.2952, train_clustering_loss:  0.2830, train_error: 0.0426
class 0: acc 1.0, correct 4/4
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 1.0, correct 17/17
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.9436, val_error: 0.5455, auc: 0.6319
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0043, instance_loss: 0.0318, weighted_loss: 0.0125, label: 3, bag_size: 48624
batch 39, loss: 0.0962, instance_loss: 0.2302, weighted_loss: 0.1364, label: 0, bag_size: 22124


class 0 clustering acc 0.9833776595744681: correct 1479/1504
class 1 clustering acc 0.4654255319148936: correct 175/376
Epoch: 44, train_loss: 0.3524, train_clustering_loss:  0.3124, train_error: 0.1489
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 1.9108, val_error: 0.5455, auc: 0.6319
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.0965, instance_loss: 0.1511, weighted_loss: 0.1129, label: 1, bag_size: 81420
batch 39, loss: 0.2330, instance_loss: 0.3328, weighted_loss: 0.2629, label: 0, bag_size: 6353


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.5585106382978723: correct 210/376
Epoch: 45, train_loss: 0.2593, train_clustering_loss:  0.2738, train_error: 0.0426
class 0: acc 1.0, correct 14/14
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.9068, val_error: 0.5455, auc: 0.6840
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.8400, instance_loss: 0.4592, weighted_loss: 0.7257, label: 1, bag_size: 18329
batch 39, loss: 0.0796, instance_loss: 0.1192, weighted_loss: 0.0915, label: 3, bag_size: 152150


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.4095744680851064: correct 154/376
Epoch: 46, train_loss: 0.4434, train_clustering_loss:  0.3273, train_error: 0.1915
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.8942, val_error: 0.6364, auc: 0.6458
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.1731, instance_loss: 0.2198, weighted_loss: 0.1871, label: 2, bag_size: 118767
batch 39, loss: 0.0115, instance_loss: 0.0308, weighted_loss: 0.0173, label: 3, bag_size: 66523


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.4627659574468085: correct 174/376
Epoch: 47, train_loss: 0.3440, train_clustering_loss:  0.3165, train_error: 0.0426
class 0: acc 0.9375, correct 15/16
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 2.0130, val_error: 0.6364, auc: 0.6458
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.0428, instance_loss: 0.1354, weighted_loss: 0.0706, label: 0, bag_size: 43538
batch 39, loss: 0.1283, instance_loss: 0.3795, weighted_loss: 0.2037, label: 1, bag_size: 104549


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.6063829787234043: correct 228/376
Epoch: 48, train_loss: 0.2148, train_clustering_loss:  0.2471, train_error: 0.0213
class 0: acc 0.875, correct 7/8
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 16/16
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 2.0361, val_error: 0.5455, auc: 0.6458
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.4184, instance_loss: 0.3788, weighted_loss: 0.4065, label: 0, bag_size: 18551
batch 39, loss: 0.2457, instance_loss: 0.3749, weighted_loss: 0.2845, label: 0, bag_size: 59350


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.5026595744680851: correct 189/376
Epoch: 49, train_loss: 0.3163, train_clustering_loss:  0.2982, train_error: 0.0851
class 0: acc 0.8, correct 8/10
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 10/10
class 3: acc 0.875, correct 14/16

Val Set, val_loss: 1.9849, val_error: 0.6364, auc: 0.6840
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.1668, instance_loss: 0.1859, weighted_loss: 0.1726, label: 2, bag_size: 69807
batch 39, loss: 0.0580, instance_loss: 0.1504, weighted_loss: 0.0857, label: 1, bag_size: 58270


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.5904255319148937: correct 222/376
Epoch: 50, train_loss: 0.2897, train_clustering_loss:  0.2823, train_error: 0.1277
class 0: acc 0.8, correct 8/10
class 1: acc 0.8125, correct 13/16
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.7624, val_error: 0.5455, auc: 0.6701
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.2481, instance_loss: 0.2596, weighted_loss: 0.2516, label: 2, bag_size: 54449
batch 39, loss: 0.3495, instance_loss: 0.3311, weighted_loss: 0.3440, label: 2, bag_size: 113492


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.6090425531914894: correct 229/376
Epoch: 51, train_loss: 0.1974, train_clustering_loss:  0.2629, train_error: 0.0213
class 0: acc 1.0, correct 16/16
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.9562, val_error: 0.6364, auc: 0.6840
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 42 out of 20
Early stopping
Val error: 0.6364, ROC AUC: 0.7292
Test error: 0.7273, ROC AUC: 0.4653
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3

Training Fold 7!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7717, instance_loss: 1.0505, weighted_loss: 1.5553, label: 3, bag_size: 48489
batch 39, loss: 1.5213, instance_loss: 0.9451, weighted_loss: 1.3484, label: 0, bag_size: 18551


class 0 clustering acc 0.9587765957446809: correct 1442/1504
class 1 clustering acc 0.023936170212765957: correct 9/376
Epoch: 0, train_loss: 1.4089, train_clustering_loss:  1.0498, train_error: 0.6596
class 0: acc 0.0, correct 0/13
class 1: acc 0.0, correct 0/9
class 2: acc 1.0, correct 16/16
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4111, val_error: 0.8182, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.411051).  Saving model ...


batch 19, loss: 1.4238, instance_loss: 0.7805, weighted_loss: 1.2308, label: 2, bag_size: 44015
batch 39, loss: 1.3646, instance_loss: 0.7202, weighted_loss: 1.1713, label: 1, bag_size: 16373


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4237, train_clustering_loss:  0.7874, train_error: 0.7872
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.0, correct 0/13
class 2: acc 0.0, correct 0/9
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.3555, val_error: 0.7273, auc: 0.8125
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.411051 --> 1.355452).  Saving model ...


batch 19, loss: 1.7144, instance_loss: 0.6715, weighted_loss: 1.4016, label: 2, bag_size: 75088
batch 39, loss: 1.2658, instance_loss: 0.6435, weighted_loss: 1.0791, label: 2, bag_size: 54449


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.4045, train_clustering_loss:  0.6486, train_error: 0.7021
class 0: acc 0.0, correct 0/8
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.14285714285714285, correct 2/14
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.4151, val_error: 0.7273, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3107, instance_loss: 0.5944, weighted_loss: 1.0958, label: 1, bag_size: 77634
batch 39, loss: 1.2236, instance_loss: 0.6114, weighted_loss: 1.0399, label: 2, bag_size: 118767


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3916, train_clustering_loss:  0.6144, train_error: 0.6809
class 0: acc 0.0, correct 0/11
class 1: acc 0.15384615384615385, correct 2/13
class 2: acc 1.0, correct 13/13
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3809, val_error: 0.6364, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0967, instance_loss: 0.5961, weighted_loss: 0.9466, label: 2, bag_size: 9530
batch 39, loss: 1.2887, instance_loss: 0.5882, weighted_loss: 1.0786, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3712, train_clustering_loss:  0.6046, train_error: 0.6596
class 0: acc 0.25, correct 4/16
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3626, val_error: 0.5455, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3117, instance_loss: 0.6030, weighted_loss: 1.0991, label: 0, bag_size: 54249
batch 39, loss: 1.3038, instance_loss: 0.6009, weighted_loss: 1.0929, label: 0, bag_size: 108548


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.4202, train_clustering_loss:  0.6055, train_error: 0.8511
class 0: acc 0.4, correct 4/10
class 1: acc 0.1, correct 1/10
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.0625, correct 1/16

Val Set, val_loss: 1.3398, val_error: 0.7273, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.355452 --> 1.339818).  Saving model ...


batch 19, loss: 1.9092, instance_loss: 0.6282, weighted_loss: 1.5249, label: 2, bag_size: 9530
batch 39, loss: 1.7288, instance_loss: 0.6416, weighted_loss: 1.4027, label: 2, bag_size: 44015


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3729, train_clustering_loss:  0.5986, train_error: 0.6596
class 0: acc 0.0, correct 0/10
class 1: acc 0.07692307692307693, correct 1/13
class 2: acc 0.0, correct 0/8
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.3390, val_error: 0.7273, auc: 0.8611
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.339818 --> 1.338987).  Saving model ...


batch 19, loss: 1.0050, instance_loss: 0.5747, weighted_loss: 0.8759, label: 1, bag_size: 49894
batch 39, loss: 1.5267, instance_loss: 0.6143, weighted_loss: 1.2530, label: 0, bag_size: 54249


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3739, train_clustering_loss:  0.6018, train_error: 0.7234
class 0: acc 0.0, correct 0/12
class 1: acc 0.8125, correct 13/16
class 2: acc 0.0, correct 0/12
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.3579, val_error: 0.7273, auc: 0.7812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2940, instance_loss: 0.6060, weighted_loss: 1.0876, label: 0, bag_size: 13999
batch 39, loss: 1.3091, instance_loss: 0.5939, weighted_loss: 1.0945, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.3317, train_clustering_loss:  0.6003, train_error: 0.7021
class 0: acc 0.5333333333333333, correct 8/15
class 1: acc 0.125, correct 1/8
class 2: acc 0.3333333333333333, correct 5/15
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3949, val_error: 0.6364, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.0365, instance_loss: 0.6323, weighted_loss: 1.6152, label: 1, bag_size: 18329
batch 39, loss: 1.3198, instance_loss: 0.5840, weighted_loss: 1.0991, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2794, train_clustering_loss:  0.5896, train_error: 0.5532
class 0: acc 0.2727272727272727, correct 3/11
class 1: acc 0.0, correct 0/8
class 2: acc 0.9473684210526315, correct 18/19
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4614, val_error: 0.8182, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7750, instance_loss: 0.5284, weighted_loss: 0.7010, label: 2, bag_size: 44015
batch 39, loss: 1.6770, instance_loss: 0.6643, weighted_loss: 1.3732, label: 1, bag_size: 16373


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2667, train_clustering_loss:  0.5868, train_error: 0.5957
class 0: acc 0.0, correct 0/11
class 1: acc 0.0, correct 0/7
class 2: acc 1.0, correct 19/19
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.4306, val_error: 0.8182, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.9268, instance_loss: 0.6615, weighted_loss: 0.8472, label: 0, bag_size: 43538
batch 39, loss: 1.2918, instance_loss: 0.6632, weighted_loss: 1.1032, label: 1, bag_size: 64834


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.3005, train_clustering_loss:  0.6138, train_error: 0.6809
class 0: acc 0.625, correct 10/16
class 1: acc 0.0, correct 0/14
class 2: acc 0.625, correct 5/8
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.2934, val_error: 0.5455, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.338987 --> 1.293425).  Saving model ...


batch 19, loss: 1.1529, instance_loss: 0.5917, weighted_loss: 0.9845, label: 3, bag_size: 77542
batch 39, loss: 1.2670, instance_loss: 0.5784, weighted_loss: 1.0604, label: 2, bag_size: 9530


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.3532, train_clustering_loss:  0.5997, train_error: 0.7021
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.16666666666666666, correct 2/12
class 3: acc 0.09090909090909091, correct 1/11

Val Set, val_loss: 1.2529, val_error: 0.5455, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.293425 --> 1.252859).  Saving model ...


batch 19, loss: 1.6410, instance_loss: 0.6137, weighted_loss: 1.3328, label: 2, bag_size: 75088
batch 39, loss: 1.6319, instance_loss: 0.6136, weighted_loss: 1.3264, label: 2, bag_size: 9530


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2930, train_clustering_loss:  0.5958, train_error: 0.5957
class 0: acc 0.5714285714285714, correct 8/14
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.0, correct 0/10
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.2758, val_error: 0.8182, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.8162, instance_loss: 0.6576, weighted_loss: 1.4686, label: 1, bag_size: 77634
batch 39, loss: 1.5797, instance_loss: 0.5799, weighted_loss: 1.2798, label: 3, bag_size: 98956


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1784, train_clustering_loss:  0.5848, train_error: 0.4894
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.0, correct 0/7
class 2: acc 0.625, correct 10/16
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.2949, val_error: 0.6364, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4490, instance_loss: 0.6353, weighted_loss: 1.2049, label: 3, bag_size: 4963
batch 39, loss: 1.3198, instance_loss: 0.5479, weighted_loss: 1.0882, label: 3, bag_size: 152150


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.1445, train_clustering_loss:  0.5837, train_error: 0.4894
class 0: acc 0.2222222222222222, correct 2/9
class 1: acc 0.7647058823529411, correct 13/17
class 2: acc 1.0, correct 6/6
class 3: acc 0.2, correct 3/15

Val Set, val_loss: 1.2518, val_error: 0.7273, auc: 0.7743
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.252859 --> 1.251756).  Saving model ...


batch 19, loss: 1.8338, instance_loss: 0.6391, weighted_loss: 1.4754, label: 2, bag_size: 9530
batch 39, loss: 1.0372, instance_loss: 0.6011, weighted_loss: 0.9064, label: 0, bag_size: 13999


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.2385, train_clustering_loss:  0.5961, train_error: 0.5532
class 0: acc 0.47058823529411764, correct 8/17
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.0, correct 0/9
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.2801, val_error: 0.6364, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1474, instance_loss: 0.5513, weighted_loss: 0.9686, label: 1, bag_size: 57038
batch 39, loss: 0.9063, instance_loss: 0.5471, weighted_loss: 0.7985, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.1634, train_clustering_loss:  0.5792, train_error: 0.5532
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.3076923076923077, correct 4/13
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.14285714285714285, correct 1/7

Val Set, val_loss: 1.2796, val_error: 0.4545, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.7810, instance_loss: 0.6158, weighted_loss: 1.4314, label: 3, bag_size: 98956
batch 39, loss: 0.9870, instance_loss: 0.5439, weighted_loss: 0.8541, label: 1, bag_size: 57038


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 1.0091, train_clustering_loss:  0.5573, train_error: 0.3404
class 0: acc 0.5, correct 5/10
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 1.0, correct 13/13
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.2127, val_error: 0.5455, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.251756 --> 1.212712).  Saving model ...


batch 19, loss: 1.6965, instance_loss: 0.6237, weighted_loss: 1.3747, label: 0, bag_size: 70920
batch 39, loss: 1.1711, instance_loss: 0.6169, weighted_loss: 1.0048, label: 3, bag_size: 83890


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 1.1039, train_clustering_loss:  0.5614, train_error: 0.3830
class 0: acc 0.1, correct 1/10
class 1: acc 1.0, correct 12/12
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.1529, val_error: 0.3636, auc: 0.7639
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.212712 --> 1.152868).  Saving model ...


batch 19, loss: 1.3449, instance_loss: 0.5569, weighted_loss: 1.1085, label: 1, bag_size: 132271
batch 39, loss: 2.4601, instance_loss: 0.7020, weighted_loss: 1.9327, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 1.1156, train_clustering_loss:  0.5616, train_error: 0.4681
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.25, correct 2/8
class 3: acc 0.6470588235294118, correct 11/17

Val Set, val_loss: 1.1810, val_error: 0.5455, auc: 0.7639
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.8020, instance_loss: 0.6313, weighted_loss: 1.4508, label: 3, bag_size: 22057
batch 39, loss: 1.0371, instance_loss: 0.4862, weighted_loss: 0.8718, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 1.0452, train_clustering_loss:  0.5556, train_error: 0.4468
class 0: acc 0.2857142857142857, correct 4/14
class 1: acc 0.8, correct 12/15
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.1927, val_error: 0.6364, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3948, instance_loss: 0.4555, weighted_loss: 0.4130, label: 3, bag_size: 77542
batch 39, loss: 0.6673, instance_loss: 0.6092, weighted_loss: 0.6499, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 22, train_loss: 0.9778, train_clustering_loss:  0.5290, train_error: 0.3404
class 0: acc 0.07692307692307693, correct 1/13
class 1: acc 1.0, correct 16/16
class 2: acc 0.4, correct 2/5
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.1850, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.3302, instance_loss: 0.4225, weighted_loss: 0.3579, label: 3, bag_size: 77542
batch 39, loss: 1.1234, instance_loss: 0.6283, weighted_loss: 0.9749, label: 0, bag_size: 56348


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 1.0237, train_clustering_loss:  0.5576, train_error: 0.4043
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.1973, val_error: 0.4545, auc: 0.7812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.5211, instance_loss: 0.6042, weighted_loss: 1.2460, label: 2, bag_size: 9530
batch 39, loss: 0.2898, instance_loss: 0.4498, weighted_loss: 0.3378, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 1.0330, train_clustering_loss:  0.5463, train_error: 0.4468
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.125, correct 1/8
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.2064, val_error: 0.4545, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.3189, instance_loss: 0.4665, weighted_loss: 0.3632, label: 0, bag_size: 43538
batch 39, loss: 0.5282, instance_loss: 0.4427, weighted_loss: 0.5026, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 25, train_loss: 0.8902, train_clustering_loss:  0.5303, train_error: 0.3617
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.875, correct 14/16
class 3: acc 0.14285714285714285, correct 1/7

Val Set, val_loss: 1.4074, val_error: 0.5455, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.3409, instance_loss: 0.6211, weighted_loss: 1.1250, label: 0, bag_size: 18551
batch 39, loss: 1.7145, instance_loss: 0.7014, weighted_loss: 1.4106, label: 0, bag_size: 130978


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 26, train_loss: 0.9406, train_clustering_loss:  0.5216, train_error: 0.3830
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.3103, val_error: 0.4545, auc: 0.7396
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.9289, instance_loss: 0.5274, weighted_loss: 0.8085, label: 2, bag_size: 54449
batch 39, loss: 2.1411, instance_loss: 0.7543, weighted_loss: 1.7250, label: 3, bag_size: 22057


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 27, train_loss: 0.9163, train_clustering_loss:  0.5292, train_error: 0.3617
class 0: acc 0.7, correct 7/10
class 1: acc 0.5, correct 5/10
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.5, correct 8/16

Val Set, val_loss: 1.2902, val_error: 0.3636, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.9116, instance_loss: 0.6330, weighted_loss: 1.5280, label: 0, bag_size: 19277
batch 39, loss: 1.6571, instance_loss: 0.6218, weighted_loss: 1.3465, label: 0, bag_size: 54249


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 28, train_loss: 0.8698, train_clustering_loss:  0.5059, train_error: 0.2340
class 0: acc 0.1, correct 1/10
class 1: acc 1.0, correct 16/16
class 2: acc 0.9, correct 9/10
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.2143, val_error: 0.3636, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.9161, instance_loss: 0.5148, weighted_loss: 0.7957, label: 3, bag_size: 83890
batch 39, loss: 0.1355, instance_loss: 0.2865, weighted_loss: 0.1808, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.007978723404255319: correct 3/376
Epoch: 29, train_loss: 0.8148, train_clustering_loss:  0.5026, train_error: 0.3404
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.2215, val_error: 0.4545, auc: 0.7500
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.6726, instance_loss: 0.5022, weighted_loss: 0.6215, label: 2, bag_size: 75088
batch 39, loss: 0.7222, instance_loss: 0.4771, weighted_loss: 0.6487, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.02127659574468085: correct 8/376
Epoch: 30, train_loss: 0.8204, train_clustering_loss:  0.4997, train_error: 0.3191
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.14285714285714285, correct 1/7
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.2871, val_error: 0.4545, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.4768, instance_loss: 0.4087, weighted_loss: 0.4564, label: 1, bag_size: 16373
batch 39, loss: 0.8007, instance_loss: 0.4608, weighted_loss: 0.6987, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 31, train_loss: 0.7899, train_clustering_loss:  0.5052, train_error: 0.3404
class 0: acc 0.375, correct 6/16
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 1.0, correct 11/11
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.2806, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.0951, instance_loss: 0.5568, weighted_loss: 0.9336, label: 3, bag_size: 22057
batch 39, loss: 0.8101, instance_loss: 0.4730, weighted_loss: 0.7090, label: 0, bag_size: 47775


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 32, train_loss: 0.7281, train_clustering_loss:  0.4772, train_error: 0.3404
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 1.0, correct 11/11
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.2022, val_error: 0.5455, auc: 0.7326
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.2176, instance_loss: 0.3840, weighted_loss: 0.2675, label: 0, bag_size: 43538
batch 39, loss: 0.8489, instance_loss: 0.5061, weighted_loss: 0.7461, label: 1, bag_size: 64834


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 33, train_loss: 0.7503, train_clustering_loss:  0.4897, train_error: 0.3404
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 1.0, correct 15/15
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.3392, val_error: 0.5455, auc: 0.7361
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1748, instance_loss: 0.4006, weighted_loss: 0.2425, label: 3, bag_size: 16626
batch 39, loss: 0.8540, instance_loss: 0.5391, weighted_loss: 0.7595, label: 2, bag_size: 99232


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.031914893617021274: correct 12/376
Epoch: 34, train_loss: 0.6763, train_clustering_loss:  0.4630, train_error: 0.2340
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.2546, val_error: 0.4545, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.4340, instance_loss: 0.6147, weighted_loss: 0.4882, label: 3, bag_size: 16626
batch 39, loss: 0.3753, instance_loss: 0.3847, weighted_loss: 0.3781, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.018617021276595744: correct 7/376
Epoch: 35, train_loss: 0.5929, train_clustering_loss:  0.4431, train_error: 0.2340
class 0: acc 0.5, correct 5/10
class 1: acc 0.9, correct 9/10
class 2: acc 1.0, correct 15/15
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.4675, val_error: 0.5455, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.4660, instance_loss: 0.4152, weighted_loss: 0.4508, label: 1, bag_size: 20030
batch 39, loss: 0.7012, instance_loss: 0.5180, weighted_loss: 0.6462, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.05585106382978723: correct 21/376
Epoch: 36, train_loss: 0.6632, train_clustering_loss:  0.4582, train_error: 0.2128
class 0: acc 0.38461538461538464, correct 5/13
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 10/10
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.2419, val_error: 0.2727, auc: 0.8299
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.8356, instance_loss: 0.4898, weighted_loss: 0.7319, label: 1, bag_size: 20030
batch 39, loss: 0.7520, instance_loss: 0.5486, weighted_loss: 0.6910, label: 1, bag_size: 18329


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.05319148936170213: correct 20/376
Epoch: 37, train_loss: 0.6573, train_clustering_loss:  0.4560, train_error: 0.2979
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.3395, val_error: 0.4545, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.1348, instance_loss: 0.6334, weighted_loss: 0.9844, label: 3, bag_size: 4963
batch 39, loss: 0.1943, instance_loss: 0.3016, weighted_loss: 0.2265, label: 2, bag_size: 75088


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.05851063829787234: correct 22/376
Epoch: 38, train_loss: 0.7344, train_clustering_loss:  0.4611, train_error: 0.3191
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.3210, val_error: 0.3636, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.3516, instance_loss: 0.6870, weighted_loss: 1.1523, label: 3, bag_size: 22057
batch 39, loss: 0.3314, instance_loss: 0.3055, weighted_loss: 0.3236, label: 2, bag_size: 23349


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.07446808510638298: correct 28/376
Epoch: 39, train_loss: 0.6638, train_clustering_loss:  0.4555, train_error: 0.1915
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 1.0, correct 14/14
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.5822, val_error: 0.4545, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0808, instance_loss: 0.2043, weighted_loss: 0.1179, label: 3, bag_size: 48489
batch 39, loss: 0.1932, instance_loss: 0.2753, weighted_loss: 0.2178, label: 2, bag_size: 75088


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0797872340425532: correct 30/376
Epoch: 40, train_loss: 0.6044, train_clustering_loss:  0.4336, train_error: 0.1915
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 16/16
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.3052, val_error: 0.4545, auc: 0.8160
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.8060, instance_loss: 0.5387, weighted_loss: 0.7258, label: 0, bag_size: 56983
batch 39, loss: 0.1017, instance_loss: 0.2584, weighted_loss: 0.1487, label: 3, bag_size: 77542


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.14095744680851063: correct 53/376
Epoch: 41, train_loss: 0.5515, train_clustering_loss:  0.4244, train_error: 0.1702
class 0: acc 0.6, correct 6/10
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 14/14
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.2406, val_error: 0.3636, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.1107, instance_loss: 0.2450, weighted_loss: 0.1510, label: 3, bag_size: 16626
batch 39, loss: 0.1639, instance_loss: 0.3141, weighted_loss: 0.2090, label: 3, bag_size: 16626


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.09840425531914894: correct 37/376
Epoch: 42, train_loss: 0.5880, train_clustering_loss:  0.4411, train_error: 0.1702
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.875, correct 7/8
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 1.3292, val_error: 0.2727, auc: 0.7396
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.4029, instance_loss: 0.3559, weighted_loss: 0.3888, label: 1, bag_size: 47433
batch 39, loss: 0.3748, instance_loss: 0.3514, weighted_loss: 0.3678, label: 1, bag_size: 64834


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.06914893617021277: correct 26/376
Epoch: 43, train_loss: 0.6532, train_clustering_loss:  0.4547, train_error: 0.1915
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 1.0, correct 16/16
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.3456, val_error: 0.3636, auc: 0.8125
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.2404, instance_loss: 0.2640, weighted_loss: 0.2475, label: 2, bag_size: 7532
batch 39, loss: 0.4052, instance_loss: 0.3398, weighted_loss: 0.3856, label: 1, bag_size: 77634


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.11436170212765957: correct 43/376
Epoch: 44, train_loss: 0.6027, train_clustering_loss:  0.4236, train_error: 0.2128
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 14/14
class 3: acc 0.4, correct 2/5

Val Set, val_loss: 1.2845, val_error: 0.4545, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.1216, instance_loss: 0.2992, weighted_loss: 0.1749, label: 0, bag_size: 43538
batch 39, loss: 0.5855, instance_loss: 0.4079, weighted_loss: 0.5322, label: 1, bag_size: 49894


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.19680851063829788: correct 74/376
Epoch: 45, train_loss: 0.4548, train_clustering_loss:  0.3781, train_error: 0.1915
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 14/14
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.3291, val_error: 0.3636, auc: 0.8090
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.1592, instance_loss: 0.3409, weighted_loss: 0.2137, label: 0, bag_size: 130978
batch 39, loss: 0.1491, instance_loss: 0.2747, weighted_loss: 0.1868, label: 3, bag_size: 16626


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.15425531914893617: correct 58/376
Epoch: 46, train_loss: 0.5126, train_clustering_loss:  0.4072, train_error: 0.1489
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.75, correct 9/12
class 2: acc 1.0, correct 15/15
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.3400, val_error: 0.3636, auc: 0.7986
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.1855, instance_loss: 0.1985, weighted_loss: 0.1894, label: 2, bag_size: 44015
batch 39, loss: 2.0698, instance_loss: 0.8384, weighted_loss: 1.7004, label: 0, bag_size: 56348


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.23404255319148937: correct 88/376
Epoch: 47, train_loss: 0.5786, train_clustering_loss:  0.4150, train_error: 0.2553
class 0: acc 0.16666666666666666, correct 2/12
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 13/13
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.2209, val_error: 0.1818, auc: 0.8229
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.8803, instance_loss: 0.6149, weighted_loss: 0.8007, label: 0, bag_size: 13999
batch 39, loss: 0.3407, instance_loss: 0.2726, weighted_loss: 0.3203, label: 1, bag_size: 16373


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.2047872340425532: correct 77/376
Epoch: 48, train_loss: 0.5684, train_clustering_loss:  0.4080, train_error: 0.1915
class 0: acc 0.4, correct 4/10
class 1: acc 0.95, correct 19/20
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.5759, val_error: 0.4545, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.2605, instance_loss: 0.2352, weighted_loss: 0.2529, label: 2, bag_size: 22416
batch 39, loss: 0.2397, instance_loss: 0.3106, weighted_loss: 0.2610, label: 3, bag_size: 25448


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.34574468085106386: correct 130/376
Epoch: 49, train_loss: 0.5712, train_clustering_loss:  0.4091, train_error: 0.1915
class 0: acc 0.3, correct 3/10
class 1: acc 1.0, correct 12/12
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.9444444444444444, correct 17/18

Val Set, val_loss: 1.2170, val_error: 0.2727, auc: 0.8090
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.0621, instance_loss: 0.1385, weighted_loss: 0.0850, label: 3, bag_size: 77542
batch 39, loss: 0.6827, instance_loss: 0.5827, weighted_loss: 0.6527, label: 0, bag_size: 18551


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.2473404255319149: correct 93/376
Epoch: 50, train_loss: 0.5367, train_clustering_loss:  0.4071, train_error: 0.1489
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.875, correct 7/8
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.2976, val_error: 0.3636, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 1.2122, instance_loss: 0.5331, weighted_loss: 1.0085, label: 2, bag_size: 54449
batch 39, loss: 0.8043, instance_loss: 0.4299, weighted_loss: 0.6920, label: 0, bag_size: 47775


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.19680851063829788: correct 74/376
Epoch: 51, train_loss: 0.5501, train_clustering_loss:  0.4082, train_error: 0.2340
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.125, correct 1/8
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.2450, val_error: 0.2727, auc: 0.8125
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 32 out of 20
Early stopping
Val error: 0.3636, ROC AUC: 0.7639
Test error: 0.9091, ROC AUC: 0.6528
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3

Training Fold 8!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6276, instance_loss: 1.0655, weighted_loss: 1.4590, label: 0, bag_size: 41829
batch 39, loss: 1.8480, instance_loss: 0.9291, weighted_loss: 1.5723, label: 1, bag_size: 16373


class 0 clustering acc 0.9361702127659575: correct 1408/1504
class 1 clustering acc 0.10372340425531915: correct 39/376
Epoch: 0, train_loss: 1.4158, train_clustering_loss:  1.0338, train_error: 0.7447
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/9
class 2: acc 0.07142857142857142, correct 1/14
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.4372, val_error: 0.8182, auc: 0.4236
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.437186).  Saving model ...


batch 19, loss: 1.1949, instance_loss: 0.6525, weighted_loss: 1.0322, label: 3, bag_size: 42569
batch 39, loss: 1.0866, instance_loss: 0.6857, weighted_loss: 0.9664, label: 1, bag_size: 47433


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3383, train_clustering_loss:  0.7417, train_error: 0.5532
class 0: acc 0.0, correct 0/6
class 1: acc 0.5555555555555556, correct 10/18
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.4347, val_error: 0.7273, auc: 0.5764
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.437186 --> 1.434684).  Saving model ...


batch 19, loss: 1.6026, instance_loss: 0.6538, weighted_loss: 1.3179, label: 2, bag_size: 69807
batch 39, loss: 1.4143, instance_loss: 0.6503, weighted_loss: 1.1851, label: 2, bag_size: 54449


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3928, train_clustering_loss:  0.6430, train_error: 0.6596
class 0: acc 0.0, correct 0/10
class 1: acc 1.0, correct 15/15
class 2: acc 0.0, correct 0/13
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.4229, val_error: 0.7273, auc: 0.5764
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.434684 --> 1.422900).  Saving model ...


batch 19, loss: 1.7395, instance_loss: 0.6528, weighted_loss: 1.4135, label: 0, bag_size: 22124
batch 39, loss: 1.2406, instance_loss: 0.6080, weighted_loss: 1.0508, label: 2, bag_size: 89905


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3624, train_clustering_loss:  0.6136, train_error: 0.6596
class 0: acc 0.0, correct 0/8
class 1: acc 1.0, correct 16/16
class 2: acc 0.0, correct 0/13
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.4285, val_error: 0.7273, auc: 0.5729
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5191, instance_loss: 0.6255, weighted_loss: 1.2510, label: 3, bag_size: 24102
batch 39, loss: 1.4771, instance_loss: 0.6085, weighted_loss: 1.2165, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3828, train_clustering_loss:  0.6096, train_error: 0.6809
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.36363636363636365, correct 4/11
class 3: acc 0.3333333333333333, correct 4/12

Val Set, val_loss: 1.3939, val_error: 0.7273, auc: 0.5000
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.422900 --> 1.393899).  Saving model ...


batch 19, loss: 1.5191, instance_loss: 0.6568, weighted_loss: 1.2604, label: 0, bag_size: 130978
batch 39, loss: 1.2799, instance_loss: 0.6301, weighted_loss: 1.0849, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3559, train_clustering_loss:  0.6126, train_error: 0.7660
class 0: acc 0.0, correct 0/13
class 1: acc 0.2727272727272727, correct 3/11
class 2: acc 0.08333333333333333, correct 1/12
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.3886, val_error: 0.7273, auc: 0.5278
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.393899 --> 1.388627).  Saving model ...


batch 19, loss: 1.1501, instance_loss: 0.5795, weighted_loss: 0.9789, label: 3, bag_size: 24102
batch 39, loss: 0.9274, instance_loss: 0.5517, weighted_loss: 0.8147, label: 3, bag_size: 24102


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.2939, train_clustering_loss:  0.6020, train_error: 0.5745
class 0: acc 0.5, correct 8/16
class 1: acc 0.0, correct 0/7
class 2: acc 0.1111111111111111, correct 1/9
class 3: acc 0.7333333333333333, correct 11/15

Val Set, val_loss: 1.4196, val_error: 0.6364, auc: 0.4479
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1435, instance_loss: 0.5725, weighted_loss: 0.9722, label: 0, bag_size: 22124
batch 39, loss: 1.2618, instance_loss: 0.5862, weighted_loss: 1.0591, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3166, train_clustering_loss:  0.6021, train_error: 0.5319
class 0: acc 1.0, correct 15/15
class 1: acc 0.09090909090909091, correct 1/11
class 2: acc 0.2, correct 2/10
class 3: acc 0.36363636363636365, correct 4/11

Val Set, val_loss: 1.3928, val_error: 0.8182, auc: 0.4792
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2595, instance_loss: 0.5972, weighted_loss: 1.0608, label: 2, bag_size: 22416
batch 39, loss: 1.9007, instance_loss: 0.6690, weighted_loss: 1.5312, label: 1, bag_size: 112135


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2703, train_clustering_loss:  0.6007, train_error: 0.5745
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.0, correct 0/8
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.4986, val_error: 0.8182, auc: 0.4236
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3436, instance_loss: 0.6244, weighted_loss: 1.1278, label: 1, bag_size: 66789
batch 39, loss: 1.1357, instance_loss: 0.5748, weighted_loss: 0.9674, label: 1, bag_size: 23122


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2406, train_clustering_loss:  0.5978, train_error: 0.6383
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.07692307692307693, correct 1/13
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.36363636363636365, correct 4/11

Val Set, val_loss: 1.4853, val_error: 0.8182, auc: 0.3889
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.1619, instance_loss: 0.5930, weighted_loss: 0.9912, label: 3, bag_size: 24102
batch 39, loss: 1.6277, instance_loss: 0.6572, weighted_loss: 1.3366, label: 1, bag_size: 47433


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2083, train_clustering_loss:  0.5965, train_error: 0.4894
class 0: acc 0.5, correct 4/8
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.625, correct 10/16

Val Set, val_loss: 1.6395, val_error: 0.7273, auc: 0.3958
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.6011, instance_loss: 0.6342, weighted_loss: 1.3111, label: 0, bag_size: 18551
batch 39, loss: 0.3596, instance_loss: 0.4342, weighted_loss: 0.3820, label: 3, bag_size: 77542


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.1468, train_clustering_loss:  0.5804, train_error: 0.5319
class 0: acc 0.14285714285714285, correct 2/14
class 1: acc 0.6666666666666666, correct 12/18
class 2: acc 0.0, correct 0/6
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.6073, val_error: 0.8182, auc: 0.3819
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.3264, instance_loss: 0.4523, weighted_loss: 0.3642, label: 3, bag_size: 42569
batch 39, loss: 1.1047, instance_loss: 0.6499, weighted_loss: 0.9682, label: 2, bag_size: 44015


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.1635, train_clustering_loss:  0.5835, train_error: 0.4468
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.75, correct 9/12
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.6342, val_error: 0.8182, auc: 0.4236
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.1081, instance_loss: 0.6369, weighted_loss: 0.9668, label: 2, bag_size: 69807
batch 39, loss: 0.5609, instance_loss: 0.5097, weighted_loss: 0.5455, label: 3, bag_size: 24102


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.1144, train_clustering_loss:  0.5868, train_error: 0.4255
class 0: acc 0.6, correct 6/10
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.6866, val_error: 0.8182, auc: 0.4757
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.2422, instance_loss: 0.6041, weighted_loss: 1.0508, label: 0, bag_size: 22124
batch 39, loss: 0.7152, instance_loss: 0.5793, weighted_loss: 0.6744, label: 2, bag_size: 118767


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 0.9977, train_clustering_loss:  0.5518, train_error: 0.4043
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.8, correct 8/10
class 3: acc 0.8235294117647058, correct 14/17

Val Set, val_loss: 1.6786, val_error: 0.8182, auc: 0.4965
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 2.1804, instance_loss: 0.6413, weighted_loss: 1.7187, label: 3, bag_size: 16626
batch 39, loss: 1.0988, instance_loss: 0.6267, weighted_loss: 0.9572, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 0.9328, train_clustering_loss:  0.5454, train_error: 0.3404
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.8, correct 12/15
class 2: acc 0.8, correct 4/5
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.7388, val_error: 0.9091, auc: 0.4236
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.1253, instance_loss: 0.6304, weighted_loss: 0.9769, label: 2, bag_size: 44015
batch 39, loss: 0.4274, instance_loss: 0.5260, weighted_loss: 0.4570, label: 2, bag_size: 22416


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.031914893617021274: correct 12/376
Epoch: 16, train_loss: 0.9226, train_clustering_loss:  0.5362, train_error: 0.4255
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.46153846153846156, correct 6/13
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.8628, val_error: 0.9091, auc: 0.4167
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 2.1054, instance_loss: 0.6448, weighted_loss: 1.6672, label: 3, bag_size: 48518
batch 39, loss: 0.7295, instance_loss: 0.5866, weighted_loss: 0.6866, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.026595744680851064: correct 10/376
Epoch: 17, train_loss: 0.9028, train_clustering_loss:  0.5311, train_error: 0.3830
class 0: acc 0.5625, correct 9/16
class 1: acc 0.25, correct 2/8
class 2: acc 0.8, correct 8/10
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.8040, val_error: 0.8182, auc: 0.4583
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.9407, instance_loss: 0.5598, weighted_loss: 0.8265, label: 2, bag_size: 118767
batch 39, loss: 0.4502, instance_loss: 0.4291, weighted_loss: 0.4439, label: 3, bag_size: 48518


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.04521276595744681: correct 17/376
Epoch: 18, train_loss: 0.9718, train_clustering_loss:  0.5352, train_error: 0.3404
class 0: acc 1.0, correct 11/11
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.9, correct 9/10
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.6711, val_error: 0.5455, auc: 0.4965
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.6947, instance_loss: 0.5641, weighted_loss: 1.3555, label: 0, bag_size: 10671
batch 39, loss: 0.2783, instance_loss: 0.3134, weighted_loss: 0.2888, label: 3, bag_size: 17590


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.031914893617021274: correct 12/376
Epoch: 19, train_loss: 0.9994, train_clustering_loss:  0.5369, train_error: 0.4255
class 0: acc 0.5, correct 6/12
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.46153846153846156, correct 6/13
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.8744, val_error: 0.6364, auc: 0.4826
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.4205, instance_loss: 0.5629, weighted_loss: 1.1632, label: 0, bag_size: 13999
batch 39, loss: 0.9961, instance_loss: 0.5956, weighted_loss: 0.8759, label: 1, bag_size: 112135


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.018617021276595744: correct 7/376
Epoch: 20, train_loss: 0.8514, train_clustering_loss:  0.5103, train_error: 0.1915
class 0: acc 0.5, correct 4/8
class 1: acc 1.0, correct 16/16
class 2: acc 1.0, correct 12/12
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.9234, val_error: 0.8182, auc: 0.4688
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.2882, instance_loss: 0.3448, weighted_loss: 0.3052, label: 3, bag_size: 48489
batch 39, loss: 0.6041, instance_loss: 0.4629, weighted_loss: 0.5617, label: 1, bag_size: 66789


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.026595744680851064: correct 10/376
Epoch: 21, train_loss: 0.8162, train_clustering_loss:  0.5036, train_error: 0.2553
class 0: acc 0.5, correct 7/14
class 1: acc 0.8888888888888888, correct 16/18
class 2: acc 0.5, correct 2/4
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.9061, val_error: 0.7273, auc: 0.4167
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0527, instance_loss: 0.1557, weighted_loss: 0.0836, label: 3, bag_size: 42569
batch 39, loss: 1.2060, instance_loss: 0.6221, weighted_loss: 1.0308, label: 0, bag_size: 54249


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.09574468085106383: correct 36/376
Epoch: 22, train_loss: 0.7409, train_clustering_loss:  0.4722, train_error: 0.3191
class 0: acc 0.25, correct 3/12
class 1: acc 1.0, correct 16/16
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.9640, val_error: 0.9091, auc: 0.4167
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 1.7009, instance_loss: 0.6345, weighted_loss: 1.3810, label: 3, bag_size: 48518
batch 39, loss: 0.0652, instance_loss: 0.1634, weighted_loss: 0.0946, label: 3, bag_size: 102779


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.09042553191489362: correct 34/376
Epoch: 23, train_loss: 0.7678, train_clustering_loss:  0.4670, train_error: 0.2979
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.7333333333333333, correct 11/15

Val Set, val_loss: 2.0143, val_error: 0.8182, auc: 0.3993
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.6983, instance_loss: 0.5075, weighted_loss: 0.6410, label: 2, bag_size: 44015
batch 39, loss: 0.6790, instance_loss: 0.5422, weighted_loss: 0.6380, label: 0, bag_size: 18551


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.14627659574468085: correct 55/376
Epoch: 24, train_loss: 0.6859, train_clustering_loss:  0.4500, train_error: 0.1702
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 2.2105, val_error: 0.9091, auc: 0.4410
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.3206, instance_loss: 0.4279, weighted_loss: 0.3528, label: 0, bag_size: 18551
batch 39, loss: 0.8821, instance_loss: 0.5668, weighted_loss: 0.7875, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0851063829787234: correct 32/376
Epoch: 25, train_loss: 0.8722, train_clustering_loss:  0.4808, train_error: 0.4255
class 0: acc 0.5333333333333333, correct 8/15
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.7, correct 7/10
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.9123, val_error: 0.9091, auc: 0.4201
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.7463, instance_loss: 0.5234, weighted_loss: 0.6794, label: 1, bag_size: 16373
batch 39, loss: 0.8026, instance_loss: 0.5418, weighted_loss: 0.7244, label: 1, bag_size: 69073


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.1702127659574468: correct 64/376
Epoch: 26, train_loss: 0.7309, train_clustering_loss:  0.4546, train_error: 0.2340
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.9, correct 9/10
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 2.1651, val_error: 0.9091, auc: 0.4201
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.4150, instance_loss: 0.5790, weighted_loss: 1.1642, label: 2, bag_size: 54449
batch 39, loss: 0.9144, instance_loss: 0.5563, weighted_loss: 0.8069, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.20212765957446807: correct 76/376
Epoch: 27, train_loss: 0.6708, train_clustering_loss:  0.4239, train_error: 0.2766
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.8666666666666667, correct 13/15

Val Set, val_loss: 2.2963, val_error: 1.0000, auc: 0.3993
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.8861, instance_loss: 0.5276, weighted_loss: 0.7785, label: 0, bag_size: 65047
batch 39, loss: 0.7696, instance_loss: 0.5705, weighted_loss: 0.7099, label: 0, bag_size: 130978


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.24468085106382978: correct 92/376
Epoch: 28, train_loss: 0.6141, train_clustering_loss:  0.4010, train_error: 0.1489
class 0: acc 1.0, correct 11/11
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 1.0, correct 10/10
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 2.2823, val_error: 0.8182, auc: 0.3889
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 1.0175, instance_loss: 0.5320, weighted_loss: 0.8718, label: 2, bag_size: 118767
batch 39, loss: 0.3492, instance_loss: 0.4305, weighted_loss: 0.3736, label: 0, bag_size: 41829


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.1356382978723404: correct 51/376
Epoch: 29, train_loss: 0.7285, train_clustering_loss:  0.4490, train_error: 0.2553
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.7, correct 7/10
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 2.3358, val_error: 0.7273, auc: 0.4201
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.7454, instance_loss: 0.4958, weighted_loss: 0.6706, label: 2, bag_size: 69807
batch 39, loss: 2.1151, instance_loss: 0.6954, weighted_loss: 1.6892, label: 1, bag_size: 112135


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.10638297872340426: correct 40/376
Epoch: 30, train_loss: 0.6933, train_clustering_loss:  0.4380, train_error: 0.2340
class 0: acc 0.65, correct 13/20
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 1.0, correct 14/14
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 2.4249, val_error: 0.9091, auc: 0.4201
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.8528, instance_loss: 0.5545, weighted_loss: 0.7633, label: 1, bag_size: 47433
batch 39, loss: 0.5870, instance_loss: 0.5123, weighted_loss: 0.5646, label: 1, bag_size: 20030


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.21808510638297873: correct 82/376
Epoch: 31, train_loss: 0.5830, train_clustering_loss:  0.4073, train_error: 0.2128
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 2.5553, val_error: 0.9091, auc: 0.3993
class 0 clustering acc 0.9034090909090909: correct 318/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0661, instance_loss: 0.1218, weighted_loss: 0.0828, label: 3, bag_size: 48489
batch 39, loss: 0.0699, instance_loss: 0.1353, weighted_loss: 0.0895, label: 3, bag_size: 48489


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.14893617021276595: correct 56/376
Epoch: 32, train_loss: 0.6433, train_clustering_loss:  0.4253, train_error: 0.2766
class 0: acc 0.631578947368421, correct 12/19
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8, correct 4/5
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 2.3582, val_error: 1.0000, auc: 0.3924
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.5121, instance_loss: 0.5278, weighted_loss: 0.5168, label: 0, bag_size: 18551
batch 39, loss: 0.0031, instance_loss: 0.0258, weighted_loss: 0.0099, label: 3, bag_size: 77542


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.24468085106382978: correct 92/376
Epoch: 33, train_loss: 0.6171, train_clustering_loss:  0.4071, train_error: 0.1489
class 0: acc 1.0, correct 9/9
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.8235294117647058, correct 14/17

Val Set, val_loss: 2.4756, val_error: 0.9091, auc: 0.3958
class 0 clustering acc 0.9147727272727273: correct 322/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.3719, instance_loss: 0.3284, weighted_loss: 0.3588, label: 2, bag_size: 113492
batch 39, loss: 0.9122, instance_loss: 0.5357, weighted_loss: 0.7993, label: 1, bag_size: 112135


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.2074468085106383: correct 78/376
Epoch: 34, train_loss: 0.5444, train_clustering_loss:  0.3883, train_error: 0.1489
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 2.5164, val_error: 0.8182, auc: 0.3819
class 0 clustering acc 0.9119318181818182: correct 321/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.3278, instance_loss: 0.3736, weighted_loss: 0.3415, label: 3, bag_size: 22057
batch 39, loss: 0.1832, instance_loss: 0.4110, weighted_loss: 0.2515, label: 0, bag_size: 43538


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.26063829787234044: correct 98/376
Epoch: 35, train_loss: 0.5048, train_clustering_loss:  0.3646, train_error: 0.1277
class 0: acc 0.7, correct 7/10
class 1: acc 1.0, correct 8/8
class 2: acc 0.8, correct 12/15
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 2.6674, val_error: 0.9091, auc: 0.3819
class 0 clustering acc 0.90625: correct 319/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.5276, instance_loss: 0.4419, weighted_loss: 0.5019, label: 1, bag_size: 20030
batch 39, loss: 1.1066, instance_loss: 0.5676, weighted_loss: 0.9449, label: 1, bag_size: 112135


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.23404255319148937: correct 88/376
Epoch: 36, train_loss: 0.4960, train_clustering_loss:  0.3737, train_error: 0.1277
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.8, correct 12/15
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 2.6520, val_error: 0.7273, auc: 0.4028
class 0 clustering acc 0.9119318181818182: correct 321/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.3269, instance_loss: 0.3334, weighted_loss: 0.3288, label: 1, bag_size: 20030
batch 39, loss: 0.6665, instance_loss: 0.4044, weighted_loss: 0.5879, label: 1, bag_size: 104549


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.2845744680851064: correct 107/376
Epoch: 37, train_loss: 0.5017, train_clustering_loss:  0.3521, train_error: 0.1489
class 0: acc 0.75, correct 6/8
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8125, correct 13/16
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 2.7054, val_error: 0.9091, auc: 0.3819
class 0 clustering acc 0.9119318181818182: correct 321/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.4353, instance_loss: 0.5863, weighted_loss: 0.4806, label: 3, bag_size: 16626
batch 39, loss: 0.0161, instance_loss: 0.0821, weighted_loss: 0.0359, label: 3, bag_size: 17590


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.3377659574468085: correct 127/376
Epoch: 38, train_loss: 0.4827, train_clustering_loss:  0.3379, train_error: 0.1702
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 2.6851, val_error: 0.9091, auc: 0.3993
class 0 clustering acc 0.90625: correct 319/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0536, instance_loss: 0.1029, weighted_loss: 0.0684, label: 3, bag_size: 48489
batch 39, loss: 0.5192, instance_loss: 0.5890, weighted_loss: 0.5402, label: 0, bag_size: 70920


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.31117021276595747: correct 117/376
Epoch: 39, train_loss: 0.5948, train_clustering_loss:  0.3770, train_error: 0.2766
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.7, correct 7/10
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 2.6071, val_error: 1.0000, auc: 0.4201
class 0 clustering acc 0.9119318181818182: correct 321/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 34 out of 20


batch 19, loss: 1.0441, instance_loss: 0.5295, weighted_loss: 0.8897, label: 0, bag_size: 59141
batch 39, loss: 1.1994, instance_loss: 0.6060, weighted_loss: 1.0213, label: 2, bag_size: 69807


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.30319148936170215: correct 114/376
Epoch: 40, train_loss: 0.5610, train_clustering_loss:  0.3687, train_error: 0.2340
class 0: acc 0.7, correct 7/10
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.5, correct 5/10
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 2.7098, val_error: 0.9091, auc: 0.3958
class 0 clustering acc 0.90625: correct 319/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.6541, instance_loss: 0.4558, weighted_loss: 0.5946, label: 2, bag_size: 7532
batch 39, loss: 0.2375, instance_loss: 0.2311, weighted_loss: 0.2356, label: 3, bag_size: 48518


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.27925531914893614: correct 105/376
Epoch: 41, train_loss: 0.4952, train_clustering_loss:  0.3457, train_error: 0.1702
class 0: acc 0.8, correct 8/10
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 2.7927, val_error: 0.9091, auc: 0.3750
class 0 clustering acc 0.90625: correct 319/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.4718, instance_loss: 0.4581, weighted_loss: 0.4677, label: 3, bag_size: 22057
batch 39, loss: 0.4403, instance_loss: 0.3709, weighted_loss: 0.4195, label: 2, bag_size: 113492


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.3617021276595745: correct 136/376
Epoch: 42, train_loss: 0.3865, train_clustering_loss:  0.3149, train_error: 0.0426
class 0: acc 1.0, correct 8/8
class 1: acc 0.875, correct 7/8
class 2: acc 0.9411764705882353, correct 16/17
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 3.0041, val_error: 0.9091, auc: 0.3993
class 0 clustering acc 0.8948863636363636: correct 315/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.1773, instance_loss: 0.2741, weighted_loss: 0.2063, label: 1, bag_size: 81420
batch 39, loss: 0.0007, instance_loss: 0.0110, weighted_loss: 0.0038, label: 3, bag_size: 77542


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.39361702127659576: correct 148/376
Epoch: 43, train_loss: 0.4686, train_clustering_loss:  0.3193, train_error: 0.1489
class 0: acc 0.625, correct 5/8
class 1: acc 0.875, correct 14/16
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 2.9250, val_error: 0.9091, auc: 0.4097
class 0 clustering acc 0.8806818181818182: correct 310/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.0287, instance_loss: 0.0525, weighted_loss: 0.0358, label: 3, bag_size: 83890
batch 39, loss: 0.3730, instance_loss: 0.4352, weighted_loss: 0.3917, label: 0, bag_size: 22124


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.39361702127659576: correct 148/376
Epoch: 44, train_loss: 0.4021, train_clustering_loss:  0.3231, train_error: 0.0638
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 2.9365, val_error: 0.9091, auc: 0.3854
class 0 clustering acc 0.8835227272727273: correct 311/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.2214, instance_loss: 0.4228, weighted_loss: 0.2818, label: 0, bag_size: 18551
batch 39, loss: 0.2997, instance_loss: 0.3973, weighted_loss: 0.3289, label: 0, bag_size: 6353


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.3670212765957447: correct 138/376
Epoch: 45, train_loss: 0.4280, train_clustering_loss:  0.3289, train_error: 0.1277
class 0: acc 0.875, correct 14/16
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.9, correct 9/10
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 2.9762, val_error: 0.9091, auc: 0.3715
class 0 clustering acc 0.8948863636363636: correct 315/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.3716, instance_loss: 0.3022, weighted_loss: 0.3508, label: 1, bag_size: 69073
batch 39, loss: 0.3738, instance_loss: 0.2641, weighted_loss: 0.3409, label: 2, bag_size: 113492


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.42021276595744683: correct 158/376
Epoch: 46, train_loss: 0.3991, train_clustering_loss:  0.2937, train_error: 0.1064
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 1.0, correct 12/12
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 2.9809, val_error: 0.9091, auc: 0.3611
class 0 clustering acc 0.875: correct 308/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.0338, instance_loss: 0.1960, weighted_loss: 0.0824, label: 3, bag_size: 24102
batch 39, loss: 1.9068, instance_loss: 0.7586, weighted_loss: 1.5623, label: 3, bag_size: 98956


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.42021276595744683: correct 158/376
Epoch: 47, train_loss: 0.4369, train_clustering_loss:  0.3159, train_error: 0.1277
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.8666666666666667, correct 13/15

Val Set, val_loss: 3.1684, val_error: 1.0000, auc: 0.3854
class 0 clustering acc 0.8948863636363636: correct 315/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.1596, instance_loss: 0.3596, weighted_loss: 0.2196, label: 0, bag_size: 46742
batch 39, loss: 0.1462, instance_loss: 0.1995, weighted_loss: 0.1622, label: 1, bag_size: 47433


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.43617021276595747: correct 164/376
Epoch: 48, train_loss: 0.4479, train_clustering_loss:  0.3126, train_error: 0.1915
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8125, correct 13/16
class 2: acc 0.8333333333333334, correct 5/6
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 2.9569, val_error: 0.9091, auc: 0.3889
class 0 clustering acc 0.8551136363636364: correct 301/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.7869, instance_loss: 0.5527, weighted_loss: 0.7166, label: 0, bag_size: 70920
batch 39, loss: 1.0083, instance_loss: 0.5769, weighted_loss: 0.8789, label: 0, bag_size: 13999


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.4122340425531915: correct 155/376
Epoch: 49, train_loss: 0.4363, train_clustering_loss:  0.3080, train_error: 0.1489
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 1.0, correct 5/5
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 2.9368, val_error: 1.0000, auc: 0.3750
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 44 out of 20


batch 19, loss: 0.2205, instance_loss: 0.2263, weighted_loss: 0.2223, label: 3, bag_size: 48518
batch 39, loss: 0.4304, instance_loss: 0.3553, weighted_loss: 0.4079, label: 1, bag_size: 23122


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.47074468085106386: correct 177/376
Epoch: 50, train_loss: 0.3172, train_clustering_loss:  0.2900, train_error: 0.1064
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 3.0291, val_error: 0.8182, auc: 0.3889
class 0 clustering acc 0.8863636363636364: correct 312/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 45 out of 20


batch 19, loss: 1.0556, instance_loss: 0.6553, weighted_loss: 0.9355, label: 2, bag_size: 54449
batch 39, loss: 0.0134, instance_loss: 0.0325, weighted_loss: 0.0191, label: 3, bag_size: 48489


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.5585106382978723: correct 210/376
Epoch: 51, train_loss: 0.2245, train_clustering_loss:  0.2277, train_error: 0.0426
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 1.0, correct 12/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 3.0523, val_error: 0.8182, auc: 0.3958
class 0 clustering acc 0.8778409090909091: correct 309/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 46 out of 20
Early stopping
Val error: 0.7273, ROC AUC: 0.5278
Test error: 0.6364, ROC AUC: 0.7014
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3

Training Fold 9!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.5943, instance_loss: 1.0782, weighted_loss: 1.4395, label: 0, bag_size: 47775
batch 39, loss: 2.3329, instance_loss: 0.9236, weighted_loss: 1.9101, label: 1, bag_size: 47433


class 0 clustering acc 0.9042553191489362: correct 1360/1504
class 1 clustering acc 0.19148936170212766: correct 72/376
Epoch: 0, train_loss: 1.3808, train_clustering_loss:  1.0006, train_error: 0.5106
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/9
class 2: acc 0.0, correct 0/6
class 3: acc 1.0, correct 23/23

Val Set, val_loss: 1.4906, val_error: 0.7273, auc: 0.5278
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.490577).  Saving model ...


batch 19, loss: 0.9734, instance_loss: 0.6938, weighted_loss: 0.8895, label: 3, bag_size: 17590
batch 39, loss: 1.2290, instance_loss: 0.7192, weighted_loss: 1.0761, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4066, train_clustering_loss:  0.7724, train_error: 0.6809
class 0: acc 0.0, correct 0/7
class 1: acc 0.06666666666666667, correct 1/15
class 2: acc 0.0, correct 0/11
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.3983, val_error: 0.7273, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.490577 --> 1.398340).  Saving model ...


batch 19, loss: 1.3814, instance_loss: 0.5992, weighted_loss: 1.1467, label: 3, bag_size: 102779
batch 39, loss: 1.0600, instance_loss: 0.6388, weighted_loss: 0.9337, label: 2, bag_size: 54449


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3967, train_clustering_loss:  0.6662, train_error: 0.7234
class 0: acc 0.0, correct 0/9
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.3125, correct 5/16
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4323, val_error: 0.8182, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6832, instance_loss: 0.6376, weighted_loss: 1.3695, label: 0, bag_size: 6353
batch 39, loss: 1.1063, instance_loss: 0.5896, weighted_loss: 0.9513, label: 3, bag_size: 98956


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3873, train_clustering_loss:  0.6105, train_error: 0.7021
class 0: acc 0.0, correct 0/8
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.1, correct 1/10
class 3: acc 0.29411764705882354, correct 5/17

Val Set, val_loss: 1.3931, val_error: 0.7273, auc: 0.8750
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.398340 --> 1.393112).  Saving model ...


batch 19, loss: 1.1151, instance_loss: 0.6044, weighted_loss: 0.9619, label: 2, bag_size: 118767
batch 39, loss: 1.7144, instance_loss: 0.6327, weighted_loss: 1.3899, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.4627, train_clustering_loss:  0.6159, train_error: 0.8936
class 0: acc 0.2, correct 3/15
class 1: acc 0.0, correct 0/12
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3569, val_error: 0.7273, auc: 0.7812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.393112 --> 1.356907).  Saving model ...


batch 19, loss: 1.5344, instance_loss: 0.6254, weighted_loss: 1.2617, label: 0, bag_size: 54249
batch 39, loss: 1.4790, instance_loss: 0.6348, weighted_loss: 1.2258, label: 0, bag_size: 41829


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3854, train_clustering_loss:  0.6098, train_error: 0.7234
class 0: acc 0.07692307692307693, correct 1/13
class 1: acc 1.0, correct 12/12
class 2: acc 0.0, correct 0/13
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3746, val_error: 0.6364, auc: 0.7812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4892, instance_loss: 0.5988, weighted_loss: 1.2221, label: 2, bag_size: 118767
batch 39, loss: 1.6618, instance_loss: 0.6132, weighted_loss: 1.3472, label: 3, bag_size: 17590


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3589, train_clustering_loss:  0.6054, train_error: 0.7021
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.1, correct 1/10
class 2: acc 0.13333333333333333, correct 2/15
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3946, val_error: 0.7273, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2348, instance_loss: 0.6014, weighted_loss: 1.0448, label: 0, bag_size: 6353
batch 39, loss: 1.2265, instance_loss: 0.5896, weighted_loss: 1.0354, label: 0, bag_size: 54249


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3273, train_clustering_loss:  0.6008, train_error: 0.5532
class 0: acc 0.75, correct 12/16
class 1: acc 0.3, correct 3/10
class 2: acc 0.0, correct 0/5
class 3: acc 0.375, correct 6/16

Val Set, val_loss: 1.3569, val_error: 0.6364, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.6093, instance_loss: 0.6160, weighted_loss: 1.3113, label: 2, bag_size: 59749
batch 39, loss: 1.6984, instance_loss: 0.6185, weighted_loss: 1.3745, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.3417, train_clustering_loss:  0.6003, train_error: 0.6596
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 0.0, correct 0/7
class 2: acc 0.0, correct 0/13
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.3599, val_error: 0.7273, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.1633, instance_loss: 0.6024, weighted_loss: 0.9951, label: 3, bag_size: 77542
batch 39, loss: 1.6393, instance_loss: 0.6356, weighted_loss: 1.3382, label: 1, bag_size: 47433


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.3166, train_clustering_loss:  0.5995, train_error: 0.5532
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.0, correct 0/12
class 2: acc 0.3333333333333333, correct 3/9
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.3396, val_error: 0.6364, auc: 0.7326
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.356907 --> 1.339640).  Saving model ...


batch 19, loss: 1.2126, instance_loss: 0.6044, weighted_loss: 1.0302, label: 3, bag_size: 17590
batch 39, loss: 1.4007, instance_loss: 0.6423, weighted_loss: 1.1732, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.3550, train_clustering_loss:  0.5979, train_error: 0.6809
class 0: acc 0.1111111111111111, correct 1/9
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.2857142857142857, correct 4/14
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.3371, val_error: 0.6364, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.339640 --> 1.337080).  Saving model ...


batch 19, loss: 0.9312, instance_loss: 0.5817, weighted_loss: 0.8264, label: 1, bag_size: 23122
batch 39, loss: 1.2286, instance_loss: 0.6172, weighted_loss: 1.0452, label: 2, bag_size: 44015


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2565, train_clustering_loss:  0.5969, train_error: 0.5957
class 0: acc 0.07692307692307693, correct 1/13
class 1: acc 0.8333333333333334, correct 15/18
class 2: acc 0.08333333333333333, correct 1/12
class 3: acc 0.5, correct 2/4

Val Set, val_loss: 1.3651, val_error: 0.7273, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1856, instance_loss: 0.5665, weighted_loss: 0.9999, label: 2, bag_size: 89905
batch 39, loss: 1.2505, instance_loss: 0.5861, weighted_loss: 1.0512, label: 2, bag_size: 118767


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.3071, train_clustering_loss:  0.6018, train_error: 0.6170
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 1.0, correct 12/12
class 2: acc 0.23076923076923078, correct 3/13
class 3: acc 0.09090909090909091, correct 1/11

Val Set, val_loss: 1.3059, val_error: 0.6364, auc: 0.8021
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.337080 --> 1.305873).  Saving model ...


batch 19, loss: 0.7992, instance_loss: 0.6097, weighted_loss: 0.7424, label: 3, bag_size: 102779
batch 39, loss: 1.2668, instance_loss: 0.5395, weighted_loss: 1.0486, label: 2, bag_size: 118767


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2800, train_clustering_loss:  0.5919, train_error: 0.6383
class 0: acc 0.2222222222222222, correct 2/9
class 1: acc 0.1, correct 1/10
class 2: acc 0.3125, correct 5/16
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.3061, val_error: 0.6364, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3903, instance_loss: 0.6285, weighted_loss: 1.1618, label: 0, bag_size: 6353
batch 39, loss: 1.1609, instance_loss: 0.5703, weighted_loss: 0.9837, label: 3, bag_size: 12412


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.2244, train_clustering_loss:  0.5848, train_error: 0.4894
class 0: acc 0.25, correct 2/8
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.8125, correct 13/16
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.3214, val_error: 0.8182, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.5019, instance_loss: 0.6511, weighted_loss: 1.2466, label: 0, bag_size: 22124
batch 39, loss: 1.6198, instance_loss: 0.5883, weighted_loss: 1.3103, label: 3, bag_size: 22057


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.2725, train_clustering_loss:  0.5979, train_error: 0.5532
class 0: acc 0.3076923076923077, correct 4/13
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.2868, val_error: 0.6364, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.305873 --> 1.286814).  Saving model ...


batch 19, loss: 1.5077, instance_loss: 0.5760, weighted_loss: 1.2282, label: 2, bag_size: 118767
batch 39, loss: 0.9220, instance_loss: 0.5000, weighted_loss: 0.7954, label: 2, bag_size: 59749


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.1550, train_clustering_loss:  0.5837, train_error: 0.4043
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.5, correct 7/14

Val Set, val_loss: 1.3120, val_error: 0.5455, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2873, instance_loss: 0.6164, weighted_loss: 1.0860, label: 2, bag_size: 9530
batch 39, loss: 0.7924, instance_loss: 0.4882, weighted_loss: 0.7011, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 0.9850, train_clustering_loss:  0.5531, train_error: 0.2979
class 0: acc 0.75, correct 9/12
class 1: acc 0.375, correct 3/8
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.3113, val_error: 0.7273, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.5598, instance_loss: 0.6007, weighted_loss: 1.2721, label: 3, bag_size: 12412
batch 39, loss: 1.1952, instance_loss: 0.6115, weighted_loss: 1.0201, label: 2, bag_size: 9530


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 1.0772, train_clustering_loss:  0.5694, train_error: 0.4255
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.8125, correct 13/16
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.3167, val_error: 0.5455, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3991, instance_loss: 0.5632, weighted_loss: 1.1484, label: 0, bag_size: 18551
batch 39, loss: 1.9224, instance_loss: 0.6677, weighted_loss: 1.5460, label: 2, bag_size: 7532


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 1.1366, train_clustering_loss:  0.5698, train_error: 0.4894
class 0: acc 0.4, correct 6/15
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.25, correct 2/8
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.3537, val_error: 0.7273, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.6431, instance_loss: 0.6200, weighted_loss: 1.3362, label: 1, bag_size: 132271
batch 39, loss: 2.0731, instance_loss: 0.6842, weighted_loss: 1.6565, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 1.0841, train_clustering_loss:  0.5587, train_error: 0.5319
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.75, correct 6/8
class 3: acc 0.3125, correct 5/16

Val Set, val_loss: 1.2728, val_error: 0.4545, auc: 0.6319
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.286814 --> 1.272776).  Saving model ...


batch 19, loss: 1.5894, instance_loss: 0.6408, weighted_loss: 1.3048, label: 3, bag_size: 16626
batch 39, loss: 0.2804, instance_loss: 0.4181, weighted_loss: 0.3217, label: 3, bag_size: 77542


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 1.0273, train_clustering_loss:  0.5524, train_error: 0.3830
class 0: acc 0.7, correct 7/10
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.45454545454545453, correct 5/11
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.2849, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6409, instance_loss: 0.4948, weighted_loss: 0.5971, label: 2, bag_size: 89905
batch 39, loss: 0.6040, instance_loss: 0.5111, weighted_loss: 0.5761, label: 0, bag_size: 46742


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 22, train_loss: 1.0227, train_clustering_loss:  0.5502, train_error: 0.4468
class 0: acc 0.5, correct 7/14
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.4, correct 4/10
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.3549, val_error: 0.6364, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.6569, instance_loss: 0.4708, weighted_loss: 0.6010, label: 2, bag_size: 89905
batch 39, loss: 1.0720, instance_loss: 0.5284, weighted_loss: 0.9089, label: 3, bag_size: 48624


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 1.1253, train_clustering_loss:  0.5638, train_error: 0.4894
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.375, correct 6/16

Val Set, val_loss: 1.2416, val_error: 0.7273, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.272776 --> 1.241579).  Saving model ...


batch 19, loss: 0.5592, instance_loss: 0.4585, weighted_loss: 0.5290, label: 2, bag_size: 118767
batch 39, loss: 0.7431, instance_loss: 0.5120, weighted_loss: 0.6737, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 0.9936, train_clustering_loss:  0.5350, train_error: 0.4043
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.625, correct 10/16
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.3017, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.7489, instance_loss: 0.6933, weighted_loss: 1.4322, label: 1, bag_size: 23122
batch 39, loss: 0.5287, instance_loss: 0.4643, weighted_loss: 0.5094, label: 1, bag_size: 20030


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 25, train_loss: 0.9154, train_clustering_loss:  0.5166, train_error: 0.2979
class 0: acc 1.0, correct 13/13
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.7, correct 7/10
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.2997, val_error: 0.6364, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2443, instance_loss: 0.4015, weighted_loss: 0.2915, label: 1, bag_size: 47433
batch 39, loss: 0.7054, instance_loss: 0.4936, weighted_loss: 0.6419, label: 1, bag_size: 16373


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 26, train_loss: 1.0500, train_clustering_loss:  0.5462, train_error: 0.4468
class 0: acc 0.25, correct 2/8
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.5, correct 7/14
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.3300, val_error: 0.4545, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.7118, instance_loss: 0.6280, weighted_loss: 1.3867, label: 2, bag_size: 54449
batch 39, loss: 0.9317, instance_loss: 0.5879, weighted_loss: 0.8286, label: 3, bag_size: 4963


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 27, train_loss: 0.9271, train_clustering_loss:  0.5229, train_error: 0.2979
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.75, correct 9/12
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.2996, val_error: 0.6364, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.2618, instance_loss: 0.6112, weighted_loss: 1.0666, label: 0, bag_size: 65047
batch 39, loss: 0.7113, instance_loss: 0.4660, weighted_loss: 0.6377, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 28, train_loss: 0.9465, train_clustering_loss:  0.5378, train_error: 0.3404
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.3551, val_error: 0.7273, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.1297, instance_loss: 0.6078, weighted_loss: 0.9732, label: 2, bag_size: 7532
batch 39, loss: 0.2894, instance_loss: 0.3318, weighted_loss: 0.3021, label: 2, bag_size: 113492


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 29, train_loss: 0.7848, train_clustering_loss:  0.4936, train_error: 0.2553
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 1.0, correct 10/10
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.3380, val_error: 0.7273, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1815, instance_loss: 0.3218, weighted_loss: 0.2236, label: 3, bag_size: 102779
batch 39, loss: 0.9158, instance_loss: 0.5846, weighted_loss: 0.8164, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 30, train_loss: 0.8638, train_clustering_loss:  0.5105, train_error: 0.3404
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.25, correct 2/8
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3641, val_error: 0.7273, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.7697, instance_loss: 0.5440, weighted_loss: 0.7020, label: 1, bag_size: 58270
batch 39, loss: 0.4179, instance_loss: 0.4341, weighted_loss: 0.4228, label: 1, bag_size: 20030


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.02127659574468085: correct 8/376
Epoch: 31, train_loss: 0.7331, train_clustering_loss:  0.4795, train_error: 0.3191
class 0: acc 0.75, correct 15/20
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 0.5714285714285714, correct 4/7

Val Set, val_loss: 1.4597, val_error: 0.7273, auc: 0.6701
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.2208, instance_loss: 0.6416, weighted_loss: 1.0470, label: 3, bag_size: 16626
batch 39, loss: 0.9613, instance_loss: 0.5862, weighted_loss: 0.8488, label: 3, bag_size: 16626


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.018617021276595744: correct 7/376
Epoch: 32, train_loss: 0.8139, train_clustering_loss:  0.4891, train_error: 0.3830
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.36363636363636365, correct 4/11

Val Set, val_loss: 1.4193, val_error: 0.6364, auc: 0.6389
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5331, instance_loss: 0.4173, weighted_loss: 0.4984, label: 0, bag_size: 18551
batch 39, loss: 1.2769, instance_loss: 0.6541, weighted_loss: 1.0900, label: 2, bag_size: 44015


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.02925531914893617: correct 11/376
Epoch: 33, train_loss: 0.7765, train_clustering_loss:  0.4824, train_error: 0.2979
class 0: acc 0.9, correct 9/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.2, correct 2/10
class 3: acc 0.8888888888888888, correct 16/18

Val Set, val_loss: 1.3800, val_error: 0.6364, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.6994, instance_loss: 0.5634, weighted_loss: 0.6586, label: 3, bag_size: 4963
batch 39, loss: 1.0468, instance_loss: 0.5992, weighted_loss: 0.9125, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.031914893617021274: correct 12/376
Epoch: 34, train_loss: 0.8000, train_clustering_loss:  0.4966, train_error: 0.2340
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.4011, val_error: 0.6364, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.8431, instance_loss: 0.4713, weighted_loss: 0.7316, label: 1, bag_size: 77634
batch 39, loss: 0.7194, instance_loss: 0.4500, weighted_loss: 0.6385, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.05319148936170213: correct 20/376
Epoch: 35, train_loss: 0.6914, train_clustering_loss:  0.4624, train_error: 0.1702
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.4104, val_error: 0.6364, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.2257, instance_loss: 0.3175, weighted_loss: 0.2532, label: 1, bag_size: 20030
batch 39, loss: 1.1434, instance_loss: 0.6226, weighted_loss: 0.9872, label: 2, bag_size: 99232


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.02925531914893617: correct 11/376
Epoch: 36, train_loss: 0.7142, train_clustering_loss:  0.4690, train_error: 0.2340
class 0: acc 0.5, correct 6/12
class 1: acc 1.0, correct 12/12
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.5556, val_error: 0.6364, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.2337, instance_loss: 0.3891, weighted_loss: 0.2803, label: 1, bag_size: 20030
batch 39, loss: 0.3767, instance_loss: 0.3620, weighted_loss: 0.3723, label: 3, bag_size: 77542


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.05851063829787234: correct 22/376
Epoch: 37, train_loss: 0.8332, train_clustering_loss:  0.4997, train_error: 0.3404
class 0: acc 0.75, correct 9/12
class 1: acc 0.6, correct 6/10
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.6092, val_error: 0.6364, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3268, instance_loss: 0.3670, weighted_loss: 0.3389, label: 0, bag_size: 22124
batch 39, loss: 0.1073, instance_loss: 0.2401, weighted_loss: 0.1471, label: 3, bag_size: 102779


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.06648936170212766: correct 25/376
Epoch: 38, train_loss: 0.6692, train_clustering_loss:  0.4604, train_error: 0.2766
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.5364, val_error: 0.6364, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.9303, instance_loss: 0.5709, weighted_loss: 0.8225, label: 3, bag_size: 16626
batch 39, loss: 0.5483, instance_loss: 0.4781, weighted_loss: 0.5273, label: 2, bag_size: 158432


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.06382978723404255: correct 24/376
Epoch: 39, train_loss: 0.7175, train_clustering_loss:  0.4705, train_error: 0.3191
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 0.75, correct 9/12
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.6170, val_error: 0.6364, auc: 0.6806
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1139, instance_loss: 0.2208, weighted_loss: 0.1460, label: 2, bag_size: 113492
batch 39, loss: 0.1716, instance_loss: 0.3254, weighted_loss: 0.2177, label: 3, bag_size: 102779


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.031914893617021274: correct 12/376
Epoch: 40, train_loss: 0.7556, train_clustering_loss:  0.4823, train_error: 0.2979
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.625, correct 10/16
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.5074, val_error: 0.6364, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.2193, instance_loss: 0.2886, weighted_loss: 0.2401, label: 0, bag_size: 114704
batch 39, loss: 0.1830, instance_loss: 0.3499, weighted_loss: 0.2331, label: 2, bag_size: 89905


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.06382978723404255: correct 24/376
Epoch: 41, train_loss: 0.6765, train_clustering_loss:  0.4691, train_error: 0.2340
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.4124, val_error: 0.6364, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.7949, instance_loss: 0.5604, weighted_loss: 0.7245, label: 1, bag_size: 77634
batch 39, loss: 1.0060, instance_loss: 0.6686, weighted_loss: 0.9048, label: 3, bag_size: 4963


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.10904255319148937: correct 41/376
Epoch: 42, train_loss: 0.6879, train_clustering_loss:  0.4544, train_error: 0.3191
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.4995, val_error: 0.6364, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.5151, instance_loss: 0.4850, weighted_loss: 0.5061, label: 1, bag_size: 104549
batch 39, loss: 0.4762, instance_loss: 0.5033, weighted_loss: 0.4843, label: 2, bag_size: 44015


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.06914893617021277: correct 26/376
Epoch: 43, train_loss: 0.6217, train_clustering_loss:  0.4482, train_error: 0.1702
class 0: acc 0.875, correct 7/8
class 1: acc 1.0, correct 14/14
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.4666, val_error: 0.6364, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 1.6822, instance_loss: 0.6622, weighted_loss: 1.3762, label: 1, bag_size: 112135
batch 39, loss: 0.4075, instance_loss: 0.4003, weighted_loss: 0.4053, label: 0, bag_size: 6353


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.18351063829787234: correct 69/376
Epoch: 44, train_loss: 0.5473, train_clustering_loss:  0.4072, train_error: 0.1915
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.5636, val_error: 0.6364, auc: 0.6910
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.4930, instance_loss: 0.4016, weighted_loss: 0.4656, label: 1, bag_size: 23122
batch 39, loss: 0.2535, instance_loss: 0.3217, weighted_loss: 0.2739, label: 0, bag_size: 19277


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.2473404255319149: correct 93/376
Epoch: 45, train_loss: 0.4864, train_clustering_loss:  0.3962, train_error: 0.1277
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 1.0, correct 13/13
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.7026, val_error: 0.6364, auc: 0.6701
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.1517, instance_loss: 0.2812, weighted_loss: 0.1905, label: 1, bag_size: 16373
batch 39, loss: 0.8887, instance_loss: 0.5651, weighted_loss: 0.7916, label: 3, bag_size: 4963


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.2845744680851064: correct 107/376
Epoch: 46, train_loss: 0.4745, train_clustering_loss:  0.3910, train_error: 0.1915
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.6668, val_error: 0.5455, auc: 0.6458
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0739, instance_loss: 0.2606, weighted_loss: 0.1299, label: 3, bag_size: 17590
batch 39, loss: 0.1517, instance_loss: 0.3724, weighted_loss: 0.2179, label: 3, bag_size: 48624


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.2765957446808511: correct 104/376
Epoch: 47, train_loss: 0.4607, train_clustering_loss:  0.3917, train_error: 0.1064
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 1.0, correct 11/11
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.6682, val_error: 0.7273, auc: 0.6319
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 1.0717, instance_loss: 0.5484, weighted_loss: 0.9147, label: 2, bag_size: 59749
batch 39, loss: 0.2251, instance_loss: 0.2810, weighted_loss: 0.2419, label: 1, bag_size: 58270


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.2872340425531915: correct 108/376
Epoch: 48, train_loss: 0.4696, train_clustering_loss:  0.4046, train_error: 0.1489
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.7322, val_error: 0.6364, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.3077, instance_loss: 0.2965, weighted_loss: 0.3043, label: 2, bag_size: 158432
batch 39, loss: 0.6154, instance_loss: 0.3850, weighted_loss: 0.5463, label: 1, bag_size: 132271


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.2154255319148936: correct 81/376
Epoch: 49, train_loss: 0.6637, train_clustering_loss:  0.4394, train_error: 0.3617
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.6875, correct 11/16
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.8111, val_error: 0.5455, auc: 0.6667
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.1599, instance_loss: 0.2394, weighted_loss: 0.1837, label: 2, bag_size: 89905
batch 39, loss: 0.1495, instance_loss: 0.2002, weighted_loss: 0.1648, label: 1, bag_size: 47433


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.29521276595744683: correct 111/376
Epoch: 50, train_loss: 0.4971, train_clustering_loss:  0.3855, train_error: 0.2128
class 0: acc 0.9, correct 9/10
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.7566, val_error: 0.7273, auc: 0.6771
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 1.0639, instance_loss: 0.5529, weighted_loss: 0.9106, label: 2, bag_size: 54449
batch 39, loss: 0.6161, instance_loss: 0.4644, weighted_loss: 0.5706, label: 3, bag_size: 22057


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.2632978723404255: correct 99/376
Epoch: 51, train_loss: 0.5018, train_clustering_loss:  0.4095, train_error: 0.1277
class 0: acc 1.0, correct 16/16
class 1: acc 0.75, correct 9/12
class 2: acc 0.7142857142857143, correct 5/7
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.6295, val_error: 0.6364, auc: 0.6771
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 28 out of 20
Early stopping
Val error: 0.7273, ROC AUC: 0.7222
Test error: 0.4545, ROC AUC: 0.7569
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
finished!
end script
Completed: Wed Apr 27 00:47:53 EDT 2022
