Started: Wed Apr 27 18:25:09 EDT 2022
[-] Unloading zlib 1.2.11  ... 
[+] Loading zlib 1.2.11  ... 
[-] Unloading gcc  7.2.0  ... 
[-] Unloading libpng 1.6.37  ... 
[+] Loading gcc  10.2.0  ... 
[+] Loading libpng 1.6.37  ... 
[-] Unloading libjpeg-turbo 2.0.6  ... 
[+] Loading libjpeg-turbo 2.0.6  ... 
[-] Unloading gcc  10.2.0  ... 
[-] Unloading libtiff libraries v 4.0.9  ... 
[+] Loading gcc  7.2.0  ... 
[+] Loading libtiff libraries v 4.0.9  ... 
[-] Unloading openjpeg  2.3.1  ... 
[+] Loading openjpeg  2.3.1  ... 
[-] Unloading SQLite 3.34.1  for gcc 4.8.5  ... 
[+] Loading SQLite 3.34.1  for gcc 4.8.5  ... 

Load Dataset
label column: label
label dictionary: {'pole': 0, 'msi': 1, 'lcn': 2, 'p53': 3}
number of classes: 4
slide-level counts:  
 0    20
1    17
2    15
3    17
Name: label, dtype: int64
Patient-LVL; Number of samples registered in class 0: 20
Slide-LVL; Number of samples registered in class 0: 20
Patient-LVL; Number of samples registered in class 1: 17
Slide-LVL; Number of samples registered in class 1: 17
Patient-LVL; Number of samples registered in class 2: 15
Slide-LVL; Number of samples registered in class 2: 15
Patient-LVL; Number of samples registered in class 3: 17
Slide-LVL; Number of samples registered in class 3: 17
split_dir:  splits/idibell_100
################# Settings ###################
num_splits:  10
k_start:  -1
k_end:  -1
task:  idibell
max_epochs:  200
results_dir:  /home/weismanal/projects/idibell/repo/results/10x/bwh_resection/training
lr:  0.0002
experiment:  2022-04-27-take_2-10x
reg:  1e-05
label_frac:  1.0
bag_loss:  ce
seed:  1
model_type:  clam_sb
model_size:  small
use_drop_out:  True
weighted_sample:  True
opt:  adam
bag_weight:  0.7
inst_loss:  svm
B:  8
split_dir:  splits/idibell_100

Training Fold 0!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.9200, instance_loss: 1.0142, weighted_loss: 0.9483, label: 2, bag_size: 7427
batch 39, loss: 1.7956, instance_loss: 0.9474, weighted_loss: 1.5412, label: 1, bag_size: 1617


class 0 clustering acc 0.9488031914893617: correct 1427/1504
class 1 clustering acc 0.09042553191489362: correct 34/376
Epoch: 0, train_loss: 1.4053, train_clustering_loss:  1.0344, train_error: 0.6596
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/9
class 2: acc 1.0, correct 16/16
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.4434, val_error: 0.8182, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.443381).  Saving model ...


batch 19, loss: 1.3200, instance_loss: 0.7351, weighted_loss: 1.1446, label: 2, bag_size: 2966
batch 39, loss: 1.2043, instance_loss: 0.6803, weighted_loss: 1.0471, label: 1, bag_size: 3328


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4015, train_clustering_loss:  0.7387, train_error: 0.7234
class 0: acc 0.0, correct 0/11
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.1, correct 1/10
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3664, val_error: 0.7273, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.443381 --> 1.366358).  Saving model ...


batch 19, loss: 1.5488, instance_loss: 0.6475, weighted_loss: 1.2784, label: 2, bag_size: 4921
batch 39, loss: 1.4472, instance_loss: 0.6490, weighted_loss: 1.2078, label: 2, bag_size: 3753


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3851, train_clustering_loss:  0.6335, train_error: 0.6596
class 0: acc 0.0, correct 0/11
class 1: acc 1.0, correct 14/14
class 2: acc 0.0, correct 0/10
class 3: acc 0.16666666666666666, correct 2/12

Val Set, val_loss: 1.3661, val_error: 0.5455, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.366358 --> 1.366102).  Saving model ...


batch 19, loss: 1.3592, instance_loss: 0.6201, weighted_loss: 1.1375, label: 0, bag_size: 460
batch 39, loss: 1.9802, instance_loss: 0.6524, weighted_loss: 1.5818, label: 2, bag_size: 7812


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3621, train_clustering_loss:  0.6153, train_error: 0.6170
class 0: acc 0.07142857142857142, correct 1/14
class 1: acc 1.0, correct 15/15
class 2: acc 0.0, correct 0/7
class 3: acc 0.18181818181818182, correct 2/11

Val Set, val_loss: 1.3635, val_error: 0.5455, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.366102 --> 1.363476).  Saving model ...


batch 19, loss: 1.6028, instance_loss: 0.6208, weighted_loss: 1.3082, label: 2, bag_size: 750
batch 39, loss: 1.6913, instance_loss: 0.6000, weighted_loss: 1.3639, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3970, train_clustering_loss:  0.6110, train_error: 0.6809
class 0: acc 1.0, correct 14/14
class 1: acc 0.0, correct 0/10
class 2: acc 0.0, correct 0/11
class 3: acc 0.08333333333333333, correct 1/12

Val Set, val_loss: 1.3681, val_error: 0.7273, auc: 0.6319
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6392, instance_loss: 0.6116, weighted_loss: 1.3309, label: 0, bag_size: 4903
batch 39, loss: 1.6369, instance_loss: 0.6460, weighted_loss: 1.3396, label: 0, bag_size: 1040


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3442, train_clustering_loss:  0.6136, train_error: 0.7234
class 0: acc 0.0, correct 0/8
class 1: acc 0.625, correct 10/16
class 2: acc 0.13333333333333333, correct 2/15
class 3: acc 0.125, correct 1/8

Val Set, val_loss: 1.4123, val_error: 0.7273, auc: 0.6007
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2380, instance_loss: 0.6287, weighted_loss: 1.0552, label: 2, bag_size: 750
batch 39, loss: 1.5829, instance_loss: 0.6296, weighted_loss: 1.2969, label: 2, bag_size: 2966


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3326, train_clustering_loss:  0.6078, train_error: 0.6809
class 0: acc 0.0, correct 0/13
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.0, correct 0/8
class 3: acc 0.6666666666666666, correct 10/15

Val Set, val_loss: 1.3691, val_error: 0.7273, auc: 0.5069
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.0041, instance_loss: 0.6008, weighted_loss: 0.8831, label: 0, bag_size: 460
batch 39, loss: 1.0467, instance_loss: 0.5970, weighted_loss: 0.9118, label: 0, bag_size: 4903


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3055, train_clustering_loss:  0.6143, train_error: 0.5957
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.0, correct 0/12
class 3: acc 0.14285714285714285, correct 1/7

Val Set, val_loss: 1.4016, val_error: 0.7273, auc: 0.5451
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8220, instance_loss: 0.5717, weighted_loss: 0.7469, label: 0, bag_size: 3896
batch 39, loss: 1.9549, instance_loss: 0.6635, weighted_loss: 1.5675, label: 3, bag_size: 4413


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2488, train_clustering_loss:  0.6071, train_error: 0.6170
class 0: acc 1.0, correct 18/18
class 1: acc 0.0, correct 0/11
class 2: acc 0.0, correct 0/12
class 3: acc 0.0, correct 0/6

Val Set, val_loss: 1.4380, val_error: 0.7273, auc: 0.5000
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.1385, instance_loss: 0.6181, weighted_loss: 0.9824, label: 1, bag_size: 4010
batch 39, loss: 1.1673, instance_loss: 0.5988, weighted_loss: 0.9967, label: 1, bag_size: 1617


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2141, train_clustering_loss:  0.5982, train_error: 0.5957
class 0: acc 0.0, correct 0/8
class 1: acc 0.26666666666666666, correct 4/15
class 2: acc 0.7894736842105263, correct 15/19
class 3: acc 0.0, correct 0/5

Val Set, val_loss: 1.5453, val_error: 0.7273, auc: 0.5139
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.8260, instance_loss: 0.5370, weighted_loss: 0.7393, label: 2, bag_size: 2966
batch 39, loss: 1.5337, instance_loss: 0.5686, weighted_loss: 1.2442, label: 1, bag_size: 3328


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2366, train_clustering_loss:  0.6018, train_error: 0.5532
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 0.16666666666666666, correct 2/12

Val Set, val_loss: 1.5071, val_error: 0.7273, auc: 0.4861
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.9195, instance_loss: 0.5880, weighted_loss: 0.8201, label: 0, bag_size: 1225
batch 39, loss: 0.7157, instance_loss: 0.5733, weighted_loss: 0.6730, label: 3, bag_size: 5428


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2071, train_clustering_loss:  0.5969, train_error: 0.4468
class 0: acc 0.875, correct 14/16
class 1: acc 0.4, correct 6/15
class 2: acc 0.375, correct 3/8
class 3: acc 0.375, correct 3/8

Val Set, val_loss: 1.4550, val_error: 0.8182, auc: 0.3576
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.8870, instance_loss: 0.6146, weighted_loss: 0.8053, label: 3, bag_size: 1720
batch 39, loss: 1.2733, instance_loss: 0.6166, weighted_loss: 1.0763, label: 2, bag_size: 750


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.1690, train_clustering_loss:  0.5939, train_error: 0.4681
class 0: acc 0.3, correct 3/10
class 1: acc 0.875, correct 14/16
class 2: acc 0.0, correct 0/9
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.4767, val_error: 0.8182, auc: 0.3785
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.6498, instance_loss: 0.6743, weighted_loss: 1.3572, label: 2, bag_size: 4921
batch 39, loss: 1.2740, instance_loss: 0.6229, weighted_loss: 1.0786, label: 2, bag_size: 750


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.1382, train_clustering_loss:  0.5845, train_error: 0.4468
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.7, correct 7/10
class 2: acc 0.45454545454545453, correct 5/11
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.4638, val_error: 0.8182, auc: 0.3924
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.2130, instance_loss: 0.5952, weighted_loss: 1.0277, label: 0, bag_size: 460
batch 39, loss: 0.7760, instance_loss: 0.5073, weighted_loss: 0.6954, label: 3, bag_size: 6746


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.0774, train_clustering_loss:  0.5762, train_error: 0.4255
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.9444444444444444, correct 17/18
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.4876, val_error: 0.8182, auc: 0.4583
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.3456, instance_loss: 0.5965, weighted_loss: 1.1209, label: 0, bag_size: 1452
batch 39, loss: 1.0462, instance_loss: 0.5948, weighted_loss: 0.9108, label: 3, bag_size: 10296


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.1077, train_clustering_loss:  0.5800, train_error: 0.4681
class 0: acc 0.2727272727272727, correct 3/11
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.2, correct 2/10
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.4713, val_error: 0.7273, auc: 0.4306
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.7547, instance_loss: 0.5521, weighted_loss: 0.6939, label: 2, bag_size: 750
batch 39, loss: 1.6946, instance_loss: 0.7023, weighted_loss: 1.3969, label: 0, bag_size: 3896


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.0265, train_clustering_loss:  0.5654, train_error: 0.3191
class 0: acc 0.3, correct 3/10
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.4657, val_error: 0.8182, auc: 0.4410
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3854, instance_loss: 0.4320, weighted_loss: 0.3994, label: 3, bag_size: 3071
batch 39, loss: 0.7901, instance_loss: 0.5638, weighted_loss: 0.7222, label: 0, bag_size: 3775


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 0.8961, train_clustering_loss:  0.5493, train_error: 0.1702
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.7, correct 7/10
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 1.5485, val_error: 0.7273, auc: 0.4722
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.1581, instance_loss: 0.5515, weighted_loss: 0.9761, label: 3, bag_size: 6746
batch 39, loss: 0.2825, instance_loss: 0.4229, weighted_loss: 0.3246, label: 3, bag_size: 3071


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.8233, train_clustering_loss:  0.5279, train_error: 0.2979
class 0: acc 1.0, correct 13/13
class 1: acc 0.2857142857142857, correct 4/14
class 2: acc 1.0, correct 9/9
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.4765, val_error: 0.7273, auc: 0.5382
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.1220, instance_loss: 0.5416, weighted_loss: 0.9479, label: 0, bag_size: 4903
batch 39, loss: 1.1135, instance_loss: 0.5175, weighted_loss: 0.9347, label: 3, bag_size: 5854


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 0.9364, train_clustering_loss:  0.5528, train_error: 0.4043
class 0: acc 0.5, correct 6/12
class 1: acc 1.0, correct 10/10
class 2: acc 0.42857142857142855, correct 6/14
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.5685, val_error: 0.7273, auc: 0.4896
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.4881, instance_loss: 0.6372, weighted_loss: 1.2328, label: 3, bag_size: 1752
batch 39, loss: 0.8081, instance_loss: 0.5285, weighted_loss: 0.7242, label: 0, bag_size: 4010


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 0.8505, train_clustering_loss:  0.5334, train_error: 0.2553
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.4578, val_error: 0.7273, auc: 0.5556
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 1.3390, instance_loss: 0.5995, weighted_loss: 1.1171, label: 3, bag_size: 1249
batch 39, loss: 0.3869, instance_loss: 0.4181, weighted_loss: 0.3962, label: 1, bag_size: 4010


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 0.7726, train_clustering_loss:  0.5112, train_error: 0.2128
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 1.0, correct 18/18
class 2: acc 0.6, correct 6/10
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.5644, val_error: 0.7273, auc: 0.4757
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.2254, instance_loss: 0.3994, weighted_loss: 0.2776, label: 3, bag_size: 1720
batch 39, loss: 0.6310, instance_loss: 0.5758, weighted_loss: 0.6145, label: 2, bag_size: 10330


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 22, train_loss: 0.7633, train_clustering_loss:  0.5042, train_error: 0.2979
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 1.0, correct 15/15
class 2: acc 0.375, correct 3/8
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.2415, val_error: 0.6364, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.363476 --> 1.241451).  Saving model ...


batch 19, loss: 0.2885, instance_loss: 0.3955, weighted_loss: 0.3206, label: 3, bag_size: 1720
batch 39, loss: 0.5678, instance_loss: 0.4813, weighted_loss: 0.5418, label: 0, bag_size: 3756


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 23, train_loss: 0.6382, train_clustering_loss:  0.4915, train_error: 0.1702
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.5055, val_error: 0.7273, auc: 0.5521
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6481, instance_loss: 0.6075, weighted_loss: 0.6359, label: 2, bag_size: 750
batch 39, loss: 1.3731, instance_loss: 0.6012, weighted_loss: 1.1415, label: 0, bag_size: 859


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 0.6376, train_clustering_loss:  0.4998, train_error: 0.1915
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 1.0, correct 8/8
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.6166, val_error: 0.8182, auc: 0.5729
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1397, instance_loss: 0.3434, weighted_loss: 0.2009, label: 0, bag_size: 1225
batch 39, loss: 0.4635, instance_loss: 0.4922, weighted_loss: 0.4721, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 25, train_loss: 0.7127, train_clustering_loss:  0.4960, train_error: 0.2553
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.6325, val_error: 0.8182, auc: 0.5000
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7742, instance_loss: 0.4464, weighted_loss: 0.6759, label: 1, bag_size: 1617
batch 39, loss: 0.4735, instance_loss: 0.4505, weighted_loss: 0.4666, label: 1, bag_size: 4646


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 26, train_loss: 0.6643, train_clustering_loss:  0.4729, train_error: 0.1702
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.6878, val_error: 0.8182, auc: 0.4097
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2947, instance_loss: 0.3530, weighted_loss: 0.3122, label: 2, bag_size: 3753
batch 39, loss: 0.9526, instance_loss: 0.5631, weighted_loss: 0.8357, label: 3, bag_size: 361


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.010638297872340425: correct 4/376
Epoch: 27, train_loss: 0.6021, train_clustering_loss:  0.4589, train_error: 0.1702
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.7166, val_error: 0.8182, auc: 0.4687
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.8735, instance_loss: 0.4851, weighted_loss: 0.7570, label: 0, bag_size: 4263
batch 39, loss: 0.7391, instance_loss: 0.5194, weighted_loss: 0.6732, label: 0, bag_size: 3775


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.010638297872340425: correct 4/376
Epoch: 28, train_loss: 0.7098, train_clustering_loss:  0.4742, train_error: 0.1915
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.9, correct 9/10
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 2.0087, val_error: 0.8182, auc: 0.4722
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.5996, instance_loss: 0.4446, weighted_loss: 0.5531, label: 3, bag_size: 5854
batch 39, loss: 0.4325, instance_loss: 0.4483, weighted_loss: 0.4372, label: 2, bag_size: 7427


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.031914893617021274: correct 12/376
Epoch: 29, train_loss: 0.5894, train_clustering_loss:  0.4552, train_error: 0.2128
class 0: acc 0.6, correct 6/10
class 1: acc 1.0, correct 13/13
class 2: acc 0.75, correct 6/8
class 3: acc 0.75, correct 12/16

Val Set, val_loss: 1.5230, val_error: 0.8182, auc: 0.5104
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.8952, instance_loss: 0.5912, weighted_loss: 0.8040, label: 2, bag_size: 4921
batch 39, loss: 0.2184, instance_loss: 0.3929, weighted_loss: 0.2708, label: 0, bag_size: 4010


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0425531914893617: correct 16/376
Epoch: 30, train_loss: 0.5638, train_clustering_loss:  0.4404, train_error: 0.1064
class 0: acc 0.8125, correct 13/16
class 1: acc 1.0, correct 4/4
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.7294, val_error: 0.8182, auc: 0.4653
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.4854, instance_loss: 0.4402, weighted_loss: 0.4719, label: 1, bag_size: 3328
batch 39, loss: 0.2893, instance_loss: 0.4621, weighted_loss: 0.3411, label: 1, bag_size: 1540


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.05319148936170213: correct 20/376
Epoch: 31, train_loss: 0.5311, train_clustering_loss:  0.4490, train_error: 0.1702
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 1.0, correct 11/11
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.8420, val_error: 0.7273, auc: 0.4792
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.7589, instance_loss: 0.5187, weighted_loss: 0.6868, label: 3, bag_size: 1249
batch 39, loss: 0.7671, instance_loss: 0.5020, weighted_loss: 0.6876, label: 3, bag_size: 1249


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.06648936170212766: correct 25/376
Epoch: 32, train_loss: 0.4127, train_clustering_loss:  0.4094, train_error: 0.0000
class 0: acc 1.0, correct 11/11
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.8216, val_error: 0.8182, auc: 0.4896
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.3195, instance_loss: 0.6123, weighted_loss: 1.1073, label: 0, bag_size: 859
batch 39, loss: 0.2104, instance_loss: 0.2901, weighted_loss: 0.2343, label: 3, bag_size: 5428


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.09574468085106383: correct 36/376
Epoch: 33, train_loss: 0.5757, train_clustering_loss:  0.4409, train_error: 0.1702
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.75, correct 6/8
class 2: acc 1.0, correct 14/14
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.8264, val_error: 0.7273, auc: 0.4792
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.2770, instance_loss: 0.3945, weighted_loss: 0.3122, label: 3, bag_size: 361
batch 39, loss: 0.1497, instance_loss: 0.3000, weighted_loss: 0.1948, label: 0, bag_size: 4010


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.2047872340425532: correct 77/376
Epoch: 34, train_loss: 0.3846, train_clustering_loss:  0.3846, train_error: 0.0851
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.8468, val_error: 0.9091, auc: 0.4444
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.6184, instance_loss: 0.5062, weighted_loss: 0.5847, label: 1, bag_size: 5086
batch 39, loss: 0.2501, instance_loss: 0.3153, weighted_loss: 0.2696, label: 0, bag_size: 3775


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.14893617021276595: correct 56/376
Epoch: 35, train_loss: 0.4118, train_clustering_loss:  0.4156, train_error: 0.0638
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 14/14
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.7882, val_error: 0.8182, auc: 0.5000
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0778, instance_loss: 0.4108, weighted_loss: 0.1777, label: 1, bag_size: 1540
batch 39, loss: 0.2456, instance_loss: 0.3653, weighted_loss: 0.2815, label: 0, bag_size: 4010


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.20212765957446807: correct 76/376
Epoch: 36, train_loss: 0.3929, train_clustering_loss:  0.3860, train_error: 0.0851
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 8/8
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.7939, val_error: 0.8182, auc: 0.5139
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3299, instance_loss: 0.4671, weighted_loss: 0.3711, label: 1, bag_size: 1540
batch 39, loss: 0.1799, instance_loss: 0.2583, weighted_loss: 0.2035, label: 1, bag_size: 4010


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.3537234042553192: correct 133/376
Epoch: 37, train_loss: 0.4115, train_clustering_loss:  0.3642, train_error: 0.1489
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 1.0, correct 10/10
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.875, correct 14/16

Val Set, val_loss: 1.7185, val_error: 0.7273, auc: 0.5000
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.5209, instance_loss: 0.4828, weighted_loss: 0.5095, label: 0, bag_size: 1452
batch 39, loss: 0.3511, instance_loss: 0.3756, weighted_loss: 0.3584, label: 2, bag_size: 4921


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.22872340425531915: correct 86/376
Epoch: 38, train_loss: 0.3559, train_clustering_loss:  0.3946, train_error: 0.0426
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 1.0, correct 9/9
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.7497, val_error: 0.7273, auc: 0.5104
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.5687, instance_loss: 0.5084, weighted_loss: 0.5506, label: 3, bag_size: 1249
batch 39, loss: 0.3040, instance_loss: 0.2667, weighted_loss: 0.2928, label: 2, bag_size: 1654


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.4574468085106383: correct 172/376
Epoch: 39, train_loss: 0.2818, train_clustering_loss:  0.3320, train_error: 0.0638
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 9/9
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.6599, val_error: 0.8182, auc: 0.5590
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.4289, instance_loss: 0.3541, weighted_loss: 0.4065, label: 1, bag_size: 8645
batch 39, loss: 0.4488, instance_loss: 0.4187, weighted_loss: 0.4398, label: 2, bag_size: 4921


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.35106382978723405: correct 132/376
Epoch: 40, train_loss: 0.3980, train_clustering_loss:  0.3725, train_error: 0.1064
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.9582, val_error: 0.6364, auc: 0.4583
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.4354, instance_loss: 0.4228, weighted_loss: 0.4316, label: 3, bag_size: 4413
batch 39, loss: 0.0282, instance_loss: 0.1529, weighted_loss: 0.0656, label: 3, bag_size: 1720


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.2845744680851064: correct 107/376
Epoch: 41, train_loss: 0.2960, train_clustering_loss:  0.3575, train_error: 0.0213
class 0: acc 1.0, correct 7/7
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 1.8420, val_error: 0.8182, auc: 0.4965
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.1430, instance_loss: 0.4001, weighted_loss: 0.2201, label: 1, bag_size: 5086
batch 39, loss: 0.5221, instance_loss: 0.4555, weighted_loss: 0.5021, label: 3, bag_size: 361


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.2127659574468085: correct 80/376
Epoch: 42, train_loss: 0.3725, train_clustering_loss:  0.3875, train_error: 0.0638
class 0: acc 0.8, correct 8/10
class 1: acc 1.0, correct 11/11
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.9142, val_error: 0.7273, auc: 0.5000
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0589, instance_loss: 0.1838, weighted_loss: 0.0963, label: 1, bag_size: 5301
batch 39, loss: 0.0152, instance_loss: 0.1026, weighted_loss: 0.0414, label: 3, bag_size: 5428


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.40425531914893614: correct 152/376
Epoch: 43, train_loss: 0.3063, train_clustering_loss:  0.3251, train_error: 0.0638
class 0: acc 0.75, correct 9/12
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.8875, val_error: 0.7273, auc: 0.4861
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.9253, instance_loss: 0.7858, weighted_loss: 1.5834, label: 3, bag_size: 941
batch 39, loss: 0.1554, instance_loss: 0.2040, weighted_loss: 0.1700, label: 0, bag_size: 460


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.35106382978723405: correct 132/376
Epoch: 44, train_loss: 0.3880, train_clustering_loss:  0.3889, train_error: 0.1277
class 0: acc 0.8421052631578947, correct 16/19
class 1: acc 1.0, correct 11/11
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.6, correct 3/5

Val Set, val_loss: 1.8598, val_error: 0.7273, auc: 0.5174
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0636, instance_loss: 0.2067, weighted_loss: 0.1066, label: 0, bag_size: 1225
batch 39, loss: 0.1344, instance_loss: 0.2131, weighted_loss: 0.1580, label: 0, bag_size: 1342


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.46808510638297873: correct 176/376
Epoch: 45, train_loss: 0.2681, train_clustering_loss:  0.3417, train_error: 0.0426
class 0: acc 1.0, correct 15/15
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 10/10
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.8884, val_error: 0.8182, auc: 0.4861
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.3794, instance_loss: 0.3071, weighted_loss: 0.3577, label: 1, bag_size: 4646
batch 39, loss: 0.2173, instance_loss: 0.3835, weighted_loss: 0.2671, label: 3, bag_size: 361


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.39893617021276595: correct 150/376
Epoch: 46, train_loss: 0.2655, train_clustering_loss:  0.3491, train_error: 0.0638
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.9194, val_error: 0.7273, auc: 0.5312
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.2228, instance_loss: 0.4559, weighted_loss: 0.2927, label: 2, bag_size: 2966
batch 39, loss: 0.2414, instance_loss: 0.3884, weighted_loss: 0.2855, label: 0, bag_size: 3756


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.4148936170212766: correct 156/376
Epoch: 47, train_loss: 0.2778, train_clustering_loss:  0.3641, train_error: 0.0426
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 13/13
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 2.0206, val_error: 0.8182, auc: 0.4757
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.3713, instance_loss: 0.4478, weighted_loss: 0.3942, label: 2, bag_size: 1646
batch 39, loss: 0.0980, instance_loss: 0.1209, weighted_loss: 0.1049, label: 1, bag_size: 3328


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.5159574468085106: correct 194/376
Epoch: 48, train_loss: 0.2622, train_clustering_loss:  0.3024, train_error: 0.0426
class 0: acc 0.8, correct 8/10
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 2.0190, val_error: 0.8182, auc: 0.4826
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.1510, instance_loss: 0.2850, weighted_loss: 0.1912, label: 2, bag_size: 1654
batch 39, loss: 0.2366, instance_loss: 0.3011, weighted_loss: 0.2559, label: 3, bag_size: 1752


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.4867021276595745: correct 183/376
Epoch: 49, train_loss: 0.2845, train_clustering_loss:  0.3222, train_error: 0.0851
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 7/7
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.9444444444444444, correct 17/18

Val Set, val_loss: 1.7784, val_error: 0.6364, auc: 0.5694
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0775, instance_loss: 0.1394, weighted_loss: 0.0960, label: 3, bag_size: 1720
batch 39, loss: 0.3480, instance_loss: 0.2454, weighted_loss: 0.3172, label: 1, bag_size: 1617


class 0 clustering acc 0.9833776595744681: correct 1479/1504
class 1 clustering acc 0.5319148936170213: correct 200/376
Epoch: 50, train_loss: 0.2527, train_clustering_loss:  0.3445, train_error: 0.0638
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 1.0, correct 15/15
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.9130, val_error: 0.7273, auc: 0.5174
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.0851, instance_loss: 0.3200, weighted_loss: 0.1556, label: 2, bag_size: 3753
batch 39, loss: 0.0969, instance_loss: 0.1239, weighted_loss: 0.1050, label: 3, bag_size: 10296


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.34574468085106386: correct 130/376
Epoch: 51, train_loss: 0.2563, train_clustering_loss:  0.3867, train_error: 0.0426
class 0: acc 1.0, correct 15/15
class 1: acc 1.0, correct 12/12
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 2.0266, val_error: 0.7273, auc: 0.4722
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 29 out of 20
Early stopping
Val error: 0.6364, ROC AUC: 0.6562
Test error: 0.4545, ROC AUC: 0.7708
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3

Training Fold 1!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6730, instance_loss: 1.0934, weighted_loss: 1.4991, label: 0, bag_size: 2826
batch 39, loss: 1.5019, instance_loss: 0.9487, weighted_loss: 1.3359, label: 1, bag_size: 1617


class 0 clustering acc 0.9514627659574468: correct 1431/1504
class 1 clustering acc 0.06382978723404255: correct 24/376
Epoch: 0, train_loss: 1.4094, train_clustering_loss:  1.0524, train_error: 0.7447
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/13
class 2: acc 0.42857142857142855, correct 6/14
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.4184, val_error: 0.8182, auc: 0.4931
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.418361).  Saving model ...


batch 19, loss: 1.2204, instance_loss: 0.7339, weighted_loss: 1.0745, label: 2, bag_size: 4328
batch 39, loss: 1.0848, instance_loss: 0.6571, weighted_loss: 0.9565, label: 1, bag_size: 5301


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3820, train_clustering_loss:  0.7327, train_error: 0.6809
class 0: acc 0.0, correct 0/7
class 1: acc 0.875, correct 14/16
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.4135, val_error: 0.7273, auc: 0.6181
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.418361 --> 1.413468).  Saving model ...


batch 19, loss: 1.2560, instance_loss: 0.6110, weighted_loss: 1.0625, label: 3, bag_size: 5854
batch 39, loss: 1.3462, instance_loss: 0.6253, weighted_loss: 1.1299, label: 2, bag_size: 3753


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.4042, train_clustering_loss:  0.6397, train_error: 0.7234
class 0: acc 0.0, correct 0/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.0, correct 0/13
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3975, val_error: 0.8182, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.413468 --> 1.397524).  Saving model ...


batch 19, loss: 0.9482, instance_loss: 0.5787, weighted_loss: 0.8374, label: 1, bag_size: 5086
batch 39, loss: 1.2642, instance_loss: 0.6153, weighted_loss: 1.0696, label: 2, bag_size: 4921


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3840, train_clustering_loss:  0.6171, train_error: 0.7021
class 0: acc 0.0, correct 0/8
class 1: acc 0.8235294117647058, correct 14/17
class 2: acc 0.0, correct 0/12
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3956, val_error: 0.7273, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.397524 --> 1.395558).  Saving model ...


batch 19, loss: 1.1987, instance_loss: 0.6005, weighted_loss: 1.0192, label: 3, bag_size: 1422
batch 39, loss: 1.3546, instance_loss: 0.6392, weighted_loss: 1.1400, label: 0, bag_size: 4263


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3788, train_clustering_loss:  0.6152, train_error: 0.7234
class 0: acc 0.0, correct 0/13
class 1: acc 0.0, correct 0/9
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.16666666666666666, correct 2/12

Val Set, val_loss: 1.3906, val_error: 0.8182, auc: 0.6389
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.395558 --> 1.390608).  Saving model ...


batch 19, loss: 1.3499, instance_loss: 0.6261, weighted_loss: 1.1328, label: 0, bag_size: 859
batch 39, loss: 1.7185, instance_loss: 0.6039, weighted_loss: 1.3841, label: 2, bag_size: 1646


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3260, train_clustering_loss:  0.6068, train_error: 0.6596
class 0: acc 0.3888888888888889, correct 7/18
class 1: acc 0.0, correct 0/8
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.3946, val_error: 0.7273, auc: 0.6632
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0848, instance_loss: 0.5452, weighted_loss: 0.9229, label: 3, bag_size: 1422
batch 39, loss: 1.0826, instance_loss: 0.5319, weighted_loss: 0.9174, label: 3, bag_size: 1422


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3311, train_clustering_loss:  0.5953, train_error: 0.5957
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.0, correct 0/9
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.3610, val_error: 0.8182, auc: 0.5799
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.390608 --> 1.360954).  Saving model ...


batch 19, loss: 1.1530, instance_loss: 0.6014, weighted_loss: 0.9875, label: 1, bag_size: 5086
batch 39, loss: 1.1227, instance_loss: 0.6118, weighted_loss: 0.9694, label: 0, bag_size: 1225


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3043, train_clustering_loss:  0.5983, train_error: 0.6596
class 0: acc 0.5714285714285714, correct 8/14
class 1: acc 0.4, correct 6/15
class 2: acc 0.0, correct 0/9
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.3898, val_error: 0.9091, auc: 0.5590
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2631, instance_loss: 0.6019, weighted_loss: 1.0648, label: 2, bag_size: 10330
batch 39, loss: 0.9724, instance_loss: 0.5702, weighted_loss: 0.8517, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2727, train_clustering_loss:  0.5982, train_error: 0.5319
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.0, correct 0/7
class 2: acc 0.6, correct 12/20
class 3: acc 0.375, correct 3/8

Val Set, val_loss: 1.5196, val_error: 0.8182, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4494, instance_loss: 0.6211, weighted_loss: 1.2009, label: 1, bag_size: 3951
batch 39, loss: 1.3970, instance_loss: 0.6225, weighted_loss: 1.1646, label: 1, bag_size: 1617


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2469, train_clustering_loss:  0.5897, train_error: 0.5532
class 0: acc 0.42857142857142855, correct 6/14
class 1: acc 0.0, correct 0/9
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.4349, val_error: 0.9091, auc: 0.6076
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2487, instance_loss: 0.5376, weighted_loss: 1.0353, label: 2, bag_size: 4328
batch 39, loss: 1.5297, instance_loss: 0.6423, weighted_loss: 1.2635, label: 1, bag_size: 5301


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.1877, train_clustering_loss:  0.5837, train_error: 0.4681
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.0, correct 0/9
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.38461538461538464, correct 5/13

Val Set, val_loss: 1.4860, val_error: 0.7273, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8482, instance_loss: 0.5885, weighted_loss: 0.7703, label: 1, bag_size: 2636
batch 39, loss: 0.3855, instance_loss: 0.5179, weighted_loss: 0.4252, label: 3, bag_size: 5428


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.1460, train_clustering_loss:  0.5847, train_error: 0.4894
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.3333333333333333, correct 3/9
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.3633, val_error: 0.8182, auc: 0.6736
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.3946, instance_loss: 0.5918, weighted_loss: 1.1538, label: 2, bag_size: 4328
batch 39, loss: 1.3176, instance_loss: 0.5784, weighted_loss: 1.0959, label: 2, bag_size: 7812


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.0493, train_clustering_loss:  0.5642, train_error: 0.4255
class 0: acc 0.25, correct 2/8
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.5, correct 6/12
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.4122, val_error: 0.5455, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.7009, instance_loss: 0.4966, weighted_loss: 0.6396, label: 3, bag_size: 5854
batch 39, loss: 0.2473, instance_loss: 0.3899, weighted_loss: 0.2901, label: 3, bag_size: 1422


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 0.9890, train_clustering_loss:  0.5568, train_error: 0.4255
class 0: acc 0.25, correct 3/12
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.4033, val_error: 0.8182, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.4938, instance_loss: 0.5985, weighted_loss: 1.2252, label: 1, bag_size: 5086
batch 39, loss: 0.2520, instance_loss: 0.3493, weighted_loss: 0.2812, label: 3, bag_size: 6746


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.0334, train_clustering_loss:  0.5548, train_error: 0.4255
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.375, correct 3/8
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.6875, correct 11/16

Val Set, val_loss: 1.3725, val_error: 0.6364, auc: 0.6458
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.2920, instance_loss: 0.5918, weighted_loss: 1.0819, label: 0, bag_size: 3642
batch 39, loss: 1.1743, instance_loss: 0.6511, weighted_loss: 1.0174, label: 1, bag_size: 8645


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 0.8376, train_clustering_loss:  0.5217, train_error: 0.2766
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.75, correct 6/8
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.4440, val_error: 0.8182, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0917, instance_loss: 0.2543, weighted_loss: 0.1405, label: 3, bag_size: 1422
batch 39, loss: 0.4544, instance_loss: 0.5038, weighted_loss: 0.4692, label: 2, bag_size: 10330


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.05319148936170213: correct 20/376
Epoch: 16, train_loss: 0.8138, train_clustering_loss:  0.5235, train_error: 0.2553
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.7647058823529411, correct 13/17
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.4442, val_error: 0.5455, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.1484, instance_loss: 0.3002, weighted_loss: 0.1939, label: 3, bag_size: 3071
batch 39, loss: 1.3321, instance_loss: 0.7659, weighted_loss: 1.1622, label: 0, bag_size: 8614


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.013297872340425532: correct 5/376
Epoch: 17, train_loss: 0.8368, train_clustering_loss:  0.5287, train_error: 0.2340
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 1.0, correct 8/8
class 2: acc 0.9375, correct 15/16
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.4644, val_error: 0.8182, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.4180, instance_loss: 0.3321, weighted_loss: 0.3923, label: 3, bag_size: 6746
batch 39, loss: 0.2487, instance_loss: 0.3874, weighted_loss: 0.2903, label: 3, bag_size: 1720


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.05319148936170213: correct 20/376
Epoch: 18, train_loss: 0.7547, train_clustering_loss:  0.5044, train_error: 0.2553
class 0: acc 1.0, correct 12/12
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.4673, val_error: 0.7273, auc: 0.5972
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.5572, instance_loss: 0.4989, weighted_loss: 0.5397, label: 0, bag_size: 1225
batch 39, loss: 0.8584, instance_loss: 0.4898, weighted_loss: 0.7478, label: 3, bag_size: 6888


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.013297872340425532: correct 5/376
Epoch: 19, train_loss: 0.8105, train_clustering_loss:  0.4989, train_error: 0.2766
class 0: acc 0.5384615384615384, correct 7/13
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.6, correct 9/15
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.3599, val_error: 0.5455, auc: 0.6875
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.360954 --> 1.359925).  Saving model ...


batch 19, loss: 0.1055, instance_loss: 0.2849, weighted_loss: 0.1593, label: 2, bag_size: 4031
batch 39, loss: 0.5560, instance_loss: 0.4784, weighted_loss: 0.5327, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.02925531914893617: correct 11/376
Epoch: 20, train_loss: 0.6486, train_clustering_loss:  0.4633, train_error: 0.1702
class 0: acc 0.8, correct 8/10
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.4530, val_error: 0.6364, auc: 0.6528
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5886, instance_loss: 0.4216, weighted_loss: 0.5385, label: 3, bag_size: 3503
batch 39, loss: 0.2221, instance_loss: 0.3443, weighted_loss: 0.2587, label: 1, bag_size: 3951


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.05585106382978723: correct 21/376
Epoch: 21, train_loss: 0.5906, train_clustering_loss:  0.4444, train_error: 0.1702
class 0: acc 0.5, correct 5/10
class 1: acc 0.95, correct 19/20
class 2: acc 0.6666666666666666, correct 4/6
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.5311, val_error: 0.7273, auc: 0.6146
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.0731, instance_loss: 0.7470, weighted_loss: 1.6753, label: 2, bag_size: 4328
batch 39, loss: 0.5334, instance_loss: 0.5001, weighted_loss: 0.5234, label: 0, bag_size: 3775


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.10638297872340426: correct 40/376
Epoch: 22, train_loss: 0.6328, train_clustering_loss:  0.4512, train_error: 0.1915
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.3598, val_error: 0.6364, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.359925 --> 1.359826).  Saving model ...


batch 19, loss: 0.4487, instance_loss: 0.3827, weighted_loss: 0.4289, label: 3, bag_size: 1720
batch 39, loss: 0.6655, instance_loss: 0.7605, weighted_loss: 0.6940, label: 1, bag_size: 7240


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.07180851063829788: correct 27/376
Epoch: 23, train_loss: 0.5841, train_clustering_loss:  0.4502, train_error: 0.1277
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.625, correct 5/8
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.3001, val_error: 0.6364, auc: 0.6979
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.359826 --> 1.300117).  Saving model ...


batch 19, loss: 0.6252, instance_loss: 0.5561, weighted_loss: 0.6045, label: 2, bag_size: 7812
batch 39, loss: 0.6012, instance_loss: 0.4289, weighted_loss: 0.5495, label: 1, bag_size: 2636


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.14627659574468085: correct 55/376
Epoch: 24, train_loss: 0.5042, train_clustering_loss:  0.4226, train_error: 0.1489
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 1.0, correct 10/10
class 2: acc 0.7, correct 7/10
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.4113, val_error: 0.6364, auc: 0.6736
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4518, instance_loss: 0.3885, weighted_loss: 0.4328, label: 1, bag_size: 2636
batch 39, loss: 0.4326, instance_loss: 0.5045, weighted_loss: 0.4542, label: 0, bag_size: 4263


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.1356382978723404: correct 51/376
Epoch: 25, train_loss: 0.4794, train_clustering_loss:  0.4209, train_error: 0.1277
class 0: acc 1.0, correct 12/12
class 1: acc 0.9, correct 9/10
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.3623, val_error: 0.6364, auc: 0.6910
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.6213, instance_loss: 0.3857, weighted_loss: 0.5506, label: 1, bag_size: 1617
batch 39, loss: 0.3523, instance_loss: 0.3412, weighted_loss: 0.3490, label: 1, bag_size: 4646


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.14893617021276595: correct 56/376
Epoch: 26, train_loss: 0.4749, train_clustering_loss:  0.4128, train_error: 0.1489
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.3615, val_error: 0.5455, auc: 0.6910
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.9060, instance_loss: 0.6655, weighted_loss: 0.8339, label: 2, bag_size: 3753
batch 39, loss: 0.1226, instance_loss: 0.2372, weighted_loss: 0.1570, label: 2, bag_size: 7427


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.15691489361702127: correct 59/376
Epoch: 27, train_loss: 0.5398, train_clustering_loss:  0.4205, train_error: 0.2340
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.625, correct 10/16
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.5979, val_error: 0.7273, auc: 0.6181
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.5638, instance_loss: 0.5204, weighted_loss: 0.5507, label: 0, bag_size: 460
batch 39, loss: 0.9638, instance_loss: 0.5452, weighted_loss: 0.8382, label: 0, bag_size: 859


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.2553191489361702: correct 96/376
Epoch: 28, train_loss: 0.3751, train_clustering_loss:  0.3764, train_error: 0.0426
class 0: acc 1.0, correct 10/10
class 1: acc 1.0, correct 13/13
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.2982, val_error: 0.7273, auc: 0.7326
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.300117 --> 1.298170).  Saving model ...


batch 19, loss: 0.4823, instance_loss: 0.3421, weighted_loss: 0.4403, label: 3, bag_size: 6888
batch 39, loss: 0.8394, instance_loss: 0.5473, weighted_loss: 0.7518, label: 0, bag_size: 1040


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.2925531914893617: correct 110/376
Epoch: 29, train_loss: 0.5180, train_clustering_loss:  0.4009, train_error: 0.1702
class 0: acc 0.6, correct 6/10
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.5387, val_error: 0.6364, auc: 0.6563
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3816, instance_loss: 0.3877, weighted_loss: 0.3835, label: 3, bag_size: 5854
batch 39, loss: 0.2452, instance_loss: 0.3347, weighted_loss: 0.2720, label: 2, bag_size: 6477


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.2712765957446808: correct 102/376
Epoch: 30, train_loss: 0.3322, train_clustering_loss:  0.3477, train_error: 0.0426
class 0: acc 0.9411764705882353, correct 16/17
class 1: acc 1.0, correct 5/5
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.6787, val_error: 0.8182, auc: 0.6701
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2271, instance_loss: 0.2978, weighted_loss: 0.2483, label: 1, bag_size: 5301
batch 39, loss: 0.3867, instance_loss: 0.4336, weighted_loss: 0.4008, label: 0, bag_size: 4263


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.2845744680851064: correct 107/376
Epoch: 31, train_loss: 0.3926, train_clustering_loss:  0.3459, train_error: 0.1277
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.4054, val_error: 0.6364, auc: 0.7222
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1462, instance_loss: 0.2560, weighted_loss: 0.1792, label: 3, bag_size: 3503
batch 39, loss: 0.1276, instance_loss: 0.2232, weighted_loss: 0.1563, label: 3, bag_size: 3503


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.3324468085106383: correct 125/376
Epoch: 32, train_loss: 0.2882, train_clustering_loss:  0.3316, train_error: 0.0426
class 0: acc 1.0, correct 17/17
class 1: acc 1.0, correct 9/9
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.3617, val_error: 0.6364, auc: 0.7535
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.4114, instance_loss: 0.4528, weighted_loss: 0.4239, label: 1, bag_size: 2636
batch 39, loss: 0.0058, instance_loss: 0.0892, weighted_loss: 0.0308, label: 3, bag_size: 3071


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.3191489361702128: correct 120/376
Epoch: 33, train_loss: 0.3750, train_clustering_loss:  0.3733, train_error: 0.0638
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 12/12
class 2: acc 0.75, correct 9/12
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.4929, val_error: 0.6364, auc: 0.6806
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0862, instance_loss: 0.1756, weighted_loss: 0.1130, label: 2, bag_size: 7427
batch 39, loss: 0.1217, instance_loss: 0.2108, weighted_loss: 0.1484, label: 2, bag_size: 6477


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.3882978723404255: correct 146/376
Epoch: 34, train_loss: 0.3364, train_clustering_loss:  0.3189, train_error: 0.0851
class 0: acc 0.9, correct 9/10
class 1: acc 1.0, correct 14/14
class 2: acc 0.8125, correct 13/16
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.4937, val_error: 0.6364, auc: 0.7083
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0574, instance_loss: 0.2062, weighted_loss: 0.1020, label: 3, bag_size: 10296
batch 39, loss: 0.3089, instance_loss: 0.4485, weighted_loss: 0.3508, label: 0, bag_size: 8614


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.5212765957446809: correct 196/376
Epoch: 35, train_loss: 0.1965, train_clustering_loss:  0.2908, train_error: 0.0213
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 9/9
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 19/19

Val Set, val_loss: 1.4650, val_error: 0.6364, auc: 0.7014
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.3494, instance_loss: 0.3909, weighted_loss: 0.3618, label: 0, bag_size: 4263
batch 39, loss: 0.2242, instance_loss: 0.2748, weighted_loss: 0.2394, label: 2, bag_size: 6477


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.34574468085106386: correct 130/376
Epoch: 36, train_loss: 0.2899, train_clustering_loss:  0.3413, train_error: 0.0213
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 12/12
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.5940, val_error: 0.6364, auc: 0.6875
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.3352, instance_loss: 0.4282, weighted_loss: 0.3631, label: 0, bag_size: 4263
batch 39, loss: 0.0059, instance_loss: 0.0981, weighted_loss: 0.0336, label: 3, bag_size: 5428


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.48936170212765956: correct 184/376
Epoch: 37, train_loss: 0.2626, train_clustering_loss:  0.3013, train_error: 0.0638
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 10/10
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.6486, val_error: 0.6364, auc: 0.6250
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.3173, instance_loss: 0.3232, weighted_loss: 0.3191, label: 0, bag_size: 3642
batch 39, loss: 0.1373, instance_loss: 0.2636, weighted_loss: 0.1752, label: 3, bag_size: 5854


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.3670212765957447: correct 138/376
Epoch: 38, train_loss: 0.3744, train_clustering_loss:  0.3439, train_error: 0.1489
class 0: acc 0.9, correct 9/10
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.8666666666666667, correct 13/15

Val Set, val_loss: 1.5022, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.1720, instance_loss: 0.1900, weighted_loss: 0.1774, label: 3, bag_size: 3503
batch 39, loss: 0.0944, instance_loss: 0.2394, weighted_loss: 0.1379, label: 0, bag_size: 4903


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.48138297872340424: correct 181/376
Epoch: 39, train_loss: 0.4010, train_clustering_loss:  0.3566, train_error: 0.1277
class 0: acc 0.875, correct 14/16
class 1: acc 1.0, correct 12/12
class 2: acc 0.7, correct 7/10
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.4562, val_error: 0.6364, auc: 0.7326
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.5490, instance_loss: 0.4674, weighted_loss: 0.5245, label: 0, bag_size: 1040
batch 39, loss: 0.0770, instance_loss: 0.1824, weighted_loss: 0.1086, label: 3, bag_size: 5854


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.5478723404255319: correct 206/376
Epoch: 40, train_loss: 0.2808, train_clustering_loss:  0.3229, train_error: 0.1277
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.9, correct 9/10
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.4882, val_error: 0.7273, auc: 0.7222
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1093, instance_loss: 0.2495, weighted_loss: 0.1514, label: 0, bag_size: 4010
batch 39, loss: 0.0596, instance_loss: 0.1642, weighted_loss: 0.0909, label: 3, bag_size: 1720


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.523936170212766: correct 197/376
Epoch: 41, train_loss: 0.2985, train_clustering_loss:  0.2934, train_error: 0.0851
class 0: acc 1.0, correct 11/11
class 1: acc 1.0, correct 11/11
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.7392, val_error: 0.6364, auc: 0.6424
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.1546, instance_loss: 0.1776, weighted_loss: 0.1615, label: 3, bag_size: 10296
batch 39, loss: 0.0683, instance_loss: 0.1300, weighted_loss: 0.0868, label: 2, bag_size: 7427


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.5478723404255319: correct 206/376
Epoch: 42, train_loss: 0.3243, train_clustering_loss:  0.2778, train_error: 0.1277
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.6487, val_error: 0.6364, auc: 0.6667
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.2187, instance_loss: 0.2331, weighted_loss: 0.2230, label: 1, bag_size: 4423
batch 39, loss: 0.0073, instance_loss: 0.0767, weighted_loss: 0.0281, label: 3, bag_size: 5428


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.5797872340425532: correct 218/376
Epoch: 43, train_loss: 0.2625, train_clustering_loss:  0.2940, train_error: 0.0851
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 17/17
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.5345, val_error: 0.6364, auc: 0.7014
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.3417, instance_loss: 0.6923, weighted_loss: 0.4469, label: 3, bag_size: 941
batch 39, loss: 0.0929, instance_loss: 0.3140, weighted_loss: 0.1593, label: 1, bag_size: 5086


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.43882978723404253: correct 165/376
Epoch: 44, train_loss: 0.2635, train_clustering_loss:  0.3160, train_error: 0.0638
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 1.0, correct 12/12
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.5614, val_error: 0.5455, auc: 0.7014
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1204, instance_loss: 0.2143, weighted_loss: 0.1486, label: 1, bag_size: 2636
batch 39, loss: 0.1362, instance_loss: 0.2952, weighted_loss: 0.1839, label: 0, bag_size: 1452


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.598404255319149: correct 225/376
Epoch: 45, train_loss: 0.1931, train_clustering_loss:  0.2636, train_error: 0.0426
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.7127, val_error: 0.6364, auc: 0.6562
class 0 clustering acc 0.9147727272727273: correct 322/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0655, instance_loss: 0.1849, weighted_loss: 0.1013, label: 1, bag_size: 4646
batch 39, loss: 0.0614, instance_loss: 0.1277, weighted_loss: 0.0813, label: 2, bag_size: 7427


class 0 clustering acc 0.980718085106383: correct 1475/1504
class 1 clustering acc 0.6090425531914894: correct 229/376
Epoch: 46, train_loss: 0.3287, train_clustering_loss:  0.3130, train_error: 0.1277
class 0: acc 0.875, correct 7/8
class 1: acc 1.0, correct 12/12
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.5058, val_error: 0.6364, auc: 0.7118
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0072, instance_loss: 0.0656, weighted_loss: 0.0247, label: 3, bag_size: 1422
batch 39, loss: 0.5471, instance_loss: 1.0777, weighted_loss: 0.7063, label: 1, bag_size: 7240


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.4734042553191489: correct 178/376
Epoch: 47, train_loss: 0.3165, train_clustering_loss:  0.3366, train_error: 0.0638
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 9/9
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4986, val_error: 0.6364, auc: 0.7118
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2329, instance_loss: 0.2941, weighted_loss: 0.2512, label: 2, bag_size: 10330
batch 39, loss: 0.0498, instance_loss: 0.2125, weighted_loss: 0.0986, label: 1, bag_size: 5301


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.699468085106383: correct 263/376
Epoch: 48, train_loss: 0.2612, train_clustering_loss:  0.2548, train_error: 0.0851
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 14/14
class 2: acc 0.6666666666666666, correct 4/6
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.9227, val_error: 0.7273, auc: 0.5972
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0316, instance_loss: 0.1397, weighted_loss: 0.0640, label: 0, bag_size: 4903
batch 39, loss: 0.1059, instance_loss: 0.2550, weighted_loss: 0.1506, label: 2, bag_size: 4031


class 0 clustering acc 0.9860372340425532: correct 1483/1504
class 1 clustering acc 0.6409574468085106: correct 241/376
Epoch: 49, train_loss: 0.4125, train_clustering_loss:  0.3018, train_error: 0.1277
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 1.0, correct 5/5
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.9127, val_error: 0.6364, auc: 0.6528
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.1217, instance_loss: 0.2354, weighted_loss: 0.1558, label: 3, bag_size: 1720
batch 39, loss: 0.2956, instance_loss: 0.2152, weighted_loss: 0.2715, label: 1, bag_size: 1617


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.5611702127659575: correct 211/376
Epoch: 50, train_loss: 0.2655, train_clustering_loss:  0.2754, train_error: 0.0638
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 11/11
class 2: acc 0.8, correct 8/10
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.8075, val_error: 0.6364, auc: 0.6632
class 0 clustering acc 0.9176136363636364: correct 323/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.3365, instance_loss: 0.4821, weighted_loss: 0.3802, label: 2, bag_size: 3753
batch 39, loss: 0.2817, instance_loss: 0.2948, weighted_loss: 0.2856, label: 1, bag_size: 8645


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.7101063829787234: correct 267/376
Epoch: 51, train_loss: 0.1610, train_clustering_loss:  0.2315, train_error: 0.0213
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 11/11
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.7947, val_error: 0.6364, auc: 0.6910
class 0 clustering acc 0.9147727272727273: correct 322/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 23 out of 20
Early stopping
Val error: 0.7273, ROC AUC: 0.7326
Test error: 0.8182, ROC AUC: 0.5104
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3

Training Fold 2!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.3343, instance_loss: 1.0765, weighted_loss: 1.2570, label: 2, bag_size: 7427
batch 39, loss: 2.0174, instance_loss: 0.9593, weighted_loss: 1.7000, label: 1, bag_size: 4010


class 0 clustering acc 0.9381648936170213: correct 1411/1504
class 1 clustering acc 0.08244680851063829: correct 31/376
Epoch: 0, train_loss: 1.3875, train_clustering_loss:  1.0410, train_error: 0.6596
class 0: acc 0.0, correct 0/8
class 1: acc 0.0, correct 0/8
class 2: acc 0.0, correct 0/14
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.4605, val_error: 0.7273, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.460515).  Saving model ...


batch 19, loss: 1.1907, instance_loss: 0.7483, weighted_loss: 1.0580, label: 2, bag_size: 4715
batch 39, loss: 1.4535, instance_loss: 0.7045, weighted_loss: 1.2288, label: 1, bag_size: 7035


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4032, train_clustering_loss:  0.7370, train_error: 0.7447
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/14
class 2: acc 0.0, correct 0/12
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.3845, val_error: 0.7273, auc: 0.6736
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.460515 --> 1.384534).  Saving model ...


batch 19, loss: 1.5319, instance_loss: 0.6163, weighted_loss: 1.2572, label: 3, bag_size: 6746
batch 39, loss: 1.5776, instance_loss: 0.6490, weighted_loss: 1.2990, label: 2, bag_size: 3753


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3748, train_clustering_loss:  0.6365, train_error: 0.7021
class 0: acc 0.0, correct 0/9
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.0, correct 0/9
class 3: acc 0.26666666666666666, correct 4/15

Val Set, val_loss: 1.3885, val_error: 0.7273, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.8159, instance_loss: 0.6447, weighted_loss: 1.4646, label: 0, bag_size: 1452
batch 39, loss: 1.7606, instance_loss: 0.6442, weighted_loss: 1.4257, label: 2, bag_size: 7812


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3812, train_clustering_loss:  0.6168, train_error: 0.6809
class 0: acc 0.0, correct 0/9
class 1: acc 0.625, correct 10/16
class 2: acc 0.0, correct 0/11
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3687, val_error: 0.5455, auc: 0.5972
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.384534 --> 1.368653).  Saving model ...


batch 19, loss: 1.0463, instance_loss: 0.6080, weighted_loss: 0.9148, label: 2, bag_size: 4715
batch 39, loss: 1.2990, instance_loss: 0.6135, weighted_loss: 1.0933, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3740, train_clustering_loss:  0.6173, train_error: 0.6809
class 0: acc 0.0, correct 0/11
class 1: acc 0.5, correct 8/16
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3649, val_error: 0.7273, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.368653 --> 1.364942).  Saving model ...


batch 19, loss: 0.8748, instance_loss: 0.5657, weighted_loss: 0.7821, label: 1, bag_size: 4646
batch 39, loss: 1.7466, instance_loss: 0.6543, weighted_loss: 1.4189, label: 0, bag_size: 3896


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3234, train_clustering_loss:  0.6153, train_error: 0.6383
class 0: acc 0.0, correct 0/9
class 1: acc 1.0, correct 16/16
class 2: acc 0.0, correct 0/9
class 3: acc 0.07692307692307693, correct 1/13

Val Set, val_loss: 1.3764, val_error: 0.7273, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0175, instance_loss: 0.5644, weighted_loss: 0.8815, label: 3, bag_size: 1422
batch 39, loss: 1.4069, instance_loss: 0.6160, weighted_loss: 1.1696, label: 2, bag_size: 4715


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3284, train_clustering_loss:  0.6222, train_error: 0.7021
class 0: acc 0.2857142857142857, correct 4/14
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.3600, val_error: 0.6364, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.364942 --> 1.360041).  Saving model ...


batch 19, loss: 0.9862, instance_loss: 0.5942, weighted_loss: 0.8686, label: 0, bag_size: 1452
batch 39, loss: 1.4136, instance_loss: 0.6184, weighted_loss: 1.1751, label: 1, bag_size: 4646


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2810, train_clustering_loss:  0.6206, train_error: 0.5957
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.3, correct 3/10
class 2: acc 0.0, correct 0/10
class 3: acc 0.25, correct 3/12

Val Set, val_loss: 1.3458, val_error: 0.7273, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.360041 --> 1.345800).  Saving model ...


batch 19, loss: 1.3287, instance_loss: 0.6211, weighted_loss: 1.1165, label: 2, bag_size: 1654
batch 39, loss: 1.1256, instance_loss: 0.6143, weighted_loss: 0.9722, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2537, train_clustering_loss:  0.6105, train_error: 0.4468
class 0: acc 0.8, correct 12/15
class 1: acc 0.125, correct 1/8
class 2: acc 0.4666666666666667, correct 7/15
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.4142, val_error: 0.8182, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1940, instance_loss: 0.6319, weighted_loss: 1.0254, label: 3, bag_size: 1720
batch 39, loss: 1.1168, instance_loss: 0.5896, weighted_loss: 0.9587, label: 1, bag_size: 4010


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2300, train_clustering_loss:  0.6040, train_error: 0.2979
class 0: acc 0.7, correct 7/10
class 1: acc 0.8, correct 12/15
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.3573, val_error: 0.8182, auc: 0.6458
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9944, instance_loss: 0.5810, weighted_loss: 0.8704, label: 2, bag_size: 4715
batch 39, loss: 1.4033, instance_loss: 0.6257, weighted_loss: 1.1700, label: 1, bag_size: 4400


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.1679, train_clustering_loss:  0.6016, train_error: 0.4468
class 0: acc 0.0, correct 0/7
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.75, correct 12/16
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.4189, val_error: 0.7273, auc: 0.5764
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7600, instance_loss: 0.5622, weighted_loss: 0.7007, label: 1, bag_size: 5301
batch 39, loss: 1.1026, instance_loss: 0.5606, weighted_loss: 0.9400, label: 2, bag_size: 2966


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.1155, train_clustering_loss:  0.5855, train_error: 0.5106
class 0: acc 0.08333333333333333, correct 1/12
class 1: acc 0.6875, correct 11/16
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.4106, val_error: 0.5455, auc: 0.5903
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.0737, instance_loss: 0.5708, weighted_loss: 0.9228, label: 2, bag_size: 6469
batch 39, loss: 0.4777, instance_loss: 0.4610, weighted_loss: 0.4727, label: 3, bag_size: 1422


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.1494, train_clustering_loss:  0.5851, train_error: 0.4255
class 0: acc 0.38461538461538464, correct 5/13
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.5, correct 5/10
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.3720, val_error: 0.6364, auc: 0.5694
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.4253, instance_loss: 0.4474, weighted_loss: 0.4320, label: 3, bag_size: 6746
batch 39, loss: 0.1701, instance_loss: 0.3955, weighted_loss: 0.2377, label: 3, bag_size: 1422


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.1892, train_clustering_loss:  0.5835, train_error: 0.5957
class 0: acc 0.375, correct 3/8
class 1: acc 0.3, correct 3/10
class 2: acc 0.16666666666666666, correct 2/12
class 3: acc 0.6470588235294118, correct 11/17

Val Set, val_loss: 1.3593, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.3773, instance_loss: 0.6366, weighted_loss: 1.1551, label: 0, bag_size: 1452
batch 39, loss: 0.9328, instance_loss: 0.5146, weighted_loss: 0.8073, label: 2, bag_size: 602


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1274, train_clustering_loss:  0.5748, train_error: 0.4468
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8888888888888888, correct 16/18
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.4389, val_error: 0.8182, auc: 0.6319
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.0682, instance_loss: 0.5680, weighted_loss: 0.9181, label: 1, bag_size: 5086
batch 39, loss: 1.8883, instance_loss: 0.6817, weighted_loss: 1.5263, label: 3, bag_size: 10296


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 0.9423, train_clustering_loss:  0.5611, train_error: 0.3617
class 0: acc 0.5, correct 8/16
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.6, correct 6/10
class 3: acc 0.42857142857142855, correct 3/7

Val Set, val_loss: 1.4027, val_error: 0.6364, auc: 0.5868
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1319, instance_loss: 0.3265, weighted_loss: 0.1903, label: 3, bag_size: 1422
batch 39, loss: 0.9866, instance_loss: 0.5580, weighted_loss: 0.8580, label: 2, bag_size: 1654


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.0299, train_clustering_loss:  0.5506, train_error: 0.4681
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.38461538461538464, correct 5/13
class 3: acc 0.625, correct 10/16

Val Set, val_loss: 1.4494, val_error: 0.6364, auc: 0.5868
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.8056, instance_loss: 0.5477, weighted_loss: 0.7282, label: 2, bag_size: 750
batch 39, loss: 0.5552, instance_loss: 0.5142, weighted_loss: 0.5429, label: 1, bag_size: 2636


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 0.9539, train_clustering_loss:  0.5377, train_error: 0.2979
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.6875, correct 11/16
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.3982, val_error: 0.6364, auc: 0.5556
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.7890, instance_loss: 0.6628, weighted_loss: 1.4512, label: 3, bag_size: 941
batch 39, loss: 0.9168, instance_loss: 0.5649, weighted_loss: 0.8112, label: 2, bag_size: 750


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.9368, train_clustering_loss:  0.5383, train_error: 0.3191
class 0: acc 0.3, correct 3/10
class 1: acc 1.0, correct 14/14
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.3687, val_error: 0.6364, auc: 0.6181
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.7260, instance_loss: 0.4980, weighted_loss: 0.6576, label: 1, bag_size: 1617
batch 39, loss: 1.6267, instance_loss: 0.6215, weighted_loss: 1.3251, label: 2, bag_size: 602


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.007978723404255319: correct 3/376
Epoch: 19, train_loss: 0.8462, train_clustering_loss:  0.5103, train_error: 0.2979
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.25, correct 2/8
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.3553, val_error: 0.5455, auc: 0.6042
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.1218, instance_loss: 0.5895, weighted_loss: 0.9621, label: 0, bag_size: 6943
batch 39, loss: 1.1312, instance_loss: 0.6085, weighted_loss: 0.9744, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.018617021276595744: correct 7/376
Epoch: 20, train_loss: 0.8300, train_clustering_loss:  0.5077, train_error: 0.2979
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.8, correct 8/10
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.7333333333333333, correct 11/15

Val Set, val_loss: 1.3898, val_error: 0.4545, auc: 0.5833
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.4176, instance_loss: 0.4869, weighted_loss: 0.4384, label: 0, bag_size: 3642
batch 39, loss: 0.2858, instance_loss: 0.3730, weighted_loss: 0.3119, label: 3, bag_size: 1720


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.031914893617021274: correct 12/376
Epoch: 21, train_loss: 0.7634, train_clustering_loss:  0.4862, train_error: 0.3404
class 0: acc 0.6, correct 6/10
class 1: acc 0.8888888888888888, correct 16/18
class 2: acc 0.125, correct 1/8
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3424, val_error: 0.7273, auc: 0.5521
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.345800 --> 1.342439).  Saving model ...


batch 19, loss: 0.8041, instance_loss: 0.5851, weighted_loss: 0.7384, label: 2, bag_size: 6469
batch 39, loss: 0.6958, instance_loss: 0.5450, weighted_loss: 0.6506, label: 0, bag_size: 4903


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.047872340425531915: correct 18/376
Epoch: 22, train_loss: 0.7575, train_clustering_loss:  0.4923, train_error: 0.2553
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 1.0, correct 12/12
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.4397, val_error: 0.5455, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9605, instance_loss: 0.5474, weighted_loss: 0.8365, label: 2, bag_size: 6469
batch 39, loss: 1.0309, instance_loss: 0.4923, weighted_loss: 0.8693, label: 3, bag_size: 4413


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.010638297872340425: correct 4/376
Epoch: 23, train_loss: 0.7382, train_clustering_loss:  0.4729, train_error: 0.2766
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.625, correct 5/8
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.3582, val_error: 0.5455, auc: 0.6042
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0844, instance_loss: 0.1822, weighted_loss: 0.1137, label: 3, bag_size: 1422
batch 39, loss: 1.1070, instance_loss: 0.4852, weighted_loss: 0.9205, label: 1, bag_size: 1617


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.10106382978723404: correct 38/376
Epoch: 24, train_loss: 0.7221, train_clustering_loss:  0.4691, train_error: 0.2766
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.9, correct 9/10
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.3703, val_error: 0.5455, auc: 0.6215
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.3310, instance_loss: 0.3399, weighted_loss: 0.3336, label: 1, bag_size: 5301
batch 39, loss: 0.1899, instance_loss: 0.3525, weighted_loss: 0.2387, label: 1, bag_size: 1540


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.08776595744680851: correct 33/376
Epoch: 25, train_loss: 0.6498, train_clustering_loss:  0.4520, train_error: 0.2128
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.8, correct 8/10
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.3440, val_error: 0.8182, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1332, instance_loss: 0.2544, weighted_loss: 0.1695, label: 1, bag_size: 4010
batch 39, loss: 0.8534, instance_loss: 0.4742, weighted_loss: 0.7396, label: 1, bag_size: 1275


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.09840425531914894: correct 37/376
Epoch: 26, train_loss: 0.5658, train_clustering_loss:  0.4370, train_error: 0.1915
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 1.0, correct 14/14
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.4043, val_error: 0.7273, auc: 0.6389
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.6102, instance_loss: 0.5019, weighted_loss: 0.5777, label: 2, bag_size: 3753
batch 39, loss: 0.3719, instance_loss: 0.3856, weighted_loss: 0.3760, label: 3, bag_size: 1534


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.05851063829787234: correct 22/376
Epoch: 27, train_loss: 0.6312, train_clustering_loss:  0.4441, train_error: 0.2340
class 0: acc 0.7, correct 7/10
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.3563, val_error: 0.5455, auc: 0.6458
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.7903, instance_loss: 0.5031, weighted_loss: 0.7041, label: 0, bag_size: 1342
batch 39, loss: 0.3357, instance_loss: 0.2798, weighted_loss: 0.3189, label: 1, bag_size: 4646


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.1196808510638298: correct 45/376
Epoch: 28, train_loss: 0.6353, train_clustering_loss:  0.4454, train_error: 0.2128
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.875, correct 7/8
class 2: acc 0.8125, correct 13/16
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.4670, val_error: 0.5455, auc: 0.6458
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.1326, instance_loss: 0.4981, weighted_loss: 0.9422, label: 2, bag_size: 602
batch 39, loss: 0.2911, instance_loss: 0.3675, weighted_loss: 0.3141, label: 2, bag_size: 7427


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.06648936170212766: correct 25/376
Epoch: 29, train_loss: 0.5667, train_clustering_loss:  0.4361, train_error: 0.1915
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.875, correct 7/8
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4222, val_error: 0.5455, auc: 0.6458
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1132, instance_loss: 0.2557, weighted_loss: 0.1559, label: 2, bag_size: 4921
batch 39, loss: 0.1910, instance_loss: 0.2541, weighted_loss: 0.2099, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.10638297872340426: correct 40/376
Epoch: 30, train_loss: 0.4618, train_clustering_loss:  0.3869, train_error: 0.0638
class 0: acc 0.9, correct 9/10
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 1.0, correct 15/15
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.4617, val_error: 0.5455, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5537, instance_loss: 0.4183, weighted_loss: 0.5131, label: 1, bag_size: 7035
batch 39, loss: 0.5536, instance_loss: 0.5012, weighted_loss: 0.5379, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.11702127659574468: correct 44/376
Epoch: 31, train_loss: 0.4892, train_clustering_loss:  0.4011, train_error: 0.1277
class 0: acc 0.8888888888888888, correct 16/18
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.5807, val_error: 0.5455, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2382, instance_loss: 0.3445, weighted_loss: 0.2701, label: 0, bag_size: 3642
batch 39, loss: 0.2832, instance_loss: 0.3312, weighted_loss: 0.2976, label: 0, bag_size: 3642


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.13829787234042554: correct 52/376
Epoch: 32, train_loss: 0.5081, train_clustering_loss:  0.3977, train_error: 0.1915
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 1.0, correct 18/18
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.375, correct 3/8

Val Set, val_loss: 1.4005, val_error: 0.6364, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.7587, instance_loss: 0.4221, weighted_loss: 0.6577, label: 1, bag_size: 1617
batch 39, loss: 0.2461, instance_loss: 0.3120, weighted_loss: 0.2659, label: 2, bag_size: 2966


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.22340425531914893: correct 84/376
Epoch: 33, train_loss: 0.4924, train_clustering_loss:  0.3752, train_error: 0.1702
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.8666666666666667, correct 13/15

Val Set, val_loss: 1.3673, val_error: 0.6364, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1241, instance_loss: 0.2334, weighted_loss: 0.1569, label: 3, bag_size: 1534
batch 39, loss: 0.2362, instance_loss: 0.3278, weighted_loss: 0.2637, label: 2, bag_size: 6477


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.30851063829787234: correct 116/376
Epoch: 34, train_loss: 0.4296, train_clustering_loss:  0.3686, train_error: 0.1064
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 1.0, correct 13/13
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.5067, val_error: 0.6364, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.5713, instance_loss: 0.4743, weighted_loss: 0.5422, label: 3, bag_size: 1249
batch 39, loss: 0.2164, instance_loss: 0.2816, weighted_loss: 0.2359, label: 1, bag_size: 2636


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.19148936170212766: correct 72/376
Epoch: 35, train_loss: 0.5236, train_clustering_loss:  0.4046, train_error: 0.1702
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.7, correct 7/10
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.4684, val_error: 0.7273, auc: 0.6736
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3207, instance_loss: 0.2770, weighted_loss: 0.3076, label: 1, bag_size: 1540
batch 39, loss: 0.1099, instance_loss: 0.1832, weighted_loss: 0.1319, label: 2, bag_size: 6477


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.24202127659574468: correct 91/376
Epoch: 36, train_loss: 0.4495, train_clustering_loss:  0.3703, train_error: 0.1489
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 1.0, correct 17/17
class 2: acc 1.0, correct 13/13
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.4904, val_error: 0.6364, auc: 0.6771
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.4304, instance_loss: 0.4136, weighted_loss: 0.4254, label: 1, bag_size: 1540
batch 39, loss: 0.1685, instance_loss: 0.2742, weighted_loss: 0.2002, label: 3, bag_size: 1720


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.300531914893617: correct 113/376
Epoch: 37, train_loss: 0.3955, train_clustering_loss:  0.3533, train_error: 0.1064
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 14/14
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.4213, val_error: 0.7273, auc: 0.6840
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.6163, instance_loss: 0.5703, weighted_loss: 1.3025, label: 1, bag_size: 5086
batch 39, loss: 0.1921, instance_loss: 0.1833, weighted_loss: 0.1895, label: 3, bag_size: 6746


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.3723404255319149: correct 140/376
Epoch: 38, train_loss: 0.4301, train_clustering_loss:  0.3541, train_error: 0.1277
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.4063, val_error: 0.6364, auc: 0.6840
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1541, instance_loss: 0.2566, weighted_loss: 0.1848, label: 0, bag_size: 3642
batch 39, loss: 0.5026, instance_loss: 0.3260, weighted_loss: 0.4496, label: 1, bag_size: 2636


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.29521276595744683: correct 111/376
Epoch: 39, train_loss: 0.4157, train_clustering_loss:  0.3616, train_error: 0.1277
class 0: acc 0.8, correct 12/15
class 1: acc 1.0, correct 11/11
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.4387, val_error: 0.5455, auc: 0.7014
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.1256, instance_loss: 0.2160, weighted_loss: 0.1527, label: 1, bag_size: 8645
batch 39, loss: 0.0739, instance_loss: 0.1577, weighted_loss: 0.0991, label: 3, bag_size: 6746


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.39095744680851063: correct 147/376
Epoch: 40, train_loss: 0.3545, train_clustering_loss:  0.3312, train_error: 0.0851
class 0: acc 0.625, correct 5/8
class 1: acc 1.0, correct 15/15
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.3291, val_error: 0.6364, auc: 0.7118
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.342439 --> 1.329087).  Saving model ...


batch 19, loss: 0.2692, instance_loss: 0.3677, weighted_loss: 0.2987, label: 0, bag_size: 4010
batch 39, loss: 0.1238, instance_loss: 0.1951, weighted_loss: 0.1452, label: 2, bag_size: 6469


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.3271276595744681: correct 123/376
Epoch: 41, train_loss: 0.4370, train_clustering_loss:  0.3564, train_error: 0.1702
class 0: acc 0.75, correct 9/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.3793, val_error: 0.5455, auc: 0.7361
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4378, instance_loss: 0.4859, weighted_loss: 0.4523, label: 3, bag_size: 1249
batch 39, loss: 0.0861, instance_loss: 0.2392, weighted_loss: 0.1321, label: 3, bag_size: 1534


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.3404255319148936: correct 128/376
Epoch: 42, train_loss: 0.4547, train_clustering_loss:  0.3610, train_error: 0.1915
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.1889, val_error: 0.5455, auc: 0.7674
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.329087 --> 1.188870).  Saving model ...


batch 19, loss: 0.0669, instance_loss: 0.1470, weighted_loss: 0.0910, label: 3, bag_size: 5428
batch 39, loss: 0.1255, instance_loss: 0.2754, weighted_loss: 0.1705, label: 2, bag_size: 2966


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.5053191489361702: correct 190/376
Epoch: 43, train_loss: 0.3018, train_clustering_loss:  0.2916, train_error: 0.0638
class 0: acc 0.75, correct 6/8
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 10/10
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.3902, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6444, instance_loss: 0.5334, weighted_loss: 0.6111, label: 3, bag_size: 3415
batch 39, loss: 0.3516, instance_loss: 0.4096, weighted_loss: 0.3690, label: 0, bag_size: 1452


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.42021276595744683: correct 158/376
Epoch: 44, train_loss: 0.3426, train_clustering_loss:  0.3362, train_error: 0.0638
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 12/12
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.4996, val_error: 0.5455, auc: 0.6771
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1000, instance_loss: 0.1590, weighted_loss: 0.1177, label: 1, bag_size: 5301
batch 39, loss: 0.1523, instance_loss: 0.3100, weighted_loss: 0.1996, label: 0, bag_size: 460


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.4946808510638298: correct 186/376
Epoch: 45, train_loss: 0.3044, train_clustering_loss:  0.3018, train_error: 0.0851
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.6151, val_error: 0.7273, auc: 0.6736
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8024, instance_loss: 0.5130, weighted_loss: 0.7155, label: 1, bag_size: 1275
batch 39, loss: 0.1261, instance_loss: 0.2767, weighted_loss: 0.1712, label: 3, bag_size: 1534


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.48936170212765956: correct 184/376
Epoch: 46, train_loss: 0.3547, train_clustering_loss:  0.3173, train_error: 0.1064
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.3347, val_error: 0.7273, auc: 0.7188
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2601, instance_loss: 0.2630, weighted_loss: 0.2610, label: 2, bag_size: 4715
batch 39, loss: 1.6992, instance_loss: 0.7597, weighted_loss: 1.4174, label: 3, bag_size: 4413


class 0 clustering acc 0.9820478723404256: correct 1477/1504
class 1 clustering acc 0.4601063829787234: correct 173/376
Epoch: 47, train_loss: 0.3598, train_clustering_loss:  0.3451, train_error: 0.0851
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 9/9
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.4047, val_error: 0.4545, auc: 0.7326
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.7614, instance_loss: 0.5854, weighted_loss: 0.7086, label: 2, bag_size: 1654
batch 39, loss: 0.1390, instance_loss: 0.1726, weighted_loss: 0.1490, label: 1, bag_size: 7035


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.5106382978723404: correct 192/376
Epoch: 48, train_loss: 0.2846, train_clustering_loss:  0.3009, train_error: 0.1064
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 1.0, correct 14/14
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.3872, val_error: 0.7273, auc: 0.7014
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.4488, instance_loss: 0.7729, weighted_loss: 1.2460, label: 0, bag_size: 859
batch 39, loss: 0.4387, instance_loss: 0.4723, weighted_loss: 0.4488, label: 0, bag_size: 6943


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.44680851063829785: correct 168/376
Epoch: 49, train_loss: 0.3783, train_clustering_loss:  0.3315, train_error: 0.1064
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.4601, val_error: 0.7273, auc: 0.7118
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0559, instance_loss: 0.1722, weighted_loss: 0.0908, label: 2, bag_size: 6469
batch 39, loss: 0.0381, instance_loss: 0.0873, weighted_loss: 0.0529, label: 1, bag_size: 4010


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.6063829787234043: correct 228/376
Epoch: 50, train_loss: 0.2529, train_clustering_loss:  0.2688, train_error: 0.0638
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.5591, val_error: 0.7273, auc: 0.6771
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.3392, instance_loss: 0.3136, weighted_loss: 0.3316, label: 2, bag_size: 3753
batch 39, loss: 0.0182, instance_loss: 0.0964, weighted_loss: 0.0416, label: 3, bag_size: 10296


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.5664893617021277: correct 213/376
Epoch: 51, train_loss: 0.2183, train_clustering_loss:  0.2697, train_error: 0.0638
class 0: acc 0.9411764705882353, correct 16/17
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.6197, val_error: 0.7273, auc: 0.6667
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1027, instance_loss: 0.2261, weighted_loss: 0.1397, label: 1, bag_size: 4646
batch 39, loss: 0.0394, instance_loss: 0.1028, weighted_loss: 0.0584, label: 3, bag_size: 6746


class 0 clustering acc 0.9827127659574468: correct 1478/1504
class 1 clustering acc 0.4867021276595745: correct 183/376
Epoch: 52, train_loss: 0.2713, train_clustering_loss:  0.3247, train_error: 0.0000
class 0: acc 1.0, correct 17/17
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 6/6
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.3671, val_error: 0.4545, auc: 0.6875
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.1171, instance_loss: 0.4230, weighted_loss: 0.2089, label: 0, bag_size: 7561
batch 39, loss: 0.4760, instance_loss: 0.4373, weighted_loss: 0.4644, label: 1, bag_size: 5086


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.598404255319149: correct 225/376
Epoch: 53, train_loss: 0.2648, train_clustering_loss:  0.2594, train_error: 0.0426
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 9/9
class 2: acc 0.75, correct 6/8
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 1.2574, val_error: 0.5455, auc: 0.7708
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1399, instance_loss: 0.2096, weighted_loss: 0.1609, label: 1, bag_size: 1540
batch 39, loss: 0.2209, instance_loss: 0.4083, weighted_loss: 0.2771, label: 2, bag_size: 750


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.5425531914893617: correct 204/376
Epoch: 54, train_loss: 0.2610, train_clustering_loss:  0.2886, train_error: 0.0426
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.9444444444444444, correct 17/18
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.0823, val_error: 0.5455, auc: 0.8160
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.188870 --> 1.082341).  Saving model ...


batch 19, loss: 0.1455, instance_loss: 0.2367, weighted_loss: 0.1729, label: 1, bag_size: 4400
batch 39, loss: 0.0882, instance_loss: 0.1205, weighted_loss: 0.0979, label: 3, bag_size: 5428


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.5398936170212766: correct 203/376
Epoch: 55, train_loss: 0.2929, train_clustering_loss:  0.2912, train_error: 0.0638
class 0: acc 0.9, correct 9/10
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.4503, val_error: 0.5455, auc: 0.7396
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2101, instance_loss: 0.2311, weighted_loss: 0.2164, label: 2, bag_size: 2966
batch 39, loss: 0.0067, instance_loss: 0.0186, weighted_loss: 0.0103, label: 3, bag_size: 3071


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.6382978723404256: correct 240/376
Epoch: 56, train_loss: 0.1901, train_clustering_loss:  0.2471, train_error: 0.0000
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.3497, val_error: 0.6364, auc: 0.7743
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1289, instance_loss: 0.1673, weighted_loss: 0.1404, label: 1, bag_size: 2636
batch 39, loss: 0.0381, instance_loss: 0.0974, weighted_loss: 0.0559, label: 1, bag_size: 5301


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.6409574468085106: correct 241/376
Epoch: 57, train_loss: 0.2140, train_clustering_loss:  0.2519, train_error: 0.0213
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 15/15
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.3714, val_error: 0.6364, auc: 0.7569
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0670, instance_loss: 0.2689, weighted_loss: 0.1276, label: 0, bag_size: 4903
batch 39, loss: 0.0505, instance_loss: 0.1269, weighted_loss: 0.0734, label: 2, bag_size: 4921


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.6063829787234043: correct 228/376
Epoch: 58, train_loss: 0.2401, train_clustering_loss:  0.2770, train_error: 0.0638
class 0: acc 1.0, correct 13/13
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.4872, val_error: 0.6364, auc: 0.7083
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1161, instance_loss: 0.1826, weighted_loss: 0.1361, label: 2, bag_size: 4921
batch 39, loss: 0.4615, instance_loss: 0.3545, weighted_loss: 0.4294, label: 1, bag_size: 5086


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.6409574468085106: correct 241/376
Epoch: 59, train_loss: 0.1887, train_clustering_loss:  0.2644, train_error: 0.0213
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.7204, val_error: 0.7273, auc: 0.6944
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0592, instance_loss: 0.3972, weighted_loss: 0.1606, label: 2, bag_size: 750
batch 39, loss: 0.5884, instance_loss: 0.3975, weighted_loss: 0.5312, label: 2, bag_size: 602


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.5292553191489362: correct 199/376
Epoch: 60, train_loss: 0.3440, train_clustering_loss:  0.2882, train_error: 0.1064
class 0: acc 1.0, correct 9/9
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.75, correct 9/12
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.7306, val_error: 0.7273, auc: 0.6944
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.6115, instance_loss: 0.4172, weighted_loss: 0.5532, label: 3, bag_size: 4413
batch 39, loss: 0.0513, instance_loss: 0.1474, weighted_loss: 0.0801, label: 2, bag_size: 4921


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.6356382978723404: correct 239/376
Epoch: 61, train_loss: 0.2585, train_clustering_loss:  0.2408, train_error: 0.1064
class 0: acc 0.5, correct 4/8
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.4622, val_error: 0.6364, auc: 0.7014
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.3589, instance_loss: 0.3514, weighted_loss: 0.3566, label: 0, bag_size: 1342
batch 39, loss: 0.2307, instance_loss: 0.1924, weighted_loss: 0.2192, label: 2, bag_size: 7427


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.6382978723404256: correct 240/376
Epoch: 62, train_loss: 0.2497, train_clustering_loss:  0.2625, train_error: 0.0851
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.5540, val_error: 0.5455, auc: 0.6771
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.0749, instance_loss: 0.7438, weighted_loss: 0.9755, label: 3, bag_size: 941
batch 39, loss: 0.4245, instance_loss: 0.3681, weighted_loss: 0.4076, label: 0, bag_size: 1342


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.5372340425531915: correct 202/376
Epoch: 63, train_loss: 0.2497, train_clustering_loss:  0.2943, train_error: 0.0638
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 9/9
class 2: acc 0.8, correct 8/10
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.6421, val_error: 0.7273, auc: 0.6424
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1243, instance_loss: 0.2832, weighted_loss: 0.1720, label: 0, bag_size: 6943
batch 39, loss: 0.3369, instance_loss: 0.3143, weighted_loss: 0.3301, label: 3, bag_size: 3415


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.5797872340425532: correct 218/376
Epoch: 64, train_loss: 0.2289, train_clustering_loss:  0.2613, train_error: 0.0213
class 0: acc 0.9444444444444444, correct 17/18
class 1: acc 1.0, correct 6/6
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.6730, val_error: 0.4545, auc: 0.6806
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.9099, instance_loss: 0.4944, weighted_loss: 0.7853, label: 0, bag_size: 3323
batch 39, loss: 0.3640, instance_loss: 0.4122, weighted_loss: 0.3784, label: 2, bag_size: 7812


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.6170212765957447: correct 232/376
Epoch: 65, train_loss: 0.2420, train_clustering_loss:  0.2790, train_error: 0.0638
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.6575, val_error: 0.5455, auc: 0.6667
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1685, instance_loss: 0.2673, weighted_loss: 0.1981, label: 1, bag_size: 7035
batch 39, loss: 0.1433, instance_loss: 0.3244, weighted_loss: 0.1977, label: 0, bag_size: 3323


class 0 clustering acc 0.9840425531914894: correct 1480/1504
class 1 clustering acc 0.6382978723404256: correct 240/376
Epoch: 66, train_loss: 0.2216, train_clustering_loss:  0.2660, train_error: 0.0851
class 0: acc 1.0, correct 13/13
class 1: acc 0.9090909090909091, correct 20/22
class 2: acc 0.875, correct 7/8
class 3: acc 0.75, correct 3/4

Val Set, val_loss: 1.9344, val_error: 0.6364, auc: 0.6562
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0703, instance_loss: 0.1646, weighted_loss: 0.0986, label: 3, bag_size: 1720
batch 39, loss: 0.0616, instance_loss: 0.0878, weighted_loss: 0.0694, label: 1, bag_size: 4646


class 0 clustering acc 0.9827127659574468: correct 1478/1504
class 1 clustering acc 0.648936170212766: correct 244/376
Epoch: 67, train_loss: 0.1897, train_clustering_loss:  0.2579, train_error: 0.0426
class 0: acc 0.875, correct 7/8
class 1: acc 1.0, correct 19/19
class 2: acc 1.0, correct 10/10
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.7028, val_error: 0.6364, auc: 0.6250
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.1438, instance_loss: 0.6339, weighted_loss: 0.9908, label: 2, bag_size: 7812
batch 39, loss: 0.0453, instance_loss: 0.1136, weighted_loss: 0.0658, label: 0, bag_size: 3756


class 0 clustering acc 0.9847074468085106: correct 1481/1504
class 1 clustering acc 0.550531914893617: correct 207/376
Epoch: 68, train_loss: 0.2390, train_clustering_loss:  0.3103, train_error: 0.0213
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 10/10
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.8374, val_error: 0.6364, auc: 0.6771
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0734, instance_loss: 0.2435, weighted_loss: 0.1244, label: 2, bag_size: 2966
batch 39, loss: 0.1210, instance_loss: 0.2370, weighted_loss: 0.1558, label: 2, bag_size: 4715


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.699468085106383: correct 263/376
Epoch: 69, train_loss: 0.1555, train_clustering_loss:  0.2242, train_error: 0.0213
class 0: acc 1.0, correct 11/11
class 1: acc 1.0, correct 17/17
class 2: acc 1.0, correct 13/13
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.8950, val_error: 0.7273, auc: 0.6944
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0034, instance_loss: 0.0222, weighted_loss: 0.0090, label: 3, bag_size: 3071
batch 39, loss: 0.1106, instance_loss: 0.1158, weighted_loss: 0.1122, label: 1, bag_size: 4646


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.6781914893617021: correct 255/376
Epoch: 70, train_loss: 0.3339, train_clustering_loss:  0.2458, train_error: 0.0851
class 0: acc 0.7, correct 7/10
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 9/9
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.9338, val_error: 0.6364, auc: 0.6215
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.2324, instance_loss: 0.2558, weighted_loss: 0.2394, label: 1, bag_size: 4400
batch 39, loss: 0.0335, instance_loss: 0.1167, weighted_loss: 0.0585, label: 1, bag_size: 1540


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.6356382978723404: correct 239/376
Epoch: 71, train_loss: 0.1605, train_clustering_loss:  0.2510, train_error: 0.0213
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 12/12
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.6963, val_error: 0.7273, auc: 0.6840
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0764, instance_loss: 0.2278, weighted_loss: 0.1218, label: 2, bag_size: 6469
batch 39, loss: 0.0835, instance_loss: 0.1055, weighted_loss: 0.0901, label: 1, bag_size: 2636


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.5611702127659575: correct 211/376
Epoch: 72, train_loss: 0.1849, train_clustering_loss:  0.2646, train_error: 0.0213
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.8335, val_error: 0.7273, auc: 0.6944
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0149, instance_loss: 0.0873, weighted_loss: 0.0366, label: 2, bag_size: 7427
batch 39, loss: 0.2944, instance_loss: 0.4804, weighted_loss: 0.3502, label: 0, bag_size: 1452


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.6622340425531915: correct 249/376
Epoch: 73, train_loss: 0.2155, train_clustering_loss:  0.2324, train_error: 0.0638
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 13/13
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.7747, val_error: 0.6364, auc: 0.7188
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0222, instance_loss: 0.0312, weighted_loss: 0.0249, label: 3, bag_size: 6746
batch 39, loss: 0.0490, instance_loss: 0.1411, weighted_loss: 0.0766, label: 3, bag_size: 1720


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.7606382978723404: correct 286/376
Epoch: 74, train_loss: 0.1410, train_clustering_loss:  0.2053, train_error: 0.0000
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 14/14
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 2.0213, val_error: 0.6364, auc: 0.6979
class 0 clustering acc 0.9119318181818182: correct 321/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.5455, ROC AUC: 0.8160
Test error: 0.6364, ROC AUC: 0.5417
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3

Training Fold 3!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.9194, instance_loss: 1.1252, weighted_loss: 1.6811, label: 1, bag_size: 8645
batch 39, loss: 1.8781, instance_loss: 0.9616, weighted_loss: 1.6031, label: 1, bag_size: 1275


class 0 clustering acc 0.944813829787234: correct 1421/1504
class 1 clustering acc 0.07180851063829788: correct 27/376
Epoch: 0, train_loss: 1.4297, train_clustering_loss:  1.0370, train_error: 0.7234
class 0: acc 0.0, correct 0/11
class 1: acc 0.0, correct 0/10
class 2: acc 1.0, correct 13/13
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.4153, val_error: 0.7273, auc: 0.5104
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.415339).  Saving model ...


batch 19, loss: 1.3982, instance_loss: 0.7607, weighted_loss: 1.2069, label: 2, bag_size: 6469
batch 39, loss: 1.2449, instance_loss: 0.6901, weighted_loss: 1.0784, label: 1, bag_size: 4010


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3744, train_clustering_loss:  0.7442, train_error: 0.7021
class 0: acc 0.0, correct 0/5
class 1: acc 0.125, correct 2/16
class 2: acc 0.0, correct 0/13
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.4485, val_error: 0.7273, auc: 0.5174
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3909, instance_loss: 0.6458, weighted_loss: 1.1674, label: 2, bag_size: 7812
batch 39, loss: 1.0709, instance_loss: 0.6206, weighted_loss: 0.9358, label: 2, bag_size: 3753


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3882, train_clustering_loss:  0.6399, train_error: 0.6809
class 0: acc 0.0, correct 0/10
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.2857142857142857, correct 4/14
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4352, val_error: 0.8182, auc: 0.5312
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1299, instance_loss: 0.5992, weighted_loss: 0.9707, label: 1, bag_size: 3332
batch 39, loss: 1.1599, instance_loss: 0.6122, weighted_loss: 0.9956, label: 3, bag_size: 1422


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3608, train_clustering_loss:  0.6204, train_error: 0.6809
class 0: acc 0.0, correct 0/8
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.3333333333333333, correct 4/12
class 3: acc 0.2857142857142857, correct 4/14

Val Set, val_loss: 1.3980, val_error: 0.7273, auc: 0.5382
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.415339 --> 1.398035).  Saving model ...


batch 19, loss: 1.3240, instance_loss: 0.5790, weighted_loss: 1.1005, label: 2, bag_size: 4328
batch 39, loss: 1.4360, instance_loss: 0.6080, weighted_loss: 1.1876, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.4098, train_clustering_loss:  0.6205, train_error: 0.8085
class 0: acc 0.07692307692307693, correct 1/13
class 1: acc 0.07142857142857142, correct 1/14
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.4043, val_error: 0.8182, auc: 0.5382
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5830, instance_loss: 0.6218, weighted_loss: 1.2946, label: 0, bag_size: 1225
batch 39, loss: 1.4229, instance_loss: 0.6178, weighted_loss: 1.1814, label: 0, bag_size: 3323


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3706, train_clustering_loss:  0.6100, train_error: 0.6809
class 0: acc 0.0, correct 0/12
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.7, correct 7/10
class 3: acc 0.0, correct 0/14

Val Set, val_loss: 1.3639, val_error: 0.6364, auc: 0.5868
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.398035 --> 1.363878).  Saving model ...


batch 19, loss: 1.8660, instance_loss: 0.6163, weighted_loss: 1.4911, label: 2, bag_size: 4328
batch 39, loss: 1.3618, instance_loss: 0.5862, weighted_loss: 1.1291, label: 2, bag_size: 6469


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3997, train_clustering_loss:  0.6129, train_error: 0.7660
class 0: acc 0.0, correct 0/12
class 1: acc 0.23076923076923078, correct 3/13
class 2: acc 0.0, correct 0/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3866, val_error: 0.7273, auc: 0.5451
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2166, instance_loss: 0.5848, weighted_loss: 1.0270, label: 1, bag_size: 3332
batch 39, loss: 1.0121, instance_loss: 0.5772, weighted_loss: 0.8816, label: 1, bag_size: 2636


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3056, train_clustering_loss:  0.6024, train_error: 0.5957
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.1, correct 1/10
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3735, val_error: 0.7273, auc: 0.5590
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1879, instance_loss: 0.6188, weighted_loss: 1.0172, label: 2, bag_size: 10330
batch 39, loss: 1.1005, instance_loss: 0.5830, weighted_loss: 0.9453, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2911, train_clustering_loss:  0.6028, train_error: 0.5957
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3963, val_error: 0.9091, auc: 0.5903
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2684, instance_loss: 0.6269, weighted_loss: 1.0760, label: 3, bag_size: 3366
batch 39, loss: 1.5786, instance_loss: 0.6235, weighted_loss: 1.2921, label: 1, bag_size: 1275


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2783, train_clustering_loss:  0.6007, train_error: 0.5957
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 0.1, correct 1/10
class 2: acc 1.0, correct 12/12
class 3: acc 0.15384615384615385, correct 2/13

Val Set, val_loss: 1.3592, val_error: 0.5455, auc: 0.6528
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.363878 --> 1.359170).  Saving model ...


batch 19, loss: 1.0486, instance_loss: 0.5489, weighted_loss: 0.8987, label: 2, bag_size: 6469
batch 39, loss: 1.5224, instance_loss: 0.6312, weighted_loss: 1.2551, label: 1, bag_size: 4010


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2547, train_clustering_loss:  0.5941, train_error: 0.4894
class 0: acc 0.4, correct 4/10
class 1: acc 0.1, correct 1/10
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.4091, val_error: 0.8182, auc: 0.5694
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0255, instance_loss: 0.5860, weighted_loss: 0.8937, label: 1, bag_size: 1617
batch 39, loss: 0.9348, instance_loss: 0.5826, weighted_loss: 0.8291, label: 3, bag_size: 1720


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2839, train_clustering_loss:  0.6058, train_error: 0.5745
class 0: acc 0.35714285714285715, correct 5/14
class 1: acc 0.5, correct 7/14
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.3431, val_error: 0.3636, auc: 0.5764
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.359170 --> 1.343147).  Saving model ...


batch 19, loss: 1.6009, instance_loss: 0.6045, weighted_loss: 1.3020, label: 2, bag_size: 750
batch 39, loss: 1.2069, instance_loss: 0.5614, weighted_loss: 1.0133, label: 2, bag_size: 4328


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2898, train_clustering_loss:  0.6023, train_error: 0.5957
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.1, correct 1/10
class 3: acc 0.16666666666666666, correct 2/12

Val Set, val_loss: 1.3295, val_error: 0.4545, auc: 0.5660
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.343147 --> 1.329452).  Saving model ...


batch 19, loss: 1.4215, instance_loss: 0.5902, weighted_loss: 1.1721, label: 2, bag_size: 7812
batch 39, loss: 1.0512, instance_loss: 0.5682, weighted_loss: 0.9063, label: 2, bag_size: 4328


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2533, train_clustering_loss:  0.5974, train_error: 0.6170
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.21428571428571427, correct 3/14
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.3499, val_error: 0.8182, auc: 0.5347
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6420, instance_loss: 0.6397, weighted_loss: 1.3413, label: 1, bag_size: 3332
batch 39, loss: 1.2280, instance_loss: 0.6342, weighted_loss: 1.0499, label: 3, bag_size: 6888


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.2002, train_clustering_loss:  0.5948, train_error: 0.5532
class 0: acc 0.0, correct 0/10
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.875, correct 14/16
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.3372, val_error: 0.7273, auc: 0.5903
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4334, instance_loss: 0.5943, weighted_loss: 1.1817, label: 3, bag_size: 1249
batch 39, loss: 1.0026, instance_loss: 0.6004, weighted_loss: 0.8820, label: 3, bag_size: 3503


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.1324, train_clustering_loss:  0.5928, train_error: 0.4681
class 0: acc 0.0, correct 0/7
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.3333333333333333, correct 3/9
class 3: acc 0.7894736842105263, correct 15/19

Val Set, val_loss: 1.4217, val_error: 0.6364, auc: 0.6181
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.1401, instance_loss: 0.5680, weighted_loss: 0.9685, label: 2, bag_size: 4328
batch 39, loss: 0.9592, instance_loss: 0.5672, weighted_loss: 0.8416, label: 2, bag_size: 10330


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.2381, train_clustering_loss:  0.5915, train_error: 0.5532
class 0: acc 0.0, correct 0/10
class 1: acc 0.3, correct 3/10
class 2: acc 0.5625, correct 9/16
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.3782, val_error: 0.9091, auc: 0.5382
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.0203, instance_loss: 0.5502, weighted_loss: 0.8793, label: 2, bag_size: 2966
batch 39, loss: 1.2290, instance_loss: 0.6303, weighted_loss: 1.0494, label: 0, bag_size: 859


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.1168, train_clustering_loss:  0.5849, train_error: 0.4681
class 0: acc 0.5, correct 8/16
class 1: acc 0.2, correct 2/10
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.16666666666666666, correct 1/6

Val Set, val_loss: 1.3616, val_error: 0.6364, auc: 0.5486
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.5445, instance_loss: 0.6695, weighted_loss: 1.2820, label: 3, bag_size: 6888
batch 39, loss: 1.0394, instance_loss: 0.5277, weighted_loss: 0.8859, label: 2, bag_size: 2966


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 1.1559, train_clustering_loss:  0.5856, train_error: 0.4681
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.23076923076923078, correct 3/13
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.3247, val_error: 0.6364, auc: 0.5694
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.329452 --> 1.324667).  Saving model ...


batch 19, loss: 0.8324, instance_loss: 0.5582, weighted_loss: 0.7502, label: 1, bag_size: 2636
batch 39, loss: 1.5052, instance_loss: 0.5911, weighted_loss: 1.2309, label: 2, bag_size: 4921


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 1.0520, train_clustering_loss:  0.5756, train_error: 0.3830
class 0: acc 0.6470588235294118, correct 11/17
class 1: acc 0.8, correct 8/10
class 2: acc 0.6, correct 6/10
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.3481, val_error: 0.5455, auc: 0.5625
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6070, instance_loss: 0.5056, weighted_loss: 0.5766, label: 0, bag_size: 2826
batch 39, loss: 2.0145, instance_loss: 0.6944, weighted_loss: 1.6185, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 0.9625, train_clustering_loss:  0.5541, train_error: 0.2979
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.42857142857142855, correct 3/7
class 3: acc 0.8333333333333334, correct 15/18

Val Set, val_loss: 1.4324, val_error: 0.5455, auc: 0.5625
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.3616, instance_loss: 0.6419, weighted_loss: 1.1457, label: 2, bag_size: 7427
batch 39, loss: 0.6567, instance_loss: 0.5096, weighted_loss: 0.6126, label: 3, bag_size: 3366


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 0.8642, train_clustering_loss:  0.5310, train_error: 0.2979
class 0: acc 0.125, correct 1/8
class 1: acc 0.9, correct 18/20
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.5278, val_error: 0.6364, auc: 0.5938
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.1563, instance_loss: 0.6420, weighted_loss: 1.0020, label: 2, bag_size: 750
batch 39, loss: 1.1035, instance_loss: 0.6242, weighted_loss: 0.9597, label: 0, bag_size: 3058


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 22, train_loss: 0.8867, train_clustering_loss:  0.5404, train_error: 0.3830
class 0: acc 0.14285714285714285, correct 2/14
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.5, correct 4/8
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4738, val_error: 0.6364, auc: 0.5312
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8068, instance_loss: 0.5873, weighted_loss: 0.7410, label: 2, bag_size: 750
batch 39, loss: 1.4359, instance_loss: 0.5842, weighted_loss: 1.1804, label: 1, bag_size: 7240


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 0.8388, train_clustering_loss:  0.5315, train_error: 0.3191
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.5701, val_error: 0.9091, auc: 0.4931
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.5725, instance_loss: 0.4815, weighted_loss: 0.5452, label: 2, bag_size: 4328
batch 39, loss: 0.5831, instance_loss: 0.5468, weighted_loss: 0.5723, label: 1, bag_size: 2636


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 0.7968, train_clustering_loss:  0.5244, train_error: 0.3404
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.5745, val_error: 0.7273, auc: 0.4792
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.0831, instance_loss: 0.5493, weighted_loss: 0.9230, label: 1, bag_size: 1617
batch 39, loss: 0.6149, instance_loss: 0.5040, weighted_loss: 0.5816, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 25, train_loss: 0.7777, train_clustering_loss:  0.5145, train_error: 0.2979
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.6304, val_error: 0.6364, auc: 0.5000
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.0721, instance_loss: 0.5699, weighted_loss: 0.9214, label: 1, bag_size: 1275
batch 39, loss: 0.3210, instance_loss: 0.4006, weighted_loss: 0.3449, label: 1, bag_size: 3328


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.013297872340425532: correct 5/376
Epoch: 26, train_loss: 0.9211, train_clustering_loss:  0.5321, train_error: 0.4043
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.5714285714285714, correct 8/14
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.6881, val_error: 0.7273, auc: 0.5000
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.6013, instance_loss: 0.4912, weighted_loss: 0.5683, label: 2, bag_size: 3753
batch 39, loss: 0.0757, instance_loss: 0.2603, weighted_loss: 0.1311, label: 3, bag_size: 10296


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.026595744680851064: correct 10/376
Epoch: 27, train_loss: 0.6748, train_clustering_loss:  0.4785, train_error: 0.1702
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.7248, val_error: 0.9091, auc: 0.4896
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.7483, instance_loss: 0.5602, weighted_loss: 0.6919, label: 0, bag_size: 1342
batch 39, loss: 0.4524, instance_loss: 0.4831, weighted_loss: 0.4616, label: 0, bag_size: 1225


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.034574468085106384: correct 13/376
Epoch: 28, train_loss: 0.7680, train_clustering_loss:  0.5057, train_error: 0.2979
class 0: acc 0.8, correct 8/10
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.875, correct 14/16
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.6797, val_error: 0.4545, auc: 0.5417
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.3897, instance_loss: 0.3915, weighted_loss: 0.3903, label: 2, bag_size: 4921
batch 39, loss: 0.5630, instance_loss: 0.4270, weighted_loss: 0.5222, label: 1, bag_size: 8645


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.07712765957446809: correct 29/376
Epoch: 29, train_loss: 0.7515, train_clustering_loss:  0.4920, train_error: 0.2766
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.8823529411764706, correct 15/17
class 2: acc 0.7, correct 7/10
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.7244, val_error: 0.5455, auc: 0.5521
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.4716, instance_loss: 0.4208, weighted_loss: 0.4564, label: 2, bag_size: 7812
batch 39, loss: 1.2823, instance_loss: 0.5583, weighted_loss: 1.0651, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.11702127659574468: correct 44/376
Epoch: 30, train_loss: 0.6912, train_clustering_loss:  0.4856, train_error: 0.2340
class 0: acc 0.6875, correct 11/16
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.7097, val_error: 0.6364, auc: 0.5312
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.3184, instance_loss: 0.3907, weighted_loss: 0.3401, label: 1, bag_size: 4010
batch 39, loss: 0.4531, instance_loss: 0.4700, weighted_loss: 0.4582, label: 1, bag_size: 1540


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.05585106382978723: correct 21/376
Epoch: 31, train_loss: 0.6195, train_clustering_loss:  0.4665, train_error: 0.1702
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.7544, val_error: 0.6364, auc: 0.5556
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0478, instance_loss: 0.1541, weighted_loss: 0.0797, label: 3, bag_size: 10296
batch 39, loss: 0.7544, instance_loss: 0.5525, weighted_loss: 0.6939, label: 2, bag_size: 7427


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.12234042553191489: correct 46/376
Epoch: 32, train_loss: 0.5389, train_clustering_loss:  0.4440, train_error: 0.1489
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 1.0, correct 13/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.7743, val_error: 0.8182, auc: 0.4792
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3199, instance_loss: 0.3735, weighted_loss: 0.3360, label: 1, bag_size: 2636
batch 39, loss: 0.1418, instance_loss: 0.2896, weighted_loss: 0.1861, label: 3, bag_size: 1720


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.09308510638297872: correct 35/376
Epoch: 33, train_loss: 0.6330, train_clustering_loss:  0.4808, train_error: 0.2128
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.75, correct 9/12
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.8258, val_error: 0.7273, auc: 0.5312
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.4426, instance_loss: 0.3366, weighted_loss: 0.4108, label: 3, bag_size: 1534
batch 39, loss: 0.8737, instance_loss: 0.5081, weighted_loss: 0.7640, label: 2, bag_size: 6477


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.1356382978723404: correct 51/376
Epoch: 34, train_loss: 0.5635, train_clustering_loss:  0.4427, train_error: 0.2128
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.8012, val_error: 0.6364, auc: 0.5729
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.3710, instance_loss: 0.3277, weighted_loss: 0.3580, label: 3, bag_size: 1534
batch 39, loss: 0.8429, instance_loss: 0.6151, weighted_loss: 0.7746, label: 0, bag_size: 859


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.22074468085106383: correct 83/376
Epoch: 35, train_loss: 0.3973, train_clustering_loss:  0.3879, train_error: 0.0638
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.8, correct 8/10
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.8652, val_error: 0.7273, auc: 0.5451
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.2116, instance_loss: 0.3853, weighted_loss: 0.2637, label: 1, bag_size: 1540
batch 39, loss: 0.8653, instance_loss: 0.5005, weighted_loss: 0.7559, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.14361702127659576: correct 54/376
Epoch: 36, train_loss: 0.4333, train_clustering_loss:  0.4046, train_error: 0.1064
class 0: acc 1.0, correct 10/10
class 1: acc 0.8125, correct 13/16
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.9352, val_error: 0.7273, auc: 0.5347
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.4756, instance_loss: 0.5175, weighted_loss: 0.4882, label: 1, bag_size: 1540
batch 39, loss: 1.5235, instance_loss: 0.6742, weighted_loss: 1.2687, label: 3, bag_size: 3366


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.08244680851063829: correct 31/376
Epoch: 37, train_loss: 0.5170, train_clustering_loss:  0.4546, train_error: 0.1277
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 1.0, correct 15/15
class 3: acc 0.6666666666666666, correct 4/6

Val Set, val_loss: 1.8411, val_error: 0.7273, auc: 0.5347
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0918, instance_loss: 0.1893, weighted_loss: 0.1211, label: 3, bag_size: 1249
batch 39, loss: 0.2422, instance_loss: 0.2599, weighted_loss: 0.2475, label: 2, bag_size: 7812


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.2127659574468085: correct 80/376
Epoch: 38, train_loss: 0.4981, train_clustering_loss:  0.4019, train_error: 0.1277
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.9375, correct 15/16
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.8873, val_error: 0.7273, auc: 0.5451
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0160, instance_loss: 0.0955, weighted_loss: 0.0398, label: 3, bag_size: 10296
batch 39, loss: 0.3586, instance_loss: 0.4607, weighted_loss: 0.3892, label: 0, bag_size: 8614


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.14095744680851063: correct 53/376
Epoch: 39, train_loss: 0.4980, train_clustering_loss:  0.4415, train_error: 0.1277
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.8019, val_error: 0.7273, auc: 0.5660
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.6901, instance_loss: 0.4523, weighted_loss: 0.6188, label: 1, bag_size: 8645
batch 39, loss: 0.2416, instance_loss: 0.4490, weighted_loss: 0.3038, label: 2, bag_size: 7812


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.15425531914893617: correct 58/376
Epoch: 40, train_loss: 0.5295, train_clustering_loss:  0.4330, train_error: 0.1277
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 1.0, correct 12/12
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.7598, val_error: 0.4545, auc: 0.5417
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.3941, instance_loss: 0.4279, weighted_loss: 0.4042, label: 0, bag_size: 7561
batch 39, loss: 0.1394, instance_loss: 0.2902, weighted_loss: 0.1847, label: 2, bag_size: 750


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.2074468085106383: correct 78/376
Epoch: 41, train_loss: 0.4072, train_clustering_loss:  0.3864, train_error: 0.1064
class 0: acc 1.0, correct 14/14
class 1: acc 0.8, correct 8/10
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.8469, val_error: 0.6364, auc: 0.5312
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.3910, instance_loss: 0.3741, weighted_loss: 0.3860, label: 3, bag_size: 1534
batch 39, loss: 0.1221, instance_loss: 0.2488, weighted_loss: 0.1601, label: 3, bag_size: 1534


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.24468085106382978: correct 92/376
Epoch: 42, train_loss: 0.3348, train_clustering_loss:  0.3577, train_error: 0.0638
class 0: acc 1.0, correct 9/9
class 1: acc 0.8, correct 8/10
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 2.0261, val_error: 0.5455, auc: 0.4688
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0929, instance_loss: 0.2361, weighted_loss: 0.1359, label: 1, bag_size: 7035
batch 39, loss: 0.0613, instance_loss: 0.2359, weighted_loss: 0.1137, label: 3, bag_size: 1720


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.32180851063829785: correct 121/376
Epoch: 43, train_loss: 0.3187, train_clustering_loss:  0.3619, train_error: 0.0213
class 0: acc 0.875, correct 7/8
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.8966, val_error: 0.6364, auc: 0.5417
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.4717, instance_loss: 0.5093, weighted_loss: 0.4830, label: 0, bag_size: 3756
batch 39, loss: 0.4976, instance_loss: 0.4278, weighted_loss: 0.4767, label: 1, bag_size: 3332


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.22606382978723405: correct 85/376
Epoch: 44, train_loss: 0.3981, train_clustering_loss:  0.3860, train_error: 0.0426
class 0: acc 1.0, correct 10/10
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 1.0, correct 14/14
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 2.0878, val_error: 0.7273, auc: 0.5347
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.4660, instance_loss: 0.3571, weighted_loss: 0.4333, label: 1, bag_size: 1617
batch 39, loss: 0.2508, instance_loss: 0.3609, weighted_loss: 0.2838, label: 0, bag_size: 460


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.2845744680851064: correct 107/376
Epoch: 45, train_loss: 0.3009, train_clustering_loss:  0.3499, train_error: 0.0426
class 0: acc 0.9411764705882353, correct 16/17
class 1: acc 1.0, correct 13/13
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.9847, val_error: 0.7273, auc: 0.5035
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.1140, instance_loss: 0.2295, weighted_loss: 0.1487, label: 1, bag_size: 3328
batch 39, loss: 0.0136, instance_loss: 0.0746, weighted_loss: 0.0319, label: 3, bag_size: 10296


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.40425531914893614: correct 152/376
Epoch: 46, train_loss: 0.3312, train_clustering_loss:  0.3381, train_error: 0.0851
class 0: acc 0.75, correct 9/12
class 1: acc 1.0, correct 12/12
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.9821, val_error: 0.7273, auc: 0.5139
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.8379, instance_loss: 0.5548, weighted_loss: 0.7530, label: 2, bag_size: 6469
batch 39, loss: 1.0277, instance_loss: 1.0837, weighted_loss: 1.0445, label: 1, bag_size: 7240


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.23404255319148937: correct 88/376
Epoch: 47, train_loss: 0.3524, train_clustering_loss:  0.3655, train_error: 0.0638
class 0: acc 0.9375, correct 15/16
class 1: acc 1.0, correct 11/11
class 2: acc 0.75, correct 6/8
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.9845, val_error: 0.6364, auc: 0.5660
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.6582, instance_loss: 0.5469, weighted_loss: 0.6248, label: 2, bag_size: 10330
batch 39, loss: 0.0631, instance_loss: 0.1757, weighted_loss: 0.0969, label: 1, bag_size: 4010


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.2845744680851064: correct 107/376
Epoch: 48, train_loss: 0.3556, train_clustering_loss:  0.3770, train_error: 0.0851
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 2.0213, val_error: 0.6364, auc: 0.5243
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.5527, instance_loss: 0.5794, weighted_loss: 0.5607, label: 0, bag_size: 8614
batch 39, loss: 0.2669, instance_loss: 0.3484, weighted_loss: 0.2914, label: 0, bag_size: 2826


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.38563829787234044: correct 145/376
Epoch: 49, train_loss: 0.2583, train_clustering_loss:  0.3244, train_error: 0.0213
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 2.0637, val_error: 0.7273, auc: 0.4826
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0652, instance_loss: 0.2533, weighted_loss: 0.1216, label: 2, bag_size: 750
batch 39, loss: 0.4087, instance_loss: 0.4627, weighted_loss: 0.4249, label: 1, bag_size: 1275


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.31117021276595747: correct 117/376
Epoch: 50, train_loss: 0.3090, train_clustering_loss:  0.3425, train_error: 0.0426
class 0: acc 1.0, correct 9/9
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 2.0953, val_error: 0.5455, auc: 0.5035
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.1572, instance_loss: 0.3996, weighted_loss: 0.2299, label: 2, bag_size: 3753
batch 39, loss: 0.1815, instance_loss: 0.3042, weighted_loss: 0.2184, label: 2, bag_size: 7427


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.35106382978723405: correct 132/376
Epoch: 51, train_loss: 0.2324, train_clustering_loss:  0.3046, train_error: 0.0213
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 8/8
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 1.9692, val_error: 0.6364, auc: 0.4896
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 33 out of 20
Early stopping
Val error: 0.6364, ROC AUC: 0.5694
Test error: 0.7273, ROC AUC: 0.8160
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3

Training Fold 4!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.1444, instance_loss: 1.0423, weighted_loss: 1.1137, label: 2, bag_size: 7427
batch 39, loss: 2.1838, instance_loss: 0.9892, weighted_loss: 1.8255, label: 1, bag_size: 5301


class 0 clustering acc 0.9527925531914894: correct 1433/1504
class 1 clustering acc 0.08776595744680851: correct 33/376
Epoch: 0, train_loss: 1.4302, train_clustering_loss:  1.0263, train_error: 0.7021
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/9
class 2: acc 0.5333333333333333, correct 8/15
class 3: acc 0.42857142857142855, correct 6/14

Val Set, val_loss: 1.4779, val_error: 0.8182, auc: 0.6042
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.477947).  Saving model ...


batch 19, loss: 1.0619, instance_loss: 0.7499, weighted_loss: 0.9683, label: 2, bag_size: 750
batch 39, loss: 1.2252, instance_loss: 0.6892, weighted_loss: 1.0644, label: 1, bag_size: 4010


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3752, train_clustering_loss:  0.7456, train_error: 0.7021
class 0: acc 0.0, correct 0/5
class 1: acc 0.1875, correct 3/16
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.4295, val_error: 0.6364, auc: 0.6215
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.477947 --> 1.429534).  Saving model ...


batch 19, loss: 0.9801, instance_loss: 0.6085, weighted_loss: 0.8686, label: 3, bag_size: 1422
batch 39, loss: 1.4078, instance_loss: 0.6403, weighted_loss: 1.1776, label: 2, bag_size: 3753


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.4011, train_clustering_loss:  0.6388, train_error: 0.6809
class 0: acc 0.0, correct 0/10
class 1: acc 0.5, correct 6/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.3904, val_error: 0.7273, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.429534 --> 1.390448).  Saving model ...


batch 19, loss: 1.6375, instance_loss: 0.6630, weighted_loss: 1.3451, label: 0, bag_size: 460
batch 39, loss: 1.5866, instance_loss: 0.6222, weighted_loss: 1.2972, label: 2, bag_size: 4715


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3713, train_clustering_loss:  0.6223, train_error: 0.6170
class 0: acc 0.0, correct 0/13
class 1: acc 0.75, correct 9/12
class 2: acc 0.0, correct 0/9
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.3471, val_error: 0.6364, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.390448 --> 1.347065).  Saving model ...


batch 19, loss: 1.1572, instance_loss: 0.6046, weighted_loss: 0.9914, label: 2, bag_size: 6469
batch 39, loss: 1.4872, instance_loss: 0.6303, weighted_loss: 1.2301, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.4084, train_clustering_loss:  0.6162, train_error: 0.7660
class 0: acc 0.6, correct 6/10
class 1: acc 0.0, correct 0/13
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.3526, val_error: 0.7273, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2572, instance_loss: 0.6076, weighted_loss: 1.0623, label: 1, bag_size: 2636
batch 39, loss: 1.6611, instance_loss: 0.6369, weighted_loss: 1.3539, label: 2, bag_size: 1646


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3641, train_clustering_loss:  0.6146, train_error: 0.6809
class 0: acc 0.0, correct 0/12
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.3328, val_error: 0.4545, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.347065 --> 1.332788).  Saving model ...


batch 19, loss: 1.6915, instance_loss: 0.6189, weighted_loss: 1.3697, label: 2, bag_size: 6469
batch 39, loss: 1.5218, instance_loss: 0.6260, weighted_loss: 1.2530, label: 2, bag_size: 6469


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3442, train_clustering_loss:  0.6132, train_error: 0.6809
class 0: acc 0.4, correct 6/15
class 1: acc 0.09090909090909091, correct 1/11
class 2: acc 0.0, correct 0/10
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3347, val_error: 0.8182, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0328, instance_loss: 0.5997, weighted_loss: 0.9029, label: 0, bag_size: 460
batch 39, loss: 1.1689, instance_loss: 0.6077, weighted_loss: 1.0006, label: 1, bag_size: 2636


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2775, train_clustering_loss:  0.6068, train_error: 0.5957
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.3076923076923077, correct 4/13
class 2: acc 0.0, correct 0/10
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.3370, val_error: 0.6364, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1415, instance_loss: 0.5880, weighted_loss: 0.9755, label: 2, bag_size: 10330
batch 39, loss: 1.1017, instance_loss: 0.5899, weighted_loss: 0.9482, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2897, train_clustering_loss:  0.6094, train_error: 0.5957
class 0: acc 0.16666666666666666, correct 2/12
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.3938, val_error: 0.8182, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6830, instance_loss: 0.5496, weighted_loss: 0.6430, label: 3, bag_size: 5428
batch 39, loss: 1.4948, instance_loss: 0.6674, weighted_loss: 1.2466, label: 1, bag_size: 5301


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2719, train_clustering_loss:  0.6052, train_error: 0.6383
class 0: acc 0.0, correct 0/10
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.2727272727272727, correct 3/11

Val Set, val_loss: 1.3243, val_error: 0.8182, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.332788 --> 1.324280).  Saving model ...


batch 19, loss: 0.9982, instance_loss: 0.5958, weighted_loss: 0.8775, label: 2, bag_size: 750
batch 39, loss: 1.4188, instance_loss: 0.6121, weighted_loss: 1.1768, label: 1, bag_size: 4010


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2526, train_clustering_loss:  0.6054, train_error: 0.5745
class 0: acc 0.0, correct 0/10
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.8421052631578947, correct 16/19
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.4208, val_error: 0.8182, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9700, instance_loss: 0.6056, weighted_loss: 0.8607, label: 1, bag_size: 1617
batch 39, loss: 1.4857, instance_loss: 0.6562, weighted_loss: 1.2368, label: 3, bag_size: 3366


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2436, train_clustering_loss:  0.6069, train_error: 0.6170
class 0: acc 0.35714285714285715, correct 5/14
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.2727272727272727, correct 3/11
class 3: acc 0.2857142857142857, correct 2/7

Val Set, val_loss: 1.2938, val_error: 0.6364, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.324280 --> 1.293753).  Saving model ...


batch 19, loss: 1.2594, instance_loss: 0.6008, weighted_loss: 1.0619, label: 2, bag_size: 750
batch 39, loss: 1.1210, instance_loss: 0.5806, weighted_loss: 0.9589, label: 2, bag_size: 4328


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2343, train_clustering_loss:  0.6058, train_error: 0.4894
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.3333333333333333, correct 4/12
class 3: acc 0.3333333333333333, correct 4/12

Val Set, val_loss: 1.2741, val_error: 0.6364, auc: 0.7361
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.293753 --> 1.274080).  Saving model ...


batch 19, loss: 0.6618, instance_loss: 0.5321, weighted_loss: 0.6229, label: 3, bag_size: 1422
batch 39, loss: 1.3115, instance_loss: 0.5845, weighted_loss: 1.0934, label: 2, bag_size: 6469


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.1840, train_clustering_loss:  0.5936, train_error: 0.5319
class 0: acc 0.1111111111111111, correct 1/9
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.35714285714285715, correct 5/14
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.2701, val_error: 0.6364, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.274080 --> 1.270142).  Saving model ...


batch 19, loss: 1.4322, instance_loss: 0.6360, weighted_loss: 1.1934, label: 0, bag_size: 460
batch 39, loss: 1.4412, instance_loss: 0.6178, weighted_loss: 1.1942, label: 2, bag_size: 602


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1775, train_clustering_loss:  0.5896, train_error: 0.4681
class 0: acc 0.0, correct 0/10
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.2202, val_error: 0.7273, auc: 0.8194
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.270142 --> 1.220234).  Saving model ...


batch 19, loss: 1.3532, instance_loss: 0.6301, weighted_loss: 1.1362, label: 0, bag_size: 1452
batch 39, loss: 1.1586, instance_loss: 0.5553, weighted_loss: 0.9776, label: 2, bag_size: 7427


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.0750, train_clustering_loss:  0.5768, train_error: 0.3830
class 0: acc 0.21428571428571427, correct 3/14
class 1: acc 0.6, correct 6/10
class 2: acc 0.7142857142857143, correct 5/7
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.1491, val_error: 0.4545, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.220234 --> 1.149061).  Saving model ...


batch 19, loss: 0.9785, instance_loss: 0.5721, weighted_loss: 0.8566, label: 2, bag_size: 6469
batch 39, loss: 0.6650, instance_loss: 0.5222, weighted_loss: 0.6222, label: 2, bag_size: 10330


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.0099, train_clustering_loss:  0.5534, train_error: 0.2979
class 0: acc 0.5, correct 3/6
class 1: acc 0.5, correct 4/8
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.2391, val_error: 0.5455, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4362, instance_loss: 0.3935, weighted_loss: 0.4234, label: 3, bag_size: 3071
batch 39, loss: 1.1755, instance_loss: 0.6189, weighted_loss: 1.0085, label: 0, bag_size: 859


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.0269, train_clustering_loss:  0.5693, train_error: 0.4043
class 0: acc 0.26666666666666666, correct 4/15
class 1: acc 0.125, correct 1/8
class 2: acc 1.0, correct 14/14
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.1641, val_error: 0.6364, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4495, instance_loss: 0.5911, weighted_loss: 1.1920, label: 2, bag_size: 602
batch 39, loss: 0.5590, instance_loss: 0.4366, weighted_loss: 0.5223, label: 3, bag_size: 1720


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.9341, train_clustering_loss:  0.5451, train_error: 0.3617
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.2857142857142857, correct 2/7
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.0825, val_error: 0.6364, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.149061 --> 1.082538).  Saving model ...


batch 19, loss: 0.6129, instance_loss: 0.5514, weighted_loss: 0.5945, label: 1, bag_size: 2636
batch 39, loss: 1.9119, instance_loss: 0.6880, weighted_loss: 1.5447, label: 2, bag_size: 7812


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 0.9777, train_clustering_loss:  0.5596, train_error: 0.4468
class 0: acc 0.6470588235294118, correct 11/17
class 1: acc 0.7, correct 7/10
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.1363, val_error: 0.5455, auc: 0.7812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6480, instance_loss: 0.6012, weighted_loss: 1.3339, label: 0, bag_size: 6943
batch 39, loss: 1.3186, instance_loss: 0.6605, weighted_loss: 1.1212, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 0.9514, train_clustering_loss:  0.5494, train_error: 0.4255
class 0: acc 0.375, correct 3/8
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.1621, val_error: 0.2727, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6355, instance_loss: 0.6437, weighted_loss: 1.3380, label: 0, bag_size: 3642
batch 39, loss: 0.2004, instance_loss: 0.2996, weighted_loss: 0.2301, label: 3, bag_size: 5428


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 21, train_loss: 0.8273, train_clustering_loss:  0.5319, train_error: 0.2553
class 0: acc 0.2222222222222222, correct 2/9
class 1: acc 1.0, correct 20/20
class 2: acc 0.75, correct 9/12
class 3: acc 0.6666666666666666, correct 4/6

Val Set, val_loss: 1.1358, val_error: 0.4545, auc: 0.7500
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5267, instance_loss: 0.5654, weighted_loss: 0.5383, label: 2, bag_size: 750
batch 39, loss: 1.0306, instance_loss: 0.6018, weighted_loss: 0.9020, label: 0, bag_size: 3058


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 22, train_loss: 0.7305, train_clustering_loss:  0.5130, train_error: 0.1489
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.1047, val_error: 0.7273, auc: 0.7326
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7483, instance_loss: 0.4672, weighted_loss: 0.6640, label: 3, bag_size: 1720
batch 39, loss: 0.6239, instance_loss: 0.4269, weighted_loss: 0.5648, label: 3, bag_size: 3415


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 0.7968, train_clustering_loss:  0.5161, train_error: 0.2553
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.6, correct 6/10
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.2217, val_error: 0.6364, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.7908, instance_loss: 0.5761, weighted_loss: 0.7264, label: 2, bag_size: 4328
batch 39, loss: 0.7635, instance_loss: 0.5682, weighted_loss: 0.7049, label: 1, bag_size: 1617


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 0.8145, train_clustering_loss:  0.5289, train_error: 0.2128
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.7, correct 7/10
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.0838, val_error: 0.5455, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.4007, instance_loss: 0.6339, weighted_loss: 1.1707, label: 1, bag_size: 1617
batch 39, loss: 0.7453, instance_loss: 0.4703, weighted_loss: 0.6628, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.04521276595744681: correct 17/376
Epoch: 25, train_loss: 0.7400, train_clustering_loss:  0.5037, train_error: 0.2128
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.8, correct 8/10
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.3476, val_error: 0.7273, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.1989, instance_loss: 0.3938, weighted_loss: 0.2574, label: 1, bag_size: 5301
batch 39, loss: 0.6005, instance_loss: 0.5289, weighted_loss: 0.5790, label: 1, bag_size: 1234


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.010638297872340425: correct 4/376
Epoch: 26, train_loss: 0.6883, train_clustering_loss:  0.4878, train_error: 0.1702
class 0: acc 0.75, correct 9/12
class 1: acc 0.75, correct 9/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.1714, val_error: 0.5455, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.4835, instance_loss: 0.4756, weighted_loss: 0.4811, label: 2, bag_size: 3753
batch 39, loss: 0.6596, instance_loss: 0.4546, weighted_loss: 0.5981, label: 3, bag_size: 361


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.013297872340425532: correct 5/376
Epoch: 27, train_loss: 0.6804, train_clustering_loss:  0.4902, train_error: 0.1915
class 0: acc 0.8, correct 12/15
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.1966, val_error: 0.5455, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5682, instance_loss: 0.4984, weighted_loss: 0.5473, label: 0, bag_size: 4263
batch 39, loss: 1.2281, instance_loss: 0.5136, weighted_loss: 1.0137, label: 0, bag_size: 1225


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.125: correct 47/376
Epoch: 28, train_loss: 0.6600, train_clustering_loss:  0.4624, train_error: 0.2340
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.6, correct 6/10
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.2519, val_error: 0.6364, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0565, instance_loss: 0.3801, weighted_loss: 0.1536, label: 2, bag_size: 7812
batch 39, loss: 0.9048, instance_loss: 0.4947, weighted_loss: 0.7818, label: 3, bag_size: 3503


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.034574468085106384: correct 13/376
Epoch: 29, train_loss: 0.6012, train_clustering_loss:  0.4650, train_error: 0.1702
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.1128, val_error: 0.5455, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.2736, instance_loss: 0.2885, weighted_loss: 0.2780, label: 3, bag_size: 1422
batch 39, loss: 0.3405, instance_loss: 0.3567, weighted_loss: 0.3453, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.05851063829787234: correct 22/376
Epoch: 30, train_loss: 0.6181, train_clustering_loss:  0.4598, train_error: 0.1489
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 0.8333333333333334, correct 5/6
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.0370, val_error: 0.4545, auc: 0.8264
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.082538 --> 1.037018).  Saving model ...


batch 19, loss: 0.5414, instance_loss: 0.5460, weighted_loss: 0.5427, label: 1, bag_size: 4010
batch 39, loss: 0.5490, instance_loss: 0.4969, weighted_loss: 0.5334, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.13829787234042554: correct 52/376
Epoch: 31, train_loss: 0.5448, train_clustering_loss:  0.4276, train_error: 0.1915
class 0: acc 0.75, correct 6/8
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 1.0, correct 15/15
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.1910, val_error: 0.4545, auc: 0.7674
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0671, instance_loss: 0.5813, weighted_loss: 0.9214, label: 0, bag_size: 3642
batch 39, loss: 0.1666, instance_loss: 0.2404, weighted_loss: 0.1887, label: 3, bag_size: 10296


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.14361702127659576: correct 54/376
Epoch: 32, train_loss: 0.6241, train_clustering_loss:  0.4362, train_error: 0.2553
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.8, correct 12/15
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.0099, val_error: 0.4545, auc: 0.8090
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.037018 --> 1.009905).  Saving model ...


batch 19, loss: 0.6443, instance_loss: 0.4623, weighted_loss: 0.5897, label: 1, bag_size: 1617
batch 39, loss: 0.0688, instance_loss: 0.1264, weighted_loss: 0.0861, label: 3, bag_size: 3071


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.14361702127659576: correct 54/376
Epoch: 33, train_loss: 0.4555, train_clustering_loss:  0.4219, train_error: 0.0638
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 1.0, correct 14/14
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.1343, val_error: 0.5455, auc: 0.7882
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7247, instance_loss: 0.4757, weighted_loss: 0.6500, label: 3, bag_size: 361
batch 39, loss: 0.2792, instance_loss: 0.3211, weighted_loss: 0.2918, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.10904255319148937: correct 41/376
Epoch: 34, train_loss: 0.5433, train_clustering_loss:  0.4372, train_error: 0.1277
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 1.0, correct 12/12
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.1277, val_error: 0.5455, auc: 0.7882
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1288, instance_loss: 0.5343, weighted_loss: 0.9504, label: 1, bag_size: 3332
batch 39, loss: 0.8019, instance_loss: 0.5200, weighted_loss: 0.7173, label: 0, bag_size: 1225


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.10638297872340426: correct 40/376
Epoch: 35, train_loss: 0.5161, train_clustering_loss:  0.4301, train_error: 0.0638
class 0: acc 1.0, correct 14/14
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.3672, val_error: 0.5455, auc: 0.6944
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1775, instance_loss: 0.3469, weighted_loss: 0.2283, label: 1, bag_size: 1540
batch 39, loss: 0.2840, instance_loss: 0.3702, weighted_loss: 0.3099, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.10106382978723404: correct 38/376
Epoch: 36, train_loss: 0.4719, train_clustering_loss:  0.4134, train_error: 0.1915
class 0: acc 0.5, correct 5/10
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 11/11
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.2041, val_error: 0.4545, auc: 0.7708
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.4353, instance_loss: 0.3615, weighted_loss: 0.4131, label: 1, bag_size: 1540
batch 39, loss: 0.3096, instance_loss: 0.2725, weighted_loss: 0.2985, label: 3, bag_size: 3366


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.28191489361702127: correct 106/376
Epoch: 37, train_loss: 0.3706, train_clustering_loss:  0.3689, train_error: 0.1064
class 0: acc 0.7, correct 7/10
class 1: acc 1.0, correct 11/11
class 2: acc 0.9, correct 9/10
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.2596, val_error: 0.4545, auc: 0.7604
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.4018, instance_loss: 0.4869, weighted_loss: 0.4274, label: 0, bag_size: 1452
batch 39, loss: 0.1346, instance_loss: 0.1860, weighted_loss: 0.1500, label: 3, bag_size: 1422


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.2898936170212766: correct 109/376
Epoch: 38, train_loss: 0.3718, train_clustering_loss:  0.3966, train_error: 0.1064
class 0: acc 0.75, correct 9/12
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.3838, val_error: 0.4545, auc: 0.7083
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.3134, instance_loss: 0.4116, weighted_loss: 0.3428, label: 0, bag_size: 3642
batch 39, loss: 0.5594, instance_loss: 0.5533, weighted_loss: 0.5575, label: 0, bag_size: 859


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.19680851063829788: correct 74/376
Epoch: 39, train_loss: 0.3400, train_clustering_loss:  0.3811, train_error: 0.0426
class 0: acc 1.0, correct 17/17
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 10/10
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.1541, val_error: 0.5455, auc: 0.7778
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.3971, instance_loss: 0.5985, weighted_loss: 1.1575, label: 3, bag_size: 3503
batch 39, loss: 0.0582, instance_loss: 0.1422, weighted_loss: 0.0834, label: 3, bag_size: 1422


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.17819148936170212: correct 67/376
Epoch: 40, train_loss: 0.4298, train_clustering_loss:  0.3984, train_error: 0.1489
class 0: acc 0.75, correct 9/12
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.3558, val_error: 0.5455, auc: 0.7188
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.6855, instance_loss: 0.3893, weighted_loss: 0.5967, label: 3, bag_size: 4413
batch 39, loss: 0.1303, instance_loss: 0.2169, weighted_loss: 0.1563, label: 3, bag_size: 1720


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.22074468085106383: correct 83/376
Epoch: 41, train_loss: 0.5257, train_clustering_loss:  0.3980, train_error: 0.1489
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 1.0, correct 12/12
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.0854, val_error: 0.6364, auc: 0.7986
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.0855, instance_loss: 0.5715, weighted_loss: 0.9313, label: 1, bag_size: 3332
batch 39, loss: 0.5067, instance_loss: 0.3715, weighted_loss: 0.4661, label: 3, bag_size: 361


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.18882978723404256: correct 71/376
Epoch: 42, train_loss: 0.5219, train_clustering_loss:  0.4148, train_error: 0.1489
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.8, correct 8/10
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.3462, val_error: 0.4545, auc: 0.7674
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2543, instance_loss: 0.2595, weighted_loss: 0.2558, label: 1, bag_size: 4400
batch 39, loss: 0.0344, instance_loss: 0.2093, weighted_loss: 0.0869, label: 3, bag_size: 3366


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.2074468085106383: correct 78/376
Epoch: 43, train_loss: 0.4180, train_clustering_loss:  0.3942, train_error: 0.0851
class 0: acc 0.6, correct 6/10
class 1: acc 1.0, correct 17/17
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.1372, val_error: 0.5455, auc: 0.7986
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.3387, instance_loss: 0.4078, weighted_loss: 0.3595, label: 0, bag_size: 3756
batch 39, loss: 0.1711, instance_loss: 0.3173, weighted_loss: 0.2150, label: 0, bag_size: 460


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.23404255319148937: correct 88/376
Epoch: 44, train_loss: 0.3181, train_clustering_loss:  0.3502, train_error: 0.0638
class 0: acc 0.9375, correct 15/16
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.2384, val_error: 0.5455, auc: 0.7743
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.2586, instance_loss: 0.2757, weighted_loss: 0.2637, label: 1, bag_size: 1617
batch 39, loss: 0.2238, instance_loss: 0.3516, weighted_loss: 0.2621, label: 0, bag_size: 1342


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.3351063829787234: correct 126/376
Epoch: 45, train_loss: 0.3295, train_clustering_loss:  0.3536, train_error: 0.0213
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.5163, val_error: 0.5455, auc: 0.7083
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3161, instance_loss: 0.3236, weighted_loss: 0.3184, label: 1, bag_size: 1234
batch 39, loss: 0.4439, instance_loss: 0.4037, weighted_loss: 0.4318, label: 3, bag_size: 361


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.2712765957446808: correct 102/376
Epoch: 46, train_loss: 0.3417, train_clustering_loss:  0.3583, train_error: 0.0851
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 1.0, correct 14/14
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.8473, val_error: 0.5455, auc: 0.6632
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0705, instance_loss: 0.3175, weighted_loss: 0.1446, label: 2, bag_size: 6469
batch 39, loss: 0.1815, instance_loss: 0.5490, weighted_loss: 0.2918, label: 1, bag_size: 7240


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.24468085106382978: correct 92/376
Epoch: 47, train_loss: 0.3426, train_clustering_loss:  0.3691, train_error: 0.0638
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.9, correct 9/10
class 2: acc 1.0, correct 9/9
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.5695, val_error: 0.5455, auc: 0.7188
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.3547, instance_loss: 0.3042, weighted_loss: 0.3395, label: 2, bag_size: 10330
batch 39, loss: 0.0483, instance_loss: 0.1286, weighted_loss: 0.0724, label: 1, bag_size: 4010


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.31648936170212766: correct 119/376
Epoch: 48, train_loss: 0.2790, train_clustering_loss:  0.3464, train_error: 0.0426
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.4632, val_error: 0.6364, auc: 0.6979
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.3169, instance_loss: 0.4907, weighted_loss: 0.3690, label: 0, bag_size: 8614
batch 39, loss: 0.2559, instance_loss: 0.4160, weighted_loss: 0.3039, label: 0, bag_size: 6943


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.34308510638297873: correct 129/376
Epoch: 49, train_loss: 0.2847, train_clustering_loss:  0.3388, train_error: 0.0426
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 7/7
class 2: acc 1.0, correct 11/11
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.4651, val_error: 0.4545, auc: 0.7396
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0436, instance_loss: 0.1245, weighted_loss: 0.0679, label: 3, bag_size: 1720
batch 39, loss: 0.0286, instance_loss: 0.1904, weighted_loss: 0.0772, label: 1, bag_size: 5301


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.48936170212765956: correct 184/376
Epoch: 50, train_loss: 0.2420, train_clustering_loss:  0.3050, train_error: 0.0213
class 0: acc 1.0, correct 8/8
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.6004, val_error: 0.6364, auc: 0.6979
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.1484, instance_loss: 0.5018, weighted_loss: 0.2544, label: 2, bag_size: 3753
batch 39, loss: 0.0671, instance_loss: 0.1229, weighted_loss: 0.0838, label: 3, bag_size: 10296


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.39095744680851063: correct 147/376
Epoch: 51, train_loss: 0.3572, train_clustering_loss:  0.3474, train_error: 0.0851
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 7/7
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 0.9129, val_error: 0.3636, auc: 0.8438
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.009905 --> 0.912906).  Saving model ...


batch 19, loss: 0.2953, instance_loss: 0.3626, weighted_loss: 0.3155, label: 1, bag_size: 2636
batch 39, loss: 0.1582, instance_loss: 0.2016, weighted_loss: 0.1712, label: 3, bag_size: 1422


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.3351063829787234: correct 126/376
Epoch: 52, train_loss: 0.3514, train_clustering_loss:  0.3558, train_error: 0.1277
class 0: acc 0.8333333333333334, correct 15/18
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 1.0, correct 3/3
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 0.9107, val_error: 0.5455, auc: 0.8646
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (0.912906 --> 0.910719).  Saving model ...


batch 19, loss: 0.0665, instance_loss: 0.2501, weighted_loss: 0.1215, label: 3, bag_size: 3415
batch 39, loss: 0.4970, instance_loss: 0.4520, weighted_loss: 0.4835, label: 1, bag_size: 3332


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.2898936170212766: correct 109/376
Epoch: 53, train_loss: 0.3573, train_clustering_loss:  0.3561, train_error: 0.1064
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.7017, val_error: 0.5455, auc: 0.6736
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4269, instance_loss: 0.4500, weighted_loss: 0.4338, label: 1, bag_size: 1540
batch 39, loss: 0.0284, instance_loss: 0.0840, weighted_loss: 0.0451, label: 3, bag_size: 3071


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.3962765957446808: correct 149/376
Epoch: 54, train_loss: 0.2616, train_clustering_loss:  0.3104, train_error: 0.0426
class 0: acc 1.0, correct 15/15
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 1.0, correct 9/9
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.8421, val_error: 0.5455, auc: 0.6736
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1956, instance_loss: 0.5175, weighted_loss: 0.9922, label: 1, bag_size: 4400
batch 39, loss: 0.2421, instance_loss: 0.2718, weighted_loss: 0.2510, label: 1, bag_size: 3951


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.3696808510638298: correct 139/376
Epoch: 55, train_loss: 0.2604, train_clustering_loss:  0.3295, train_error: 0.0426
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 15/15
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.8197, val_error: 0.5455, auc: 0.6875
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0570, instance_loss: 0.0735, weighted_loss: 0.0620, label: 3, bag_size: 3071
batch 39, loss: 0.0020, instance_loss: 0.0223, weighted_loss: 0.0081, label: 3, bag_size: 5428


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.4148936170212766: correct 156/376
Epoch: 56, train_loss: 0.2538, train_clustering_loss:  0.3121, train_error: 0.0638
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 2.1909, val_error: 0.5455, auc: 0.6528
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.25: correct 22/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3841, instance_loss: 0.5562, weighted_loss: 0.4357, label: 0, bag_size: 859
batch 39, loss: 0.1824, instance_loss: 0.2996, weighted_loss: 0.2176, label: 1, bag_size: 1234


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.4308510638297872: correct 162/376
Epoch: 57, train_loss: 0.2875, train_clustering_loss:  0.3393, train_error: 0.0213
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.1573, val_error: 0.4545, auc: 0.7917
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.26136363636363635: correct 23/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.2118, instance_loss: 0.3634, weighted_loss: 0.2573, label: 0, bag_size: 3058
batch 39, loss: 0.1810, instance_loss: 0.2742, weighted_loss: 0.2089, label: 2, bag_size: 4715


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.4095744680851064: correct 154/376
Epoch: 58, train_loss: 0.2099, train_clustering_loss:  0.3223, train_error: 0.0213
class 0: acc 1.0, correct 15/15
class 1: acc 0.9375, correct 15/16
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.4444, val_error: 0.4545, auc: 0.7639
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0689, instance_loss: 0.1677, weighted_loss: 0.0985, label: 3, bag_size: 1422
batch 39, loss: 0.1855, instance_loss: 0.3333, weighted_loss: 0.2298, label: 0, bag_size: 1452


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.3324468085106383: correct 125/376
Epoch: 59, train_loss: 0.2950, train_clustering_loss:  0.3415, train_error: 0.0426
class 0: acc 1.0, correct 19/19
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 1.0, correct 8/8
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.5545, val_error: 0.4545, auc: 0.7431
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.3522727272727273: correct 31/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0289, instance_loss: 0.0748, weighted_loss: 0.0427, label: 3, bag_size: 3071
batch 39, loss: 0.0016, instance_loss: 0.3243, weighted_loss: 0.0984, label: 2, bag_size: 7812


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.43351063829787234: correct 163/376
Epoch: 60, train_loss: 0.2202, train_clustering_loss:  0.3394, train_error: 0.0426
class 0: acc 1.0, correct 11/11
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 1.0, correct 12/12
class 3: acc 0.8571428571428571, correct 6/7

Val Set, val_loss: 1.5317, val_error: 0.4545, auc: 0.7118
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0784, instance_loss: 0.4693, weighted_loss: 0.1957, label: 1, bag_size: 7240
batch 39, loss: 0.0837, instance_loss: 0.2878, weighted_loss: 0.1449, label: 2, bag_size: 4715


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.526595744680851: correct 198/376
Epoch: 61, train_loss: 0.1722, train_clustering_loss:  0.3006, train_error: 0.0213
class 0: acc 1.0, correct 10/10
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 14/14
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.4045, val_error: 0.4545, auc: 0.7535
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.3125, instance_loss: 0.4266, weighted_loss: 0.3467, label: 0, bag_size: 4263
batch 39, loss: 0.0599, instance_loss: 0.1444, weighted_loss: 0.0852, label: 2, bag_size: 7427


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.48936170212765956: correct 184/376
Epoch: 62, train_loss: 0.2387, train_clustering_loss:  0.2978, train_error: 0.0213
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 18/18
class 2: acc 0.875, correct 7/8
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.4041, val_error: 0.4545, auc: 0.7674
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2683, instance_loss: 0.3692, weighted_loss: 0.2985, label: 2, bag_size: 602
batch 39, loss: 0.2855, instance_loss: 0.4654, weighted_loss: 0.3395, label: 0, bag_size: 4263


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.4228723404255319: correct 159/376
Epoch: 63, train_loss: 0.1737, train_clustering_loss:  0.2857, train_error: 0.0213
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 9/9
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.5318, val_error: 0.4545, auc: 0.7431
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.26136363636363635: correct 23/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.3877, instance_loss: 0.4285, weighted_loss: 0.3999, label: 0, bag_size: 1040
batch 39, loss: 0.0628, instance_loss: 0.4527, weighted_loss: 0.1797, label: 1, bag_size: 7240


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.5904255319148937: correct 222/376
Epoch: 64, train_loss: 0.1877, train_clustering_loss:  0.2851, train_error: 0.0213
class 0: acc 1.0, correct 15/15
class 1: acc 0.9, correct 9/10
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.5891, val_error: 0.5455, auc: 0.7326
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.32954545454545453: correct 29/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0969, instance_loss: 0.2421, weighted_loss: 0.1405, label: 0, bag_size: 3323
batch 39, loss: 0.0377, instance_loss: 0.2226, weighted_loss: 0.0932, label: 2, bag_size: 4328


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.5957446808510638: correct 224/376
Epoch: 65, train_loss: 0.1248, train_clustering_loss:  0.2503, train_error: 0.0000
class 0: acc 1.0, correct 10/10
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 16/16
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.8008, val_error: 0.4545, auc: 0.7014
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.3181818181818182: correct 28/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0085, instance_loss: 0.1079, weighted_loss: 0.0383, label: 1, bag_size: 4010
batch 39, loss: 0.0494, instance_loss: 0.1989, weighted_loss: 0.0943, label: 0, bag_size: 3323


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.6542553191489362: correct 246/376
Epoch: 66, train_loss: 0.1150, train_clustering_loss:  0.2420, train_error: 0.0000
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 18/18
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.8471, val_error: 0.4545, auc: 0.7118
class 0 clustering acc 0.9204545454545454: correct 324/352
class 1 clustering acc 0.3181818181818182: correct 28/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0015, instance_loss: 0.0102, weighted_loss: 0.0041, label: 3, bag_size: 5428
batch 39, loss: 0.0558, instance_loss: 0.1766, weighted_loss: 0.0920, label: 1, bag_size: 2636


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.6835106382978723: correct 257/376
Epoch: 67, train_loss: 0.1305, train_clustering_loss:  0.2414, train_error: 0.0213
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 18/18
class 2: acc 1.0, correct 11/11
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.7661, val_error: 0.4545, auc: 0.7118
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.36363636363636365: correct 32/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0379, instance_loss: 0.2548, weighted_loss: 0.1030, label: 2, bag_size: 4328
batch 39, loss: 0.0986, instance_loss: 0.1604, weighted_loss: 0.1171, label: 3, bag_size: 941


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.6143617021276596: correct 231/376
Epoch: 68, train_loss: 0.2034, train_clustering_loss:  0.2834, train_error: 0.0638
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 9/9
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.3557, val_error: 0.4545, auc: 0.7882
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.36363636363636365: correct 32/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0488, instance_loss: 0.2953, weighted_loss: 0.1228, label: 3, bag_size: 3366
batch 39, loss: 0.0241, instance_loss: 0.1349, weighted_loss: 0.0573, label: 2, bag_size: 6469


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.6037234042553191: correct 227/376
Epoch: 69, train_loss: 0.1551, train_clustering_loss:  0.2739, train_error: 0.0426
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.2147, val_error: 0.4545, auc: 0.8021
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.3522727272727273: correct 31/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0006, instance_loss: 0.0050, weighted_loss: 0.0019, label: 3, bag_size: 5428
batch 39, loss: 0.1420, instance_loss: 0.2591, weighted_loss: 0.1772, label: 1, bag_size: 2636


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.550531914893617: correct 207/376
Epoch: 70, train_loss: 0.1629, train_clustering_loss:  0.2879, train_error: 0.0213
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 9/9
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.2145, val_error: 0.5455, auc: 0.7986
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.32954545454545453: correct 29/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0065, instance_loss: 0.0711, weighted_loss: 0.0259, label: 1, bag_size: 4010
batch 39, loss: 0.4451, instance_loss: 0.2009, weighted_loss: 0.3718, label: 1, bag_size: 1540


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.6968085106382979: correct 262/376
Epoch: 71, train_loss: 0.1046, train_clustering_loss:  0.2110, train_error: 0.0000
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 21/21

Val Set, val_loss: 1.4309, val_error: 0.4545, auc: 0.7743
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.3409090909090909: correct 30/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0617, instance_loss: 0.1129, weighted_loss: 0.0771, label: 3, bag_size: 1720
batch 39, loss: 0.1543, instance_loss: 0.5526, weighted_loss: 0.2738, label: 0, bag_size: 859


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.5664893617021277: correct 213/376
Epoch: 72, train_loss: 0.1282, train_clustering_loss:  0.2560, train_error: 0.0000
class 0: acc 1.0, correct 11/11
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.7511, val_error: 0.4545, auc: 0.7118
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.375: correct 33/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.5455, ROC AUC: 0.8646
Test error: 0.7273, ROC AUC: 0.6111
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3

Training Fold 5!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 2.0587, instance_loss: 1.1222, weighted_loss: 1.7778, label: 1, bag_size: 8645
batch 39, loss: 1.9440, instance_loss: 0.9546, weighted_loss: 1.6472, label: 1, bag_size: 1617


class 0 clustering acc 0.9454787234042553: correct 1422/1504
class 1 clustering acc 0.07180851063829788: correct 27/376
Epoch: 0, train_loss: 1.4401, train_clustering_loss:  1.0409, train_error: 0.7021
class 0: acc 0.0, correct 0/11
class 1: acc 0.0, correct 0/10
class 2: acc 1.0, correct 12/12
class 3: acc 0.14285714285714285, correct 2/14

Val Set, val_loss: 1.4137, val_error: 0.7273, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.413716).  Saving model ...


batch 19, loss: 1.4020, instance_loss: 0.7635, weighted_loss: 1.2105, label: 2, bag_size: 750
batch 39, loss: 1.3335, instance_loss: 0.6940, weighted_loss: 1.1417, label: 1, bag_size: 1275


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4131, train_clustering_loss:  0.7480, train_error: 0.7447
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/13
class 2: acc 0.0, correct 0/13
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.3736, val_error: 0.7273, auc: 0.7396
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.413716 --> 1.373633).  Saving model ...


batch 19, loss: 1.3457, instance_loss: 0.6345, weighted_loss: 1.1323, label: 2, bag_size: 7812
batch 39, loss: 1.1774, instance_loss: 0.6240, weighted_loss: 1.0114, label: 2, bag_size: 3753


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3845, train_clustering_loss:  0.6382, train_error: 0.7447
class 0: acc 0.0, correct 0/10
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.42857142857142855, correct 6/14
class 3: acc 0.0, correct 0/12

Val Set, val_loss: 1.3995, val_error: 0.8182, auc: 0.7743
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1587, instance_loss: 0.6153, weighted_loss: 0.9957, label: 1, bag_size: 3332
batch 39, loss: 1.1788, instance_loss: 0.5990, weighted_loss: 1.0048, label: 3, bag_size: 1422


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3871, train_clustering_loss:  0.6217, train_error: 0.6383
class 0: acc 0.0, correct 0/10
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.25, correct 2/8
class 3: acc 0.4, correct 6/15

Val Set, val_loss: 1.3618, val_error: 0.7273, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.373633 --> 1.361844).  Saving model ...


batch 19, loss: 1.4486, instance_loss: 0.6128, weighted_loss: 1.1979, label: 2, bag_size: 6469
batch 39, loss: 1.1322, instance_loss: 0.6008, weighted_loss: 0.9728, label: 0, bag_size: 4263


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.4109, train_clustering_loss:  0.6187, train_error: 0.7660
class 0: acc 0.4666666666666667, correct 7/15
class 1: acc 0.0, correct 0/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.3716, val_error: 0.7273, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3132, instance_loss: 0.5943, weighted_loss: 1.0975, label: 0, bag_size: 3058
batch 39, loss: 1.7906, instance_loss: 0.6260, weighted_loss: 1.4412, label: 2, bag_size: 4031


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3656, train_clustering_loss:  0.6103, train_error: 0.6809
class 0: acc 0.3076923076923077, correct 4/13
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.2, correct 2/10
class 3: acc 0.4666666666666667, correct 7/15

Val Set, val_loss: 1.3316, val_error: 0.4545, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.361844 --> 1.331610).  Saving model ...


batch 19, loss: 1.6278, instance_loss: 0.6270, weighted_loss: 1.3275, label: 2, bag_size: 6469
batch 39, loss: 1.5610, instance_loss: 0.6521, weighted_loss: 1.2883, label: 2, bag_size: 750


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3763, train_clustering_loss:  0.6150, train_error: 0.6596
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3553, val_error: 0.8182, auc: 0.6875
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4256, instance_loss: 0.6349, weighted_loss: 1.1884, label: 1, bag_size: 3332
batch 39, loss: 1.0555, instance_loss: 0.5648, weighted_loss: 0.9083, label: 0, bag_size: 3058


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2865, train_clustering_loss:  0.6081, train_error: 0.6383
class 0: acc 1.0, correct 16/16
class 1: acc 0.09090909090909091, correct 1/11
class 2: acc 0.0, correct 0/8
class 3: acc 0.0, correct 0/12

Val Set, val_loss: 1.3321, val_error: 0.7273, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9941, instance_loss: 0.5482, weighted_loss: 0.8603, label: 0, bag_size: 3896
batch 39, loss: 1.3884, instance_loss: 0.6407, weighted_loss: 1.1641, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2755, train_clustering_loss:  0.6072, train_error: 0.6809
class 0: acc 1.0, correct 15/15
class 1: acc 0.0, correct 0/8
class 2: acc 0.0, correct 0/15
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3500, val_error: 0.6364, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3319, instance_loss: 0.6309, weighted_loss: 1.1216, label: 3, bag_size: 3366
batch 39, loss: 1.6118, instance_loss: 0.6513, weighted_loss: 1.3236, label: 1, bag_size: 1617


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2540, train_clustering_loss:  0.6053, train_error: 0.6170
class 0: acc 0.0, correct 0/12
class 1: acc 0.0, correct 0/8
class 2: acc 0.9473684210526315, correct 18/19
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4437, val_error: 0.8182, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.1060, instance_loss: 0.5650, weighted_loss: 0.9437, label: 2, bag_size: 750
batch 39, loss: 1.3239, instance_loss: 0.6380, weighted_loss: 1.1181, label: 1, bag_size: 1275


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2543, train_clustering_loss:  0.6022, train_error: 0.4681
class 0: acc 0.8, correct 8/10
class 1: acc 0.14285714285714285, correct 2/14
class 2: acc 0.9375, correct 15/16
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.3792, val_error: 0.9091, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.6967, instance_loss: 0.5425, weighted_loss: 0.6504, label: 1, bag_size: 2636
batch 39, loss: 1.6425, instance_loss: 0.7024, weighted_loss: 1.3605, label: 3, bag_size: 3071


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2319, train_clustering_loss:  0.5986, train_error: 0.5745
class 0: acc 0.15384615384615385, correct 2/13
class 1: acc 0.8888888888888888, correct 16/18
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.0, correct 0/5

Val Set, val_loss: 1.3518, val_error: 0.6364, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.0778, instance_loss: 0.5764, weighted_loss: 0.9274, label: 2, bag_size: 2966
batch 39, loss: 0.8603, instance_loss: 0.5296, weighted_loss: 0.7611, label: 2, bag_size: 6469


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2508, train_clustering_loss:  0.5992, train_error: 0.5745
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.6, correct 9/15
class 3: acc 0.16666666666666666, correct 2/12

Val Set, val_loss: 1.3229, val_error: 0.6364, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.331610 --> 1.322876).  Saving model ...


batch 19, loss: 1.2853, instance_loss: 0.5502, weighted_loss: 1.0648, label: 2, bag_size: 7812
batch 39, loss: 1.3340, instance_loss: 0.5742, weighted_loss: 1.1061, label: 2, bag_size: 6469


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2015, train_clustering_loss:  0.5973, train_error: 0.6170
class 0: acc 0.0, correct 0/7
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.08333333333333333, correct 1/12
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.2936, val_error: 0.6364, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.322876 --> 1.293618).  Saving model ...


batch 19, loss: 1.4043, instance_loss: 0.6149, weighted_loss: 1.1675, label: 1, bag_size: 3332
batch 39, loss: 1.0269, instance_loss: 0.5539, weighted_loss: 0.8850, label: 3, bag_size: 6746


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1822, train_clustering_loss:  0.5897, train_error: 0.5319
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.125, correct 1/8
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.2749, val_error: 0.6364, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.293618 --> 1.274939).  Saving model ...


batch 19, loss: 1.4012, instance_loss: 0.6321, weighted_loss: 1.1705, label: 1, bag_size: 5086
batch 39, loss: 1.4400, instance_loss: 0.6379, weighted_loss: 1.1994, label: 3, bag_size: 10296


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.2208, train_clustering_loss:  0.5980, train_error: 0.5957
class 0: acc 0.5384615384615384, correct 7/13
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.2727272727272727, correct 3/11
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.2182, val_error: 0.6364, auc: 0.7500
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.274939 --> 1.218170).  Saving model ...


batch 19, loss: 0.9337, instance_loss: 0.5802, weighted_loss: 0.8276, label: 2, bag_size: 6469
batch 39, loss: 1.5283, instance_loss: 0.6410, weighted_loss: 1.2621, label: 0, bag_size: 3896


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.1331, train_clustering_loss:  0.5857, train_error: 0.3404
class 0: acc 0.16666666666666666, correct 1/6
class 1: acc 0.75, correct 9/12
class 2: acc 0.875, correct 14/16
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.2904, val_error: 0.6364, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4958, instance_loss: 0.5112, weighted_loss: 0.5004, label: 3, bag_size: 1720
batch 39, loss: 1.4882, instance_loss: 0.6585, weighted_loss: 1.2393, label: 0, bag_size: 4903


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.1674, train_clustering_loss:  0.5888, train_error: 0.5745
class 0: acc 0.0, correct 0/12
class 1: acc 0.3, correct 3/10
class 2: acc 0.6470588235294118, correct 11/17
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.3862, val_error: 0.9091, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9764, instance_loss: 0.5538, weighted_loss: 0.8496, label: 3, bag_size: 6746
batch 39, loss: 0.7632, instance_loss: 0.5568, weighted_loss: 0.7013, label: 3, bag_size: 1720


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 1.0393, train_clustering_loss:  0.5737, train_error: 0.2979
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.42857142857142855, correct 6/14
class 2: acc 1.0, correct 9/9
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.1883, val_error: 0.7273, auc: 0.7743
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.218170 --> 1.188258).  Saving model ...


batch 19, loss: 0.8004, instance_loss: 0.5608, weighted_loss: 0.7285, label: 0, bag_size: 8614
batch 39, loss: 1.9803, instance_loss: 0.6844, weighted_loss: 1.5915, label: 3, bag_size: 5854


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 1.1350, train_clustering_loss:  0.5755, train_error: 0.4468
class 0: acc 0.6428571428571429, correct 9/14
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.3333333333333333, correct 5/15
class 3: acc 0.2, correct 1/5

Val Set, val_loss: 1.2116, val_error: 0.5455, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2318, instance_loss: 0.5744, weighted_loss: 1.0346, label: 0, bag_size: 6943
batch 39, loss: 1.0061, instance_loss: 0.5613, weighted_loss: 0.8726, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 1.0032, train_clustering_loss:  0.5661, train_error: 0.3830
class 0: acc 0.5, correct 6/12
class 1: acc 0.7, correct 7/10
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.1209, val_error: 0.4545, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.188258 --> 1.120896).  Saving model ...


batch 19, loss: 0.8102, instance_loss: 0.5386, weighted_loss: 0.7287, label: 0, bag_size: 3642
batch 39, loss: 0.9375, instance_loss: 0.5933, weighted_loss: 0.8342, label: 3, bag_size: 3366


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 0.9383, train_clustering_loss:  0.5514, train_error: 0.2766
class 0: acc 1.0, correct 15/15
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.0762, val_error: 0.4545, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.120896 --> 1.076183).  Saving model ...


batch 19, loss: 1.5559, instance_loss: 0.6452, weighted_loss: 1.2827, label: 2, bag_size: 2966
batch 39, loss: 1.3656, instance_loss: 0.6506, weighted_loss: 1.1511, label: 2, bag_size: 10330


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 22, train_loss: 0.8999, train_clustering_loss:  0.5431, train_error: 0.2553
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 1.0, correct 9/9
class 2: acc 0.3333333333333333, correct 3/9
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.1914, val_error: 0.6364, auc: 0.7986
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2221, instance_loss: 0.6174, weighted_loss: 1.0407, label: 2, bag_size: 2966
batch 39, loss: 1.2439, instance_loss: 0.6081, weighted_loss: 1.0531, label: 3, bag_size: 4413


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 0.8753, train_clustering_loss:  0.5356, train_error: 0.2766
class 0: acc 1.0, correct 14/14
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.0720, val_error: 0.5455, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.076183 --> 1.072018).  Saving model ...


batch 19, loss: 0.3017, instance_loss: 0.5077, weighted_loss: 0.3635, label: 2, bag_size: 6469
batch 39, loss: 0.3986, instance_loss: 0.4594, weighted_loss: 0.4169, label: 0, bag_size: 8614


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 0.7918, train_clustering_loss:  0.5284, train_error: 0.2553
class 0: acc 1.0, correct 13/13
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.0574, val_error: 0.5455, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.072018 --> 1.057362).  Saving model ...


batch 19, loss: 0.6864, instance_loss: 0.4848, weighted_loss: 0.6259, label: 1, bag_size: 2636
batch 39, loss: 1.2171, instance_loss: 0.5758, weighted_loss: 1.0247, label: 0, bag_size: 4263


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 25, train_loss: 0.8478, train_clustering_loss:  0.5294, train_error: 0.2128
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.0389, val_error: 0.4545, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.057362 --> 1.038911).  Saving model ...


batch 19, loss: 0.6706, instance_loss: 0.5713, weighted_loss: 0.6408, label: 1, bag_size: 1617
batch 39, loss: 0.5731, instance_loss: 0.4297, weighted_loss: 0.5301, label: 1, bag_size: 4646


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 26, train_loss: 0.7470, train_clustering_loss:  0.5123, train_error: 0.2128
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.75, correct 9/12
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.1283, val_error: 0.5455, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6538, instance_loss: 0.5185, weighted_loss: 0.6133, label: 2, bag_size: 3753
batch 39, loss: 1.5125, instance_loss: 0.6131, weighted_loss: 1.2426, label: 3, bag_size: 1249


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 27, train_loss: 0.8159, train_clustering_loss:  0.5152, train_error: 0.2128
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.9375, correct 15/16
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.1389, val_error: 0.5455, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8642, instance_loss: 0.5189, weighted_loss: 0.7606, label: 0, bag_size: 1342
batch 39, loss: 0.8782, instance_loss: 0.5242, weighted_loss: 0.7720, label: 0, bag_size: 4903


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.007978723404255319: correct 3/376
Epoch: 28, train_loss: 0.7108, train_clustering_loss:  0.4853, train_error: 0.2128
class 0: acc 0.75, correct 6/8
class 1: acc 1.0, correct 14/14
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.0996, val_error: 0.5455, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.0212, instance_loss: 0.5126, weighted_loss: 0.8687, label: 3, bag_size: 5854
batch 39, loss: 0.7303, instance_loss: 0.4641, weighted_loss: 0.6504, label: 1, bag_size: 8645


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 29, train_loss: 0.7379, train_clustering_loss:  0.4756, train_error: 0.2340
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 1.0, correct 16/16
class 2: acc 0.6, correct 6/10
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.0720, val_error: 0.3636, auc: 0.8229
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.6381, instance_loss: 0.5033, weighted_loss: 0.5977, label: 2, bag_size: 7812
batch 39, loss: 0.7033, instance_loss: 0.5333, weighted_loss: 0.6523, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 30, train_loss: 0.7763, train_clustering_loss:  0.5053, train_error: 0.2766
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.2226, val_error: 0.5455, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.8550, instance_loss: 0.4934, weighted_loss: 0.7465, label: 1, bag_size: 1275
batch 39, loss: 1.1970, instance_loss: 0.5423, weighted_loss: 1.0006, label: 0, bag_size: 4263


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.023936170212765957: correct 9/376
Epoch: 31, train_loss: 0.6731, train_clustering_loss:  0.4755, train_error: 0.2128
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.8, correct 4/5

Val Set, val_loss: 1.1074, val_error: 0.5455, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.3797, instance_loss: 0.3819, weighted_loss: 0.3804, label: 0, bag_size: 3642
batch 39, loss: 0.3889, instance_loss: 0.3397, weighted_loss: 0.3742, label: 0, bag_size: 3642


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 32, train_loss: 0.7040, train_clustering_loss:  0.4804, train_error: 0.2128
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.8, correct 8/10
class 2: acc 0.9, correct 9/10
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.0540, val_error: 0.5455, auc: 0.8229
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.3704, instance_loss: 0.3813, weighted_loss: 0.3737, label: 0, bag_size: 8614
batch 39, loss: 0.2242, instance_loss: 0.3236, weighted_loss: 0.2540, label: 3, bag_size: 3071


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.023936170212765957: correct 9/376
Epoch: 33, train_loss: 0.5543, train_clustering_loss:  0.4467, train_error: 0.1277
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 11/11
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.1584, val_error: 0.4545, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.8560, instance_loss: 0.5548, weighted_loss: 0.7657, label: 3, bag_size: 1249
batch 39, loss: 0.4368, instance_loss: 0.4824, weighted_loss: 0.4505, label: 2, bag_size: 6477


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.07180851063829788: correct 27/376
Epoch: 34, train_loss: 0.6085, train_clustering_loss:  0.4482, train_error: 0.1915
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.9, correct 9/10
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.0341, val_error: 0.6364, auc: 0.8056
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.038911 --> 1.034111).  Saving model ...


batch 19, loss: 0.5864, instance_loss: 0.4923, weighted_loss: 0.5582, label: 3, bag_size: 361
batch 39, loss: 0.2481, instance_loss: 0.3928, weighted_loss: 0.2915, label: 0, bag_size: 4903


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.07446808510638298: correct 28/376
Epoch: 35, train_loss: 0.4930, train_clustering_loss:  0.4216, train_error: 0.1277
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 1.0, correct 13/13
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.1694, val_error: 0.7273, auc: 0.7604
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8929, instance_loss: 0.5425, weighted_loss: 0.7878, label: 0, bag_size: 4263
batch 39, loss: 0.5332, instance_loss: 0.4648, weighted_loss: 0.5126, label: 2, bag_size: 6477


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.125: correct 47/376
Epoch: 36, train_loss: 0.4164, train_clustering_loss:  0.3872, train_error: 0.0638
class 0: acc 0.9444444444444444, correct 17/18
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 11/11
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 1.2523, val_error: 0.5455, auc: 0.7535
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9475, instance_loss: 0.4699, weighted_loss: 0.8042, label: 0, bag_size: 4263
batch 39, loss: 0.2832, instance_loss: 0.4324, weighted_loss: 0.3280, label: 3, bag_size: 3366


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.2074468085106383: correct 78/376
Epoch: 37, train_loss: 0.5033, train_clustering_loss:  0.3938, train_error: 0.1702
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.875, correct 7/8
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.2216, val_error: 0.5455, auc: 0.7396
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6287, instance_loss: 0.4573, weighted_loss: 0.5773, label: 1, bag_size: 5086
batch 39, loss: 0.3989, instance_loss: 0.3864, weighted_loss: 0.3951, label: 2, bag_size: 7812


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.1675531914893617: correct 63/376
Epoch: 38, train_loss: 0.4926, train_clustering_loss:  0.4048, train_error: 0.1277
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.3057, val_error: 0.7273, auc: 0.6979
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2824, instance_loss: 0.2906, weighted_loss: 0.2849, label: 0, bag_size: 3642
batch 39, loss: 0.3050, instance_loss: 0.2518, weighted_loss: 0.2891, label: 0, bag_size: 3775


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.15425531914893617: correct 58/376
Epoch: 39, train_loss: 0.6039, train_clustering_loss:  0.4338, train_error: 0.2128
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 1.0, correct 11/11
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.3224, val_error: 0.5455, auc: 0.7500
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.6533, instance_loss: 0.5694, weighted_loss: 0.6281, label: 3, bag_size: 1752
batch 39, loss: 0.3790, instance_loss: 0.4061, weighted_loss: 0.3871, label: 2, bag_size: 7812


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.22074468085106383: correct 83/376
Epoch: 40, train_loss: 0.4627, train_clustering_loss:  0.3993, train_error: 0.1277
class 0: acc 1.0, correct 9/9
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.2346, val_error: 0.5455, auc: 0.7535
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1207, instance_loss: 0.2001, weighted_loss: 0.1445, label: 0, bag_size: 4010
batch 39, loss: 0.5580, instance_loss: 0.4505, weighted_loss: 0.5257, label: 2, bag_size: 2966


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.27925531914893614: correct 105/376
Epoch: 41, train_loss: 0.4596, train_clustering_loss:  0.3838, train_error: 0.1489
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9, correct 9/10
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.4172, val_error: 0.5455, auc: 0.7465
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.5658, instance_loss: 0.4961, weighted_loss: 0.5449, label: 3, bag_size: 361
batch 39, loss: 1.2521, instance_loss: 0.6249, weighted_loss: 1.0639, label: 3, bag_size: 1249


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.2127659574468085: correct 80/376
Epoch: 42, train_loss: 0.5505, train_clustering_loss:  0.4110, train_error: 0.1915
class 0: acc 0.9, correct 9/10
class 1: acc 1.0, correct 11/11
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.2515, val_error: 0.4545, auc: 0.7083
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1092, instance_loss: 0.1524, weighted_loss: 0.1221, label: 1, bag_size: 7035
batch 39, loss: 0.0555, instance_loss: 0.1434, weighted_loss: 0.0818, label: 3, bag_size: 3071


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.24468085106382978: correct 92/376
Epoch: 43, train_loss: 0.4870, train_clustering_loss:  0.3890, train_error: 0.1702
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.75, correct 6/8
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.0658, val_error: 0.4545, auc: 0.7951
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5328, instance_loss: 0.4040, weighted_loss: 0.4942, label: 1, bag_size: 7240
batch 39, loss: 0.5395, instance_loss: 0.4116, weighted_loss: 0.5011, label: 1, bag_size: 3332


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.25: correct 94/376
Epoch: 44, train_loss: 0.4535, train_clustering_loss:  0.3993, train_error: 0.0851
class 0: acc 0.9473684210526315, correct 18/19
class 1: acc 1.0, correct 9/9
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 1.4000, val_error: 0.6364, auc: 0.7188
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.1720, instance_loss: 0.2459, weighted_loss: 0.1942, label: 1, bag_size: 2636
batch 39, loss: 0.3266, instance_loss: 0.3368, weighted_loss: 0.3297, label: 0, bag_size: 460


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.36436170212765956: correct 137/376
Epoch: 45, train_loss: 0.4139, train_clustering_loss:  0.3561, train_error: 0.1277
class 0: acc 1.0, correct 14/14
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.42857142857142855, correct 3/7

Val Set, val_loss: 1.4065, val_error: 0.6364, auc: 0.7396
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.2921, instance_loss: 0.2966, weighted_loss: 0.2935, label: 1, bag_size: 4646
batch 39, loss: 0.7839, instance_loss: 0.5779, weighted_loss: 0.7221, label: 3, bag_size: 1249


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.3776595744680851: correct 142/376
Epoch: 46, train_loss: 0.3735, train_clustering_loss:  0.3527, train_error: 0.0426
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 17/17
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.3530, val_error: 0.5455, auc: 0.7847
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.2414, instance_loss: 0.3403, weighted_loss: 0.2711, label: 2, bag_size: 750
batch 39, loss: 1.1144, instance_loss: 0.6625, weighted_loss: 0.9788, label: 3, bag_size: 4413


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.2632978723404255: correct 99/376
Epoch: 47, train_loss: 0.4281, train_clustering_loss:  0.3882, train_error: 0.1064
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 1.0, correct 9/9
class 2: acc 1.0, correct 12/12
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.5077, val_error: 0.4545, auc: 0.7153
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.2967, instance_loss: 0.4274, weighted_loss: 0.3359, label: 2, bag_size: 1646
batch 39, loss: 0.2848, instance_loss: 0.3025, weighted_loss: 0.2901, label: 1, bag_size: 1275


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.324468085106383: correct 122/376
Epoch: 48, train_loss: 0.4198, train_clustering_loss:  0.3746, train_error: 0.0851
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.9, correct 9/10
class 2: acc 1.0, correct 7/7
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.3156, val_error: 0.5455, auc: 0.7569
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.2282, instance_loss: 0.2852, weighted_loss: 0.2453, label: 0, bag_size: 3775
batch 39, loss: 0.6196, instance_loss: 0.4355, weighted_loss: 0.5643, label: 0, bag_size: 6943


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.300531914893617: correct 113/376
Epoch: 49, train_loss: 0.4412, train_clustering_loss:  0.3766, train_error: 0.1915
class 0: acc 1.0, correct 11/11
class 1: acc 0.8333333333333334, correct 5/6
class 2: acc 0.375, correct 3/8
class 3: acc 0.8636363636363636, correct 19/22

Val Set, val_loss: 1.4335, val_error: 0.6364, auc: 0.7535
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.8916, instance_loss: 0.5963, weighted_loss: 0.8030, label: 2, bag_size: 2966
batch 39, loss: 0.2071, instance_loss: 0.2390, weighted_loss: 0.2167, label: 1, bag_size: 1617


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.3058510638297872: correct 115/376
Epoch: 50, train_loss: 0.4345, train_clustering_loss:  0.3724, train_error: 0.1702
class 0: acc 1.0, correct 13/13
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.4256, val_error: 0.6364, auc: 0.7431
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.2756, instance_loss: 0.4296, weighted_loss: 0.3218, label: 2, bag_size: 3753
batch 39, loss: 0.2396, instance_loss: 0.3629, weighted_loss: 0.2766, label: 3, bag_size: 10296


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.3670212765957447: correct 138/376
Epoch: 51, train_loss: 0.3666, train_clustering_loss:  0.3498, train_error: 0.0851
class 0: acc 1.0, correct 20/20
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.8571428571428571, correct 6/7

Val Set, val_loss: 1.4592, val_error: 0.6364, auc: 0.7292
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0535, instance_loss: 0.2072, weighted_loss: 0.0996, label: 0, bag_size: 3058
batch 39, loss: 0.6238, instance_loss: 0.4980, weighted_loss: 0.5861, label: 2, bag_size: 7812


class 0 clustering acc 0.9827127659574468: correct 1478/1504
class 1 clustering acc 0.30319148936170215: correct 114/376
Epoch: 52, train_loss: 0.4960, train_clustering_loss:  0.3941, train_error: 0.1915
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 1.0, correct 15/15
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.4260, val_error: 0.6364, auc: 0.7604
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.2357, instance_loss: 0.3131, weighted_loss: 0.2589, label: 0, bag_size: 7561
batch 39, loss: 0.2634, instance_loss: 0.3149, weighted_loss: 0.2789, label: 1, bag_size: 5086


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.30319148936170215: correct 114/376
Epoch: 53, train_loss: 0.3362, train_clustering_loss:  0.3536, train_error: 0.0426
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 14/14
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.5296, val_error: 0.7273, auc: 0.6979
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.1597, instance_loss: 0.2952, weighted_loss: 0.2004, label: 0, bag_size: 1342
batch 39, loss: 0.0489, instance_loss: 0.1935, weighted_loss: 0.0922, label: 3, bag_size: 1720


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.46808510638297873: correct 176/376
Epoch: 54, train_loss: 0.2877, train_clustering_loss:  0.3104, train_error: 0.0638
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 10/10
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.4112, val_error: 0.7273, auc: 0.7292
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.6364, ROC AUC: 0.8056
Test error: 0.3636, ROC AUC: 0.7500
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3

Training Fold 6!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7175, instance_loss: 1.1111, weighted_loss: 1.5356, label: 1, bag_size: 8645
batch 39, loss: 1.9027, instance_loss: 0.9522, weighted_loss: 1.6175, label: 1, bag_size: 4010


class 0 clustering acc 0.9507978723404256: correct 1430/1504
class 1 clustering acc 0.061170212765957445: correct 23/376
Epoch: 0, train_loss: 1.3821, train_clustering_loss:  1.0352, train_error: 0.6596
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/9
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.8823529411764706, correct 15/17

Val Set, val_loss: 1.4104, val_error: 0.7273, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.410371).  Saving model ...


batch 19, loss: 1.4353, instance_loss: 0.7353, weighted_loss: 1.2253, label: 2, bag_size: 7812
batch 39, loss: 1.4022, instance_loss: 0.6944, weighted_loss: 1.1898, label: 1, bag_size: 7035


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3975, train_clustering_loss:  0.7263, train_error: 0.7234
class 0: acc 0.0, correct 0/7
class 1: acc 0.0, correct 0/14
class 2: acc 0.07142857142857142, correct 1/14
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.4004, val_error: 0.6364, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.410371 --> 1.400384).  Saving model ...


batch 19, loss: 1.5349, instance_loss: 0.6063, weighted_loss: 1.2563, label: 3, bag_size: 6746
batch 39, loss: 1.0758, instance_loss: 0.5985, weighted_loss: 0.9326, label: 2, bag_size: 3753


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.4028, train_clustering_loss:  0.6397, train_error: 0.7872
class 0: acc 0.0, correct 0/11
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.2857142857142857, correct 4/14
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4066, val_error: 0.8182, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.7979, instance_loss: 0.6520, weighted_loss: 1.4542, label: 0, bag_size: 1452
batch 39, loss: 1.2808, instance_loss: 0.6199, weighted_loss: 1.0825, label: 3, bag_size: 5854


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.4002, train_clustering_loss:  0.6221, train_error: 0.6809
class 0: acc 0.0, correct 0/10
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.1, correct 1/10
class 3: acc 0.25, correct 3/12

Val Set, val_loss: 1.3525, val_error: 0.4545, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.400384 --> 1.352549).  Saving model ...


batch 19, loss: 1.2387, instance_loss: 0.5972, weighted_loss: 1.0462, label: 2, bag_size: 7812
batch 39, loss: 1.2704, instance_loss: 0.5846, weighted_loss: 1.0646, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3658, train_clustering_loss:  0.6096, train_error: 0.6170
class 0: acc 0.2, correct 2/10
class 1: acc 0.625, correct 10/16
class 2: acc 0.45454545454545453, correct 5/11
class 3: acc 0.1, correct 1/10

Val Set, val_loss: 1.3433, val_error: 0.4545, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.352549 --> 1.343340).  Saving model ...


batch 19, loss: 1.0233, instance_loss: 0.5663, weighted_loss: 0.8862, label: 1, bag_size: 1617
batch 39, loss: 1.5425, instance_loss: 0.6455, weighted_loss: 1.2734, label: 0, bag_size: 3775


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3496, train_clustering_loss:  0.6054, train_error: 0.6170
class 0: acc 0.0, correct 0/10
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.0, correct 0/8
class 3: acc 0.2857142857142857, correct 4/14

Val Set, val_loss: 1.3549, val_error: 0.7273, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6259, instance_loss: 0.6414, weighted_loss: 1.3306, label: 2, bag_size: 4921
batch 39, loss: 1.3019, instance_loss: 0.6078, weighted_loss: 1.0937, label: 2, bag_size: 7812


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3400, train_clustering_loss:  0.6125, train_error: 0.5106
class 0: acc 0.3076923076923077, correct 4/13
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.25, correct 3/12
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.3369, val_error: 0.6364, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.343340 --> 1.336877).  Saving model ...


batch 19, loss: 1.0216, instance_loss: 0.6369, weighted_loss: 0.9062, label: 0, bag_size: 1452
batch 39, loss: 1.3086, instance_loss: 0.5837, weighted_loss: 1.0912, label: 1, bag_size: 1617


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3018, train_clustering_loss:  0.6103, train_error: 0.5319
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.1111111111111111, correct 1/9
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.3086, val_error: 0.7273, auc: 0.6910
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.336877 --> 1.308581).  Saving model ...


batch 19, loss: 1.1322, instance_loss: 0.5905, weighted_loss: 0.9697, label: 0, bag_size: 4903
batch 39, loss: 1.8036, instance_loss: 0.6754, weighted_loss: 1.4652, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2333, train_clustering_loss:  0.6061, train_error: 0.4043
class 0: acc 0.7777777777777778, correct 14/18
class 1: acc 0.3333333333333333, correct 2/6
class 2: acc 0.0, correct 0/9
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.3544, val_error: 0.6364, auc: 0.6910
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6689, instance_loss: 0.6640, weighted_loss: 1.3674, label: 2, bag_size: 2966
batch 39, loss: 1.1453, instance_loss: 0.6060, weighted_loss: 0.9835, label: 1, bag_size: 4010


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2483, train_clustering_loss:  0.6048, train_error: 0.5532
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.21428571428571427, correct 3/14
class 2: acc 0.0, correct 0/7
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.2951, val_error: 0.5455, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.308581 --> 1.295110).  Saving model ...


batch 19, loss: 1.3208, instance_loss: 0.6419, weighted_loss: 1.1171, label: 2, bag_size: 7812
batch 39, loss: 1.3369, instance_loss: 0.5913, weighted_loss: 1.1132, label: 1, bag_size: 4400


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2241, train_clustering_loss:  0.6124, train_error: 0.5106
class 0: acc 0.0, correct 0/5
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.3125, correct 5/16
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.3920, val_error: 0.5455, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7658, instance_loss: 0.5568, weighted_loss: 0.7031, label: 1, bag_size: 5301
batch 39, loss: 1.3653, instance_loss: 0.6068, weighted_loss: 1.1377, label: 2, bag_size: 750


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2369, train_clustering_loss:  0.5981, train_error: 0.5106
class 0: acc 0.0, correct 0/10
class 1: acc 0.8823529411764706, correct 15/17
class 2: acc 0.25, correct 3/12
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.3449, val_error: 0.6364, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9224, instance_loss: 0.5653, weighted_loss: 0.8153, label: 2, bag_size: 4715
batch 39, loss: 0.9524, instance_loss: 0.5681, weighted_loss: 0.8371, label: 2, bag_size: 4921


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.1736, train_clustering_loss:  0.6002, train_error: 0.4043
class 0: acc 0.5, correct 8/16
class 1: acc 0.8, correct 8/10
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.3653, val_error: 0.7273, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.9327, instance_loss: 0.5265, weighted_loss: 0.8108, label: 3, bag_size: 6746
batch 39, loss: 1.6371, instance_loss: 0.6674, weighted_loss: 1.3462, label: 2, bag_size: 4921


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2562, train_clustering_loss:  0.6013, train_error: 0.6383
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.0, correct 0/9
class 2: acc 0.1, correct 1/10
class 3: acc 0.5294117647058824, correct 9/17

Val Set, val_loss: 1.3235, val_error: 0.7273, auc: 0.6736
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.0620, instance_loss: 0.5877, weighted_loss: 0.9197, label: 0, bag_size: 1452
batch 39, loss: 1.2814, instance_loss: 0.5972, weighted_loss: 1.0761, label: 2, bag_size: 602


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1427, train_clustering_loss:  0.5826, train_error: 0.5319
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.125, correct 1/8
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.3333333333333333, correct 4/12

Val Set, val_loss: 1.2983, val_error: 0.7273, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.5616, instance_loss: 0.6481, weighted_loss: 1.2876, label: 1, bag_size: 3332
batch 39, loss: 2.2037, instance_loss: 0.6335, weighted_loss: 1.7326, label: 3, bag_size: 3503


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.0388, train_clustering_loss:  0.5703, train_error: 0.3404
class 0: acc 0.6875, correct 11/16
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.5714285714285714, correct 8/14
class 3: acc 0.75, correct 3/4

Val Set, val_loss: 1.4571, val_error: 0.5455, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.1115, instance_loss: 0.5779, weighted_loss: 0.9514, label: 2, bag_size: 4921
batch 39, loss: 0.8763, instance_loss: 0.5945, weighted_loss: 0.7917, label: 0, bag_size: 4903


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.1064, train_clustering_loss:  0.5632, train_error: 0.4255
class 0: acc 0.5, correct 5/10
class 1: acc 0.75, correct 6/8
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.7777777777777778, correct 14/18

Val Set, val_loss: 1.4567, val_error: 0.7273, auc: 0.5833
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.9060, instance_loss: 0.5308, weighted_loss: 0.7934, label: 2, bag_size: 4328
batch 39, loss: 0.6030, instance_loss: 0.4984, weighted_loss: 0.5716, label: 1, bag_size: 4646


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.0672, train_clustering_loss:  0.5655, train_error: 0.4043
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.6666666666666666, correct 4/6

Val Set, val_loss: 1.4355, val_error: 0.5455, auc: 0.6458
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.8967, instance_loss: 0.7001, weighted_loss: 1.5377, label: 3, bag_size: 941
batch 39, loss: 0.9421, instance_loss: 0.5561, weighted_loss: 0.8263, label: 2, bag_size: 4328


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.9559, train_clustering_loss:  0.5426, train_error: 0.2979
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 1.0, correct 14/14
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.4651, val_error: 0.6364, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5326, instance_loss: 0.4364, weighted_loss: 0.5037, label: 1, bag_size: 3328
batch 39, loss: 1.5904, instance_loss: 0.5985, weighted_loss: 1.2928, label: 2, bag_size: 602


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 0.9290, train_clustering_loss:  0.5350, train_error: 0.3617
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.3, correct 3/10
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.4143, val_error: 0.6364, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.1156, instance_loss: 0.6056, weighted_loss: 0.9626, label: 0, bag_size: 3896
batch 39, loss: 0.6679, instance_loss: 0.5322, weighted_loss: 0.6272, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 20, train_loss: 0.7970, train_clustering_loss:  0.5072, train_error: 0.2340
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.9, correct 9/10
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.5390, val_error: 0.6364, auc: 0.6146
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.9406, instance_loss: 0.5992, weighted_loss: 0.8381, label: 2, bag_size: 7427
batch 39, loss: 0.8990, instance_loss: 0.5885, weighted_loss: 0.8059, label: 2, bag_size: 2966


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.031914893617021274: correct 12/376
Epoch: 21, train_loss: 0.7073, train_clustering_loss:  0.4800, train_error: 0.1915
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.8888888888888888, correct 16/18
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.5246, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.6266, instance_loss: 0.5340, weighted_loss: 0.5988, label: 2, bag_size: 4715
batch 39, loss: 0.9787, instance_loss: 0.5719, weighted_loss: 0.8566, label: 0, bag_size: 859


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.05585106382978723: correct 21/376
Epoch: 22, train_loss: 0.7198, train_clustering_loss:  0.4760, train_error: 0.2128
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.7, correct 7/10
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.6246, val_error: 0.7273, auc: 0.6146
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.6552, instance_loss: 0.5240, weighted_loss: 0.6158, label: 2, bag_size: 4715
batch 39, loss: 0.0667, instance_loss: 0.2459, weighted_loss: 0.1205, label: 3, bag_size: 4413


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.11436170212765957: correct 43/376
Epoch: 23, train_loss: 0.7240, train_clustering_loss:  0.4701, train_error: 0.2128
class 0: acc 1.0, correct 12/12
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.5700, val_error: 0.5455, auc: 0.6250
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.5197, instance_loss: 0.4971, weighted_loss: 0.5129, label: 2, bag_size: 4921
batch 39, loss: 0.4003, instance_loss: 0.4260, weighted_loss: 0.4080, label: 1, bag_size: 3328


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.09308510638297872: correct 35/376
Epoch: 24, train_loss: 0.6462, train_clustering_loss:  0.4644, train_error: 0.1702
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.6519, val_error: 0.6364, auc: 0.6250
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.3558, instance_loss: 0.4067, weighted_loss: 0.3710, label: 1, bag_size: 5301
batch 39, loss: 0.5758, instance_loss: 0.4065, weighted_loss: 0.5250, label: 1, bag_size: 1540


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.09840425531914894: correct 37/376
Epoch: 25, train_loss: 0.5804, train_clustering_loss:  0.4468, train_error: 0.1915
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.7, correct 7/10
class 2: acc 0.8125, correct 13/16
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.7238, val_error: 0.6364, auc: 0.6146
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.4161, instance_loss: 0.5581, weighted_loss: 0.4587, label: 1, bag_size: 4010
batch 39, loss: 1.0510, instance_loss: 0.4811, weighted_loss: 0.8800, label: 1, bag_size: 1275


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.19148936170212766: correct 72/376
Epoch: 26, train_loss: 0.4951, train_clustering_loss:  0.4035, train_error: 0.1064
class 0: acc 1.0, correct 8/8
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 1.0, correct 10/10
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.5409, val_error: 0.5455, auc: 0.6146
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.5673, instance_loss: 0.5689, weighted_loss: 0.5678, label: 2, bag_size: 3753
batch 39, loss: 0.1204, instance_loss: 0.1945, weighted_loss: 0.1426, label: 3, bag_size: 10296


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.14361702127659576: correct 54/376
Epoch: 27, train_loss: 0.6588, train_clustering_loss:  0.4650, train_error: 0.2766
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4819, val_error: 0.5455, auc: 0.6250
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.1855, instance_loss: 0.5375, weighted_loss: 0.9911, label: 0, bag_size: 1342
batch 39, loss: 0.8770, instance_loss: 0.4361, weighted_loss: 0.7448, label: 1, bag_size: 1617


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.19680851063829788: correct 74/376
Epoch: 28, train_loss: 0.6416, train_clustering_loss:  0.4257, train_error: 0.2340
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.7240, val_error: 0.7273, auc: 0.6042
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.9797, instance_loss: 0.5179, weighted_loss: 0.8412, label: 2, bag_size: 602
batch 39, loss: 0.6266, instance_loss: 0.4151, weighted_loss: 0.5631, label: 1, bag_size: 8645


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.20212765957446807: correct 76/376
Epoch: 29, train_loss: 0.5097, train_clustering_loss:  0.4048, train_error: 0.1277
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.9, correct 9/10
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.8656, val_error: 0.7273, auc: 0.5938
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.1187, instance_loss: 0.1590, weighted_loss: 0.1308, label: 3, bag_size: 6888
batch 39, loss: 0.3015, instance_loss: 0.3813, weighted_loss: 0.3255, label: 2, bag_size: 6477


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.22606382978723405: correct 85/376
Epoch: 30, train_loss: 0.5317, train_clustering_loss:  0.3959, train_error: 0.1915
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.7672, val_error: 0.7273, auc: 0.5833
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.4827, instance_loss: 0.3585, weighted_loss: 0.4454, label: 1, bag_size: 7035
batch 39, loss: 0.6469, instance_loss: 0.4708, weighted_loss: 0.5940, label: 1, bag_size: 1540


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.09042553191489362: correct 34/376
Epoch: 31, train_loss: 0.5066, train_clustering_loss:  0.4142, train_error: 0.1064
class 0: acc 0.875, correct 14/16
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 5/5

Val Set, val_loss: 1.9751, val_error: 0.7273, auc: 0.5833
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.3397, instance_loss: 0.4849, weighted_loss: 0.3833, label: 2, bag_size: 7427
batch 39, loss: 0.3080, instance_loss: 0.4641, weighted_loss: 0.3548, label: 2, bag_size: 7427


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.2872340425531915: correct 108/376
Epoch: 32, train_loss: 0.4047, train_clustering_loss:  0.3518, train_error: 0.0426
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 16/16
class 2: acc 1.0, correct 9/9
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.8921, val_error: 0.7273, auc: 0.5833
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.1874, instance_loss: 0.2716, weighted_loss: 0.2126, label: 1, bag_size: 3328
batch 39, loss: 0.2094, instance_loss: 0.3959, weighted_loss: 0.2654, label: 2, bag_size: 750


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.32180851063829785: correct 121/376
Epoch: 33, train_loss: 0.4124, train_clustering_loss:  0.3650, train_error: 0.1702
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.9444444444444444, correct 17/18

Val Set, val_loss: 1.6947, val_error: 0.6364, auc: 0.6250
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.1036, instance_loss: 0.1447, weighted_loss: 0.1159, label: 3, bag_size: 10296
batch 39, loss: 0.0910, instance_loss: 0.1840, weighted_loss: 0.1189, label: 2, bag_size: 6477


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.3377659574468085: correct 127/376
Epoch: 34, train_loss: 0.3739, train_clustering_loss:  0.3400, train_error: 0.0638
class 0: acc 0.9, correct 9/10
class 1: acc 0.9, correct 9/10
class 2: acc 1.0, correct 13/13
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.6528, val_error: 0.6364, auc: 0.6007
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0748, instance_loss: 0.1978, weighted_loss: 0.1117, label: 3, bag_size: 1249
batch 39, loss: 0.1552, instance_loss: 0.2814, weighted_loss: 0.1931, label: 1, bag_size: 4646


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.2579787234042553: correct 97/376
Epoch: 35, train_loss: 0.4757, train_clustering_loss:  0.3808, train_error: 0.1489
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.6, correct 6/10
class 2: acc 0.9, correct 9/10
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.6526, val_error: 0.6364, auc: 0.6146
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.2158, instance_loss: 0.3346, weighted_loss: 0.2514, label: 1, bag_size: 1540
batch 39, loss: 0.0532, instance_loss: 0.1641, weighted_loss: 0.0865, label: 2, bag_size: 6477


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.23670212765957446: correct 89/376
Epoch: 36, train_loss: 0.4808, train_clustering_loss:  0.3781, train_error: 0.1277
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.75, correct 12/16
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.8923, val_error: 0.6364, auc: 0.6215
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.4515, instance_loss: 0.3983, weighted_loss: 0.4355, label: 1, bag_size: 1540
batch 39, loss: 0.2449, instance_loss: 0.2799, weighted_loss: 0.2554, label: 2, bag_size: 2966


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.3271276595744681: correct 123/376
Epoch: 37, train_loss: 0.3243, train_clustering_loss:  0.3363, train_error: 0.0426
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 15/15
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.8100, val_error: 0.6364, auc: 0.6458
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 1.6553, instance_loss: 0.6101, weighted_loss: 1.3417, label: 1, bag_size: 3332
batch 39, loss: 0.0976, instance_loss: 0.2274, weighted_loss: 0.1365, label: 3, bag_size: 6746


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.2925531914893617: correct 110/376
Epoch: 38, train_loss: 0.3813, train_clustering_loss:  0.3689, train_error: 0.0851
class 0: acc 1.0, correct 12/12
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 1.0, correct 14/14
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.6870, val_error: 0.6364, auc: 0.5903
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.2134, instance_loss: 0.2771, weighted_loss: 0.2325, label: 2, bag_size: 7427
batch 39, loss: 0.1282, instance_loss: 0.2018, weighted_loss: 0.1503, label: 1, bag_size: 4646


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.28191489361702127: correct 106/376
Epoch: 39, train_loss: 0.3316, train_clustering_loss:  0.3584, train_error: 0.0426
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 2.0136, val_error: 0.7273, auc: 0.6042
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.2225, instance_loss: 0.2519, weighted_loss: 0.2313, label: 1, bag_size: 8645
batch 39, loss: 0.0668, instance_loss: 0.1108, weighted_loss: 0.0800, label: 3, bag_size: 6746


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.449468085106383: correct 169/376
Epoch: 40, train_loss: 0.2895, train_clustering_loss:  0.3136, train_error: 0.0638
class 0: acc 1.0, correct 10/10
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 1.0, correct 13/13
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 2.0443, val_error: 0.7273, auc: 0.5833
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.1173, instance_loss: 0.2641, weighted_loss: 0.1613, label: 0, bag_size: 4010
batch 39, loss: 0.2255, instance_loss: 0.2666, weighted_loss: 0.2379, label: 2, bag_size: 4715


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.3803191489361702: correct 143/376
Epoch: 41, train_loss: 0.3514, train_clustering_loss:  0.3358, train_error: 0.1277
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7, correct 7/10
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.6255, val_error: 0.6364, auc: 0.6111
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.1985, instance_loss: 0.3086, weighted_loss: 0.2316, label: 3, bag_size: 1249
batch 39, loss: 0.1143, instance_loss: 0.1517, weighted_loss: 0.1255, label: 3, bag_size: 10296


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.3696808510638298: correct 139/376
Epoch: 42, train_loss: 0.3853, train_clustering_loss:  0.3482, train_error: 0.1064
class 0: acc 1.0, correct 8/8
class 1: acc 0.75, correct 9/12
class 2: acc 0.875, correct 14/16
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.7116, val_error: 0.5455, auc: 0.6215
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0342, instance_loss: 0.2233, weighted_loss: 0.0909, label: 3, bag_size: 5428
batch 39, loss: 0.0667, instance_loss: 0.2359, weighted_loss: 0.1174, label: 2, bag_size: 750


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.5718085106382979: correct 215/376
Epoch: 43, train_loss: 0.2284, train_clustering_loss:  0.2769, train_error: 0.0213
class 0: acc 0.75, correct 3/4
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 17/17
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.8027, val_error: 0.5455, auc: 0.6250
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0133, instance_loss: 0.3625, weighted_loss: 0.1180, label: 3, bag_size: 3415
batch 39, loss: 0.2765, instance_loss: 0.3601, weighted_loss: 0.3016, label: 0, bag_size: 1452


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.3696808510638298: correct 139/376
Epoch: 44, train_loss: 0.2578, train_clustering_loss:  0.3505, train_error: 0.0426
class 0: acc 0.9411764705882353, correct 16/17
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 2.1604, val_error: 0.7273, auc: 0.5938
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.0623, instance_loss: 0.1471, weighted_loss: 0.0878, label: 1, bag_size: 5301
batch 39, loss: 0.0656, instance_loss: 0.2141, weighted_loss: 0.1102, label: 0, bag_size: 460


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.5585106382978723: correct 210/376
Epoch: 45, train_loss: 0.2527, train_clustering_loss:  0.2722, train_error: 0.0851
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 2.3094, val_error: 0.7273, auc: 0.5833
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 36 out of 20


batch 19, loss: 1.1358, instance_loss: 0.6681, weighted_loss: 0.9955, label: 1, bag_size: 1275
batch 39, loss: 0.1382, instance_loss: 0.1569, weighted_loss: 0.1438, label: 3, bag_size: 10296


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.4867021276595745: correct 183/376
Epoch: 46, train_loss: 0.3678, train_clustering_loss:  0.3324, train_error: 0.1489
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 1.0, correct 9/9
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 2.0544, val_error: 0.7273, auc: 0.5833
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.5722, instance_loss: 0.6292, weighted_loss: 0.5893, label: 2, bag_size: 7812
batch 39, loss: 0.0352, instance_loss: 0.3907, weighted_loss: 0.1419, label: 3, bag_size: 4413


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.47074468085106386: correct 177/376
Epoch: 47, train_loss: 0.2456, train_clustering_loss:  0.3089, train_error: 0.0426
class 0: acc 0.9375, correct 15/16
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 2.2472, val_error: 0.8182, auc: 0.5938
class 0 clustering acc 0.90625: correct 319/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.1256, instance_loss: 0.2275, weighted_loss: 0.1562, label: 0, bag_size: 3058
batch 39, loss: 0.1618, instance_loss: 0.1928, weighted_loss: 0.1711, label: 1, bag_size: 7035


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.5851063829787234: correct 220/376
Epoch: 48, train_loss: 0.1987, train_clustering_loss:  0.2567, train_error: 0.0426
class 0: acc 0.875, correct 7/8
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 1.0, correct 16/16
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.7936, val_error: 0.5455, auc: 0.5590
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.3917, instance_loss: 0.4125, weighted_loss: 0.3979, label: 0, bag_size: 1225
batch 39, loss: 0.7506, instance_loss: 0.4825, weighted_loss: 0.6702, label: 0, bag_size: 3896


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.4920212765957447: correct 185/376
Epoch: 49, train_loss: 0.2203, train_clustering_loss:  0.2856, train_error: 0.0213
class 0: acc 1.0, correct 10/10
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 2.1989, val_error: 0.8182, auc: 0.5729
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.1100, instance_loss: 0.2500, weighted_loss: 0.1520, label: 2, bag_size: 4715
batch 39, loss: 0.0573, instance_loss: 0.1027, weighted_loss: 0.0709, label: 1, bag_size: 4010


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.6117021276595744: correct 230/376
Epoch: 50, train_loss: 0.2011, train_clustering_loss:  0.2628, train_error: 0.0213
class 0: acc 1.0, correct 10/10
class 1: acc 0.9375, correct 15/16
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 2.0983, val_error: 0.7273, auc: 0.5729
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.0455, instance_loss: 0.7214, weighted_loss: 0.2483, label: 2, bag_size: 3753
batch 39, loss: 0.1341, instance_loss: 0.2560, weighted_loss: 0.1707, label: 2, bag_size: 7427


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.7074468085106383: correct 266/376
Epoch: 51, train_loss: 0.1771, train_clustering_loss:  0.2381, train_error: 0.0426
class 0: acc 1.0, correct 16/16
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 2.0514, val_error: 0.6364, auc: 0.5590
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 42 out of 20
Early stopping
Val error: 0.5455, ROC AUC: 0.7292
Test error: 0.7273, ROC AUC: 0.4375
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3

Training Fold 7!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7799, instance_loss: 1.0702, weighted_loss: 1.5670, label: 3, bag_size: 3503
batch 39, loss: 1.5205, instance_loss: 0.9377, weighted_loss: 1.3457, label: 0, bag_size: 1225


class 0 clustering acc 0.9468085106382979: correct 1424/1504
class 1 clustering acc 0.08776595744680851: correct 33/376
Epoch: 0, train_loss: 1.4037, train_clustering_loss:  1.0499, train_error: 0.6596
class 0: acc 0.0, correct 0/13
class 1: acc 0.0, correct 0/9
class 2: acc 1.0, correct 16/16
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4151, val_error: 0.8182, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.415082).  Saving model ...


batch 19, loss: 1.4537, instance_loss: 0.7080, weighted_loss: 1.2300, label: 2, bag_size: 2966
batch 39, loss: 1.3886, instance_loss: 0.7037, weighted_loss: 1.1832, label: 1, bag_size: 1234


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4199, train_clustering_loss:  0.7457, train_error: 0.7872
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.0, correct 0/13
class 2: acc 0.0, correct 0/9
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.3577, val_error: 0.7273, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.415082 --> 1.357750).  Saving model ...


batch 19, loss: 1.6944, instance_loss: 0.6643, weighted_loss: 1.3854, label: 2, bag_size: 4921
batch 39, loss: 1.2271, instance_loss: 0.6285, weighted_loss: 1.0475, label: 2, bag_size: 3753


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3955, train_clustering_loss:  0.6387, train_error: 0.6596
class 0: acc 0.125, correct 1/8
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.14285714285714285, correct 2/14
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.4215, val_error: 0.9091, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3196, instance_loss: 0.6235, weighted_loss: 1.1108, label: 1, bag_size: 5086
batch 39, loss: 1.2365, instance_loss: 0.5813, weighted_loss: 1.0400, label: 2, bag_size: 7812


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3857, train_clustering_loss:  0.6095, train_error: 0.7021
class 0: acc 0.0, correct 0/11
class 1: acc 0.07692307692307693, correct 1/13
class 2: acc 1.0, correct 13/13
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3801, val_error: 0.8182, auc: 0.6632
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1053, instance_loss: 0.5920, weighted_loss: 0.9513, label: 2, bag_size: 750
batch 39, loss: 1.3369, instance_loss: 0.6178, weighted_loss: 1.1212, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3607, train_clustering_loss:  0.6115, train_error: 0.6809
class 0: acc 0.25, correct 4/16
class 1: acc 0.0, correct 0/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3595, val_error: 0.6364, auc: 0.7361
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2602, instance_loss: 0.6183, weighted_loss: 1.0677, label: 0, bag_size: 3775
batch 39, loss: 1.3107, instance_loss: 0.5978, weighted_loss: 1.0969, label: 0, bag_size: 6943


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.4083, train_clustering_loss:  0.6097, train_error: 0.7872
class 0: acc 0.5, correct 5/10
class 1: acc 0.2, correct 2/10
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.125, correct 2/16

Val Set, val_loss: 1.3318, val_error: 0.4545, auc: 0.7743
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.357750 --> 1.331788).  Saving model ...


batch 19, loss: 1.9168, instance_loss: 0.6521, weighted_loss: 1.5374, label: 2, bag_size: 750
batch 39, loss: 1.7555, instance_loss: 0.6279, weighted_loss: 1.4172, label: 2, bag_size: 2966


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3599, train_clustering_loss:  0.6062, train_error: 0.6170
class 0: acc 0.0, correct 0/10
class 1: acc 0.15384615384615385, correct 2/13
class 2: acc 0.0, correct 0/8
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.3269, val_error: 0.7273, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.331788 --> 1.326939).  Saving model ...


batch 19, loss: 0.9955, instance_loss: 0.5835, weighted_loss: 0.8719, label: 1, bag_size: 3332
batch 39, loss: 1.4591, instance_loss: 0.6201, weighted_loss: 1.2074, label: 0, bag_size: 3775


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3484, train_clustering_loss:  0.6068, train_error: 0.7021
class 0: acc 0.0, correct 0/12
class 1: acc 0.875, correct 14/16
class 2: acc 0.0, correct 0/12
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.3370, val_error: 0.5455, auc: 0.7639
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2409, instance_loss: 0.6297, weighted_loss: 1.0575, label: 0, bag_size: 1040
batch 39, loss: 1.2165, instance_loss: 0.5617, weighted_loss: 1.0201, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.3069, train_clustering_loss:  0.6039, train_error: 0.6809
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.0, correct 0/8
class 2: acc 0.3333333333333333, correct 5/15
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3811, val_error: 0.7273, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.0326, instance_loss: 0.6349, weighted_loss: 1.6133, label: 1, bag_size: 1275
batch 39, loss: 1.2867, instance_loss: 0.6002, weighted_loss: 1.0808, label: 0, bag_size: 1225


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2655, train_clustering_loss:  0.5947, train_error: 0.5319
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.0, correct 0/8
class 2: acc 0.9473684210526315, correct 18/19
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4437, val_error: 0.8182, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8390, instance_loss: 0.5382, weighted_loss: 0.7488, label: 2, bag_size: 2966
batch 39, loss: 1.7099, instance_loss: 0.6514, weighted_loss: 1.3923, label: 1, bag_size: 1234


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2269, train_clustering_loss:  0.5906, train_error: 0.5745
class 0: acc 0.0, correct 0/11
class 1: acc 0.14285714285714285, correct 1/7
class 2: acc 1.0, correct 19/19
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.4043, val_error: 0.8182, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.9074, instance_loss: 0.6131, weighted_loss: 0.8191, label: 0, bag_size: 3058
batch 39, loss: 1.3370, instance_loss: 0.6318, weighted_loss: 1.1255, label: 1, bag_size: 4400


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2536, train_clustering_loss:  0.6030, train_error: 0.5745
class 0: acc 0.6875, correct 11/16
class 1: acc 0.14285714285714285, correct 2/14
class 2: acc 0.875, correct 7/8
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.2741, val_error: 0.4545, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.326939 --> 1.274098).  Saving model ...


batch 19, loss: 1.3870, instance_loss: 0.6402, weighted_loss: 1.1629, label: 3, bag_size: 5428
batch 39, loss: 1.2365, instance_loss: 0.5857, weighted_loss: 1.0413, label: 2, bag_size: 750


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.3334, train_clustering_loss:  0.5978, train_error: 0.6596
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.25, correct 3/12
class 3: acc 0.09090909090909091, correct 1/11

Val Set, val_loss: 1.2616, val_error: 0.5455, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.274098 --> 1.261590).  Saving model ...


batch 19, loss: 1.4720, instance_loss: 0.6259, weighted_loss: 1.2181, label: 2, bag_size: 4921
batch 39, loss: 1.6243, instance_loss: 0.6107, weighted_loss: 1.3202, label: 2, bag_size: 750


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2200, train_clustering_loss:  0.5855, train_error: 0.4894
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.0, correct 0/10
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.2722, val_error: 0.6364, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6417, instance_loss: 0.6368, weighted_loss: 1.3402, label: 1, bag_size: 5086
batch 39, loss: 1.4703, instance_loss: 0.5794, weighted_loss: 1.2030, label: 3, bag_size: 6888


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1151, train_clustering_loss:  0.5722, train_error: 0.4255
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.0, correct 0/7
class 2: acc 0.6875, correct 11/16
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.2693, val_error: 0.7273, auc: 0.7639
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.3713, instance_loss: 0.6146, weighted_loss: 1.1443, label: 3, bag_size: 361
batch 39, loss: 1.2015, instance_loss: 0.6096, weighted_loss: 1.0240, label: 3, bag_size: 10296


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.0257, train_clustering_loss:  0.5691, train_error: 0.4681
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.7647058823529411, correct 13/17
class 2: acc 0.8333333333333334, correct 5/6
class 3: acc 0.26666666666666666, correct 4/15

Val Set, val_loss: 1.2199, val_error: 0.3636, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.261590 --> 1.219943).  Saving model ...


batch 19, loss: 1.7527, instance_loss: 0.6270, weighted_loss: 1.4150, label: 2, bag_size: 750
batch 39, loss: 0.9580, instance_loss: 0.5901, weighted_loss: 0.8476, label: 0, bag_size: 1040


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.1046, train_clustering_loss:  0.5762, train_error: 0.4681
class 0: acc 0.29411764705882354, correct 5/17
class 1: acc 1.0, correct 9/9
class 2: acc 0.1111111111111111, correct 1/9
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.2772, val_error: 0.6364, auc: 0.7500
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6749, instance_loss: 0.4956, weighted_loss: 0.6211, label: 1, bag_size: 3951
batch 39, loss: 0.5585, instance_loss: 0.4877, weighted_loss: 0.5373, label: 2, bag_size: 1654


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.0733, train_clustering_loss:  0.5623, train_error: 0.4681
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.23076923076923078, correct 3/13
class 2: acc 0.6666666666666666, correct 12/18
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 1.2604, val_error: 0.5455, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.3832, instance_loss: 0.5647, weighted_loss: 1.1377, label: 3, bag_size: 6888
batch 39, loss: 0.6497, instance_loss: 0.4830, weighted_loss: 0.5997, label: 1, bag_size: 3951


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.8887, train_clustering_loss:  0.5289, train_error: 0.2553
class 0: acc 0.7, correct 7/10
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 1.0, correct 13/13
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.2275, val_error: 0.2727, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2953, instance_loss: 0.5806, weighted_loss: 1.0809, label: 0, bag_size: 4903
batch 39, loss: 1.0528, instance_loss: 0.6370, weighted_loss: 0.9281, label: 3, bag_size: 5854


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 1.0254, train_clustering_loss:  0.5448, train_error: 0.4468
class 0: acc 0.2, correct 2/10
class 1: acc 0.75, correct 9/12
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.36363636363636365, correct 4/11

Val Set, val_loss: 1.2050, val_error: 0.4545, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.219943 --> 1.205032).  Saving model ...


batch 19, loss: 1.1643, instance_loss: 0.4899, weighted_loss: 0.9620, label: 1, bag_size: 8645
batch 39, loss: 0.9229, instance_loss: 0.5283, weighted_loss: 0.8045, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 0.8763, train_clustering_loss:  0.5225, train_error: 0.3617
class 0: acc 0.4444444444444444, correct 4/9
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.125, correct 1/8
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.2995, val_error: 0.4545, auc: 0.6736
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2762, instance_loss: 0.6167, weighted_loss: 1.0783, label: 3, bag_size: 1534
batch 39, loss: 0.5551, instance_loss: 0.4677, weighted_loss: 0.5289, label: 1, bag_size: 1275


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 0.8709, train_clustering_loss:  0.5207, train_error: 0.3191
class 0: acc 0.5714285714285714, correct 8/14
class 1: acc 0.8, correct 12/15
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.2046, val_error: 0.4545, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.205032 --> 1.204636).  Saving model ...


batch 19, loss: 0.4116, instance_loss: 0.4464, weighted_loss: 0.4221, label: 3, bag_size: 5428
batch 39, loss: 0.3603, instance_loss: 0.5319, weighted_loss: 0.4118, label: 0, bag_size: 3896


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.010638297872340425: correct 4/376
Epoch: 22, train_loss: 0.8350, train_clustering_loss:  0.5135, train_error: 0.3617
class 0: acc 0.15384615384615385, correct 2/13
class 1: acc 1.0, correct 16/16
class 2: acc 0.4, correct 2/5
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.3270, val_error: 0.4545, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2430, instance_loss: 0.4073, weighted_loss: 0.2923, label: 3, bag_size: 5428
batch 39, loss: 0.7586, instance_loss: 0.5295, weighted_loss: 0.6899, label: 0, bag_size: 3756


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.010638297872340425: correct 4/376
Epoch: 23, train_loss: 0.6901, train_clustering_loss:  0.4863, train_error: 0.2128
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.6153846153846154, correct 8/13
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.3039, val_error: 0.5455, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9537, instance_loss: 0.5445, weighted_loss: 0.8310, label: 2, bag_size: 750
batch 39, loss: 0.3088, instance_loss: 0.3758, weighted_loss: 0.3289, label: 0, bag_size: 3058


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 24, train_loss: 0.7473, train_clustering_loss:  0.4866, train_error: 0.3191
class 0: acc 1.0, correct 14/14
class 1: acc 0.0, correct 0/8
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.2920, val_error: 0.4545, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2429, instance_loss: 0.3444, weighted_loss: 0.2734, label: 0, bag_size: 3058
batch 39, loss: 0.6236, instance_loss: 0.4992, weighted_loss: 0.5863, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.015957446808510637: correct 6/376
Epoch: 25, train_loss: 0.7628, train_clustering_loss:  0.4959, train_error: 0.2340
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.75, correct 9/12
class 2: acc 0.8125, correct 13/16
class 3: acc 0.5714285714285714, correct 4/7

Val Set, val_loss: 1.3482, val_error: 0.4545, auc: 0.7222
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.9364, instance_loss: 0.4881, weighted_loss: 0.8019, label: 0, bag_size: 1225
batch 39, loss: 0.5226, instance_loss: 0.5164, weighted_loss: 0.5208, label: 0, bag_size: 8614


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.06648936170212766: correct 25/376
Epoch: 26, train_loss: 0.6418, train_clustering_loss:  0.4645, train_error: 0.1702
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 17/17
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.2989, val_error: 0.4545, auc: 0.7326
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.8339, instance_loss: 0.5331, weighted_loss: 0.7437, label: 2, bag_size: 3753
batch 39, loss: 0.9165, instance_loss: 0.6493, weighted_loss: 0.8363, label: 3, bag_size: 1534


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.02127659574468085: correct 8/376
Epoch: 27, train_loss: 0.6778, train_clustering_loss:  0.4722, train_error: 0.2553
class 0: acc 0.7, correct 7/10
class 1: acc 0.5, correct 5/10
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.875, correct 14/16

Val Set, val_loss: 1.3029, val_error: 0.4545, auc: 0.7396
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.2443, instance_loss: 0.5886, weighted_loss: 1.0476, label: 0, bag_size: 1342
batch 39, loss: 0.8800, instance_loss: 0.5635, weighted_loss: 0.7850, label: 0, bag_size: 3775


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.06914893617021277: correct 26/376
Epoch: 28, train_loss: 0.6461, train_clustering_loss:  0.4545, train_error: 0.2553
class 0: acc 0.4, correct 4/10
class 1: acc 0.9375, correct 15/16
class 2: acc 0.8, correct 8/10
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.0446, val_error: 0.4545, auc: 0.7986
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.204636 --> 1.044607).  Saving model ...


batch 19, loss: 1.1379, instance_loss: 0.5440, weighted_loss: 0.9597, label: 3, bag_size: 5854
batch 39, loss: 0.0982, instance_loss: 0.2208, weighted_loss: 0.1350, label: 3, bag_size: 3503


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.11436170212765957: correct 43/376
Epoch: 29, train_loss: 0.6841, train_clustering_loss:  0.4563, train_error: 0.2766
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.3768, val_error: 0.3636, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1736, instance_loss: 0.3310, weighted_loss: 0.2208, label: 2, bag_size: 4921
batch 39, loss: 0.1180, instance_loss: 0.2490, weighted_loss: 0.1573, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.1675531914893617: correct 63/376
Epoch: 30, train_loss: 0.5556, train_clustering_loss:  0.4214, train_error: 0.2553
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.14285714285714285, correct 1/7
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.2149, val_error: 0.3636, auc: 0.8021
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9747, instance_loss: 0.6175, weighted_loss: 0.8675, label: 1, bag_size: 1234
batch 39, loss: 0.8823, instance_loss: 0.5046, weighted_loss: 0.7690, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.11170212765957446: correct 42/376
Epoch: 31, train_loss: 0.6059, train_clustering_loss:  0.4515, train_error: 0.1489
class 0: acc 0.625, correct 10/16
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.2548, val_error: 0.3636, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5589, instance_loss: 0.4960, weighted_loss: 0.5401, label: 3, bag_size: 1534
batch 39, loss: 0.4250, instance_loss: 0.3852, weighted_loss: 0.4130, label: 0, bag_size: 3642


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.15425531914893617: correct 58/376
Epoch: 32, train_loss: 0.4994, train_clustering_loss:  0.4075, train_error: 0.1277
class 0: acc 1.0, correct 14/14
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 1.0, correct 11/11
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.2010, val_error: 0.3636, auc: 0.7778
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2375, instance_loss: 0.3185, weighted_loss: 0.2618, label: 0, bag_size: 3058
batch 39, loss: 0.8319, instance_loss: 0.5982, weighted_loss: 0.7618, label: 1, bag_size: 4400


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.17287234042553193: correct 65/376
Epoch: 33, train_loss: 0.4881, train_clustering_loss:  0.3943, train_error: 0.1489
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.3882, val_error: 0.2727, auc: 0.7743
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.9624, instance_loss: 0.5602, weighted_loss: 0.8417, label: 3, bag_size: 1249
batch 39, loss: 0.0754, instance_loss: 0.1712, weighted_loss: 0.1041, label: 2, bag_size: 6477


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.22074468085106383: correct 83/376
Epoch: 34, train_loss: 0.6133, train_clustering_loss:  0.4305, train_error: 0.2128
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.7, correct 7/10
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.0874, val_error: 0.4545, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.2426, instance_loss: 0.3229, weighted_loss: 0.2667, label: 3, bag_size: 1249
batch 39, loss: 0.1259, instance_loss: 0.2505, weighted_loss: 0.1633, label: 2, bag_size: 1654


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.2553191489361702: correct 96/376
Epoch: 35, train_loss: 0.4798, train_clustering_loss:  0.3886, train_error: 0.1277
class 0: acc 0.9, correct 9/10
class 1: acc 0.6, correct 6/10
class 2: acc 1.0, correct 15/15
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.1665, val_error: 0.2727, auc: 0.8056
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.6664, instance_loss: 0.4627, weighted_loss: 0.6053, label: 1, bag_size: 1540
batch 39, loss: 0.1643, instance_loss: 0.1861, weighted_loss: 0.1708, label: 2, bag_size: 6477


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.2579787234042553: correct 97/376
Epoch: 36, train_loss: 0.4947, train_clustering_loss:  0.3818, train_error: 0.1064
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9, correct 9/10
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.2380, val_error: 0.3636, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.6211, instance_loss: 0.4582, weighted_loss: 0.5722, label: 1, bag_size: 1540
batch 39, loss: 0.3144, instance_loss: 0.3724, weighted_loss: 0.3318, label: 1, bag_size: 1275


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.27925531914893614: correct 105/376
Epoch: 37, train_loss: 0.4498, train_clustering_loss:  0.3689, train_error: 0.1277
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.2872, val_error: 0.3636, auc: 0.7882
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.4189, instance_loss: 0.4770, weighted_loss: 0.4363, label: 3, bag_size: 361
batch 39, loss: 0.1055, instance_loss: 0.1991, weighted_loss: 0.1336, label: 2, bag_size: 4921


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.2872340425531915: correct 108/376
Epoch: 38, train_loss: 0.4734, train_clustering_loss:  0.3751, train_error: 0.1489
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.1973, val_error: 0.4545, auc: 0.7951
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2767, instance_loss: 0.5717, weighted_loss: 0.3652, label: 3, bag_size: 1534
batch 39, loss: 0.0579, instance_loss: 0.1555, weighted_loss: 0.0872, label: 2, bag_size: 1654


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.324468085106383: correct 122/376
Epoch: 39, train_loss: 0.3873, train_clustering_loss:  0.3741, train_error: 0.0426
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.2420, val_error: 0.3636, auc: 0.7812
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0315, instance_loss: 0.1437, weighted_loss: 0.0652, label: 3, bag_size: 3503
batch 39, loss: 0.0537, instance_loss: 0.1318, weighted_loss: 0.0771, label: 2, bag_size: 4921


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.3058510638297872: correct 115/376
Epoch: 40, train_loss: 0.4201, train_clustering_loss:  0.3556, train_error: 0.1277
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.875, correct 14/16
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.1738, val_error: 0.4545, auc: 0.8125
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.3733, instance_loss: 0.3907, weighted_loss: 0.3785, label: 0, bag_size: 4010
batch 39, loss: 0.0480, instance_loss: 0.1679, weighted_loss: 0.0839, label: 3, bag_size: 5428


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.35106382978723405: correct 132/376
Epoch: 41, train_loss: 0.4390, train_clustering_loss:  0.3586, train_error: 0.1489
class 0: acc 0.5, correct 5/10
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 14/14
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.1476, val_error: 0.1818, auc: 0.8368
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0535, instance_loss: 0.1861, weighted_loss: 0.0932, label: 3, bag_size: 1249
batch 39, loss: 0.0513, instance_loss: 0.1648, weighted_loss: 0.0853, label: 3, bag_size: 1249


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.25: correct 94/376
Epoch: 42, train_loss: 0.4126, train_clustering_loss:  0.3748, train_error: 0.1702
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 1.0, correct 8/8
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.8823529411764706, correct 15/17

Val Set, val_loss: 1.1337, val_error: 0.3636, auc: 0.8472
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0371, instance_loss: 0.0937, weighted_loss: 0.0541, label: 1, bag_size: 3328
batch 39, loss: 0.2770, instance_loss: 0.3152, weighted_loss: 0.2885, label: 1, bag_size: 4400


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.28191489361702127: correct 106/376
Epoch: 43, train_loss: 0.4498, train_clustering_loss:  0.3832, train_error: 0.1702
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.75, correct 12/16
class 2: acc 0.8, correct 8/10
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.1843, val_error: 0.3636, auc: 0.7951
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.1796, instance_loss: 0.5098, weighted_loss: 0.9787, label: 2, bag_size: 602
batch 39, loss: 0.1892, instance_loss: 0.2899, weighted_loss: 0.2194, label: 1, bag_size: 5086


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.31648936170212766: correct 119/376
Epoch: 44, train_loss: 0.3757, train_clustering_loss:  0.3520, train_error: 0.1064
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 1.0, correct 15/15
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.6, correct 3/5

Val Set, val_loss: 1.2347, val_error: 0.3636, auc: 0.8056
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1014, instance_loss: 0.2501, weighted_loss: 0.1460, label: 0, bag_size: 3058
batch 39, loss: 0.6652, instance_loss: 0.5593, weighted_loss: 0.6334, label: 1, bag_size: 3332


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.3803191489361702: correct 143/376
Epoch: 45, train_loss: 0.3971, train_clustering_loss:  0.3364, train_error: 0.1277
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 14/14
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.1350, val_error: 0.3636, auc: 0.7951
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1501, instance_loss: 0.2497, weighted_loss: 0.1800, label: 0, bag_size: 8614
batch 39, loss: 0.2519, instance_loss: 0.3825, weighted_loss: 0.2911, label: 3, bag_size: 1249


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.32978723404255317: correct 124/376
Epoch: 46, train_loss: 0.4292, train_clustering_loss:  0.3586, train_error: 0.1064
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 1.0, correct 15/15
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.1239, val_error: 0.3636, auc: 0.8264
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.2962, instance_loss: 0.3450, weighted_loss: 0.3108, label: 2, bag_size: 2966
batch 39, loss: 0.3428, instance_loss: 0.6264, weighted_loss: 0.4279, label: 0, bag_size: 3756


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.300531914893617: correct 113/376
Epoch: 47, train_loss: 0.4371, train_clustering_loss:  0.3758, train_error: 0.1277
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 1.0, correct 11/11
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.3918, val_error: 0.5455, auc: 0.7674
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.6738, instance_loss: 0.5479, weighted_loss: 0.6361, label: 0, bag_size: 1040
batch 39, loss: 0.2782, instance_loss: 0.3467, weighted_loss: 0.2987, label: 1, bag_size: 1234


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.3723404255319149: correct 140/376
Epoch: 48, train_loss: 0.3134, train_clustering_loss:  0.3177, train_error: 0.0426
class 0: acc 1.0, correct 10/10
class 1: acc 0.95, correct 19/20
class 2: acc 1.0, correct 9/9
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.3219, val_error: 0.4545, auc: 0.7812
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0185, instance_loss: 0.0622, weighted_loss: 0.0316, label: 2, bag_size: 1646
batch 39, loss: 0.2583, instance_loss: 0.3096, weighted_loss: 0.2737, label: 3, bag_size: 1752


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.4228723404255319: correct 159/376
Epoch: 49, train_loss: 0.3618, train_clustering_loss:  0.3438, train_error: 0.2128
class 0: acc 0.4, correct 4/10
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.8888888888888888, correct 16/18

Val Set, val_loss: 1.4017, val_error: 0.4545, auc: 0.7812
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0210, instance_loss: 0.0932, weighted_loss: 0.0427, label: 3, bag_size: 5428
batch 39, loss: 0.5523, instance_loss: 0.3581, weighted_loss: 0.4940, label: 0, bag_size: 1225


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.3776595744680851: correct 142/376
Epoch: 50, train_loss: 0.3225, train_clustering_loss:  0.3233, train_error: 0.1277
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.2437, val_error: 0.3636, auc: 0.8160
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.3885, instance_loss: 0.5967, weighted_loss: 0.4510, label: 2, bag_size: 3753
batch 39, loss: 0.2521, instance_loss: 0.2858, weighted_loss: 0.2622, label: 0, bag_size: 3642


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.4521276595744681: correct 170/376
Epoch: 51, train_loss: 0.3710, train_clustering_loss:  0.3312, train_error: 0.1064
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.625, correct 5/8
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 1.2034, val_error: 0.3636, auc: 0.8021
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 23 out of 20
Early stopping
Val error: 0.4545, ROC AUC: 0.7986
Test error: 0.8182, ROC AUC: 0.5556
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3

Training Fold 8!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6455, instance_loss: 1.1267, weighted_loss: 1.4899, label: 0, bag_size: 2826
batch 39, loss: 1.8385, instance_loss: 0.9454, weighted_loss: 1.5706, label: 1, bag_size: 1234


class 0 clustering acc 0.9441489361702128: correct 1420/1504
class 1 clustering acc 0.08776595744680851: correct 33/376
Epoch: 0, train_loss: 1.4191, train_clustering_loss:  1.0417, train_error: 0.7447
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/9
class 2: acc 0.14285714285714285, correct 2/14
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.4299, val_error: 0.8182, auc: 0.5035
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.429920).  Saving model ...


batch 19, loss: 1.2124, instance_loss: 0.6816, weighted_loss: 1.0532, label: 3, bag_size: 3071
batch 39, loss: 1.0759, instance_loss: 0.6578, weighted_loss: 0.9505, label: 1, bag_size: 3328


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3361, train_clustering_loss:  0.7304, train_error: 0.5106
class 0: acc 0.0, correct 0/6
class 1: acc 0.6111111111111112, correct 11/18
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.4380, val_error: 0.7273, auc: 0.5694
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6280, instance_loss: 0.6542, weighted_loss: 1.3359, label: 2, bag_size: 4715
batch 39, loss: 1.4028, instance_loss: 0.6349, weighted_loss: 1.1724, label: 2, bag_size: 3753


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3967, train_clustering_loss:  0.6342, train_error: 0.6809
class 0: acc 0.0, correct 0/10
class 1: acc 1.0, correct 15/15
class 2: acc 0.0, correct 0/13
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4130, val_error: 0.7273, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.429920 --> 1.412955).  Saving model ...


batch 19, loss: 1.7193, instance_loss: 0.6571, weighted_loss: 1.4006, label: 0, bag_size: 1452
batch 39, loss: 1.2780, instance_loss: 0.6145, weighted_loss: 1.0790, label: 2, bag_size: 6469


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3561, train_clustering_loss:  0.6176, train_error: 0.6596
class 0: acc 0.0, correct 0/8
class 1: acc 1.0, correct 16/16
class 2: acc 0.0, correct 0/13
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.4175, val_error: 0.7273, auc: 0.6458
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4692, instance_loss: 0.6302, weighted_loss: 1.2175, label: 3, bag_size: 1720
batch 39, loss: 1.5220, instance_loss: 0.6088, weighted_loss: 1.2480, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3882, train_clustering_loss:  0.6147, train_error: 0.6809
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.36363636363636365, correct 4/11
class 3: acc 0.3333333333333333, correct 4/12

Val Set, val_loss: 1.3742, val_error: 0.7273, auc: 0.6736
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.412955 --> 1.374151).  Saving model ...


batch 19, loss: 1.5280, instance_loss: 0.6389, weighted_loss: 1.2613, label: 0, bag_size: 8614
batch 39, loss: 1.3347, instance_loss: 0.6217, weighted_loss: 1.1208, label: 0, bag_size: 3896


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3614, train_clustering_loss:  0.6144, train_error: 0.7234
class 0: acc 0.0, correct 0/13
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.0, correct 0/12
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.3626, val_error: 0.7273, auc: 0.7326
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.374151 --> 1.362563).  Saving model ...


batch 19, loss: 1.0673, instance_loss: 0.5973, weighted_loss: 0.9263, label: 3, bag_size: 1720
batch 39, loss: 0.8430, instance_loss: 0.5734, weighted_loss: 0.7621, label: 3, bag_size: 1720


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.2959, train_clustering_loss:  0.6076, train_error: 0.5745
class 0: acc 0.4375, correct 7/16
class 1: acc 0.0, correct 0/7
class 2: acc 0.1111111111111111, correct 1/9
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.3619, val_error: 0.6364, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.362563 --> 1.361932).  Saving model ...


batch 19, loss: 1.0973, instance_loss: 0.5984, weighted_loss: 0.9476, label: 0, bag_size: 1452
batch 39, loss: 1.2770, instance_loss: 0.6052, weighted_loss: 1.0755, label: 0, bag_size: 859


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3044, train_clustering_loss:  0.6132, train_error: 0.5745
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.0, correct 0/10
class 3: acc 0.36363636363636365, correct 4/11

Val Set, val_loss: 1.3417, val_error: 0.7273, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.361932 --> 1.341722).  Saving model ...


batch 19, loss: 1.3054, instance_loss: 0.6147, weighted_loss: 1.0982, label: 2, bag_size: 1646
batch 39, loss: 1.8718, instance_loss: 0.6537, weighted_loss: 1.5064, label: 1, bag_size: 7240


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2773, train_clustering_loss:  0.6041, train_error: 0.6170
class 0: acc 0.75, correct 9/12
class 1: acc 0.0, correct 0/8
class 2: acc 0.3888888888888889, correct 7/18
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.4627, val_error: 0.8182, auc: 0.5312
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3781, instance_loss: 0.6660, weighted_loss: 1.1645, label: 1, bag_size: 4423
batch 39, loss: 1.0399, instance_loss: 0.6077, weighted_loss: 0.9103, label: 1, bag_size: 1617


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2417, train_clustering_loss:  0.6024, train_error: 0.5745
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.15384615384615385, correct 2/13
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.4075, val_error: 0.8182, auc: 0.3993
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0731, instance_loss: 0.6045, weighted_loss: 0.9325, label: 3, bag_size: 1720
batch 39, loss: 1.3084, instance_loss: 0.6354, weighted_loss: 1.1065, label: 1, bag_size: 3328


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.1884, train_clustering_loss:  0.6026, train_error: 0.4681
class 0: acc 0.25, correct 2/8
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.5, correct 6/12
class 3: acc 0.625, correct 10/16

Val Set, val_loss: 1.4815, val_error: 0.6364, auc: 0.5799
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.5478, instance_loss: 0.5993, weighted_loss: 1.2633, label: 0, bag_size: 1225
batch 39, loss: 0.4105, instance_loss: 0.4276, weighted_loss: 0.4157, label: 3, bag_size: 5428


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.1733, train_clustering_loss:  0.5839, train_error: 0.5319
class 0: acc 0.07142857142857142, correct 1/14
class 1: acc 0.7777777777777778, correct 14/18
class 2: acc 0.0, correct 0/6
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.4154, val_error: 0.7273, auc: 0.5382
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2916, instance_loss: 0.4104, weighted_loss: 0.3272, label: 3, bag_size: 3071
batch 39, loss: 1.2542, instance_loss: 0.6421, weighted_loss: 1.0706, label: 2, bag_size: 2966


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.1668, train_clustering_loss:  0.5916, train_error: 0.5319
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.0, correct 0/12
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.4053, val_error: 0.8182, auc: 0.5660
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.1168, instance_loss: 0.5962, weighted_loss: 0.9606, label: 2, bag_size: 4715
batch 39, loss: 0.5147, instance_loss: 0.5111, weighted_loss: 0.5137, label: 3, bag_size: 1720


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.1155, train_clustering_loss:  0.5796, train_error: 0.4043
class 0: acc 0.8, correct 8/10
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.5714285714285714, correct 8/14
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.4381, val_error: 0.9091, auc: 0.5417
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.1867, instance_loss: 0.5886, weighted_loss: 1.0073, label: 0, bag_size: 1452
batch 39, loss: 0.9364, instance_loss: 0.5705, weighted_loss: 0.8266, label: 2, bag_size: 7812


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.0162, train_clustering_loss:  0.5475, train_error: 0.4894
class 0: acc 0.2727272727272727, correct 3/11
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.5, correct 5/10
class 3: acc 0.8823529411764706, correct 15/17

Val Set, val_loss: 1.4254, val_error: 0.8182, auc: 0.6215
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 2.3500, instance_loss: 0.6802, weighted_loss: 1.8491, label: 3, bag_size: 1249
batch 39, loss: 1.2619, instance_loss: 0.6303, weighted_loss: 1.0724, label: 1, bag_size: 8645


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.0597, train_clustering_loss:  0.5635, train_error: 0.4043
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.6, correct 9/15
class 2: acc 0.6, correct 3/5
class 3: acc 0.5, correct 7/14

Val Set, val_loss: 1.4336, val_error: 0.7273, auc: 0.5139
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.5655, instance_loss: 0.6707, weighted_loss: 1.2971, label: 2, bag_size: 2966
batch 39, loss: 0.5090, instance_loss: 0.5771, weighted_loss: 0.5294, label: 2, bag_size: 1646


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 16, train_loss: 1.0070, train_clustering_loss:  0.5418, train_error: 0.3830
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.3076923076923077, correct 4/13
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.5022, val_error: 0.8182, auc: 0.5174
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.4224, instance_loss: 0.5896, weighted_loss: 1.1726, label: 3, bag_size: 3366
batch 39, loss: 0.7375, instance_loss: 0.5558, weighted_loss: 0.6830, label: 0, bag_size: 3058


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.026595744680851064: correct 10/376
Epoch: 17, train_loss: 0.8676, train_clustering_loss:  0.5213, train_error: 0.3404
class 0: acc 0.6875, correct 11/16
class 1: acc 0.625, correct 5/8
class 2: acc 0.5, correct 5/10
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.4875, val_error: 0.9091, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.1907, instance_loss: 0.6275, weighted_loss: 1.0217, label: 2, bag_size: 7812
batch 39, loss: 0.5988, instance_loss: 0.4909, weighted_loss: 0.5665, label: 3, bag_size: 3366


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.023936170212765957: correct 9/376
Epoch: 18, train_loss: 0.9445, train_clustering_loss:  0.5334, train_error: 0.4043
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.4, correct 4/10
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.4252, val_error: 0.6364, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 2.0565, instance_loss: 0.6966, weighted_loss: 1.6485, label: 0, bag_size: 859
batch 39, loss: 0.1490, instance_loss: 0.2454, weighted_loss: 0.1779, label: 3, bag_size: 1422


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.05319148936170213: correct 20/376
Epoch: 19, train_loss: 0.8710, train_clustering_loss:  0.5261, train_error: 0.3830
class 0: acc 0.5, correct 6/12
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.5838, val_error: 0.7273, auc: 0.5694
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.2131, instance_loss: 0.5642, weighted_loss: 1.0184, label: 0, bag_size: 1040
batch 39, loss: 0.9320, instance_loss: 0.5047, weighted_loss: 0.8038, label: 1, bag_size: 7240


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.026595744680851064: correct 10/376
Epoch: 20, train_loss: 0.7711, train_clustering_loss:  0.5027, train_error: 0.1702
class 0: acc 0.625, correct 5/8
class 1: acc 1.0, correct 16/16
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.5773, val_error: 0.6364, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.6170, instance_loss: 0.4189, weighted_loss: 0.5576, label: 3, bag_size: 3503
batch 39, loss: 0.6027, instance_loss: 0.4080, weighted_loss: 0.5443, label: 1, bag_size: 4423


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.061170212765957445: correct 23/376
Epoch: 21, train_loss: 0.6874, train_clustering_loss:  0.4622, train_error: 0.2128
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.9444444444444444, correct 17/18
class 2: acc 0.0, correct 0/4
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.5563, val_error: 0.7273, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0342, instance_loss: 0.1430, weighted_loss: 0.0668, label: 3, bag_size: 3071
batch 39, loss: 0.7410, instance_loss: 0.5509, weighted_loss: 0.6839, label: 0, bag_size: 3775


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.125: correct 47/376
Epoch: 22, train_loss: 0.6147, train_clustering_loss:  0.4512, train_error: 0.2340
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 1.0, correct 16/16
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.5321, val_error: 0.7273, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.0131, instance_loss: 0.5179, weighted_loss: 0.8646, label: 3, bag_size: 3366
batch 39, loss: 0.0987, instance_loss: 0.2205, weighted_loss: 0.1352, label: 3, bag_size: 6746


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0851063829787234: correct 32/376
Epoch: 23, train_loss: 0.7220, train_clustering_loss:  0.4686, train_error: 0.1915
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.7333333333333333, correct 11/15

Val Set, val_loss: 1.4368, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 2.0483, instance_loss: 0.7969, weighted_loss: 1.6729, label: 2, bag_size: 2966
batch 39, loss: 0.5463, instance_loss: 0.4424, weighted_loss: 0.5151, label: 0, bag_size: 1225


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.125: correct 47/376
Epoch: 24, train_loss: 0.6375, train_clustering_loss:  0.4434, train_error: 0.2340
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.8143, val_error: 0.6364, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.2883, instance_loss: 0.3772, weighted_loss: 0.3150, label: 0, bag_size: 1225
batch 39, loss: 0.6548, instance_loss: 0.4717, weighted_loss: 0.5999, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0425531914893617: correct 16/376
Epoch: 25, train_loss: 0.8918, train_clustering_loss:  0.5020, train_error: 0.4043
class 0: acc 0.6, correct 9/15
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.6, correct 6/10
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.4071, val_error: 0.7273, auc: 0.7118
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.0286, instance_loss: 0.5457, weighted_loss: 0.8837, label: 1, bag_size: 1234
batch 39, loss: 0.3755, instance_loss: 0.3775, weighted_loss: 0.3761, label: 1, bag_size: 4646


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.12234042553191489: correct 46/376
Epoch: 26, train_loss: 0.7591, train_clustering_loss:  0.4668, train_error: 0.2979
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.3, correct 3/10
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.4355, val_error: 0.6364, auc: 0.7326
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.1351, instance_loss: 0.6891, weighted_loss: 1.0013, label: 2, bag_size: 3753
batch 39, loss: 0.6359, instance_loss: 0.4807, weighted_loss: 0.5894, label: 2, bag_size: 7427


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.10638297872340426: correct 40/376
Epoch: 27, train_loss: 0.6401, train_clustering_loss:  0.4495, train_error: 0.2128
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.4604, val_error: 0.8182, auc: 0.7396
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 1.0442, instance_loss: 0.5092, weighted_loss: 0.8837, label: 0, bag_size: 4263
batch 39, loss: 0.2352, instance_loss: 0.3093, weighted_loss: 0.2575, label: 0, bag_size: 8614


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.19946808510638298: correct 75/376
Epoch: 28, train_loss: 0.6328, train_clustering_loss:  0.4251, train_error: 0.2766
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.5, correct 5/10
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.6495, val_error: 0.6364, auc: 0.6979
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.3717, instance_loss: 0.6227, weighted_loss: 1.1470, label: 2, bag_size: 7812
batch 39, loss: 0.2169, instance_loss: 0.3405, weighted_loss: 0.2540, label: 0, bag_size: 2826


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.1276595744680851: correct 48/376
Epoch: 29, train_loss: 0.5244, train_clustering_loss:  0.4194, train_error: 0.1277
class 0: acc 1.0, correct 11/11
class 1: acc 1.0, correct 12/12
class 2: acc 0.5, correct 5/10
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.4672, val_error: 0.5455, auc: 0.7604
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.7107, instance_loss: 0.4863, weighted_loss: 0.6434, label: 2, bag_size: 4715
batch 39, loss: 0.5324, instance_loss: 0.7042, weighted_loss: 0.5839, label: 1, bag_size: 7240


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.10106382978723404: correct 38/376
Epoch: 30, train_loss: 0.5108, train_clustering_loss:  0.4229, train_error: 0.0851
class 0: acc 0.9, correct 18/20
class 1: acc 1.0, correct 7/7
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.7935, val_error: 0.8182, auc: 0.6701
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.1427, instance_loss: 0.3333, weighted_loss: 0.1998, label: 1, bag_size: 3328
batch 39, loss: 0.5812, instance_loss: 0.5258, weighted_loss: 0.5646, label: 1, bag_size: 1540


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.16489361702127658: correct 62/376
Epoch: 31, train_loss: 0.5745, train_clustering_loss:  0.4191, train_error: 0.2128
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.7904, val_error: 0.6364, auc: 0.6424
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.1895, instance_loss: 0.2369, weighted_loss: 0.2037, label: 3, bag_size: 3503
batch 39, loss: 0.1161, instance_loss: 0.2007, weighted_loss: 0.1415, label: 3, bag_size: 3503


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.23404255319148937: correct 88/376
Epoch: 32, train_loss: 0.5108, train_clustering_loss:  0.3929, train_error: 0.1064
class 0: acc 0.8947368421052632, correct 17/19
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.6, correct 3/5
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.6857, val_error: 0.6364, auc: 0.6528
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.2756, instance_loss: 0.3156, weighted_loss: 0.2876, label: 0, bag_size: 1225
batch 39, loss: 0.0259, instance_loss: 0.1236, weighted_loss: 0.0552, label: 3, bag_size: 5428


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.27393617021276595: correct 103/376
Epoch: 33, train_loss: 0.4765, train_clustering_loss:  0.3820, train_error: 0.1702
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.8823529411764706, correct 15/17

Val Set, val_loss: 1.7937, val_error: 0.6364, auc: 0.6215
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.4548, instance_loss: 0.4625, weighted_loss: 0.4571, label: 2, bag_size: 7427
batch 39, loss: 0.1548, instance_loss: 0.5925, weighted_loss: 0.2861, label: 1, bag_size: 7240


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.21010638297872342: correct 79/376
Epoch: 34, train_loss: 0.4788, train_clustering_loss:  0.3965, train_error: 0.1277
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.8244, val_error: 0.7273, auc: 0.6111
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.1163, instance_loss: 0.2112, weighted_loss: 0.1447, label: 3, bag_size: 1534
batch 39, loss: 0.2225, instance_loss: 0.3385, weighted_loss: 0.2573, label: 0, bag_size: 3058


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.22872340425531915: correct 86/376
Epoch: 35, train_loss: 0.4509, train_clustering_loss:  0.3935, train_error: 0.0851
class 0: acc 1.0, correct 10/10
class 1: acc 1.0, correct 8/8
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.7040, val_error: 0.5455, auc: 0.6771
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.2003, instance_loss: 0.4654, weighted_loss: 0.2798, label: 1, bag_size: 1540
batch 39, loss: 0.3712, instance_loss: 0.5976, weighted_loss: 0.4392, label: 1, bag_size: 7240


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.2526595744680851: correct 95/376
Epoch: 36, train_loss: 0.4604, train_clustering_loss:  0.3953, train_error: 0.1489
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.9111, val_error: 0.6364, auc: 0.5903
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0628, instance_loss: 0.2725, weighted_loss: 0.1257, label: 1, bag_size: 1540
batch 39, loss: 0.9352, instance_loss: 0.4408, weighted_loss: 0.7869, label: 1, bag_size: 7035


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.3377659574468085: correct 127/376
Epoch: 37, train_loss: 0.4594, train_clustering_loss:  0.3617, train_error: 0.1702
class 0: acc 0.5, correct 4/8
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8125, correct 13/16
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.8259, val_error: 0.5455, auc: 0.6771
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.6591, instance_loss: 0.5267, weighted_loss: 0.6194, label: 3, bag_size: 1249
batch 39, loss: 0.0242, instance_loss: 0.0942, weighted_loss: 0.0452, label: 3, bag_size: 1422


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.4095744680851064: correct 154/376
Epoch: 38, train_loss: 0.3056, train_clustering_loss:  0.3174, train_error: 0.0638
class 0: acc 1.0, correct 11/11
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 1.7121, val_error: 0.5455, auc: 0.7083
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.1204, instance_loss: 0.1750, weighted_loss: 0.1368, label: 3, bag_size: 3503
batch 39, loss: 0.1633, instance_loss: 0.2350, weighted_loss: 0.1848, label: 0, bag_size: 4903


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.39361702127659576: correct 148/376
Epoch: 39, train_loss: 0.2895, train_clustering_loss:  0.3359, train_error: 0.0213
class 0: acc 1.0, correct 15/15
class 1: acc 1.0, correct 11/11
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.7663, val_error: 0.8182, auc: 0.6632
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 2.0595, instance_loss: 0.6602, weighted_loss: 1.6397, label: 0, bag_size: 4046
batch 39, loss: 0.4907, instance_loss: 0.4229, weighted_loss: 0.4703, label: 2, bag_size: 4715


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.3882978723404255: correct 146/376
Epoch: 40, train_loss: 0.4797, train_clustering_loss:  0.3767, train_error: 0.2128
class 0: acc 0.8, correct 8/10
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.6, correct 6/10
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.9296, val_error: 0.7273, auc: 0.6076
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.9230, instance_loss: 0.5592, weighted_loss: 0.8139, label: 2, bag_size: 602
batch 39, loss: 0.0810, instance_loss: 0.1746, weighted_loss: 0.1091, label: 3, bag_size: 3366


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.4148936170212766: correct 156/376
Epoch: 41, train_loss: 0.3418, train_clustering_loss:  0.3391, train_error: 0.1064
class 0: acc 0.9, correct 9/10
class 1: acc 1.0, correct 12/12
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.6690, val_error: 0.6364, auc: 0.6111
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.0592, instance_loss: 0.1376, weighted_loss: 0.0827, label: 3, bag_size: 1534
batch 39, loss: 0.2067, instance_loss: 0.2775, weighted_loss: 0.2279, label: 2, bag_size: 7427


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.3962765957446808: correct 149/376
Epoch: 42, train_loss: 0.3170, train_clustering_loss:  0.3282, train_error: 0.0213
class 0: acc 1.0, correct 8/8
class 1: acc 1.0, correct 8/8
class 2: acc 1.0, correct 17/17
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.8814, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.1865, instance_loss: 0.2515, weighted_loss: 0.2060, label: 1, bag_size: 5301
batch 39, loss: 0.0196, instance_loss: 0.0700, weighted_loss: 0.0347, label: 3, bag_size: 5428


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.4867021276595745: correct 183/376
Epoch: 43, train_loss: 0.3552, train_clustering_loss:  0.3233, train_error: 0.1064
class 0: acc 0.75, correct 6/8
class 1: acc 1.0, correct 16/16
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.6640, val_error: 0.4545, auc: 0.7812
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.3353, instance_loss: 0.3022, weighted_loss: 0.3253, label: 3, bag_size: 5854
batch 39, loss: 0.2325, instance_loss: 0.2994, weighted_loss: 0.2526, label: 0, bag_size: 1452


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.43882978723404253: correct 165/376
Epoch: 44, train_loss: 0.3003, train_clustering_loss:  0.3223, train_error: 0.0851
class 0: acc 1.0, correct 14/14
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.5712, val_error: 0.4545, auc: 0.7500
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.1261, instance_loss: 0.1873, weighted_loss: 0.1445, label: 0, bag_size: 1225
batch 39, loss: 0.1601, instance_loss: 0.2387, weighted_loss: 0.1837, label: 0, bag_size: 460


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.5186170212765957: correct 195/376
Epoch: 45, train_loss: 0.2849, train_clustering_loss:  0.3086, train_error: 0.0851
class 0: acc 1.0, correct 16/16
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.7, correct 7/10
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 2.2991, val_error: 0.7273, auc: 0.6146
class 0 clustering acc 0.9204545454545454: correct 324/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.1522, instance_loss: 0.4260, weighted_loss: 0.2343, label: 1, bag_size: 4646
batch 39, loss: 0.1077, instance_loss: 0.2801, weighted_loss: 0.1594, label: 2, bag_size: 7427


class 0 clustering acc 0.9847074468085106: correct 1481/1504
class 1 clustering acc 0.425531914893617: correct 160/376
Epoch: 46, train_loss: 0.3151, train_clustering_loss:  0.3668, train_error: 0.0213
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.8321, val_error: 0.7273, auc: 0.6597
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0372, instance_loss: 0.0989, weighted_loss: 0.0558, label: 3, bag_size: 1720
batch 39, loss: 0.3981, instance_loss: 0.3198, weighted_loss: 0.3746, label: 3, bag_size: 6888


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.48138297872340424: correct 181/376
Epoch: 47, train_loss: 0.3241, train_clustering_loss:  0.3189, train_error: 0.1064
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.5086, val_error: 0.4545, auc: 0.6944
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.4628, instance_loss: 0.4249, weighted_loss: 0.4514, label: 0, bag_size: 3323
batch 39, loss: 0.0189, instance_loss: 0.0718, weighted_loss: 0.0348, label: 1, bag_size: 3328


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.4734042553191489: correct 178/376
Epoch: 48, train_loss: 0.2920, train_clustering_loss:  0.3055, train_error: 0.1064
class 0: acc 1.0, correct 11/11
class 1: acc 0.75, correct 12/16
class 2: acc 0.8333333333333334, correct 5/6
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 2.1017, val_error: 0.7273, auc: 0.6007
class 0 clustering acc 0.90625: correct 319/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.1518, instance_loss: 0.2442, weighted_loss: 0.1795, label: 0, bag_size: 4903
batch 39, loss: 0.2856, instance_loss: 0.2956, weighted_loss: 0.2886, label: 0, bag_size: 1040


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.42819148936170215: correct 161/376
Epoch: 49, train_loss: 0.4139, train_clustering_loss:  0.3309, train_error: 0.1915
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 1.0, correct 5/5
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 2.0651, val_error: 0.7273, auc: 0.6042
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.0530, instance_loss: 0.1330, weighted_loss: 0.0770, label: 3, bag_size: 3366
batch 39, loss: 0.2827, instance_loss: 0.2517, weighted_loss: 0.2734, label: 1, bag_size: 1617


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.5638297872340425: correct 212/376
Epoch: 50, train_loss: 0.2434, train_clustering_loss:  0.2637, train_error: 0.0851
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.7178, val_error: 0.5455, auc: 0.6319
class 0 clustering acc 0.9034090909090909: correct 318/352
class 1 clustering acc 0.26136363636363635: correct 23/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 43 out of 20


batch 19, loss: 1.4443, instance_loss: 0.7558, weighted_loss: 1.2378, label: 2, bag_size: 3753
batch 39, loss: 0.1094, instance_loss: 0.1775, weighted_loss: 0.1298, label: 3, bag_size: 3503


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.6675531914893617: correct 251/376
Epoch: 51, train_loss: 0.1834, train_clustering_loss:  0.2269, train_error: 0.0213
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 12/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.8133, val_error: 0.6364, auc: 0.6493
class 0 clustering acc 0.9005681818181818: correct 317/352
class 1 clustering acc 0.25: correct 22/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 44 out of 20
Early stopping
Val error: 0.7273, ROC AUC: 0.7188
Test error: 0.8182, ROC AUC: 0.6493
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3

Training Fold 9!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6245, instance_loss: 1.1035, weighted_loss: 1.4682, label: 0, bag_size: 3642
batch 39, loss: 2.3138, instance_loss: 0.9391, weighted_loss: 1.9014, label: 1, bag_size: 3328


class 0 clustering acc 0.9042553191489362: correct 1360/1504
class 1 clustering acc 0.17287234042553193: correct 65/376
Epoch: 0, train_loss: 1.3725, train_clustering_loss:  1.0122, train_error: 0.5319
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/9
class 2: acc 0.0, correct 0/6
class 3: acc 0.9565217391304348, correct 22/23

Val Set, val_loss: 1.4802, val_error: 0.7273, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.480194).  Saving model ...


batch 19, loss: 0.9484, instance_loss: 0.6914, weighted_loss: 0.8713, label: 3, bag_size: 1422
batch 39, loss: 1.2571, instance_loss: 0.7181, weighted_loss: 1.0954, label: 1, bag_size: 4010


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4062, train_clustering_loss:  0.7588, train_error: 0.7021
class 0: acc 0.0, correct 0/7
class 1: acc 0.0, correct 0/15
class 2: acc 0.0, correct 0/11
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.3931, val_error: 0.7273, auc: 0.8194
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.480194 --> 1.393071).  Saving model ...


batch 19, loss: 1.3714, instance_loss: 0.6120, weighted_loss: 1.1436, label: 3, bag_size: 6746
batch 39, loss: 1.1142, instance_loss: 0.6578, weighted_loss: 0.9773, label: 2, bag_size: 3753


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3960, train_clustering_loss:  0.6628, train_error: 0.7660
class 0: acc 0.0, correct 0/9
class 1: acc 0.42857142857142855, correct 6/14
class 2: acc 0.3125, correct 5/16
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4205, val_error: 0.8182, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6728, instance_loss: 0.6448, weighted_loss: 1.3644, label: 0, bag_size: 460
batch 39, loss: 1.0699, instance_loss: 0.5876, weighted_loss: 0.9252, label: 3, bag_size: 6888


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3694, train_clustering_loss:  0.6186, train_error: 0.6809
class 0: acc 0.0, correct 0/8
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.1, correct 1/10
class 3: acc 0.35294117647058826, correct 6/17

Val Set, val_loss: 1.3948, val_error: 0.7273, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1543, instance_loss: 0.5817, weighted_loss: 0.9825, label: 2, bag_size: 7812
batch 39, loss: 1.7118, instance_loss: 0.6565, weighted_loss: 1.3952, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.4568, train_clustering_loss:  0.6239, train_error: 0.9149
class 0: acc 0.2, correct 3/15
class 1: acc 0.0, correct 0/12
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3582, val_error: 0.7273, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.393071 --> 1.358210).  Saving model ...


batch 19, loss: 1.5208, instance_loss: 0.6199, weighted_loss: 1.2505, label: 0, bag_size: 3775
batch 39, loss: 1.5087, instance_loss: 0.6279, weighted_loss: 1.2445, label: 0, bag_size: 2826


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3744, train_clustering_loss:  0.6134, train_error: 0.7021
class 0: acc 0.07692307692307693, correct 1/13
class 1: acc 1.0, correct 12/12
class 2: acc 0.07692307692307693, correct 1/13
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3802, val_error: 0.7273, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5425, instance_loss: 0.6178, weighted_loss: 1.2651, label: 2, bag_size: 7812
batch 39, loss: 1.6059, instance_loss: 0.6421, weighted_loss: 1.3167, label: 3, bag_size: 1422


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3457, train_clustering_loss:  0.6145, train_error: 0.6809
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.0, correct 0/10
class 2: acc 0.2, correct 3/15
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4065, val_error: 0.8182, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1998, instance_loss: 0.5963, weighted_loss: 1.0188, label: 0, bag_size: 460
batch 39, loss: 1.1286, instance_loss: 0.5879, weighted_loss: 0.9664, label: 0, bag_size: 3775


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3186, train_clustering_loss:  0.6116, train_error: 0.5745
class 0: acc 0.5625, correct 9/16
class 1: acc 0.1, correct 1/10
class 2: acc 0.0, correct 0/5
class 3: acc 0.625, correct 10/16

Val Set, val_loss: 1.3634, val_error: 0.7273, auc: 0.8021
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.6596, instance_loss: 0.6118, weighted_loss: 1.3453, label: 2, bag_size: 4031
batch 39, loss: 1.6618, instance_loss: 0.6460, weighted_loss: 1.3571, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.3274, train_clustering_loss:  0.6093, train_error: 0.6596
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 0.0, correct 0/7
class 2: acc 0.0, correct 0/13
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.3613, val_error: 0.8182, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.1809, instance_loss: 0.5991, weighted_loss: 1.0063, label: 3, bag_size: 5428
batch 39, loss: 1.3274, instance_loss: 0.6040, weighted_loss: 1.1103, label: 1, bag_size: 3328


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2791, train_clustering_loss:  0.6032, train_error: 0.5319
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.08333333333333333, correct 1/12
class 2: acc 0.3333333333333333, correct 3/9
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.3481, val_error: 0.7273, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.358210 --> 1.348142).  Saving model ...


batch 19, loss: 1.1522, instance_loss: 0.5857, weighted_loss: 0.9822, label: 3, bag_size: 1422
batch 39, loss: 1.5840, instance_loss: 0.6397, weighted_loss: 1.3007, label: 1, bag_size: 4010


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.3221, train_clustering_loss:  0.6063, train_error: 0.5532
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.35714285714285715, correct 5/14
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.3554, val_error: 0.7273, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8093, instance_loss: 0.5818, weighted_loss: 0.7411, label: 1, bag_size: 1617
batch 39, loss: 1.2307, instance_loss: 0.5973, weighted_loss: 1.0407, label: 2, bag_size: 2966


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2373, train_clustering_loss:  0.5975, train_error: 0.5319
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.8888888888888888, correct 16/18
class 2: acc 0.08333333333333333, correct 1/12
class 3: acc 0.5, correct 2/4

Val Set, val_loss: 1.3869, val_error: 0.6364, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2565, instance_loss: 0.5916, weighted_loss: 1.0570, label: 2, bag_size: 6469
batch 39, loss: 1.3107, instance_loss: 0.6018, weighted_loss: 1.0980, label: 2, bag_size: 7812


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2746, train_clustering_loss:  0.5973, train_error: 0.6383
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.15384615384615385, correct 2/13
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.3209, val_error: 0.6364, auc: 0.7500
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.348142 --> 1.320850).  Saving model ...


batch 19, loss: 0.8398, instance_loss: 0.6067, weighted_loss: 0.7699, label: 3, bag_size: 6746
batch 39, loss: 1.3740, instance_loss: 0.5869, weighted_loss: 1.1379, label: 2, bag_size: 7812


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2737, train_clustering_loss:  0.5974, train_error: 0.6809
class 0: acc 0.2222222222222222, correct 2/9
class 1: acc 0.0, correct 0/10
class 2: acc 0.25, correct 4/16
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.3121, val_error: 0.5455, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.320850 --> 1.312098).  Saving model ...


batch 19, loss: 1.2741, instance_loss: 0.6199, weighted_loss: 1.0779, label: 0, bag_size: 460
batch 39, loss: 1.1728, instance_loss: 0.5716, weighted_loss: 0.9924, label: 3, bag_size: 941


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1979, train_clustering_loss:  0.5883, train_error: 0.4255
class 0: acc 0.375, correct 3/8
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.8125, correct 13/16
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.3308, val_error: 0.5455, auc: 0.8264
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5601, instance_loss: 0.6375, weighted_loss: 1.2833, label: 0, bag_size: 1452
batch 39, loss: 1.3389, instance_loss: 0.5975, weighted_loss: 1.1165, label: 3, bag_size: 1534


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.2534, train_clustering_loss:  0.5960, train_error: 0.5106
class 0: acc 0.38461538461538464, correct 5/13
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.2724, val_error: 0.6364, auc: 0.8160
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.312098 --> 1.272404).  Saving model ...


batch 19, loss: 1.6217, instance_loss: 0.5903, weighted_loss: 1.3123, label: 2, bag_size: 7812
batch 39, loss: 1.3810, instance_loss: 0.6008, weighted_loss: 1.1469, label: 2, bag_size: 4031


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.1300, train_clustering_loss:  0.5820, train_error: 0.3830
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.0, correct 0/11
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.2812, val_error: 0.5455, auc: 0.8368
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1384, instance_loss: 0.5927, weighted_loss: 0.9747, label: 2, bag_size: 750
batch 39, loss: 0.7396, instance_loss: 0.5153, weighted_loss: 0.6723, label: 2, bag_size: 1654


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.0049, train_clustering_loss:  0.5644, train_error: 0.2979
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.25, correct 2/8
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.2915, val_error: 0.6364, auc: 0.7743
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4506, instance_loss: 0.5871, weighted_loss: 1.1915, label: 3, bag_size: 941
batch 39, loss: 0.9386, instance_loss: 0.5164, weighted_loss: 0.8120, label: 2, bag_size: 750


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 1.0777, train_clustering_loss:  0.5739, train_error: 0.3617
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.9375, correct 15/16
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.2816, val_error: 0.5455, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.1880, instance_loss: 0.6184, weighted_loss: 1.0171, label: 0, bag_size: 1225
batch 39, loss: 2.1456, instance_loss: 0.6701, weighted_loss: 1.7029, label: 2, bag_size: 602


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 1.1327, train_clustering_loss:  0.5762, train_error: 0.4894
class 0: acc 0.4, correct 6/15
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.125, correct 1/8
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.2683, val_error: 0.7273, auc: 0.7743
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.272404 --> 1.268287).  Saving model ...


batch 19, loss: 1.4064, instance_loss: 0.5996, weighted_loss: 1.1644, label: 1, bag_size: 8645
batch 39, loss: 1.5404, instance_loss: 0.6223, weighted_loss: 1.2650, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 1.0558, train_clustering_loss:  0.5637, train_error: 0.4894
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.5, correct 6/12
class 2: acc 0.0, correct 0/8
class 3: acc 0.625, correct 10/16

Val Set, val_loss: 1.3835, val_error: 0.5455, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.8003, instance_loss: 0.6493, weighted_loss: 1.4550, label: 3, bag_size: 1249
batch 39, loss: 0.1760, instance_loss: 0.3895, weighted_loss: 0.2401, label: 3, bag_size: 5428


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 1.0680, train_clustering_loss:  0.5576, train_error: 0.4894
class 0: acc 0.5, correct 5/10
class 1: acc 0.6, correct 9/15
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.2221, val_error: 0.5455, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.268287 --> 1.222085).  Saving model ...


batch 19, loss: 1.2409, instance_loss: 0.6261, weighted_loss: 1.0565, label: 2, bag_size: 6469
batch 39, loss: 0.6547, instance_loss: 0.5050, weighted_loss: 0.6098, label: 0, bag_size: 3323


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 22, train_loss: 0.9843, train_clustering_loss:  0.5467, train_error: 0.4043
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.3, correct 3/10
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.2787, val_error: 0.6364, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2181, instance_loss: 0.6596, weighted_loss: 1.0506, label: 2, bag_size: 6469
batch 39, loss: 0.8000, instance_loss: 0.5034, weighted_loss: 0.7110, label: 3, bag_size: 3415


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 1.0023, train_clustering_loss:  0.5484, train_error: 0.5106
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.3076923076923077, correct 4/13
class 3: acc 0.5625, correct 9/16

Val Set, val_loss: 1.1598, val_error: 0.3636, auc: 0.8403
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.222085 --> 1.159754).  Saving model ...


batch 19, loss: 0.8649, instance_loss: 0.5310, weighted_loss: 0.7647, label: 2, bag_size: 7812
batch 39, loss: 0.3773, instance_loss: 0.4668, weighted_loss: 0.4042, label: 0, bag_size: 1225


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 0.9463, train_clustering_loss:  0.5453, train_error: 0.3404
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.625, correct 10/16
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.2489, val_error: 0.5455, auc: 0.7361
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1748, instance_loss: 0.5652, weighted_loss: 0.9919, label: 1, bag_size: 1617
batch 39, loss: 0.7573, instance_loss: 0.5515, weighted_loss: 0.6956, label: 1, bag_size: 1540


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 25, train_loss: 0.8324, train_clustering_loss:  0.5137, train_error: 0.3191
class 0: acc 1.0, correct 13/13
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.7, correct 7/10
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.2122, val_error: 0.5455, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1644, instance_loss: 0.3247, weighted_loss: 0.2125, label: 1, bag_size: 3328
batch 39, loss: 0.8453, instance_loss: 0.5369, weighted_loss: 0.7528, label: 1, bag_size: 1234


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 26, train_loss: 0.9450, train_clustering_loss:  0.5411, train_error: 0.3830
class 0: acc 0.75, correct 6/8
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.35714285714285715, correct 5/14
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.2739, val_error: 0.4545, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.0065, instance_loss: 0.5421, weighted_loss: 0.8671, label: 2, bag_size: 3753
batch 39, loss: 0.7411, instance_loss: 0.5392, weighted_loss: 0.6806, label: 3, bag_size: 361


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 27, train_loss: 0.8214, train_clustering_loss:  0.5237, train_error: 0.2979
class 0: acc 0.75, correct 9/12
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.2606, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.9738, instance_loss: 0.5453, weighted_loss: 0.8453, label: 0, bag_size: 4263
batch 39, loss: 0.7387, instance_loss: 0.4678, weighted_loss: 0.6574, label: 2, bag_size: 1654


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 28, train_loss: 0.7821, train_clustering_loss:  0.5085, train_error: 0.3191
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.3194, val_error: 0.5455, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.1690, instance_loss: 0.6266, weighted_loss: 1.0063, label: 2, bag_size: 602
batch 39, loss: 0.5043, instance_loss: 0.4323, weighted_loss: 0.4827, label: 2, bag_size: 7427


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 29, train_loss: 0.7003, train_clustering_loss:  0.4842, train_error: 0.2340
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.9, correct 9/10
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.1641, val_error: 0.5455, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.2520, instance_loss: 0.3442, weighted_loss: 0.2797, label: 3, bag_size: 6746
batch 39, loss: 0.4653, instance_loss: 0.4587, weighted_loss: 0.4633, label: 2, bag_size: 6477


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 30, train_loss: 0.7028, train_clustering_loss:  0.4927, train_error: 0.1277
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.75, correct 6/8
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.2479, val_error: 0.4545, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.7605, instance_loss: 0.5332, weighted_loss: 0.6923, label: 1, bag_size: 4010
batch 39, loss: 0.4534, instance_loss: 0.5213, weighted_loss: 0.4738, label: 1, bag_size: 1540


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.018617021276595744: correct 7/376
Epoch: 31, train_loss: 0.6665, train_clustering_loss:  0.4585, train_error: 0.2979
class 0: acc 0.9, correct 18/20
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.2857142857142857, correct 2/7
class 3: acc 0.8571428571428571, correct 6/7

Val Set, val_loss: 1.3030, val_error: 0.4545, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.0483, instance_loss: 0.6169, weighted_loss: 0.9189, label: 3, bag_size: 1249
batch 39, loss: 0.7860, instance_loss: 0.4614, weighted_loss: 0.6886, label: 3, bag_size: 1249


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.023936170212765957: correct 9/376
Epoch: 32, train_loss: 0.6434, train_clustering_loss:  0.4704, train_error: 0.2128
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.75, correct 9/12
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.2435, val_error: 0.5455, auc: 0.7361
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5450, instance_loss: 0.3586, weighted_loss: 0.4891, label: 0, bag_size: 1225
batch 39, loss: 1.4076, instance_loss: 0.7092, weighted_loss: 1.1981, label: 2, bag_size: 2966


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.034574468085106384: correct 13/376
Epoch: 33, train_loss: 0.6959, train_clustering_loss:  0.4536, train_error: 0.1915
class 0: acc 0.8, correct 8/10
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.5, correct 5/10
class 3: acc 1.0, correct 18/18

Val Set, val_loss: 1.1812, val_error: 0.3636, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.6901, instance_loss: 0.5205, weighted_loss: 0.6392, label: 3, bag_size: 361
batch 39, loss: 0.5135, instance_loss: 0.4777, weighted_loss: 0.5028, label: 2, bag_size: 6477


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.05851063829787234: correct 22/376
Epoch: 34, train_loss: 0.7107, train_clustering_loss:  0.4661, train_error: 0.3191
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.3332, val_error: 0.5455, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.7896, instance_loss: 0.4932, weighted_loss: 0.7007, label: 1, bag_size: 5086
batch 39, loss: 0.9141, instance_loss: 0.5274, weighted_loss: 0.7981, label: 2, bag_size: 1654


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.047872340425531915: correct 18/376
Epoch: 35, train_loss: 0.7028, train_clustering_loss:  0.4880, train_error: 0.2553
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.1984, val_error: 0.5455, auc: 0.7396
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.6305, instance_loss: 0.4688, weighted_loss: 0.5820, label: 1, bag_size: 1540
batch 39, loss: 0.6121, instance_loss: 0.5039, weighted_loss: 0.5796, label: 2, bag_size: 6477


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.0425531914893617: correct 16/376
Epoch: 36, train_loss: 0.5655, train_clustering_loss:  0.4507, train_error: 0.1489
class 0: acc 0.75, correct 9/12
class 1: acc 1.0, correct 12/12
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.1831, val_error: 0.3636, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.4256, instance_loss: 0.4055, weighted_loss: 0.4196, label: 1, bag_size: 1540
batch 39, loss: 0.1305, instance_loss: 0.2562, weighted_loss: 0.1682, label: 3, bag_size: 5428


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.0425531914893617: correct 16/376
Epoch: 37, train_loss: 0.5822, train_clustering_loss:  0.4755, train_error: 0.2553
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.6, correct 6/10
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.3464, val_error: 0.3636, auc: 0.7361
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1716, instance_loss: 0.2908, weighted_loss: 0.2073, label: 0, bag_size: 1452
batch 39, loss: 0.1320, instance_loss: 0.2374, weighted_loss: 0.1636, label: 3, bag_size: 6746


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.0851063829787234: correct 32/376
Epoch: 38, train_loss: 0.4871, train_clustering_loss:  0.4191, train_error: 0.1277
class 0: acc 1.0, correct 12/12
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.3888, val_error: 0.4545, auc: 0.7465
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.5385, instance_loss: 0.4670, weighted_loss: 0.5170, label: 3, bag_size: 1249
batch 39, loss: 0.4912, instance_loss: 0.4273, weighted_loss: 0.4720, label: 2, bag_size: 10330


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.19414893617021275: correct 73/376
Epoch: 39, train_loss: 0.4768, train_clustering_loss:  0.4168, train_error: 0.2128
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.5, correct 6/12
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.5672, val_error: 0.5455, auc: 0.7049
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.2629, instance_loss: 0.3232, weighted_loss: 0.2810, label: 2, bag_size: 7427
batch 39, loss: 0.1639, instance_loss: 0.2807, weighted_loss: 0.1989, label: 3, bag_size: 6746


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.11436170212765957: correct 43/376
Epoch: 40, train_loss: 0.5715, train_clustering_loss:  0.4605, train_error: 0.1489
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 12/12
class 2: acc 0.75, correct 12/16
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.4204, val_error: 0.4545, auc: 0.7500
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.4933, instance_loss: 0.4137, weighted_loss: 0.4694, label: 0, bag_size: 7561
batch 39, loss: 0.2586, instance_loss: 0.3776, weighted_loss: 0.2943, label: 2, bag_size: 6469


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.10904255319148937: correct 41/376
Epoch: 41, train_loss: 0.5087, train_clustering_loss:  0.4423, train_error: 0.1064
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4136, val_error: 0.4545, auc: 0.7708
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.4234, instance_loss: 0.5917, weighted_loss: 1.1739, label: 1, bag_size: 5086
batch 39, loss: 0.8385, instance_loss: 0.5652, weighted_loss: 0.7565, label: 3, bag_size: 361


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.22340425531914893: correct 84/376
Epoch: 42, train_loss: 0.4957, train_clustering_loss:  0.4153, train_error: 0.1064
class 0: acc 0.8, correct 12/15
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.4699, val_error: 0.4545, auc: 0.7708
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.1011, instance_loss: 0.5381, weighted_loss: 0.9322, label: 1, bag_size: 7035
batch 39, loss: 0.8205, instance_loss: 0.5943, weighted_loss: 0.7526, label: 2, bag_size: 2966


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.09574468085106383: correct 36/376
Epoch: 43, train_loss: 0.4893, train_clustering_loss:  0.4347, train_error: 0.1489
class 0: acc 0.75, correct 6/8
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.4587, val_error: 0.5455, auc: 0.7465
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.2611, instance_loss: 0.6429, weighted_loss: 0.3756, label: 1, bag_size: 7240
batch 39, loss: 0.1191, instance_loss: 0.2313, weighted_loss: 0.1527, label: 0, bag_size: 460


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.2632978723404255: correct 99/376
Epoch: 44, train_loss: 0.3305, train_clustering_loss:  0.3808, train_error: 0.0638
class 0: acc 1.0, correct 15/15
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.6040, val_error: 0.5455, auc: 0.7153
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.3209, instance_loss: 0.2843, weighted_loss: 0.3099, label: 1, bag_size: 1617
batch 39, loss: 0.1030, instance_loss: 0.1593, weighted_loss: 0.1199, label: 0, bag_size: 1342


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.26595744680851063: correct 100/376
Epoch: 45, train_loss: 0.3589, train_clustering_loss:  0.3985, train_error: 0.0638
class 0: acc 1.0, correct 15/15
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.4936, val_error: 0.4545, auc: 0.7257
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.2607, instance_loss: 0.4442, weighted_loss: 0.3158, label: 1, bag_size: 1234
batch 39, loss: 0.6402, instance_loss: 0.5487, weighted_loss: 0.6128, label: 3, bag_size: 361


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.2074468085106383: correct 78/376
Epoch: 46, train_loss: 0.5469, train_clustering_loss:  0.4273, train_error: 0.1915
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.4543, val_error: 0.4545, auc: 0.7153
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0287, instance_loss: 0.1926, weighted_loss: 0.0778, label: 3, bag_size: 1422
batch 39, loss: 0.2092, instance_loss: 0.3857, weighted_loss: 0.2621, label: 3, bag_size: 3415


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.31117021276595747: correct 117/376
Epoch: 47, train_loss: 0.3711, train_clustering_loss:  0.3688, train_error: 0.0851
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.4490, val_error: 0.4545, auc: 0.7396
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 1.6855, instance_loss: 0.7623, weighted_loss: 1.4085, label: 2, bag_size: 4031
batch 39, loss: 0.1263, instance_loss: 0.2903, weighted_loss: 0.1755, label: 1, bag_size: 4010


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.2393617021276596: correct 90/376
Epoch: 48, train_loss: 0.4346, train_clustering_loss:  0.3909, train_error: 0.1064
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.3951, val_error: 0.4545, auc: 0.7396
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.2299, instance_loss: 0.3628, weighted_loss: 0.2698, label: 2, bag_size: 10330
batch 39, loss: 0.5476, instance_loss: 0.4619, weighted_loss: 0.5219, label: 1, bag_size: 8645


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.2526595744680851: correct 95/376
Epoch: 49, train_loss: 0.4635, train_clustering_loss:  0.4196, train_error: 0.1702
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.75, correct 12/16
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.2970, val_error: 0.2727, auc: 0.7639
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.2195, instance_loss: 0.3412, weighted_loss: 0.2560, label: 2, bag_size: 6469
batch 39, loss: 0.0982, instance_loss: 0.1841, weighted_loss: 0.1240, label: 1, bag_size: 3328


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.22340425531914893: correct 84/376
Epoch: 50, train_loss: 0.4053, train_clustering_loss:  0.3821, train_error: 0.0213
class 0: acc 1.0, correct 10/10
class 1: acc 1.0, correct 14/14
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.6935, val_error: 0.5455, auc: 0.7153
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.2101, instance_loss: 0.4053, weighted_loss: 0.2687, label: 2, bag_size: 3753
batch 39, loss: 0.2358, instance_loss: 0.3816, weighted_loss: 0.2796, label: 3, bag_size: 1534


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.30851063829787234: correct 116/376
Epoch: 51, train_loss: 0.3938, train_clustering_loss:  0.3825, train_error: 0.0851
class 0: acc 1.0, correct 16/16
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.7142857142857143, correct 5/7
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.5927, val_error: 0.5455, auc: 0.7465
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 28 out of 20
Early stopping
Val error: 0.3636, ROC AUC: 0.8403
Test error: 0.6364, ROC AUC: 0.8333
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
finished!
end script
Completed: Wed Apr 27 18:50:33 EDT 2022
