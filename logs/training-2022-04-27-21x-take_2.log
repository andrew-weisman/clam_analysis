Started: Wed Apr 27 18:25:05 EDT 2022
[-] Unloading zlib 1.2.11  ... 
[+] Loading zlib 1.2.11  ... 
[-] Unloading gcc  7.2.0  ... 
[-] Unloading libpng 1.6.37  ... 
[+] Loading gcc  10.2.0  ... 
[+] Loading libpng 1.6.37  ... 
[-] Unloading libjpeg-turbo 2.0.6  ... 
[+] Loading libjpeg-turbo 2.0.6  ... 
[-] Unloading gcc  10.2.0  ... 
[-] Unloading libtiff libraries v 4.0.9  ... 
[+] Loading gcc  7.2.0  ... 
[+] Loading libtiff libraries v 4.0.9  ... 
[-] Unloading openjpeg  2.3.1  ... 
[+] Loading openjpeg  2.3.1  ... 
[-] Unloading SQLite 3.34.1  for gcc 4.8.5  ... 
[+] Loading SQLite 3.34.1  for gcc 4.8.5  ... 

Load Dataset
label column: label
label dictionary: {'pole': 0, 'msi': 1, 'lcn': 2, 'p53': 3}
number of classes: 4
slide-level counts:  
 0    20
1    17
2    15
3    17
Name: label, dtype: int64
Patient-LVL; Number of samples registered in class 0: 20
Slide-LVL; Number of samples registered in class 0: 20
Patient-LVL; Number of samples registered in class 1: 17
Slide-LVL; Number of samples registered in class 1: 17
Patient-LVL; Number of samples registered in class 2: 15
Slide-LVL; Number of samples registered in class 2: 15
Patient-LVL; Number of samples registered in class 3: 17
Slide-LVL; Number of samples registered in class 3: 17
split_dir:  splits/idibell_100
################# Settings ###################
num_splits:  10
k_start:  -1
k_end:  -1
task:  idibell
max_epochs:  200
results_dir:  /home/weismanal/projects/idibell/repo/results/21x/bwh_resection/training
lr:  0.0002
experiment:  2022-04-27-take_2-21x
reg:  1e-05
label_frac:  1.0
bag_loss:  ce
seed:  1
model_type:  clam_sb
model_size:  small
use_drop_out:  True
weighted_sample:  True
opt:  adam
bag_weight:  0.7
inst_loss:  svm
B:  8
split_dir:  splits/idibell_100

Training Fold 0!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 0.9172, instance_loss: 0.9993, weighted_loss: 0.9418, label: 2, bag_size: 28856
batch 39, loss: 1.8296, instance_loss: 0.9339, weighted_loss: 1.5609, label: 1, bag_size: 6021


class 0 clustering acc 0.9461436170212766: correct 1423/1504
class 1 clustering acc 0.04521276595744681: correct 17/376
Epoch: 0, train_loss: 1.4058, train_clustering_loss:  1.0239, train_error: 0.6596
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/9
class 2: acc 1.0, correct 16/16
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.4457, val_error: 0.8182, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.445727).  Saving model ...


batch 19, loss: 1.2892, instance_loss: 0.7262, weighted_loss: 1.1203, label: 2, bag_size: 11341
batch 39, loss: 1.2127, instance_loss: 0.7070, weighted_loss: 1.0610, label: 1, bag_size: 12367


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4007, train_clustering_loss:  0.7435, train_error: 0.6809
class 0: acc 0.0, correct 0/11
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.2, correct 2/10
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.3668, val_error: 0.7273, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.445727 --> 1.366775).  Saving model ...


batch 19, loss: 1.5027, instance_loss: 0.6418, weighted_loss: 1.2445, label: 2, bag_size: 19134
batch 39, loss: 1.4570, instance_loss: 0.6523, weighted_loss: 1.2156, label: 2, bag_size: 14084


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3878, train_clustering_loss:  0.6378, train_error: 0.6809
class 0: acc 0.0, correct 0/11
class 1: acc 1.0, correct 14/14
class 2: acc 0.0, correct 0/10
class 3: acc 0.08333333333333333, correct 1/12

Val Set, val_loss: 1.3653, val_error: 0.5455, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.366775 --> 1.365307).  Saving model ...


batch 19, loss: 1.3610, instance_loss: 0.6290, weighted_loss: 1.1414, label: 0, bag_size: 1677
batch 39, loss: 1.9672, instance_loss: 0.6346, weighted_loss: 1.5674, label: 2, bag_size: 30302


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3598, train_clustering_loss:  0.6135, train_error: 0.6383
class 0: acc 0.0, correct 0/14
class 1: acc 1.0, correct 15/15
class 2: acc 0.0, correct 0/7
class 3: acc 0.18181818181818182, correct 2/11

Val Set, val_loss: 1.3668, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5996, instance_loss: 0.6173, weighted_loss: 1.3049, label: 2, bag_size: 2632
batch 39, loss: 1.6650, instance_loss: 0.6131, weighted_loss: 1.3495, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3926, train_clustering_loss:  0.6087, train_error: 0.6809
class 0: acc 1.0, correct 14/14
class 1: acc 0.0, correct 0/10
class 2: acc 0.0, correct 0/11
class 3: acc 0.08333333333333333, correct 1/12

Val Set, val_loss: 1.3633, val_error: 0.7273, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.365307 --> 1.363273).  Saving model ...


batch 19, loss: 1.6377, instance_loss: 0.5953, weighted_loss: 1.3250, label: 0, bag_size: 18417
batch 39, loss: 1.6339, instance_loss: 0.6199, weighted_loss: 1.3297, label: 0, bag_size: 3710


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3398, train_clustering_loss:  0.6087, train_error: 0.7021
class 0: acc 0.0, correct 0/8
class 1: acc 0.75, correct 12/16
class 2: acc 0.13333333333333333, correct 2/15
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4072, val_error: 0.7273, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2303, instance_loss: 0.6146, weighted_loss: 1.0456, label: 2, bag_size: 2632
batch 39, loss: 1.5311, instance_loss: 0.6067, weighted_loss: 1.2538, label: 2, bag_size: 11341


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3287, train_clustering_loss:  0.6043, train_error: 0.6809
class 0: acc 0.0, correct 0/13
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.0, correct 0/8
class 3: acc 0.6666666666666666, correct 10/15

Val Set, val_loss: 1.3708, val_error: 0.7273, auc: 0.5556
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0151, instance_loss: 0.6087, weighted_loss: 0.8932, label: 0, bag_size: 1677
batch 39, loss: 1.0444, instance_loss: 0.6184, weighted_loss: 0.9166, label: 0, bag_size: 18417


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2899, train_clustering_loss:  0.6090, train_error: 0.5745
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.0, correct 0/12
class 3: acc 0.14285714285714285, correct 1/7

Val Set, val_loss: 1.4053, val_error: 0.7273, auc: 0.5799
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7703, instance_loss: 0.5639, weighted_loss: 0.7084, label: 0, bag_size: 15101
batch 39, loss: 2.0095, instance_loss: 0.6788, weighted_loss: 1.6103, label: 3, bag_size: 17024


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2243, train_clustering_loss:  0.6016, train_error: 0.5532
class 0: acc 1.0, correct 18/18
class 1: acc 0.0, correct 0/11
class 2: acc 0.25, correct 3/12
class 3: acc 0.0, correct 0/6

Val Set, val_loss: 1.4471, val_error: 0.7273, auc: 0.4965
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.0401, instance_loss: 0.5797, weighted_loss: 0.9020, label: 1, bag_size: 15079
batch 39, loss: 1.2378, instance_loss: 0.5766, weighted_loss: 1.0394, label: 1, bag_size: 6021


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.1881, train_clustering_loss:  0.5943, train_error: 0.5319
class 0: acc 0.125, correct 1/8
class 1: acc 0.3333333333333333, correct 5/15
class 2: acc 0.8421052631578947, correct 16/19
class 3: acc 0.0, correct 0/5

Val Set, val_loss: 1.5274, val_error: 0.7273, auc: 0.5243
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.6796, instance_loss: 0.5341, weighted_loss: 0.6359, label: 2, bag_size: 11341
batch 39, loss: 1.6512, instance_loss: 0.5857, weighted_loss: 1.3315, label: 1, bag_size: 12367


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2313, train_clustering_loss:  0.5979, train_error: 0.5745
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7647058823529411, correct 13/17
class 3: acc 0.16666666666666666, correct 2/12

Val Set, val_loss: 1.4969, val_error: 0.8182, auc: 0.5000
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.8887, instance_loss: 0.6016, weighted_loss: 0.8026, label: 0, bag_size: 4729
batch 39, loss: 0.7813, instance_loss: 0.5885, weighted_loss: 0.7235, label: 3, bag_size: 20225


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.1895, train_clustering_loss:  0.5911, train_error: 0.4681
class 0: acc 0.875, correct 14/16
class 1: acc 0.4, correct 6/15
class 2: acc 0.375, correct 3/8
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.4523, val_error: 0.8182, auc: 0.3819
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.0842, instance_loss: 0.6202, weighted_loss: 0.9450, label: 3, bag_size: 6377
batch 39, loss: 1.3013, instance_loss: 0.6047, weighted_loss: 1.0923, label: 2, bag_size: 2632


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.1601, train_clustering_loss:  0.5862, train_error: 0.5106
class 0: acc 0.3, correct 3/10
class 1: acc 0.8125, correct 13/16
class 2: acc 0.1111111111111111, correct 1/9
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.4945, val_error: 0.8182, auc: 0.4236
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.7518, instance_loss: 0.6724, weighted_loss: 1.4280, label: 2, bag_size: 19134
batch 39, loss: 1.1973, instance_loss: 0.6419, weighted_loss: 1.0307, label: 2, bag_size: 2632


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.0941, train_clustering_loss:  0.5815, train_error: 0.4043
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.6, correct 6/10
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.4688, val_error: 0.7273, auc: 0.5035
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.1094, instance_loss: 0.5672, weighted_loss: 0.9467, label: 0, bag_size: 1677
batch 39, loss: 0.8784, instance_loss: 0.5390, weighted_loss: 0.7766, label: 3, bag_size: 26172


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.0370, train_clustering_loss:  0.5668, train_error: 0.4468
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.8888888888888888, correct 16/18
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.5293, val_error: 0.9091, auc: 0.4444
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.0833, instance_loss: 0.5892, weighted_loss: 0.9351, label: 0, bag_size: 5626
batch 39, loss: 0.8644, instance_loss: 0.4887, weighted_loss: 0.7517, label: 3, bag_size: 39178


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 0.9771, train_clustering_loss:  0.5539, train_error: 0.3617
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.4, correct 4/10
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.4212, val_error: 0.7273, auc: 0.5972
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.7724, instance_loss: 0.5364, weighted_loss: 0.7016, label: 2, bag_size: 2632
batch 39, loss: 1.4043, instance_loss: 0.6522, weighted_loss: 1.1787, label: 0, bag_size: 15101


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 0.9433, train_clustering_loss:  0.5516, train_error: 0.3191
class 0: acc 0.3, correct 3/10
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.6026, val_error: 0.8182, auc: 0.4097
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.3842, instance_loss: 0.4329, weighted_loss: 0.3988, label: 3, bag_size: 11206
batch 39, loss: 0.9194, instance_loss: 0.6023, weighted_loss: 0.8243, label: 0, bag_size: 14055


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 0.8297, train_clustering_loss:  0.5382, train_error: 0.1702
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.9, correct 9/10
class 2: acc 0.8235294117647058, correct 14/17
class 3: acc 0.5714285714285714, correct 4/7

Val Set, val_loss: 1.6959, val_error: 0.8182, auc: 0.4583
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.5637, instance_loss: 0.6390, weighted_loss: 1.2863, label: 3, bag_size: 26172
batch 39, loss: 0.3126, instance_loss: 0.4433, weighted_loss: 0.3518, label: 3, bag_size: 11206


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.7910, train_clustering_loss:  0.5174, train_error: 0.2553
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 1.0, correct 9/9
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.6252, val_error: 0.8182, auc: 0.4792
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.1154, instance_loss: 0.6226, weighted_loss: 0.9676, label: 0, bag_size: 18417
batch 39, loss: 1.0890, instance_loss: 0.5750, weighted_loss: 0.9348, label: 3, bag_size: 21991


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 0.7966, train_clustering_loss:  0.5198, train_error: 0.2766
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.9, correct 9/10
class 2: acc 0.5714285714285714, correct 8/14
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.6817, val_error: 0.8182, auc: 0.4896
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 2.1954, instance_loss: 0.6969, weighted_loss: 1.7459, label: 3, bag_size: 6572
batch 39, loss: 0.7037, instance_loss: 0.5041, weighted_loss: 0.6438, label: 0, bag_size: 14952


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 0.8439, train_clustering_loss:  0.5179, train_error: 0.2766
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.6481, val_error: 0.8182, auc: 0.4965
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.3653, instance_loss: 0.6362, weighted_loss: 1.1466, label: 3, bag_size: 4443
batch 39, loss: 0.2892, instance_loss: 0.3316, weighted_loss: 0.3019, label: 1, bag_size: 15079


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.015957446808510637: correct 6/376
Epoch: 21, train_loss: 0.6955, train_clustering_loss:  0.4820, train_error: 0.1915
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 1.0, correct 18/18
class 2: acc 0.7, correct 7/10
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.5997, val_error: 0.8182, auc: 0.5938
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 1.4004, instance_loss: 0.6893, weighted_loss: 1.1871, label: 3, bag_size: 6377
batch 39, loss: 0.4662, instance_loss: 0.4476, weighted_loss: 0.4606, label: 2, bag_size: 40177


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.034574468085106384: correct 13/376
Epoch: 22, train_loss: 0.7570, train_clustering_loss:  0.4990, train_error: 0.2979
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 1.0, correct 15/15
class 2: acc 0.5, correct 4/8
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.4813, val_error: 0.6364, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.1003, instance_loss: 0.6666, weighted_loss: 0.9702, label: 3, bag_size: 6377
batch 39, loss: 1.3368, instance_loss: 0.5638, weighted_loss: 1.1049, label: 0, bag_size: 14436


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 23, train_loss: 0.6711, train_clustering_loss:  0.4886, train_error: 0.2128
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.5768, val_error: 0.5455, auc: 0.5278
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.6645, instance_loss: 0.5008, weighted_loss: 0.6154, label: 2, bag_size: 2632
batch 39, loss: 0.4253, instance_loss: 0.5294, weighted_loss: 0.4566, label: 0, bag_size: 2928


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 0.6166, train_clustering_loss:  0.4696, train_error: 0.1702
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.875, correct 7/8
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.5116, val_error: 0.6364, auc: 0.5729
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.1153, instance_loss: 0.2491, weighted_loss: 0.1554, label: 0, bag_size: 4729
batch 39, loss: 0.5775, instance_loss: 0.4683, weighted_loss: 0.5447, label: 1, bag_size: 5424


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.010638297872340425: correct 4/376
Epoch: 25, train_loss: 0.5510, train_clustering_loss:  0.4457, train_error: 0.1489
class 0: acc 1.0, correct 14/14
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 13/13
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.6695, val_error: 0.8182, auc: 0.5556
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.3593, instance_loss: 0.3537, weighted_loss: 0.3576, label: 1, bag_size: 6021
batch 39, loss: 0.2390, instance_loss: 0.3356, weighted_loss: 0.2680, label: 1, bag_size: 17691


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.02925531914893617: correct 11/376
Epoch: 26, train_loss: 0.5378, train_clustering_loss:  0.4343, train_error: 0.0851
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 1.0, correct 11/11
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.7825, val_error: 0.8182, auc: 0.5556
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.2657, instance_loss: 0.3894, weighted_loss: 0.3028, label: 2, bag_size: 14084
batch 39, loss: 0.9931, instance_loss: 0.6497, weighted_loss: 0.8901, label: 3, bag_size: 1295


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.07446808510638298: correct 28/376
Epoch: 27, train_loss: 0.5296, train_clustering_loss:  0.4353, train_error: 0.1915
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 1.0, correct 9/9
class 2: acc 1.0, correct 13/13
class 3: acc 0.38461538461538464, correct 5/13

Val Set, val_loss: 1.7210, val_error: 0.6364, auc: 0.5764
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.5737, instance_loss: 0.3244, weighted_loss: 0.4989, label: 0, bag_size: 16555
batch 39, loss: 0.2380, instance_loss: 0.2943, weighted_loss: 0.2549, label: 0, bag_size: 14055


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.10372340425531915: correct 39/376
Epoch: 28, train_loss: 0.4610, train_clustering_loss:  0.4142, train_error: 0.1277
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.7, correct 7/10
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.7170, val_error: 0.7273, auc: 0.5799
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.5358, instance_loss: 0.4954, weighted_loss: 0.5237, label: 3, bag_size: 21991
batch 39, loss: 0.5317, instance_loss: 0.4642, weighted_loss: 0.5115, label: 2, bag_size: 28856


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.1622340425531915: correct 61/376
Epoch: 29, train_loss: 0.4800, train_clustering_loss:  0.4241, train_error: 0.1277
class 0: acc 0.8, correct 8/10
class 1: acc 1.0, correct 13/13
class 2: acc 0.75, correct 6/8
class 3: acc 0.875, correct 14/16

Val Set, val_loss: 1.7609, val_error: 0.5455, auc: 0.5660
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.4890, instance_loss: 0.5807, weighted_loss: 0.5165, label: 2, bag_size: 19134
batch 39, loss: 0.2186, instance_loss: 0.2385, weighted_loss: 0.2245, label: 0, bag_size: 14952


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.11702127659574468: correct 44/376
Epoch: 30, train_loss: 0.4449, train_clustering_loss:  0.4198, train_error: 0.0851
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 4/4
class 2: acc 1.0, correct 12/12
class 3: acc 0.7333333333333333, correct 11/15

Val Set, val_loss: 1.7596, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0948, instance_loss: 0.2638, weighted_loss: 0.1455, label: 1, bag_size: 12367
batch 39, loss: 0.3315, instance_loss: 0.4361, weighted_loss: 0.3629, label: 1, bag_size: 5424


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.19680851063829788: correct 74/376
Epoch: 31, train_loss: 0.3547, train_clustering_loss:  0.3647, train_error: 0.1064
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 11/11
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.5970, val_error: 0.7273, auc: 0.5938
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.7756, instance_loss: 0.5485, weighted_loss: 0.7075, label: 3, bag_size: 4443
batch 39, loss: 0.5033, instance_loss: 0.5083, weighted_loss: 0.5048, label: 3, bag_size: 4443


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.22074468085106383: correct 83/376
Epoch: 32, train_loss: 0.4266, train_clustering_loss:  0.4083, train_error: 0.1277
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 13/13
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.6763, val_error: 0.7273, auc: 0.6007
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.5137, instance_loss: 0.7704, weighted_loss: 0.5907, label: 0, bag_size: 2928
batch 39, loss: 0.2023, instance_loss: 0.3434, weighted_loss: 0.2446, label: 3, bag_size: 20225


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.20212765957446807: correct 76/376
Epoch: 33, train_loss: 0.3778, train_clustering_loss:  0.3989, train_error: 0.1064
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.875, correct 7/8
class 2: acc 1.0, correct 14/14
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.5857, val_error: 0.4545, auc: 0.6597
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.1921, instance_loss: 0.4542, weighted_loss: 0.2708, label: 3, bag_size: 1295
batch 39, loss: 0.1164, instance_loss: 0.2141, weighted_loss: 0.1457, label: 0, bag_size: 14952


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.2925531914893617: correct 110/376
Epoch: 34, train_loss: 0.4183, train_clustering_loss:  0.3802, train_error: 0.1277
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.7142857142857143, correct 5/7
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.8080, val_error: 0.6364, auc: 0.5278
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.1914, instance_loss: 0.3810, weighted_loss: 0.2483, label: 1, bag_size: 19756
batch 39, loss: 0.2159, instance_loss: 0.3091, weighted_loss: 0.2439, label: 0, bag_size: 14055


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.19414893617021275: correct 73/376
Epoch: 35, train_loss: 0.3806, train_clustering_loss:  0.3891, train_error: 0.0851
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 10/10
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.8719, val_error: 0.7273, auc: 0.5069
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.1392, instance_loss: 0.2918, weighted_loss: 0.1850, label: 1, bag_size: 5424
batch 39, loss: 0.1149, instance_loss: 0.2340, weighted_loss: 0.1506, label: 0, bag_size: 14952


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.3537234042553192: correct 133/376
Epoch: 36, train_loss: 0.2515, train_clustering_loss:  0.3338, train_error: 0.0213
class 0: acc 1.0, correct 12/12
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.7770, val_error: 0.5455, auc: 0.5833
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.2640, instance_loss: 0.2413, weighted_loss: 0.2572, label: 1, bag_size: 5424
batch 39, loss: 0.1282, instance_loss: 0.1697, weighted_loss: 0.1406, label: 1, bag_size: 15079


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.4574468085106383: correct 172/376
Epoch: 37, train_loss: 0.2816, train_clustering_loss:  0.3141, train_error: 0.0638
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 1.0, correct 10/10
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.7221, val_error: 0.5455, auc: 0.5764
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.0884, instance_loss: 0.2404, weighted_loss: 0.1340, label: 0, bag_size: 5626
batch 39, loss: 0.2388, instance_loss: 0.3161, weighted_loss: 0.2620, label: 2, bag_size: 19134


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.3723404255319149: correct 140/376
Epoch: 38, train_loss: 0.2365, train_clustering_loss:  0.3180, train_error: 0.0000
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 9/9
class 2: acc 1.0, correct 14/14
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.6922, val_error: 0.5455, auc: 0.6076
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.4906, instance_loss: 0.4778, weighted_loss: 0.4868, label: 3, bag_size: 4443
batch 39, loss: 0.2928, instance_loss: 0.4901, weighted_loss: 0.3520, label: 2, bag_size: 6102


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.5106382978723404: correct 192/376
Epoch: 39, train_loss: 0.2839, train_clustering_loss:  0.3203, train_error: 0.0638
class 0: acc 0.9375, correct 15/16
class 1: acc 1.0, correct 9/9
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.8031, val_error: 0.6364, auc: 0.5694
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.3368, instance_loss: 0.3309, weighted_loss: 0.3350, label: 1, bag_size: 33605
batch 39, loss: 0.1920, instance_loss: 0.2896, weighted_loss: 0.2213, label: 2, bag_size: 19134


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.4973404255319149: correct 187/376
Epoch: 40, train_loss: 0.1970, train_clustering_loss:  0.2990, train_error: 0.0213
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 13/13
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.7836, val_error: 0.7273, auc: 0.5729
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.1083, instance_loss: 0.1896, weighted_loss: 0.1327, label: 3, bag_size: 17024
batch 39, loss: 0.0459, instance_loss: 0.2487, weighted_loss: 0.1067, label: 3, bag_size: 6377


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.4867021276595745: correct 183/376
Epoch: 41, train_loss: 0.2363, train_clustering_loss:  0.3178, train_error: 0.0851
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 1.0, correct 12/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.8823529411764706, correct 15/17

Val Set, val_loss: 1.9190, val_error: 0.5455, auc: 0.6215
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.1116, instance_loss: 0.3662, weighted_loss: 0.1880, label: 1, bag_size: 19756
batch 39, loss: 0.4992, instance_loss: 0.5365, weighted_loss: 0.5104, label: 3, bag_size: 1295


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.42021276595744683: correct 158/376
Epoch: 42, train_loss: 0.2998, train_clustering_loss:  0.3564, train_error: 0.0851
class 0: acc 0.9, correct 9/10
class 1: acc 1.0, correct 11/11
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.9241, val_error: 0.8182, auc: 0.5694
class 0 clustering acc 0.9204545454545454: correct 324/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.0653, instance_loss: 0.1244, weighted_loss: 0.0830, label: 1, bag_size: 20684
batch 39, loss: 0.0476, instance_loss: 0.1869, weighted_loss: 0.0894, label: 3, bag_size: 20225


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.5558510638297872: correct 209/376
Epoch: 43, train_loss: 0.2394, train_clustering_loss:  0.2806, train_error: 0.0638
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 1.0, correct 15/15
class 2: acc 0.875, correct 7/8
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.8833, val_error: 0.5455, auc: 0.6076
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0954, instance_loss: 0.3385, weighted_loss: 0.1683, label: 3, bag_size: 3355
batch 39, loss: 0.0417, instance_loss: 0.0944, weighted_loss: 0.0575, label: 0, bag_size: 1677


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.5425531914893617: correct 204/376
Epoch: 44, train_loss: 0.2113, train_clustering_loss:  0.3004, train_error: 0.0426
class 0: acc 1.0, correct 19/19
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 12/12
class 3: acc 0.8, correct 4/5

Val Set, val_loss: 1.7528, val_error: 0.5455, auc: 0.5660
class 0 clustering acc 0.9176136363636364: correct 323/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.0179, instance_loss: 0.1321, weighted_loss: 0.0521, label: 0, bag_size: 4729
batch 39, loss: 0.0475, instance_loss: 0.0929, weighted_loss: 0.0611, label: 0, bag_size: 5007


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.6143617021276596: correct 231/376
Epoch: 45, train_loss: 0.2948, train_clustering_loss:  0.2883, train_error: 0.0638
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 10/10
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.8848, val_error: 0.7273, auc: 0.5729
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.2058, instance_loss: 0.2840, weighted_loss: 0.2293, label: 1, bag_size: 17691
batch 39, loss: 0.3296, instance_loss: 0.5176, weighted_loss: 0.3860, label: 3, bag_size: 1295


class 0 clustering acc 0.9840425531914894: correct 1480/1504
class 1 clustering acc 0.6063829787234043: correct 228/376
Epoch: 46, train_loss: 0.2354, train_clustering_loss:  0.2792, train_error: 0.0426
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 2.0117, val_error: 0.6364, auc: 0.5347
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.0827, instance_loss: 0.1782, weighted_loss: 0.1114, label: 2, bag_size: 11341
batch 39, loss: 1.4559, instance_loss: 0.6570, weighted_loss: 1.2163, label: 0, bag_size: 14436


class 0 clustering acc 0.9827127659574468: correct 1478/1504
class 1 clustering acc 0.5558510638297872: correct 209/376
Epoch: 47, train_loss: 0.3473, train_clustering_loss:  0.3128, train_error: 0.0851
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 11/11
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.9723, val_error: 0.4545, auc: 0.5833
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.4412, instance_loss: 0.6176, weighted_loss: 0.4941, label: 2, bag_size: 5938
batch 39, loss: 0.0277, instance_loss: 0.0663, weighted_loss: 0.0393, label: 1, bag_size: 12367


class 0 clustering acc 0.973404255319149: correct 1464/1504
class 1 clustering acc 0.5425531914893617: correct 204/376
Epoch: 48, train_loss: 0.2963, train_clustering_loss:  0.3470, train_error: 0.0426
class 0: acc 1.0, correct 10/10
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 8/8
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 2.0974, val_error: 0.6364, auc: 0.5729
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 44 out of 20


batch 19, loss: 0.1790, instance_loss: 0.4878, weighted_loss: 0.2716, label: 2, bag_size: 6102
batch 39, loss: 2.1230, instance_loss: 0.9740, weighted_loss: 1.7783, label: 3, bag_size: 6572


class 0 clustering acc 0.9833776595744681: correct 1479/1504
class 1 clustering acc 0.4175531914893617: correct 157/376
Epoch: 49, train_loss: 0.3223, train_clustering_loss:  0.3546, train_error: 0.0638
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 7/7
class 2: acc 1.0, correct 9/9
class 3: acc 0.8888888888888888, correct 16/18

Val Set, val_loss: 2.1951, val_error: 0.6364, auc: 0.6250
class 0 clustering acc 0.9176136363636364: correct 323/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 45 out of 20


batch 19, loss: 0.0724, instance_loss: 0.2944, weighted_loss: 0.1390, label: 3, bag_size: 6377
batch 39, loss: 0.1592, instance_loss: 0.2144, weighted_loss: 0.1758, label: 1, bag_size: 6021


class 0 clustering acc 0.9847074468085106: correct 1481/1504
class 1 clustering acc 0.5478723404255319: correct 206/376
Epoch: 50, train_loss: 0.1973, train_clustering_loss:  0.3068, train_error: 0.0213
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.8692, val_error: 0.5455, auc: 0.5625
class 0 clustering acc 0.9147727272727273: correct 322/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 46 out of 20


batch 19, loss: 0.0206, instance_loss: 0.0921, weighted_loss: 0.0421, label: 2, bag_size: 14084
batch 39, loss: 0.0617, instance_loss: 0.1864, weighted_loss: 0.0991, label: 3, bag_size: 39178


class 0 clustering acc 0.9827127659574468: correct 1478/1504
class 1 clustering acc 0.4867021276595745: correct 183/376
Epoch: 51, train_loss: 0.2783, train_clustering_loss:  0.3410, train_error: 0.0638
class 0: acc 1.0, correct 15/15
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 9/9
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.7885, val_error: 0.5455, auc: 0.6076
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 47 out of 20
Early stopping
Val error: 0.7273, ROC AUC: 0.6597
Test error: 0.4545, ROC AUC: 0.8958
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 3/3

Training Fold 1!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6640, instance_loss: 1.1082, weighted_loss: 1.4972, label: 0, bag_size: 10695
batch 39, loss: 1.5077, instance_loss: 0.9384, weighted_loss: 1.3369, label: 1, bag_size: 6021


class 0 clustering acc 0.9481382978723404: correct 1426/1504
class 1 clustering acc 0.06914893617021277: correct 26/376
Epoch: 0, train_loss: 1.4083, train_clustering_loss:  1.0538, train_error: 0.7660
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/13
class 2: acc 0.35714285714285715, correct 5/14
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.4158, val_error: 0.8182, auc: 0.5833
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.415806).  Saving model ...


batch 19, loss: 1.2154, instance_loss: 0.7431, weighted_loss: 1.0737, label: 2, bag_size: 16556
batch 39, loss: 1.1077, instance_loss: 0.6662, weighted_loss: 0.9753, label: 1, bag_size: 20684


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3827, train_clustering_loss:  0.7462, train_error: 0.6809
class 0: acc 0.0, correct 0/7
class 1: acc 0.875, correct 14/16
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.4106, val_error: 0.7273, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.415806 --> 1.410626).  Saving model ...


batch 19, loss: 1.2711, instance_loss: 0.6182, weighted_loss: 1.0752, label: 3, bag_size: 21991
batch 39, loss: 1.3353, instance_loss: 0.6303, weighted_loss: 1.1238, label: 2, bag_size: 14084


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3999, train_clustering_loss:  0.6408, train_error: 0.7021
class 0: acc 0.0, correct 0/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.0, correct 0/13
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.4004, val_error: 0.8182, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.410626 --> 1.400395).  Saving model ...


batch 19, loss: 0.9240, instance_loss: 0.5674, weighted_loss: 0.8170, label: 1, bag_size: 19756
batch 39, loss: 1.2636, instance_loss: 0.6160, weighted_loss: 1.0693, label: 2, bag_size: 19134


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3799, train_clustering_loss:  0.6167, train_error: 0.7021
class 0: acc 0.0, correct 0/8
class 1: acc 0.8235294117647058, correct 14/17
class 2: acc 0.0, correct 0/12
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3952, val_error: 0.6364, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.400395 --> 1.395233).  Saving model ...


batch 19, loss: 1.1789, instance_loss: 0.5806, weighted_loss: 0.9994, label: 3, bag_size: 4892
batch 39, loss: 1.3173, instance_loss: 0.6070, weighted_loss: 1.1042, label: 0, bag_size: 16555


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3677, train_clustering_loss:  0.6040, train_error: 0.6809
class 0: acc 0.0, correct 0/13
class 1: acc 0.0, correct 0/9
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.3333333333333333, correct 4/12

Val Set, val_loss: 1.3932, val_error: 0.7273, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.395233 --> 1.393203).  Saving model ...


batch 19, loss: 1.3401, instance_loss: 0.6131, weighted_loss: 1.1220, label: 0, bag_size: 2928
batch 39, loss: 1.7424, instance_loss: 0.6017, weighted_loss: 1.4002, label: 2, bag_size: 5938


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3143, train_clustering_loss:  0.6025, train_error: 0.6170
class 0: acc 0.5, correct 9/18
class 1: acc 0.0, correct 0/8
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.4016, val_error: 0.7273, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0697, instance_loss: 0.5386, weighted_loss: 0.9104, label: 3, bag_size: 4892
batch 39, loss: 1.0702, instance_loss: 0.5368, weighted_loss: 0.9102, label: 3, bag_size: 4892


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3241, train_clustering_loss:  0.5947, train_error: 0.6170
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.0, correct 0/9
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.3594, val_error: 0.8182, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.393203 --> 1.359372).  Saving model ...


batch 19, loss: 1.1348, instance_loss: 0.5871, weighted_loss: 0.9705, label: 1, bag_size: 19756
batch 39, loss: 1.0535, instance_loss: 0.5757, weighted_loss: 0.9102, label: 0, bag_size: 4729


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2813, train_clustering_loss:  0.5954, train_error: 0.6383
class 0: acc 0.5714285714285714, correct 8/14
class 1: acc 0.4, correct 6/15
class 2: acc 0.0, correct 0/9
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.3917, val_error: 0.9091, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1852, instance_loss: 0.6064, weighted_loss: 1.0116, label: 2, bag_size: 40177
batch 39, loss: 1.0302, instance_loss: 0.5768, weighted_loss: 0.8941, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2510, train_clustering_loss:  0.5964, train_error: 0.5532
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.0, correct 0/7
class 2: acc 0.6, correct 12/20
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.4876, val_error: 0.8182, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4014, instance_loss: 0.6039, weighted_loss: 1.1621, label: 1, bag_size: 14785
batch 39, loss: 1.4007, instance_loss: 0.6396, weighted_loss: 1.1723, label: 1, bag_size: 6021


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2232, train_clustering_loss:  0.5882, train_error: 0.5319
class 0: acc 0.5714285714285714, correct 8/14
class 1: acc 0.0, correct 0/9
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.4065, val_error: 0.7273, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.1540, instance_loss: 0.5534, weighted_loss: 0.9738, label: 2, bag_size: 16556
batch 39, loss: 1.5585, instance_loss: 0.6272, weighted_loss: 1.2791, label: 1, bag_size: 20684


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.1636, train_clustering_loss:  0.5828, train_error: 0.4255
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.0, correct 0/9
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.38461538461538464, correct 5/13

Val Set, val_loss: 1.4488, val_error: 0.8182, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7377, instance_loss: 0.5582, weighted_loss: 0.6838, label: 1, bag_size: 9703
batch 39, loss: 0.4312, instance_loss: 0.5116, weighted_loss: 0.4553, label: 3, bag_size: 20225


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.0967, train_clustering_loss:  0.5804, train_error: 0.3830
class 0: acc 0.3076923076923077, correct 4/13
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.3507, val_error: 0.9091, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.359372 --> 1.350746).  Saving model ...


batch 19, loss: 1.3024, instance_loss: 0.5819, weighted_loss: 1.0862, label: 2, bag_size: 16556
batch 39, loss: 1.3978, instance_loss: 0.5918, weighted_loss: 1.1560, label: 2, bag_size: 30302


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.0017, train_clustering_loss:  0.5581, train_error: 0.4043
class 0: acc 0.25, correct 2/8
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.7333333333333333, correct 11/15

Val Set, val_loss: 1.3875, val_error: 0.7273, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5937, instance_loss: 0.4475, weighted_loss: 0.5498, label: 3, bag_size: 21991
batch 39, loss: 0.2333, instance_loss: 0.3528, weighted_loss: 0.2692, label: 3, bag_size: 4892


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 0.9403, train_clustering_loss:  0.5500, train_error: 0.3617
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.8666666666666667, correct 13/15

Val Set, val_loss: 1.3491, val_error: 0.7273, auc: 0.6701
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.350746 --> 1.349123).  Saving model ...


batch 19, loss: 1.4887, instance_loss: 0.6277, weighted_loss: 1.2304, label: 1, bag_size: 19756
batch 39, loss: 0.2050, instance_loss: 0.3301, weighted_loss: 0.2425, label: 3, bag_size: 26172


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 0.9587, train_clustering_loss:  0.5457, train_error: 0.3404
class 0: acc 0.75, correct 9/12
class 1: acc 0.5, correct 4/8
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.6875, correct 11/16

Val Set, val_loss: 1.3272, val_error: 0.8182, auc: 0.6910
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.349123 --> 1.327186).  Saving model ...


batch 19, loss: 0.7452, instance_loss: 0.5683, weighted_loss: 0.6921, label: 0, bag_size: 12821
batch 39, loss: 0.8755, instance_loss: 0.5431, weighted_loss: 0.7758, label: 1, bag_size: 33605


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.007978723404255319: correct 3/376
Epoch: 15, train_loss: 0.7472, train_clustering_loss:  0.5017, train_error: 0.2128
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.75, correct 6/8
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.4783, val_error: 0.9091, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0581, instance_loss: 0.2241, weighted_loss: 0.1079, label: 3, bag_size: 4892
batch 39, loss: 0.3267, instance_loss: 0.4366, weighted_loss: 0.3597, label: 2, bag_size: 40177


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.06648936170212766: correct 25/376
Epoch: 16, train_loss: 0.7006, train_clustering_loss:  0.4894, train_error: 0.1702
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.7647058823529411, correct 13/17
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.4898, val_error: 0.6364, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1570, instance_loss: 0.2844, weighted_loss: 0.1952, label: 3, bag_size: 11206
batch 39, loss: 3.0872, instance_loss: 0.8982, weighted_loss: 2.4305, label: 0, bag_size: 33379


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.026595744680851064: correct 10/376
Epoch: 17, train_loss: 0.7959, train_clustering_loss:  0.5194, train_error: 0.2340
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 1.0, correct 8/8
class 2: acc 0.8125, correct 13/16
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.7030, val_error: 0.9091, auc: 0.5868
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.0676, instance_loss: 0.6588, weighted_loss: 0.9450, label: 3, bag_size: 26172
batch 39, loss: 0.3836, instance_loss: 0.4052, weighted_loss: 0.3901, label: 3, bag_size: 6377


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.06648936170212766: correct 25/376
Epoch: 18, train_loss: 0.8230, train_clustering_loss:  0.5015, train_error: 0.2553
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.75, correct 9/12
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.4632, val_error: 0.6364, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.5195, instance_loss: 0.4697, weighted_loss: 0.5045, label: 0, bag_size: 4729
batch 39, loss: 0.8184, instance_loss: 0.5226, weighted_loss: 0.7296, label: 3, bag_size: 25817


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.03723404255319149: correct 14/376
Epoch: 19, train_loss: 0.7693, train_clustering_loss:  0.4798, train_error: 0.2128
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.3531, val_error: 0.5455, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0947, instance_loss: 0.2302, weighted_loss: 0.1353, label: 2, bag_size: 15369
batch 39, loss: 1.1381, instance_loss: 0.6488, weighted_loss: 0.9913, label: 2, bag_size: 25227


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.06648936170212766: correct 25/376
Epoch: 20, train_loss: 0.5774, train_clustering_loss:  0.4288, train_error: 0.1489
class 0: acc 0.9, correct 9/10
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.5341, val_error: 0.8182, auc: 0.6181
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.6018, instance_loss: 0.5000, weighted_loss: 0.5713, label: 3, bag_size: 12796
batch 39, loss: 0.0939, instance_loss: 0.2722, weighted_loss: 0.1474, label: 1, bag_size: 14785


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.11170212765957446: correct 42/376
Epoch: 21, train_loss: 0.5041, train_clustering_loss:  0.4134, train_error: 0.0851
class 0: acc 0.9, correct 9/10
class 1: acc 0.95, correct 19/20
class 2: acc 0.8333333333333334, correct 5/6
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.4184, val_error: 0.7273, auc: 0.6597
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.1233, instance_loss: 0.6585, weighted_loss: 0.9839, label: 2, bag_size: 16556
batch 39, loss: 0.4990, instance_loss: 0.4789, weighted_loss: 0.4930, label: 0, bag_size: 14055


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.2473404255319149: correct 93/376
Epoch: 22, train_loss: 0.4842, train_clustering_loss:  0.4026, train_error: 0.1277
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.3660, val_error: 0.6364, auc: 0.7118
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.5044, instance_loss: 0.3847, weighted_loss: 0.4685, label: 3, bag_size: 6377
batch 39, loss: 1.1935, instance_loss: 0.6203, weighted_loss: 1.0216, label: 1, bag_size: 28374


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.10638297872340426: correct 40/376
Epoch: 23, train_loss: 0.5834, train_clustering_loss:  0.4255, train_error: 0.1702
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.75, correct 6/8
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.4824, val_error: 0.8182, auc: 0.6701
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.1077, instance_loss: 0.5838, weighted_loss: 0.9505, label: 2, bag_size: 30302
batch 39, loss: 0.3242, instance_loss: 0.3374, weighted_loss: 0.3281, label: 1, bag_size: 9703


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.2127659574468085: correct 80/376
Epoch: 24, train_loss: 0.4556, train_clustering_loss:  0.3978, train_error: 0.0851
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 1.0, correct 10/10
class 2: acc 0.7, correct 7/10
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.2575, val_error: 0.6364, auc: 0.7431
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.327186 --> 1.257541).  Saving model ...


batch 19, loss: 0.3400, instance_loss: 0.3087, weighted_loss: 0.3306, label: 1, bag_size: 9703
batch 39, loss: 0.3353, instance_loss: 0.3638, weighted_loss: 0.3439, label: 0, bag_size: 16555


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.2074468085106383: correct 78/376
Epoch: 25, train_loss: 0.3690, train_clustering_loss:  0.3641, train_error: 0.0851
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 10/10
class 2: acc 0.75, correct 9/12
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.2626, val_error: 0.5455, auc: 0.7535
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0751, instance_loss: 0.6369, weighted_loss: 0.9436, label: 1, bag_size: 6021
batch 39, loss: 0.3039, instance_loss: 0.2562, weighted_loss: 0.2896, label: 1, bag_size: 17691


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.22872340425531915: correct 86/376
Epoch: 26, train_loss: 0.4450, train_clustering_loss:  0.3688, train_error: 0.0851
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.3738, val_error: 0.5455, auc: 0.7222
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.6177, instance_loss: 0.6000, weighted_loss: 0.6124, label: 2, bag_size: 14084
batch 39, loss: 0.2698, instance_loss: 0.3180, weighted_loss: 0.2843, label: 2, bag_size: 28856


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.22340425531914893: correct 84/376
Epoch: 27, train_loss: 0.4183, train_clustering_loss:  0.3702, train_error: 0.1489
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.875, correct 14/16
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.4656, val_error: 0.6364, auc: 0.7083
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5562, instance_loss: 0.4119, weighted_loss: 0.5129, label: 0, bag_size: 1677
batch 39, loss: 0.7928, instance_loss: 0.6157, weighted_loss: 0.7397, label: 0, bag_size: 2928


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.35638297872340424: correct 134/376
Epoch: 28, train_loss: 0.3204, train_clustering_loss:  0.3152, train_error: 0.0213
class 0: acc 1.0, correct 10/10
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 9/9
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.3561, val_error: 0.6364, auc: 0.7743
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2974, instance_loss: 0.3837, weighted_loss: 0.3233, label: 3, bag_size: 25817
batch 39, loss: 0.2149, instance_loss: 0.3733, weighted_loss: 0.2624, label: 0, bag_size: 3710


class 0 clustering acc 0.9860372340425532: correct 1483/1504
class 1 clustering acc 0.3776595744680851: correct 142/376
Epoch: 29, train_loss: 0.6190, train_clustering_loss:  0.3940, train_error: 0.1277
class 0: acc 0.8, correct 8/10
class 1: acc 0.8, correct 12/15
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.7458, val_error: 0.8182, auc: 0.6701
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.5922, instance_loss: 0.3359, weighted_loss: 0.5153, label: 3, bag_size: 21991
batch 39, loss: 0.3448, instance_loss: 0.3544, weighted_loss: 0.3477, label: 2, bag_size: 25227


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.4308510638297872: correct 162/376
Epoch: 30, train_loss: 0.2969, train_clustering_loss:  0.3122, train_error: 0.0213
class 0: acc 0.9411764705882353, correct 16/17
class 1: acc 1.0, correct 5/5
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.9694, val_error: 0.8182, auc: 0.6458
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.0998, instance_loss: 0.5168, weighted_loss: 0.9249, label: 1, bag_size: 20684
batch 39, loss: 0.2188, instance_loss: 0.3153, weighted_loss: 0.2478, label: 0, bag_size: 16555


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.4122340425531915: correct 155/376
Epoch: 31, train_loss: 0.3927, train_clustering_loss:  0.3148, train_error: 0.1064
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.4765, val_error: 0.7273, auc: 0.7222
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.1398, instance_loss: 0.2570, weighted_loss: 0.1750, label: 3, bag_size: 12796
batch 39, loss: 0.1758, instance_loss: 0.2955, weighted_loss: 0.2117, label: 3, bag_size: 12796


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.4973404255319149: correct 187/376
Epoch: 32, train_loss: 0.3397, train_clustering_loss:  0.3217, train_error: 0.0638
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 1.0, correct 9/9
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.5076, val_error: 0.5455, auc: 0.7431
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1124, instance_loss: 0.2665, weighted_loss: 0.1586, label: 1, bag_size: 9703
batch 39, loss: 0.0139, instance_loss: 0.0838, weighted_loss: 0.0349, label: 3, bag_size: 11206


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.4148936170212766: correct 156/376
Epoch: 33, train_loss: 0.3086, train_clustering_loss:  0.3209, train_error: 0.0638
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 12/12
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.6305, val_error: 0.6364, auc: 0.6771
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.2294, instance_loss: 0.2821, weighted_loss: 0.2452, label: 2, bag_size: 28856
batch 39, loss: 0.2010, instance_loss: 0.3283, weighted_loss: 0.2391, label: 2, bag_size: 25227


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.4973404255319149: correct 187/376
Epoch: 34, train_loss: 0.3126, train_clustering_loss:  0.2949, train_error: 0.0638
class 0: acc 0.8, correct 8/10
class 1: acc 1.0, correct 14/14
class 2: acc 0.9375, correct 15/16
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.3815, val_error: 0.6364, auc: 0.7535
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.0867, instance_loss: 0.2731, weighted_loss: 0.1426, label: 3, bag_size: 39178
batch 39, loss: 0.4770, instance_loss: 0.4383, weighted_loss: 0.4654, label: 0, bag_size: 33379


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.5771276595744681: correct 217/376
Epoch: 35, train_loss: 0.1895, train_clustering_loss:  0.2554, train_error: 0.0426
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 9/9
class 2: acc 0.9, correct 9/10
class 3: acc 0.9473684210526315, correct 18/19

Val Set, val_loss: 1.4500, val_error: 0.5455, auc: 0.7188
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0683, instance_loss: 0.2152, weighted_loss: 0.1124, label: 0, bag_size: 16555
batch 39, loss: 0.1926, instance_loss: 0.3434, weighted_loss: 0.2378, label: 2, bag_size: 25227


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.4654255319148936: correct 175/376
Epoch: 36, train_loss: 0.2497, train_clustering_loss:  0.3027, train_error: 0.0426
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 12/12
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.3992, val_error: 0.5455, auc: 0.7396
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0889, instance_loss: 0.3810, weighted_loss: 0.1765, label: 0, bag_size: 16555
batch 39, loss: 0.0170, instance_loss: 0.1640, weighted_loss: 0.0611, label: 3, bag_size: 20225


class 0 clustering acc 0.9833776595744681: correct 1479/1504
class 1 clustering acc 0.6303191489361702: correct 237/376
Epoch: 37, train_loss: 0.3290, train_clustering_loss:  0.2925, train_error: 0.1277
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.8, correct 8/10
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.4415, val_error: 0.6364, auc: 0.7535
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.2791, instance_loss: 0.2809, weighted_loss: 0.2797, label: 0, bag_size: 12821
batch 39, loss: 0.0548, instance_loss: 0.1049, weighted_loss: 0.0698, label: 3, bag_size: 21991


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.5452127659574468: correct 205/376
Epoch: 38, train_loss: 0.2785, train_clustering_loss:  0.2913, train_error: 0.0851
class 0: acc 0.9, correct 9/10
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 11/11
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.3603, val_error: 0.5455, auc: 0.7639
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1160, instance_loss: 0.2372, weighted_loss: 0.1524, label: 3, bag_size: 12796
batch 39, loss: 0.0474, instance_loss: 0.1465, weighted_loss: 0.0771, label: 0, bag_size: 18417


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.5372340425531915: correct 202/376
Epoch: 39, train_loss: 0.2556, train_clustering_loss:  0.2859, train_error: 0.0213
class 0: acc 0.9375, correct 15/16
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.4582, val_error: 0.6364, auc: 0.7639
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.2083, instance_loss: 0.3110, weighted_loss: 0.2391, label: 0, bag_size: 3710
batch 39, loss: 0.0543, instance_loss: 0.1226, weighted_loss: 0.0748, label: 3, bag_size: 21991


class 0 clustering acc 0.9847074468085106: correct 1481/1504
class 1 clustering acc 0.6728723404255319: correct 253/376
Epoch: 40, train_loss: 0.1647, train_clustering_loss:  0.2447, train_error: 0.0213
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 11/11
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.6771, val_error: 0.6364, auc: 0.6875
class 0 clustering acc 0.9147727272727273: correct 322/352
class 1 clustering acc 0.26136363636363635: correct 23/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1415, instance_loss: 0.2352, weighted_loss: 0.1696, label: 0, bag_size: 14952
batch 39, loss: 0.2261, instance_loss: 0.2433, weighted_loss: 0.2312, label: 3, bag_size: 6377


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.7154255319148937: correct 269/376
Epoch: 41, train_loss: 0.1652, train_clustering_loss:  0.2311, train_error: 0.0213
class 0: acc 1.0, correct 11/11
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.5322, val_error: 0.6364, auc: 0.7396
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0889, instance_loss: 0.1338, weighted_loss: 0.1023, label: 3, bag_size: 39178
batch 39, loss: 0.1349, instance_loss: 0.2045, weighted_loss: 0.1558, label: 2, bag_size: 28856


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.7340425531914894: correct 276/376
Epoch: 42, train_loss: 0.1600, train_clustering_loss:  0.2403, train_error: 0.0000
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 9/9
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 1.4728, val_error: 0.6364, auc: 0.7535
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.2727272727272727: correct 24/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.2831, instance_loss: 0.2241, weighted_loss: 0.2654, label: 1, bag_size: 17027
batch 39, loss: 0.0116, instance_loss: 0.0551, weighted_loss: 0.0246, label: 3, bag_size: 20225


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.7632978723404256: correct 287/376
Epoch: 43, train_loss: 0.1440, train_clustering_loss:  0.2085, train_error: 0.0000
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 17/17
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.5579, val_error: 0.6364, auc: 0.7396
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.3181818181818182: correct 28/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0797, instance_loss: 0.4665, weighted_loss: 0.1958, label: 3, bag_size: 3355
batch 39, loss: 0.9268, instance_loss: 0.6139, weighted_loss: 0.8330, label: 1, bag_size: 19756


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.7127659574468085: correct 268/376
Epoch: 44, train_loss: 0.1535, train_clustering_loss:  0.2327, train_error: 0.0426
class 0: acc 1.0, correct 15/15
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 9/9
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.4935, val_error: 0.6364, auc: 0.7535
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.29545454545454547: correct 26/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0389, instance_loss: 0.1219, weighted_loss: 0.0638, label: 1, bag_size: 9703
batch 39, loss: 0.0793, instance_loss: 0.2341, weighted_loss: 0.1257, label: 0, bag_size: 5626


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.7632978723404256: correct 287/376
Epoch: 45, train_loss: 0.1461, train_clustering_loss:  0.2177, train_error: 0.0426
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 9/9
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 2.1933, val_error: 0.7273, auc: 0.6840
class 0 clustering acc 0.8664772727272727: correct 305/352
class 1 clustering acc 0.25: correct 22/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.1003, instance_loss: 0.2738, weighted_loss: 0.1523, label: 1, bag_size: 17691
batch 39, loss: 0.1267, instance_loss: 0.1837, weighted_loss: 0.1438, label: 2, bag_size: 28856


class 0 clustering acc 0.9860372340425532: correct 1483/1504
class 1 clustering acc 0.7632978723404256: correct 287/376
Epoch: 46, train_loss: 0.1318, train_clustering_loss:  0.2137, train_error: 0.0213
class 0: acc 1.0, correct 8/8
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 15/15
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4787, val_error: 0.6364, auc: 0.7639
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.2840909090909091: correct 25/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0062, instance_loss: 0.0363, weighted_loss: 0.0152, label: 3, bag_size: 4892
batch 39, loss: 0.5187, instance_loss: 0.7068, weighted_loss: 0.5751, label: 1, bag_size: 28374


class 0 clustering acc 0.9813829787234043: correct 1476/1504
class 1 clustering acc 0.6808510638297872: correct 256/376
Epoch: 47, train_loss: 0.1589, train_clustering_loss:  0.2511, train_error: 0.0213
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 9/9
class 2: acc 1.0, correct 12/12
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 2.2199, val_error: 0.7273, auc: 0.6597
class 0 clustering acc 0.8892045454545454: correct 313/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.1210, instance_loss: 0.1158, weighted_loss: 0.1194, label: 2, bag_size: 40177
batch 39, loss: 0.0748, instance_loss: 0.1625, weighted_loss: 0.1011, label: 1, bag_size: 20684


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.8138297872340425: correct 306/376
Epoch: 48, train_loss: 0.0891, train_clustering_loss:  0.1935, train_error: 0.0000
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 6/6
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 2.1014, val_error: 0.8182, auc: 0.6701
class 0 clustering acc 0.9034090909090909: correct 318/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0206, instance_loss: 0.0556, weighted_loss: 0.0311, label: 0, bag_size: 18417
batch 39, loss: 0.2159, instance_loss: 0.1108, weighted_loss: 0.1844, label: 2, bag_size: 15369


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.776595744680851: correct 292/376
Epoch: 49, train_loss: 0.1326, train_clustering_loss:  0.1912, train_error: 0.0426
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 5/5
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 2.2906, val_error: 0.7273, auc: 0.6597
class 0 clustering acc 0.8977272727272727: correct 316/352
class 1 clustering acc 0.25: correct 22/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.1934, instance_loss: 0.2540, weighted_loss: 0.2115, label: 3, bag_size: 6377
batch 39, loss: 0.1262, instance_loss: 0.2222, weighted_loss: 0.1550, label: 1, bag_size: 6021


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.7712765957446809: correct 290/376
Epoch: 50, train_loss: 0.1160, train_clustering_loss:  0.2224, train_error: 0.0000
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.7831, val_error: 0.5455, auc: 0.6875
class 0 clustering acc 0.9147727272727273: correct 322/352
class 1 clustering acc 0.3068181818181818: correct 27/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.1088, instance_loss: 0.5495, weighted_loss: 0.2410, label: 2, bag_size: 14084
batch 39, loss: 0.0833, instance_loss: 0.1461, weighted_loss: 0.1022, label: 1, bag_size: 33605


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.8138297872340425: correct 306/376
Epoch: 51, train_loss: 0.1188, train_clustering_loss:  0.1954, train_error: 0.0000
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.6335, val_error: 0.5455, auc: 0.7396
class 0 clustering acc 0.9147727272727273: correct 322/352
class 1 clustering acc 0.3522727272727273: correct 31/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 27 out of 20
Early stopping
Val error: 0.6364, ROC AUC: 0.7431
Test error: 0.8182, ROC AUC: 0.5451
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3

Training Fold 2!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.3302, instance_loss: 1.0590, weighted_loss: 1.2488, label: 2, bag_size: 28856
batch 39, loss: 2.0520, instance_loss: 0.9300, weighted_loss: 1.7154, label: 1, bag_size: 15079


class 0 clustering acc 0.9335106382978723: correct 1404/1504
class 1 clustering acc 0.09308510638297872: correct 35/376
Epoch: 0, train_loss: 1.3899, train_clustering_loss:  1.0248, train_error: 0.6596
class 0: acc 0.0, correct 0/8
class 1: acc 0.0, correct 0/8
class 2: acc 0.0, correct 0/14
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.4621, val_error: 0.7273, auc: 0.5868
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.462147).  Saving model ...


batch 19, loss: 1.1732, instance_loss: 0.7503, weighted_loss: 1.0463, label: 2, bag_size: 18012
batch 39, loss: 1.4403, instance_loss: 0.6821, weighted_loss: 1.2128, label: 1, bag_size: 26697


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4039, train_clustering_loss:  0.7222, train_error: 0.7234
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/14
class 2: acc 0.08333333333333333, correct 1/12
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.3805, val_error: 0.7273, auc: 0.5938
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.462147 --> 1.380474).  Saving model ...


batch 19, loss: 1.5589, instance_loss: 0.6426, weighted_loss: 1.2840, label: 3, bag_size: 26172
batch 39, loss: 1.5779, instance_loss: 0.6537, weighted_loss: 1.3006, label: 2, bag_size: 14084


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3782, train_clustering_loss:  0.6354, train_error: 0.6809
class 0: acc 0.0, correct 0/9
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.0, correct 0/9
class 3: acc 0.4, correct 6/15

Val Set, val_loss: 1.3929, val_error: 0.7273, auc: 0.6215
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.8477, instance_loss: 0.6691, weighted_loss: 1.4941, label: 0, bag_size: 5626
batch 39, loss: 1.7129, instance_loss: 0.6636, weighted_loss: 1.3981, label: 2, bag_size: 30302


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3869, train_clustering_loss:  0.6171, train_error: 0.7234
class 0: acc 0.0, correct 0/9
class 1: acc 0.625, correct 10/16
class 2: acc 0.0, correct 0/11
class 3: acc 0.2727272727272727, correct 3/11

Val Set, val_loss: 1.3700, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.380474 --> 1.369973).  Saving model ...


batch 19, loss: 0.9971, instance_loss: 0.5943, weighted_loss: 0.8762, label: 2, bag_size: 18012
batch 39, loss: 1.2627, instance_loss: 0.6077, weighted_loss: 1.0662, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3577, train_clustering_loss:  0.6161, train_error: 0.6596
class 0: acc 0.0, correct 0/11
class 1: acc 0.5, correct 8/16
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3653, val_error: 0.7273, auc: 0.6319
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.369973 --> 1.365275).  Saving model ...


batch 19, loss: 0.8186, instance_loss: 0.5694, weighted_loss: 0.7439, label: 1, bag_size: 17691
batch 39, loss: 1.7451, instance_loss: 0.6712, weighted_loss: 1.4229, label: 0, bag_size: 15101


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3167, train_clustering_loss:  0.6165, train_error: 0.6383
class 0: acc 0.0, correct 0/9
class 1: acc 1.0, correct 16/16
class 2: acc 0.0, correct 0/9
class 3: acc 0.07692307692307693, correct 1/13

Val Set, val_loss: 1.3777, val_error: 0.7273, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0343, instance_loss: 0.6045, weighted_loss: 0.9053, label: 3, bag_size: 4892
batch 39, loss: 1.2921, instance_loss: 0.6174, weighted_loss: 1.0897, label: 2, bag_size: 18012


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3017, train_clustering_loss:  0.6271, train_error: 0.7234
class 0: acc 0.2857142857142857, correct 4/14
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.3547, val_error: 0.6364, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.365275 --> 1.354692).  Saving model ...


batch 19, loss: 0.9699, instance_loss: 0.6308, weighted_loss: 0.8682, label: 0, bag_size: 5626
batch 39, loss: 1.3693, instance_loss: 0.6002, weighted_loss: 1.1386, label: 1, bag_size: 17691


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2669, train_clustering_loss:  0.6226, train_error: 0.5957
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.3, correct 3/10
class 2: acc 0.1, correct 1/10
class 3: acc 0.16666666666666666, correct 2/12

Val Set, val_loss: 1.3418, val_error: 0.6364, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.354692 --> 1.341824).  Saving model ...


batch 19, loss: 1.3842, instance_loss: 0.6583, weighted_loss: 1.1665, label: 2, bag_size: 6102
batch 39, loss: 1.0800, instance_loss: 0.6140, weighted_loss: 0.9402, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2177, train_clustering_loss:  0.6142, train_error: 0.3617
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.0, correct 0/8
class 2: acc 0.8, correct 12/15
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.4047, val_error: 0.6364, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1333, instance_loss: 0.5896, weighted_loss: 0.9702, label: 3, bag_size: 6377
batch 39, loss: 1.0178, instance_loss: 0.5813, weighted_loss: 0.8868, label: 1, bag_size: 15079


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2092, train_clustering_loss:  0.6054, train_error: 0.4043
class 0: acc 0.3, correct 3/10
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3416, val_error: 0.8182, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.341824 --> 1.341577).  Saving model ...


batch 19, loss: 0.7857, instance_loss: 0.5355, weighted_loss: 0.7106, label: 2, bag_size: 18012
batch 39, loss: 1.3831, instance_loss: 0.6234, weighted_loss: 1.1552, label: 1, bag_size: 16680


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.1415, train_clustering_loss:  0.5931, train_error: 0.4255
class 0: acc 0.0, correct 0/7
class 1: acc 0.75, correct 9/12
class 2: acc 0.6875, correct 11/16
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.3948, val_error: 0.8182, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6989, instance_loss: 0.5335, weighted_loss: 0.6493, label: 1, bag_size: 20684
batch 39, loss: 0.7730, instance_loss: 0.5315, weighted_loss: 0.7005, label: 2, bag_size: 11341


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.0939, train_clustering_loss:  0.5888, train_error: 0.3830
class 0: acc 0.16666666666666666, correct 2/12
class 1: acc 0.8125, correct 13/16
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.3814, val_error: 0.5455, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7627, instance_loss: 0.5046, weighted_loss: 0.6853, label: 2, bag_size: 23737
batch 39, loss: 0.6367, instance_loss: 0.5168, weighted_loss: 0.6008, label: 3, bag_size: 4892


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.1307, train_clustering_loss:  0.5799, train_error: 0.4894
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.75, correct 9/12
class 2: acc 0.6, correct 6/10
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.3331, val_error: 0.6364, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.341577 --> 1.333126).  Saving model ...


batch 19, loss: 0.5291, instance_loss: 0.4856, weighted_loss: 0.5160, label: 3, bag_size: 26172
batch 39, loss: 0.1760, instance_loss: 0.4142, weighted_loss: 0.2474, label: 3, bag_size: 4892


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.1804, train_clustering_loss:  0.5819, train_error: 0.5745
class 0: acc 0.5, correct 4/8
class 1: acc 0.2, correct 2/10
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.5294117647058824, correct 9/17

Val Set, val_loss: 1.3538, val_error: 0.6364, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3172, instance_loss: 0.6350, weighted_loss: 1.1125, label: 0, bag_size: 5626
batch 39, loss: 0.7887, instance_loss: 0.5131, weighted_loss: 0.7060, label: 2, bag_size: 2078


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.0668, train_clustering_loss:  0.5601, train_error: 0.4043
class 0: acc 0.2727272727272727, correct 3/11
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8888888888888888, correct 16/18
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.3996, val_error: 0.6364, auc: 0.6910
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8466, instance_loss: 0.5317, weighted_loss: 0.7521, label: 1, bag_size: 19756
batch 39, loss: 2.2418, instance_loss: 0.7004, weighted_loss: 1.7794, label: 3, bag_size: 39178


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 0.9592, train_clustering_loss:  0.5528, train_error: 0.3617
class 0: acc 0.4375, correct 7/16
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.7, correct 7/10
class 3: acc 0.42857142857142855, correct 3/7

Val Set, val_loss: 1.3538, val_error: 0.5455, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0851, instance_loss: 0.3311, weighted_loss: 0.1589, label: 3, bag_size: 4892
batch 39, loss: 1.1415, instance_loss: 0.5915, weighted_loss: 0.9765, label: 2, bag_size: 6102


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.0447, train_clustering_loss:  0.5527, train_error: 0.4894
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.46153846153846156, correct 6/13
class 3: acc 0.625, correct 10/16

Val Set, val_loss: 1.4442, val_error: 0.5455, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.9241, instance_loss: 0.5486, weighted_loss: 0.8114, label: 2, bag_size: 2632
batch 39, loss: 0.4781, instance_loss: 0.4748, weighted_loss: 0.4771, label: 1, bag_size: 9703


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 0.9713, train_clustering_loss:  0.5412, train_error: 0.3617
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.8125, correct 13/16
class 2: acc 0.75, correct 9/12
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.3065, val_error: 0.5455, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.333126 --> 1.306538).  Saving model ...


batch 19, loss: 1.6583, instance_loss: 0.6748, weighted_loss: 1.3632, label: 3, bag_size: 3355
batch 39, loss: 0.8386, instance_loss: 0.5147, weighted_loss: 0.7414, label: 2, bag_size: 2632


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.9508, train_clustering_loss:  0.5361, train_error: 0.3404
class 0: acc 0.3, correct 3/10
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.3274, val_error: 0.5455, auc: 0.6424
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6732, instance_loss: 0.4512, weighted_loss: 0.6066, label: 1, bag_size: 6021
batch 39, loss: 1.3192, instance_loss: 0.5465, weighted_loss: 1.0874, label: 2, bag_size: 2078


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 0.8974, train_clustering_loss:  0.5234, train_error: 0.2979
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.625, correct 5/8
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.3445, val_error: 0.5455, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.5102, instance_loss: 0.6367, weighted_loss: 1.2482, label: 0, bag_size: 27370
batch 39, loss: 0.7924, instance_loss: 0.5740, weighted_loss: 0.7269, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 0.9320, train_clustering_loss:  0.5297, train_error: 0.3617
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.6, correct 6/10
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.6, correct 9/15

Val Set, val_loss: 1.3113, val_error: 0.4545, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6236, instance_loss: 0.5169, weighted_loss: 0.5916, label: 0, bag_size: 12821
batch 39, loss: 0.5292, instance_loss: 0.4491, weighted_loss: 0.5052, label: 3, bag_size: 6377


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 21, train_loss: 0.8895, train_clustering_loss:  0.5174, train_error: 0.3404
class 0: acc 0.8, correct 8/10
class 1: acc 0.7777777777777778, correct 14/18
class 2: acc 0.375, correct 3/8
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.2513, val_error: 0.6364, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.306538 --> 1.251345).  Saving model ...


batch 19, loss: 0.5197, instance_loss: 0.4744, weighted_loss: 0.5061, label: 2, bag_size: 23737
batch 39, loss: 0.6788, instance_loss: 0.5675, weighted_loss: 0.6454, label: 0, bag_size: 18417


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.02127659574468085: correct 8/376
Epoch: 22, train_loss: 0.8092, train_clustering_loss:  0.5012, train_error: 0.1915
class 0: acc 0.42857142857142855, correct 6/14
class 1: acc 1.0, correct 12/12
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.3742, val_error: 0.5455, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4013, instance_loss: 0.3741, weighted_loss: 0.3931, label: 2, bag_size: 23737
batch 39, loss: 0.9239, instance_loss: 0.4697, weighted_loss: 0.7876, label: 3, bag_size: 17024


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.010638297872340425: correct 4/376
Epoch: 23, train_loss: 0.7294, train_clustering_loss:  0.4767, train_error: 0.2128
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.75, correct 6/8
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.2312, val_error: 0.4545, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.251345 --> 1.231172).  Saving model ...


batch 19, loss: 0.1128, instance_loss: 0.2526, weighted_loss: 0.1548, label: 3, bag_size: 4892
batch 39, loss: 0.5932, instance_loss: 0.4064, weighted_loss: 0.5372, label: 1, bag_size: 6021


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.08776595744680851: correct 33/376
Epoch: 24, train_loss: 0.7202, train_clustering_loss:  0.4742, train_error: 0.1702
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.9, correct 9/10
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.1344, val_error: 0.4545, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.231172 --> 1.134397).  Saving model ...


batch 19, loss: 0.8220, instance_loss: 0.4367, weighted_loss: 0.7064, label: 1, bag_size: 20684
batch 39, loss: 0.3471, instance_loss: 0.3690, weighted_loss: 0.3536, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.09840425531914894: correct 37/376
Epoch: 25, train_loss: 0.6857, train_clustering_loss:  0.4419, train_error: 0.2128
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.8, correct 8/10
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 0.9924, val_error: 0.4545, auc: 0.8785
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.134397 --> 0.992437).  Saving model ...


batch 19, loss: 0.2916, instance_loss: 0.3310, weighted_loss: 0.3034, label: 1, bag_size: 15079
batch 39, loss: 1.3712, instance_loss: 0.5335, weighted_loss: 1.1199, label: 1, bag_size: 4747


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.07180851063829788: correct 27/376
Epoch: 26, train_loss: 0.5956, train_clustering_loss:  0.4312, train_error: 0.2128
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.3460, val_error: 0.6364, auc: 0.7153
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1969, instance_loss: 0.6168, weighted_loss: 1.0229, label: 2, bag_size: 14084
batch 39, loss: 0.5008, instance_loss: 0.3581, weighted_loss: 0.4580, label: 3, bag_size: 5751


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.08776595744680851: correct 33/376
Epoch: 27, train_loss: 0.6762, train_clustering_loss:  0.4514, train_error: 0.2128
class 0: acc 0.6, correct 6/10
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.1067, val_error: 0.4545, auc: 0.8229
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9224, instance_loss: 0.5798, weighted_loss: 0.8196, label: 0, bag_size: 5007
batch 39, loss: 0.4089, instance_loss: 0.3040, weighted_loss: 0.3774, label: 1, bag_size: 17691


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.2047872340425532: correct 77/376
Epoch: 28, train_loss: 0.6014, train_clustering_loss:  0.4176, train_error: 0.1915
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.875, correct 7/8
class 2: acc 0.9375, correct 15/16
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.4897, val_error: 0.5455, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5549, instance_loss: 0.3580, weighted_loss: 0.4958, label: 2, bag_size: 2078
batch 39, loss: 0.4255, instance_loss: 0.3957, weighted_loss: 0.4166, label: 2, bag_size: 28856


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.1196808510638298: correct 45/376
Epoch: 29, train_loss: 0.6008, train_clustering_loss:  0.4280, train_error: 0.2340
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.625, correct 5/8
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.0207, val_error: 0.3636, auc: 0.8264
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1378, instance_loss: 0.2116, weighted_loss: 0.1599, label: 2, bag_size: 19134
batch 39, loss: 0.3121, instance_loss: 0.3177, weighted_loss: 0.3138, label: 2, bag_size: 25227


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.2473404255319149: correct 93/376
Epoch: 30, train_loss: 0.5158, train_clustering_loss:  0.3819, train_error: 0.1489
class 0: acc 0.5, correct 5/10
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 1.0, correct 15/15
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.2487, val_error: 0.5455, auc: 0.7708
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.8797, instance_loss: 0.6614, weighted_loss: 1.5142, label: 1, bag_size: 26697
batch 39, loss: 0.5282, instance_loss: 0.3717, weighted_loss: 0.4812, label: 1, bag_size: 5424


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.1702127659574468: correct 64/376
Epoch: 31, train_loss: 0.5406, train_clustering_loss:  0.4196, train_error: 0.1702
class 0: acc 0.8333333333333334, correct 15/18
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.5108, val_error: 0.4545, auc: 0.7187
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.2590, instance_loss: 0.3786, weighted_loss: 0.2949, label: 0, bag_size: 12821
batch 39, loss: 0.3786, instance_loss: 0.3781, weighted_loss: 0.3784, label: 0, bag_size: 12821


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.18882978723404256: correct 71/376
Epoch: 32, train_loss: 0.5608, train_clustering_loss:  0.3909, train_error: 0.1915
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.9444444444444444, correct 17/18
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.375, correct 3/8

Val Set, val_loss: 0.9979, val_error: 0.4545, auc: 0.8646
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.3821, instance_loss: 0.3133, weighted_loss: 0.3615, label: 1, bag_size: 6021
batch 39, loss: 0.1027, instance_loss: 0.1611, weighted_loss: 0.1202, label: 2, bag_size: 11341


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.34574468085106386: correct 130/376
Epoch: 33, train_loss: 0.3879, train_clustering_loss:  0.3348, train_error: 0.0426
class 0: acc 1.0, correct 6/6
class 1: acc 1.0, correct 9/9
class 2: acc 0.8823529411764706, correct 15/17
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.0690, val_error: 0.3636, auc: 0.8021
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.4073, instance_loss: 0.3622, weighted_loss: 0.3938, label: 3, bag_size: 5751
batch 39, loss: 0.1890, instance_loss: 0.2352, weighted_loss: 0.2029, label: 2, bag_size: 25227


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.34308510638297873: correct 129/376
Epoch: 34, train_loss: 0.4571, train_clustering_loss:  0.3628, train_error: 0.1489
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.1660, val_error: 0.4545, auc: 0.7604
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5827, instance_loss: 0.6104, weighted_loss: 0.5910, label: 3, bag_size: 4443
batch 39, loss: 0.1335, instance_loss: 0.2839, weighted_loss: 0.1786, label: 1, bag_size: 9703


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.2845744680851064: correct 107/376
Epoch: 35, train_loss: 0.3995, train_clustering_loss:  0.3474, train_error: 0.1277
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.8, correct 8/10
class 2: acc 1.0, correct 11/11
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.1254, val_error: 0.4545, auc: 0.8056
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2882, instance_loss: 0.3362, weighted_loss: 0.3026, label: 1, bag_size: 5424
batch 39, loss: 0.1258, instance_loss: 0.1256, weighted_loss: 0.1258, label: 2, bag_size: 25227


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.4122340425531915: correct 155/376
Epoch: 36, train_loss: 0.4114, train_clustering_loss:  0.3343, train_error: 0.1489
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.8823529411764706, correct 15/17
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.2072, val_error: 0.5455, auc: 0.8056
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.4354, instance_loss: 0.2925, weighted_loss: 0.3925, label: 1, bag_size: 5424
batch 39, loss: 0.1683, instance_loss: 0.2832, weighted_loss: 0.2028, label: 3, bag_size: 6377


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.3377659574468085: correct 127/376
Epoch: 37, train_loss: 0.4462, train_clustering_loss:  0.3509, train_error: 0.1702
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.4783, val_error: 0.6364, auc: 0.7361
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 2.1569, instance_loss: 0.7799, weighted_loss: 1.7438, label: 1, bag_size: 19756
batch 39, loss: 0.0963, instance_loss: 0.2291, weighted_loss: 0.1361, label: 3, bag_size: 26172


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.38563829787234044: correct 145/376
Epoch: 38, train_loss: 0.4917, train_clustering_loss:  0.3633, train_error: 0.1489
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.1793, val_error: 0.4545, auc: 0.8299
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3932, instance_loss: 0.3384, weighted_loss: 0.3768, label: 0, bag_size: 12821
batch 39, loss: 0.1218, instance_loss: 0.1894, weighted_loss: 0.1421, label: 1, bag_size: 9703


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.3191489361702128: correct 120/376
Epoch: 39, train_loss: 0.4406, train_clustering_loss:  0.3397, train_error: 0.1277
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.1862, val_error: 0.5455, auc: 0.7812
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3219, instance_loss: 0.2423, weighted_loss: 0.2980, label: 1, bag_size: 33605
batch 39, loss: 0.4196, instance_loss: 0.4268, weighted_loss: 0.4217, label: 3, bag_size: 26172


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.3696808510638298: correct 139/376
Epoch: 40, train_loss: 0.4455, train_clustering_loss:  0.3520, train_error: 0.1702
class 0: acc 0.75, correct 6/8
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.7172, val_error: 0.6364, auc: 0.6354
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.5024, instance_loss: 0.4666, weighted_loss: 0.4917, label: 0, bag_size: 14952
batch 39, loss: 0.0506, instance_loss: 0.0883, weighted_loss: 0.0619, label: 2, bag_size: 23737


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.3776595744680851: correct 142/376
Epoch: 41, train_loss: 0.3994, train_clustering_loss:  0.3403, train_error: 0.0851
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.5507, val_error: 0.5455, auc: 0.6806
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.4622, instance_loss: 0.4738, weighted_loss: 0.4657, label: 3, bag_size: 4443
batch 39, loss: 0.2246, instance_loss: 0.2764, weighted_loss: 0.2401, label: 3, bag_size: 5751


class 0 clustering acc 0.9860372340425532: correct 1483/1504
class 1 clustering acc 0.48138297872340424: correct 181/376
Epoch: 42, train_loss: 0.3557, train_clustering_loss:  0.3098, train_error: 0.1277
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 1.0, correct 14/14
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.3715, val_error: 0.5455, auc: 0.7361
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0132, instance_loss: 0.0775, weighted_loss: 0.0325, label: 3, bag_size: 20225
batch 39, loss: 0.0411, instance_loss: 0.0996, weighted_loss: 0.0586, label: 2, bag_size: 11341


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.5398936170212766: correct 203/376
Epoch: 43, train_loss: 0.2611, train_clustering_loss:  0.2608, train_error: 0.0638
class 0: acc 0.625, correct 5/8
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.5220, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.2499, instance_loss: 0.4009, weighted_loss: 0.2952, label: 3, bag_size: 12708
batch 39, loss: 0.1782, instance_loss: 0.3230, weighted_loss: 0.2217, label: 0, bag_size: 5626


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.48404255319148937: correct 182/376
Epoch: 44, train_loss: 0.3110, train_clustering_loss:  0.3207, train_error: 0.0426
class 0: acc 0.9375, correct 15/16
class 1: acc 1.0, correct 12/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.4308, val_error: 0.5455, auc: 0.7361
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.1615, instance_loss: 0.1660, weighted_loss: 0.1629, label: 1, bag_size: 20684
batch 39, loss: 0.4302, instance_loss: 0.5340, weighted_loss: 0.4614, label: 0, bag_size: 1677


class 0 clustering acc 0.9860372340425532: correct 1483/1504
class 1 clustering acc 0.5053191489361702: correct 190/376
Epoch: 45, train_loss: 0.3619, train_clustering_loss:  0.3060, train_error: 0.1277
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.3462, val_error: 0.5455, auc: 0.7917
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 1.0058, instance_loss: 0.4602, weighted_loss: 0.8421, label: 1, bag_size: 4747
batch 39, loss: 0.2946, instance_loss: 0.3055, weighted_loss: 0.2979, label: 3, bag_size: 5751


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.4787234042553192: correct 180/376
Epoch: 46, train_loss: 0.3206, train_clustering_loss:  0.2984, train_error: 0.1064
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.2626, val_error: 0.4545, auc: 0.7951
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0855, instance_loss: 0.1059, weighted_loss: 0.0917, label: 2, bag_size: 18012
batch 39, loss: 0.9414, instance_loss: 0.4572, weighted_loss: 0.7962, label: 3, bag_size: 17024


class 0 clustering acc 0.9833776595744681: correct 1479/1504
class 1 clustering acc 0.5132978723404256: correct 193/376
Epoch: 47, train_loss: 0.3163, train_clustering_loss:  0.3219, train_error: 0.0851
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 9/9
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.4077, val_error: 0.4545, auc: 0.7465
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.6468, instance_loss: 0.4937, weighted_loss: 0.6009, label: 2, bag_size: 6102
batch 39, loss: 0.2441, instance_loss: 0.3566, weighted_loss: 0.2778, label: 1, bag_size: 26697


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.5345744680851063: correct 201/376
Epoch: 48, train_loss: 0.3168, train_clustering_loss:  0.3153, train_error: 0.1064
class 0: acc 0.4444444444444444, correct 4/9
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.4436, val_error: 0.4545, auc: 0.7882
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.8088, instance_loss: 0.5853, weighted_loss: 0.7417, label: 0, bag_size: 2928
batch 39, loss: 1.4229, instance_loss: 0.8511, weighted_loss: 1.2513, label: 0, bag_size: 27370


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.550531914893617: correct 207/376
Epoch: 49, train_loss: 0.3266, train_clustering_loss:  0.3094, train_error: 0.0851
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 1.0, correct 12/12
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.4322, val_error: 0.5455, auc: 0.7917
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0330, instance_loss: 0.0483, weighted_loss: 0.0376, label: 2, bag_size: 23737
batch 39, loss: 0.0880, instance_loss: 0.2304, weighted_loss: 0.1307, label: 1, bag_size: 15079


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.550531914893617: correct 207/376
Epoch: 50, train_loss: 0.2903, train_clustering_loss:  0.2762, train_error: 0.1064
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.3339, val_error: 0.4545, auc: 0.8056
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0884, instance_loss: 0.1584, weighted_loss: 0.1094, label: 2, bag_size: 14084
batch 39, loss: 0.0365, instance_loss: 0.1611, weighted_loss: 0.0739, label: 3, bag_size: 39178


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.46808510638297873: correct 176/376
Epoch: 51, train_loss: 0.2648, train_clustering_loss:  0.3019, train_error: 0.0638
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.5386, val_error: 0.4545, auc: 0.7951
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 26 out of 20
Early stopping
Val error: 0.4545, ROC AUC: 0.8785
Test error: 0.6364, ROC AUC: 0.6389
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3

Training Fold 3!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.9428, instance_loss: 1.0894, weighted_loss: 1.6868, label: 1, bag_size: 33605
batch 39, loss: 1.9065, instance_loss: 0.9267, weighted_loss: 1.6126, label: 1, bag_size: 4747


class 0 clustering acc 0.9541223404255319: correct 1435/1504
class 1 clustering acc 0.061170212765957445: correct 23/376
Epoch: 0, train_loss: 1.4289, train_clustering_loss:  1.0240, train_error: 0.7021
class 0: acc 0.0, correct 0/11
class 1: acc 0.0, correct 0/10
class 2: acc 1.0, correct 13/13
class 3: acc 0.07692307692307693, correct 1/13

Val Set, val_loss: 1.4191, val_error: 0.7273, auc: 0.3993
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.419092).  Saving model ...


batch 19, loss: 1.4189, instance_loss: 0.7306, weighted_loss: 1.2124, label: 2, bag_size: 23737
batch 39, loss: 1.2085, instance_loss: 0.6524, weighted_loss: 1.0417, label: 1, bag_size: 15079


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3740, train_clustering_loss:  0.7276, train_error: 0.7234
class 0: acc 0.0, correct 0/5
class 1: acc 0.1875, correct 3/16
class 2: acc 0.0, correct 0/13
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.4576, val_error: 0.7273, auc: 0.3924
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3793, instance_loss: 0.6464, weighted_loss: 1.1594, label: 2, bag_size: 30302
batch 39, loss: 1.0603, instance_loss: 0.6010, weighted_loss: 0.9225, label: 2, bag_size: 14084


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3808, train_clustering_loss:  0.6338, train_error: 0.7021
class 0: acc 0.0, correct 0/10
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.2857142857142857, correct 4/14
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4401, val_error: 0.8182, auc: 0.4514
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0992, instance_loss: 0.5862, weighted_loss: 0.9453, label: 1, bag_size: 12737
batch 39, loss: 1.1415, instance_loss: 0.5939, weighted_loss: 0.9772, label: 3, bag_size: 4892


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3569, train_clustering_loss:  0.6184, train_error: 0.6809
class 0: acc 0.0, correct 0/8
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.25, correct 3/12
class 3: acc 0.2857142857142857, correct 4/14

Val Set, val_loss: 1.4103, val_error: 0.7273, auc: 0.4965
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.419092 --> 1.410307).  Saving model ...


batch 19, loss: 1.2607, instance_loss: 0.5807, weighted_loss: 1.0567, label: 2, bag_size: 16556
batch 39, loss: 1.4227, instance_loss: 0.6256, weighted_loss: 1.1835, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3973, train_clustering_loss:  0.6189, train_error: 0.7660
class 0: acc 0.15384615384615385, correct 2/13
class 1: acc 0.07142857142857142, correct 1/14
class 2: acc 0.5, correct 6/12
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.4102, val_error: 0.7273, auc: 0.4861
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.410307 --> 1.410204).  Saving model ...


batch 19, loss: 1.5447, instance_loss: 0.6527, weighted_loss: 1.2771, label: 0, bag_size: 4729
batch 39, loss: 1.4359, instance_loss: 0.6170, weighted_loss: 1.1902, label: 0, bag_size: 12246


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3555, train_clustering_loss:  0.6142, train_error: 0.6596
class 0: acc 0.0, correct 0/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.7, correct 7/10
class 3: acc 0.0, correct 0/14

Val Set, val_loss: 1.3720, val_error: 0.7273, auc: 0.5243
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.410204 --> 1.371952).  Saving model ...


batch 19, loss: 1.7801, instance_loss: 0.6102, weighted_loss: 1.4291, label: 2, bag_size: 16556
batch 39, loss: 1.2546, instance_loss: 0.6101, weighted_loss: 1.0613, label: 2, bag_size: 23737


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3789, train_clustering_loss:  0.6141, train_error: 0.7447
class 0: acc 0.0, correct 0/12
class 1: acc 0.23076923076923078, correct 3/13
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3977, val_error: 0.8182, auc: 0.5243
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1824, instance_loss: 0.5848, weighted_loss: 1.0031, label: 1, bag_size: 12737
batch 39, loss: 0.9601, instance_loss: 0.5770, weighted_loss: 0.8452, label: 1, bag_size: 9703


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2710, train_clustering_loss:  0.6053, train_error: 0.5957
class 0: acc 0.16666666666666666, correct 2/12
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.3, correct 3/10
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3781, val_error: 0.8182, auc: 0.5556
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1381, instance_loss: 0.6075, weighted_loss: 0.9789, label: 2, bag_size: 40177
batch 39, loss: 1.1285, instance_loss: 0.5993, weighted_loss: 0.9697, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2485, train_clustering_loss:  0.6004, train_error: 0.5319
class 0: acc 0.5, correct 6/12
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.8333333333333334, correct 15/18
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3994, val_error: 0.8182, auc: 0.5382
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2494, instance_loss: 0.6485, weighted_loss: 1.0691, label: 3, bag_size: 12626
batch 39, loss: 1.5501, instance_loss: 0.6254, weighted_loss: 1.2727, label: 1, bag_size: 4747


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2190, train_clustering_loss:  0.5969, train_error: 0.5106
class 0: acc 0.5, correct 6/12
class 1: acc 0.1, correct 1/10
class 2: acc 1.0, correct 12/12
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.3652, val_error: 0.5455, auc: 0.5972
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.371952 --> 1.365222).  Saving model ...


batch 19, loss: 0.7810, instance_loss: 0.5083, weighted_loss: 0.6992, label: 2, bag_size: 23737
batch 39, loss: 1.4046, instance_loss: 0.6209, weighted_loss: 1.1695, label: 1, bag_size: 15079


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2149, train_clustering_loss:  0.5894, train_error: 0.4681
class 0: acc 0.6, correct 6/10
class 1: acc 0.3, correct 3/10
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.4105, val_error: 0.9091, auc: 0.5174
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0178, instance_loss: 0.6111, weighted_loss: 0.8958, label: 1, bag_size: 6021
batch 39, loss: 0.7986, instance_loss: 0.5736, weighted_loss: 0.7311, label: 3, bag_size: 6377


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2331, train_clustering_loss:  0.6031, train_error: 0.4894
class 0: acc 0.2857142857142857, correct 4/14
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.3582, val_error: 0.5455, auc: 0.5972
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.365222 --> 1.358199).  Saving model ...


batch 19, loss: 1.4339, instance_loss: 0.6087, weighted_loss: 1.1863, label: 2, bag_size: 2632
batch 39, loss: 0.9374, instance_loss: 0.5669, weighted_loss: 0.8262, label: 2, bag_size: 16556


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2454, train_clustering_loss:  0.6007, train_error: 0.5745
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.3, correct 3/10
class 3: acc 0.25, correct 3/12

Val Set, val_loss: 1.3474, val_error: 0.5455, auc: 0.5938
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.358199 --> 1.347429).  Saving model ...


batch 19, loss: 1.1296, instance_loss: 0.5496, weighted_loss: 0.9556, label: 2, bag_size: 30302
batch 39, loss: 0.7357, instance_loss: 0.5128, weighted_loss: 0.6689, label: 2, bag_size: 16556


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2059, train_clustering_loss:  0.5903, train_error: 0.5532
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.5, correct 7/14
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.3706, val_error: 0.8182, auc: 0.5000
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5546, instance_loss: 0.6329, weighted_loss: 1.2781, label: 1, bag_size: 12737
batch 39, loss: 1.1820, instance_loss: 0.6088, weighted_loss: 1.0100, label: 3, bag_size: 25817


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1345, train_clustering_loss:  0.5760, train_error: 0.5106
class 0: acc 0.4, correct 4/10
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.75, correct 12/16
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.3469, val_error: 0.5455, auc: 0.5729
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.347429 --> 1.346943).  Saving model ...


batch 19, loss: 1.8538, instance_loss: 0.6398, weighted_loss: 1.4896, label: 3, bag_size: 4443
batch 39, loss: 1.1439, instance_loss: 0.5781, weighted_loss: 0.9742, label: 3, bag_size: 12796


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.0864, train_clustering_loss:  0.5733, train_error: 0.4255
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.75, correct 9/12
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.6842105263157895, correct 13/19

Val Set, val_loss: 1.4571, val_error: 0.7273, auc: 0.6354
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7643, instance_loss: 0.5036, weighted_loss: 0.6861, label: 2, bag_size: 16556
batch 39, loss: 0.7317, instance_loss: 0.4613, weighted_loss: 0.6506, label: 2, bag_size: 40177


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.1355, train_clustering_loss:  0.5689, train_error: 0.5106
class 0: acc 0.1, correct 1/10
class 1: acc 0.1, correct 1/10
class 2: acc 0.75, correct 12/16
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.4421, val_error: 0.9091, auc: 0.5174
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7237, instance_loss: 0.4534, weighted_loss: 0.6426, label: 2, bag_size: 11341
batch 39, loss: 1.2139, instance_loss: 0.6230, weighted_loss: 1.0366, label: 0, bag_size: 2928


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.0117, train_clustering_loss:  0.5538, train_error: 0.3404
class 0: acc 0.6875, correct 11/16
class 1: acc 0.4, correct 4/10
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.5, correct 3/6

Val Set, val_loss: 1.3711, val_error: 0.7273, auc: 0.5833
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.6024, instance_loss: 0.6997, weighted_loss: 1.3316, label: 3, bag_size: 25817
batch 39, loss: 0.5060, instance_loss: 0.4380, weighted_loss: 0.4856, label: 2, bag_size: 11341


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 1.0674, train_clustering_loss:  0.5653, train_error: 0.3830
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.3535, val_error: 0.6364, auc: 0.6146
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7063, instance_loss: 0.5443, weighted_loss: 0.6577, label: 1, bag_size: 9703
batch 39, loss: 0.7708, instance_loss: 0.4695, weighted_loss: 0.6804, label: 2, bag_size: 19134


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 0.9694, train_clustering_loss:  0.5457, train_error: 0.3617
class 0: acc 0.5882352941176471, correct 10/17
class 1: acc 0.7, correct 7/10
class 2: acc 0.9, correct 9/10
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.3749, val_error: 0.5455, auc: 0.6458
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.6202, instance_loss: 0.5050, weighted_loss: 0.5856, label: 0, bag_size: 10695
batch 39, loss: 2.0734, instance_loss: 0.7269, weighted_loss: 1.6694, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 0.9458, train_clustering_loss:  0.5387, train_error: 0.2979
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.8333333333333334, correct 15/18

Val Set, val_loss: 1.3635, val_error: 0.5455, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.7928, instance_loss: 0.6703, weighted_loss: 1.4561, label: 2, bag_size: 28856
batch 39, loss: 0.2636, instance_loss: 0.3744, weighted_loss: 0.2968, label: 3, bag_size: 12626


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 0.8662, train_clustering_loss:  0.5229, train_error: 0.2553
class 0: acc 0.5, correct 4/8
class 1: acc 0.95, correct 19/20
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.3620, val_error: 0.5455, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.9829, instance_loss: 0.5578, weighted_loss: 0.8554, label: 2, bag_size: 2632
batch 39, loss: 0.5364, instance_loss: 0.5714, weighted_loss: 0.5469, label: 0, bag_size: 11326


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 22, train_loss: 0.8451, train_clustering_loss:  0.5146, train_error: 0.3191
class 0: acc 0.35714285714285715, correct 5/14
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.75, correct 6/8
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.3040, val_error: 0.5455, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.346943 --> 1.304008).  Saving model ...


batch 19, loss: 0.6311, instance_loss: 0.4757, weighted_loss: 0.5845, label: 2, bag_size: 2632
batch 39, loss: 1.7250, instance_loss: 0.5803, weighted_loss: 1.3816, label: 1, bag_size: 28374


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 1.0044, train_clustering_loss:  0.5460, train_error: 0.4894
class 0: acc 0.8, correct 12/15
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.2727272727272727, correct 3/11

Val Set, val_loss: 1.3987, val_error: 0.5455, auc: 0.6319
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2564, instance_loss: 0.3252, weighted_loss: 0.2771, label: 2, bag_size: 16556
batch 39, loss: 0.7464, instance_loss: 0.5144, weighted_loss: 0.6768, label: 1, bag_size: 9703


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 24, train_loss: 0.8081, train_clustering_loss:  0.5016, train_error: 0.3617
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.3112, val_error: 0.5455, auc: 0.6111
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1471, instance_loss: 0.5991, weighted_loss: 0.9827, label: 1, bag_size: 6021
batch 39, loss: 1.6257, instance_loss: 0.6206, weighted_loss: 1.3242, label: 1, bag_size: 5424


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 25, train_loss: 0.8921, train_clustering_loss:  0.5164, train_error: 0.3830
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.6153846153846154, correct 8/13
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.3286, val_error: 0.5455, auc: 0.6076
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.5671, instance_loss: 0.6322, weighted_loss: 1.2866, label: 1, bag_size: 4747
batch 39, loss: 0.4062, instance_loss: 0.4198, weighted_loss: 0.4102, label: 1, bag_size: 12367


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 26, train_loss: 0.8309, train_clustering_loss:  0.5095, train_error: 0.3617
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.3076923076923077, correct 4/13
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.3348, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7198, instance_loss: 0.4774, weighted_loss: 0.6471, label: 2, bag_size: 14084
batch 39, loss: 1.0087, instance_loss: 0.5858, weighted_loss: 0.8818, label: 3, bag_size: 39178


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.02127659574468085: correct 8/376
Epoch: 27, train_loss: 0.8109, train_clustering_loss:  0.4975, train_error: 0.3617
class 0: acc 0.5, correct 6/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3464, val_error: 0.4545, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.1677, instance_loss: 0.5866, weighted_loss: 0.9933, label: 0, bag_size: 5007
batch 39, loss: 0.3978, instance_loss: 0.4552, weighted_loss: 0.4150, label: 0, bag_size: 4729


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.06914893617021277: correct 26/376
Epoch: 28, train_loss: 0.6424, train_clustering_loss:  0.4571, train_error: 0.2128
class 0: acc 0.6, correct 6/10
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.9375, correct 15/16
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.3550, val_error: 0.6364, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1031, instance_loss: 0.2228, weighted_loss: 0.1390, label: 2, bag_size: 19134
batch 39, loss: 0.6072, instance_loss: 0.5023, weighted_loss: 0.5758, label: 1, bag_size: 33605


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.04521276595744681: correct 17/376
Epoch: 29, train_loss: 0.6985, train_clustering_loss:  0.4728, train_error: 0.2340
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.8823529411764706, correct 15/17
class 2: acc 1.0, correct 10/10
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3146, val_error: 0.4545, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.2275, instance_loss: 0.2652, weighted_loss: 0.2388, label: 2, bag_size: 30302
batch 39, loss: 0.8002, instance_loss: 0.5497, weighted_loss: 0.7251, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.07446808510638298: correct 28/376
Epoch: 30, train_loss: 0.6990, train_clustering_loss:  0.4713, train_error: 0.2979
class 0: acc 0.625, correct 10/16
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.375, correct 3/8

Val Set, val_loss: 1.4020, val_error: 0.4545, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.2921, instance_loss: 0.3687, weighted_loss: 0.3151, label: 1, bag_size: 15079
batch 39, loss: 1.0674, instance_loss: 0.5720, weighted_loss: 0.9188, label: 1, bag_size: 5424


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.03723404255319149: correct 14/376
Epoch: 31, train_loss: 0.6942, train_clustering_loss:  0.4691, train_error: 0.3191
class 0: acc 0.6, correct 9/15
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.4242, val_error: 0.5455, auc: 0.6250
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.3330, instance_loss: 0.6643, weighted_loss: 1.1324, label: 3, bag_size: 39178
batch 39, loss: 0.6792, instance_loss: 0.4699, weighted_loss: 0.6164, label: 2, bag_size: 28856


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.03723404255319149: correct 14/376
Epoch: 32, train_loss: 0.6270, train_clustering_loss:  0.4615, train_error: 0.1702
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.4418, val_error: 0.4545, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.3097, instance_loss: 0.3628, weighted_loss: 0.3256, label: 1, bag_size: 9703
batch 39, loss: 0.0458, instance_loss: 0.1870, weighted_loss: 0.0881, label: 3, bag_size: 6377


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.125: correct 47/376
Epoch: 33, train_loss: 0.5419, train_clustering_loss:  0.4175, train_error: 0.1702
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.75, correct 9/12
class 2: acc 1.0, correct 18/18
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.3814, val_error: 0.3636, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.2101, instance_loss: 0.3130, weighted_loss: 0.2409, label: 3, bag_size: 5751
batch 39, loss: 0.3148, instance_loss: 0.3265, weighted_loss: 0.3183, label: 2, bag_size: 25227


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.10106382978723404: correct 38/376
Epoch: 34, train_loss: 0.5432, train_clustering_loss:  0.4356, train_error: 0.1064
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.4959, val_error: 0.5455, auc: 0.6007
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.5255, instance_loss: 0.3840, weighted_loss: 0.4831, label: 3, bag_size: 5751
batch 39, loss: 0.3189, instance_loss: 0.5637, weighted_loss: 0.3923, label: 0, bag_size: 2928


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.13031914893617022: correct 49/376
Epoch: 35, train_loss: 0.7210, train_clustering_loss:  0.4736, train_error: 0.3191
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.7, correct 7/10
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.4979, val_error: 0.4545, auc: 0.6076
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.0513, instance_loss: 0.4445, weighted_loss: 0.8693, label: 1, bag_size: 5424
batch 39, loss: 0.2390, instance_loss: 0.2860, weighted_loss: 0.2531, label: 2, bag_size: 25227


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.10638297872340426: correct 40/376
Epoch: 36, train_loss: 0.5652, train_clustering_loss:  0.4323, train_error: 0.1702
class 0: acc 0.6, correct 6/10
class 1: acc 0.8125, correct 13/16
class 2: acc 1.0, correct 14/14
class 3: acc 0.8571428571428571, correct 6/7

Val Set, val_loss: 1.4091, val_error: 0.6364, auc: 0.6562
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.1733, instance_loss: 0.5073, weighted_loss: 0.9735, label: 1, bag_size: 5424
batch 39, loss: 0.2535, instance_loss: 0.3358, weighted_loss: 0.2782, label: 3, bag_size: 12626


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.19148936170212766: correct 72/376
Epoch: 37, train_loss: 0.5423, train_clustering_loss:  0.4175, train_error: 0.1489
class 0: acc 0.8, correct 12/15
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 1.0, correct 15/15
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.5194, val_error: 0.4545, auc: 0.6181
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.4977, instance_loss: 0.5777, weighted_loss: 0.5217, label: 3, bag_size: 4443
batch 39, loss: 0.1281, instance_loss: 0.1691, weighted_loss: 0.1404, label: 2, bag_size: 30302


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.2579787234042553: correct 97/376
Epoch: 38, train_loss: 0.4619, train_clustering_loss:  0.3822, train_error: 0.1702
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 1.0, correct 16/16
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.4629, val_error: 0.3636, auc: 0.6493
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 1.5863, instance_loss: 0.6345, weighted_loss: 1.3007, label: 3, bag_size: 39178
batch 39, loss: 0.1601, instance_loss: 0.4230, weighted_loss: 0.2390, label: 0, bag_size: 33379


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.14361702127659576: correct 54/376
Epoch: 39, train_loss: 0.5204, train_clustering_loss:  0.4314, train_error: 0.2128
class 0: acc 0.5882352941176471, correct 10/17
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 1.0, correct 9/9
class 3: acc 0.8571428571428571, correct 6/7

Val Set, val_loss: 1.6333, val_error: 0.5455, auc: 0.6319
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.9619, instance_loss: 0.5896, weighted_loss: 0.8502, label: 1, bag_size: 33605
batch 39, loss: 0.1540, instance_loss: 0.1878, weighted_loss: 0.1642, label: 2, bag_size: 30302


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.2579787234042553: correct 97/376
Epoch: 40, train_loss: 0.4470, train_clustering_loss:  0.3826, train_error: 0.1277
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 1.0, correct 13/13
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.4970, val_error: 0.4545, auc: 0.5938
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.7667, instance_loss: 0.4862, weighted_loss: 0.6825, label: 0, bag_size: 29269
batch 39, loss: 0.6191, instance_loss: 0.5549, weighted_loss: 0.5999, label: 2, bag_size: 2632


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.2393617021276596: correct 90/376
Epoch: 41, train_loss: 0.4594, train_clustering_loss:  0.3901, train_error: 0.1489
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 12/12
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.7189, val_error: 0.5455, auc: 0.6528
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.3886, instance_loss: 0.4040, weighted_loss: 0.3933, label: 3, bag_size: 5751
batch 39, loss: 0.2020, instance_loss: 0.2819, weighted_loss: 0.2260, label: 3, bag_size: 5751


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.3617021276595745: correct 136/376
Epoch: 42, train_loss: 0.3697, train_clustering_loss:  0.3626, train_error: 0.0851
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7, correct 7/10
class 2: acc 1.0, correct 14/14
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.6064, val_error: 0.6364, auc: 0.5938
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.2161, instance_loss: 0.2875, weighted_loss: 0.2375, label: 1, bag_size: 26697
batch 39, loss: 0.0162, instance_loss: 0.1009, weighted_loss: 0.0416, label: 3, bag_size: 6377


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.4441489361702128: correct 167/376
Epoch: 43, train_loss: 0.3215, train_clustering_loss:  0.3346, train_error: 0.1064
class 0: acc 0.5, correct 4/8
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.6997, val_error: 0.4545, auc: 0.6319
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 2.3301, instance_loss: 0.8751, weighted_loss: 1.8936, label: 0, bag_size: 14436
batch 39, loss: 1.0131, instance_loss: 0.4311, weighted_loss: 0.8385, label: 1, bag_size: 12737


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.3351063829787234: correct 126/376
Epoch: 44, train_loss: 0.5053, train_clustering_loss:  0.3595, train_error: 0.1064
class 0: acc 0.8, correct 8/10
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.6095, val_error: 0.5455, auc: 0.7049
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.4271, instance_loss: 0.3854, weighted_loss: 0.4146, label: 1, bag_size: 6021
batch 39, loss: 0.4290, instance_loss: 0.4683, weighted_loss: 0.4408, label: 0, bag_size: 1677


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.42021276595744683: correct 158/376
Epoch: 45, train_loss: 0.3925, train_clustering_loss:  0.3512, train_error: 0.1064
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 11/11
class 3: acc 0.6666666666666666, correct 4/6

Val Set, val_loss: 1.5401, val_error: 0.4545, auc: 0.6910
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.1359, instance_loss: 0.2027, weighted_loss: 0.1560, label: 1, bag_size: 12367
batch 39, loss: 0.7303, instance_loss: 0.4804, weighted_loss: 0.6553, label: 3, bag_size: 39178


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.3537234042553192: correct 133/376
Epoch: 46, train_loss: 0.4104, train_clustering_loss:  0.3594, train_error: 0.1064
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 12/12
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.4753, val_error: 0.4545, auc: 0.6632
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0275, instance_loss: 0.1784, weighted_loss: 0.0727, label: 2, bag_size: 23737
batch 39, loss: 0.4115, instance_loss: 0.4541, weighted_loss: 0.4243, label: 1, bag_size: 28374


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.2712765957446808: correct 102/376
Epoch: 47, train_loss: 0.4044, train_clustering_loss:  0.3683, train_error: 0.1489
class 0: acc 0.625, correct 10/16
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 8/8
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.6125, val_error: 0.5455, auc: 0.6840
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.4166, instance_loss: 0.3596, weighted_loss: 0.3995, label: 2, bag_size: 40177
batch 39, loss: 0.0955, instance_loss: 0.1386, weighted_loss: 0.1084, label: 1, bag_size: 15079


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.42021276595744683: correct 158/376
Epoch: 48, train_loss: 0.2886, train_clustering_loss:  0.3177, train_error: 0.0638
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 11/11
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.5382, val_error: 0.6364, auc: 0.6528
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.0657, instance_loss: 0.5420, weighted_loss: 0.2086, label: 0, bag_size: 33379
batch 39, loss: 0.0838, instance_loss: 0.4875, weighted_loss: 0.2049, label: 0, bag_size: 10695


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.4015957446808511: correct 151/376
Epoch: 49, train_loss: 0.3642, train_clustering_loss:  0.3466, train_error: 0.1064
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.5570, val_error: 0.4545, auc: 0.6632
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.3524, instance_loss: 0.4601, weighted_loss: 0.3847, label: 2, bag_size: 2632
batch 39, loss: 0.4425, instance_loss: 0.3741, weighted_loss: 0.4220, label: 1, bag_size: 4747


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.40425531914893614: correct 152/376
Epoch: 50, train_loss: 0.2710, train_clustering_loss:  0.3402, train_error: 0.0213
class 0: acc 1.0, correct 9/9
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.7978, val_error: 0.4545, auc: 0.6215
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.1303, instance_loss: 0.2201, weighted_loss: 0.1573, label: 2, bag_size: 14084
batch 39, loss: 0.1049, instance_loss: 0.1881, weighted_loss: 0.1299, label: 2, bag_size: 28856


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.42819148936170215: correct 161/376
Epoch: 51, train_loss: 0.3522, train_clustering_loss:  0.3318, train_error: 0.1277
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 1.0, correct 8/8
class 2: acc 1.0, correct 9/9
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.6622, val_error: 0.6364, auc: 0.6424
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 29 out of 20
Early stopping
Val error: 0.5455, ROC AUC: 0.6493
Test error: 0.5455, ROC AUC: 0.8507
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3

Training Fold 4!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.1548, instance_loss: 1.0114, weighted_loss: 1.1118, label: 2, bag_size: 28856
batch 39, loss: 2.2682, instance_loss: 0.9788, weighted_loss: 1.8814, label: 1, bag_size: 20684


class 0 clustering acc 0.9514627659574468: correct 1431/1504
class 1 clustering acc 0.08776595744680851: correct 33/376
Epoch: 0, train_loss: 1.4332, train_clustering_loss:  1.0150, train_error: 0.6596
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/9
class 2: acc 0.5333333333333333, correct 8/15
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.4723, val_error: 0.8182, auc: 0.6181
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.472339).  Saving model ...


batch 19, loss: 1.0689, instance_loss: 0.7423, weighted_loss: 0.9709, label: 2, bag_size: 2632
batch 39, loss: 1.2104, instance_loss: 0.6897, weighted_loss: 1.0542, label: 1, bag_size: 15079


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3844, train_clustering_loss:  0.7390, train_error: 0.6809
class 0: acc 0.0, correct 0/5
class 1: acc 0.25, correct 4/16
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.0, correct 0/13

Val Set, val_loss: 1.4220, val_error: 0.7273, auc: 0.6111
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.472339 --> 1.421979).  Saving model ...


batch 19, loss: 1.0157, instance_loss: 0.5990, weighted_loss: 0.8907, label: 3, bag_size: 4892
batch 39, loss: 1.4269, instance_loss: 0.6266, weighted_loss: 1.1868, label: 2, bag_size: 14084


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.4013, train_clustering_loss:  0.6310, train_error: 0.6809
class 0: acc 0.0, correct 0/10
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.3863, val_error: 0.7273, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.421979 --> 1.386269).  Saving model ...


batch 19, loss: 1.5999, instance_loss: 0.6553, weighted_loss: 1.3165, label: 0, bag_size: 1677
batch 39, loss: 1.5359, instance_loss: 0.6360, weighted_loss: 1.2659, label: 2, bag_size: 18012


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3677, train_clustering_loss:  0.6194, train_error: 0.6596
class 0: acc 0.0, correct 0/13
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.1111111111111111, correct 1/9
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.3414, val_error: 0.7273, auc: 0.8229
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.386269 --> 1.341419).  Saving model ...


batch 19, loss: 1.1089, instance_loss: 0.6022, weighted_loss: 0.9569, label: 2, bag_size: 23737
batch 39, loss: 1.4791, instance_loss: 0.6210, weighted_loss: 1.2216, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.4097, train_clustering_loss:  0.6105, train_error: 0.7447
class 0: acc 0.5, correct 5/10
class 1: acc 0.0, correct 0/13
class 2: acc 0.2727272727272727, correct 3/11
class 3: acc 0.3076923076923077, correct 4/13

Val Set, val_loss: 1.3392, val_error: 0.7273, auc: 0.8403
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.341419 --> 1.339174).  Saving model ...


batch 19, loss: 1.2029, instance_loss: 0.6141, weighted_loss: 1.0262, label: 1, bag_size: 9703
batch 39, loss: 1.7281, instance_loss: 0.6397, weighted_loss: 1.4015, label: 2, bag_size: 5938


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3584, train_clustering_loss:  0.6078, train_error: 0.6809
class 0: acc 0.0, correct 0/12
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.3246, val_error: 0.5455, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.339174 --> 1.324624).  Saving model ...


batch 19, loss: 1.6294, instance_loss: 0.6156, weighted_loss: 1.3252, label: 2, bag_size: 23737
batch 39, loss: 1.4712, instance_loss: 0.6249, weighted_loss: 1.2173, label: 2, bag_size: 23737


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3343, train_clustering_loss:  0.6053, train_error: 0.6809
class 0: acc 0.4, correct 6/15
class 1: acc 0.09090909090909091, correct 1/11
class 2: acc 0.0, correct 0/10
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3249, val_error: 0.7273, auc: 0.8160
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0101, instance_loss: 0.5839, weighted_loss: 0.8822, label: 0, bag_size: 1677
batch 39, loss: 1.1177, instance_loss: 0.5951, weighted_loss: 0.9609, label: 1, bag_size: 9703


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2574, train_clustering_loss:  0.5946, train_error: 0.5319
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.1, correct 1/10
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.3269, val_error: 0.7273, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0769, instance_loss: 0.5891, weighted_loss: 0.9305, label: 2, bag_size: 40177
batch 39, loss: 1.1615, instance_loss: 0.5935, weighted_loss: 0.9911, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2631, train_clustering_loss:  0.5969, train_error: 0.5319
class 0: acc 0.25, correct 3/12
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.9411764705882353, correct 16/17
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.3703, val_error: 0.7273, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7631, instance_loss: 0.5494, weighted_loss: 0.6990, label: 3, bag_size: 20225
batch 39, loss: 1.4890, instance_loss: 0.6223, weighted_loss: 1.2290, label: 1, bag_size: 20684


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2291, train_clustering_loss:  0.5920, train_error: 0.5319
class 0: acc 0.3, correct 3/10
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 1.0, correct 14/14
class 3: acc 0.2727272727272727, correct 3/11

Val Set, val_loss: 1.2874, val_error: 0.7273, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.324624 --> 1.287412).  Saving model ...


batch 19, loss: 0.9877, instance_loss: 0.5657, weighted_loss: 0.8611, label: 2, bag_size: 2632
batch 39, loss: 1.2578, instance_loss: 0.5974, weighted_loss: 1.0597, label: 1, bag_size: 15079


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2295, train_clustering_loss:  0.5861, train_error: 0.6170
class 0: acc 0.0, correct 0/10
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.7368421052631579, correct 14/19
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.3616, val_error: 0.8182, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9846, instance_loss: 0.5881, weighted_loss: 0.8657, label: 1, bag_size: 6021
batch 39, loss: 1.4640, instance_loss: 0.6745, weighted_loss: 1.2271, label: 3, bag_size: 12626


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2050, train_clustering_loss:  0.5963, train_error: 0.5957
class 0: acc 0.35714285714285715, correct 5/14
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.36363636363636365, correct 4/11
class 3: acc 0.2857142857142857, correct 2/7

Val Set, val_loss: 1.2469, val_error: 0.6364, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.287412 --> 1.246903).  Saving model ...


batch 19, loss: 1.2449, instance_loss: 0.5894, weighted_loss: 1.0482, label: 2, bag_size: 2632
batch 39, loss: 0.9486, instance_loss: 0.5390, weighted_loss: 0.8257, label: 2, bag_size: 16556


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2071, train_clustering_loss:  0.5902, train_error: 0.4468
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.3333333333333333, correct 4/12

Val Set, val_loss: 1.2332, val_error: 0.5455, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.246903 --> 1.233182).  Saving model ...


batch 19, loss: 0.5808, instance_loss: 0.5075, weighted_loss: 0.5588, label: 3, bag_size: 4892
batch 39, loss: 1.1255, instance_loss: 0.5392, weighted_loss: 0.9496, label: 2, bag_size: 23737


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.1369, train_clustering_loss:  0.5770, train_error: 0.4043
class 0: acc 0.2222222222222222, correct 2/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.8, correct 12/15

Val Set, val_loss: 1.2016, val_error: 0.6364, auc: 0.8507
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.233182 --> 1.201582).  Saving model ...


batch 19, loss: 1.4259, instance_loss: 0.6218, weighted_loss: 1.1847, label: 0, bag_size: 1677
batch 39, loss: 1.4360, instance_loss: 0.5967, weighted_loss: 1.1842, label: 2, bag_size: 2078


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1082, train_clustering_loss:  0.5669, train_error: 0.4255
class 0: acc 0.1, correct 1/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.8, correct 12/15
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.1581, val_error: 0.5455, auc: 0.8299
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.201582 --> 1.158144).  Saving model ...


batch 19, loss: 1.2890, instance_loss: 0.6069, weighted_loss: 1.0843, label: 0, bag_size: 5626
batch 39, loss: 1.1702, instance_loss: 0.5714, weighted_loss: 0.9906, label: 2, bag_size: 28856


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.0178, train_clustering_loss:  0.5596, train_error: 0.3404
class 0: acc 0.2857142857142857, correct 4/14
class 1: acc 0.9, correct 9/10
class 2: acc 0.7142857142857143, correct 5/7
class 3: acc 0.8125, correct 13/16

Val Set, val_loss: 1.1335, val_error: 0.4545, auc: 0.8542
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.158144 --> 1.133533).  Saving model ...


batch 19, loss: 0.6412, instance_loss: 0.5072, weighted_loss: 0.6010, label: 2, bag_size: 23737
batch 39, loss: 0.6303, instance_loss: 0.5336, weighted_loss: 0.6013, label: 2, bag_size: 40177


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 16, train_loss: 0.9342, train_clustering_loss:  0.5386, train_error: 0.2979
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.625, correct 5/8
class 2: acc 0.7222222222222222, correct 13/18
class 3: acc 0.7333333333333333, correct 11/15

Val Set, val_loss: 1.1544, val_error: 0.5455, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1877, instance_loss: 0.3198, weighted_loss: 0.2274, label: 3, bag_size: 11206
batch 39, loss: 1.1237, instance_loss: 0.5942, weighted_loss: 0.9648, label: 0, bag_size: 2928


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 17, train_loss: 0.9116, train_clustering_loss:  0.5418, train_error: 0.1702
class 0: acc 0.6, correct 9/15
class 1: acc 0.75, correct 6/8
class 2: acc 1.0, correct 14/14
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.1830, val_error: 0.7273, auc: 0.8090
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9504, instance_loss: 0.5396, weighted_loss: 0.8272, label: 2, bag_size: 2078
batch 39, loss: 0.5647, instance_loss: 0.4296, weighted_loss: 0.5241, label: 3, bag_size: 6377


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 18, train_loss: 0.8860, train_clustering_loss:  0.5270, train_error: 0.3191
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.3076923076923077, correct 4/13
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.0891, val_error: 0.4545, auc: 0.8507
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.133533 --> 1.089130).  Saving model ...


batch 19, loss: 0.4776, instance_loss: 0.4922, weighted_loss: 0.4819, label: 1, bag_size: 9703
batch 39, loss: 1.5710, instance_loss: 0.6782, weighted_loss: 1.3032, label: 2, bag_size: 30302


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.010638297872340425: correct 4/376
Epoch: 19, train_loss: 0.9293, train_clustering_loss:  0.5347, train_error: 0.4255
class 0: acc 0.6470588235294118, correct 11/17
class 1: acc 0.6, correct 6/10
class 2: acc 0.45454545454545453, correct 5/11
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.0851, val_error: 0.6364, auc: 0.8542
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.089130 --> 1.085052).  Saving model ...


batch 19, loss: 2.2672, instance_loss: 0.7504, weighted_loss: 1.8122, label: 0, bag_size: 27370
batch 39, loss: 0.9352, instance_loss: 0.5551, weighted_loss: 0.8212, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 20, train_loss: 0.9463, train_clustering_loss:  0.5313, train_error: 0.2128
class 0: acc 0.5, correct 4/8
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 1.0, correct 14/14
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.1194, val_error: 0.3636, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5800, instance_loss: 0.6158, weighted_loss: 1.2907, label: 0, bag_size: 12821
batch 39, loss: 0.0742, instance_loss: 0.2141, weighted_loss: 0.1161, label: 3, bag_size: 20225


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.023936170212765957: correct 9/376
Epoch: 21, train_loss: 0.7681, train_clustering_loss:  0.4981, train_error: 0.2340
class 0: acc 0.0, correct 0/9
class 1: acc 1.0, correct 20/20
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.1664, val_error: 0.6364, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3649, instance_loss: 0.4489, weighted_loss: 0.3901, label: 2, bag_size: 2632
batch 39, loss: 0.8950, instance_loss: 0.5623, weighted_loss: 0.7952, label: 0, bag_size: 11326


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.05319148936170213: correct 20/376
Epoch: 22, train_loss: 0.7619, train_clustering_loss:  0.4949, train_error: 0.1702
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.1102, val_error: 0.5455, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7416, instance_loss: 0.4522, weighted_loss: 0.6548, label: 3, bag_size: 6377
batch 39, loss: 0.3424, instance_loss: 0.3968, weighted_loss: 0.3587, label: 3, bag_size: 12708


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 23, train_loss: 1.0171, train_clustering_loss:  0.5384, train_error: 0.4043
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.2, correct 2/10
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.1350, val_error: 0.6364, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.4651, instance_loss: 0.4649, weighted_loss: 0.4650, label: 2, bag_size: 16556
batch 39, loss: 1.1311, instance_loss: 0.5817, weighted_loss: 0.9663, label: 1, bag_size: 6021


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.010638297872340425: correct 4/376
Epoch: 24, train_loss: 0.7729, train_clustering_loss:  0.4999, train_error: 0.1915
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.6, correct 6/10
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.0443, val_error: 0.4545, auc: 0.8194
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.085052 --> 1.044333).  Saving model ...


batch 19, loss: 1.5420, instance_loss: 0.6589, weighted_loss: 1.2771, label: 1, bag_size: 6021
batch 39, loss: 0.4703, instance_loss: 0.4156, weighted_loss: 0.4539, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.06382978723404255: correct 24/376
Epoch: 25, train_loss: 0.7393, train_clustering_loss:  0.4736, train_error: 0.2766
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.3, correct 3/10
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.2417, val_error: 0.6364, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5091, instance_loss: 0.4445, weighted_loss: 0.4897, label: 1, bag_size: 20684
batch 39, loss: 0.4069, instance_loss: 0.5392, weighted_loss: 0.4466, label: 1, bag_size: 4387


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.07446808510638298: correct 28/376
Epoch: 26, train_loss: 0.7483, train_clustering_loss:  0.4724, train_error: 0.1915
class 0: acc 1.0, correct 12/12
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.0896, val_error: 0.5455, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2293, instance_loss: 0.5895, weighted_loss: 1.0374, label: 2, bag_size: 14084
batch 39, loss: 0.5979, instance_loss: 0.4810, weighted_loss: 0.5628, label: 3, bag_size: 1295


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.05319148936170213: correct 20/376
Epoch: 27, train_loss: 0.7144, train_clustering_loss:  0.4719, train_error: 0.1489
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.1113, val_error: 0.5455, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5331, instance_loss: 0.4592, weighted_loss: 0.5110, label: 0, bag_size: 16555
batch 39, loss: 0.6990, instance_loss: 0.4770, weighted_loss: 0.6324, label: 0, bag_size: 4729


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.14095744680851063: correct 53/376
Epoch: 28, train_loss: 0.6048, train_clustering_loss:  0.4284, train_error: 0.2128
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.2, correct 2/10
class 2: acc 1.0, correct 14/14
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.1974, val_error: 0.6364, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2975, instance_loss: 0.3365, weighted_loss: 0.3092, label: 2, bag_size: 30302
batch 39, loss: 0.2591, instance_loss: 0.2501, weighted_loss: 0.2564, label: 3, bag_size: 12796


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.11436170212765957: correct 43/376
Epoch: 29, train_loss: 0.6594, train_clustering_loss:  0.4376, train_error: 0.2128
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.0384, val_error: 0.4545, auc: 0.8264
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.044333 --> 1.038447).  Saving model ...


batch 19, loss: 0.0372, instance_loss: 0.1346, weighted_loss: 0.0664, label: 3, bag_size: 4892
batch 39, loss: 0.4828, instance_loss: 0.5084, weighted_loss: 0.4905, label: 2, bag_size: 25227


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.19414893617021275: correct 73/376
Epoch: 30, train_loss: 0.5328, train_clustering_loss:  0.4193, train_error: 0.1489
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 0.6666666666666666, correct 4/6
class 2: acc 1.0, correct 13/13
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.1730, val_error: 0.6364, auc: 0.8090
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7257, instance_loss: 0.5348, weighted_loss: 0.6684, label: 1, bag_size: 15079
batch 39, loss: 0.2865, instance_loss: 0.4229, weighted_loss: 0.3274, label: 1, bag_size: 5424


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.2553191489361702: correct 96/376
Epoch: 31, train_loss: 0.5645, train_clustering_loss:  0.4169, train_error: 0.2128
class 0: acc 1.0, correct 8/8
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.9333333333333333, correct 14/15
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.1124, val_error: 0.5455, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.9134, instance_loss: 0.5949, weighted_loss: 0.8179, label: 0, bag_size: 12821
batch 39, loss: 1.3439, instance_loss: 0.7811, weighted_loss: 1.1750, label: 3, bag_size: 39178


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.20212765957446807: correct 76/376
Epoch: 32, train_loss: 0.6237, train_clustering_loss:  0.4186, train_error: 0.1915
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.0749, val_error: 0.5455, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8632, instance_loss: 0.5289, weighted_loss: 0.7629, label: 1, bag_size: 6021
batch 39, loss: 0.0252, instance_loss: 0.0911, weighted_loss: 0.0450, label: 3, bag_size: 11206


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.17287234042553193: correct 65/376
Epoch: 33, train_loss: 0.5356, train_clustering_loss:  0.3976, train_error: 0.1489
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 1.0, correct 17/17
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.1268, val_error: 0.5455, auc: 0.7882
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.6789, instance_loss: 0.5080, weighted_loss: 0.6276, label: 3, bag_size: 1295
batch 39, loss: 0.2439, instance_loss: 0.2729, weighted_loss: 0.2526, label: 2, bag_size: 25227


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.19680851063829788: correct 74/376
Epoch: 34, train_loss: 0.5527, train_clustering_loss:  0.4114, train_error: 0.1489
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.1462, val_error: 0.4545, auc: 0.7743
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.8225, instance_loss: 0.5416, weighted_loss: 0.7382, label: 1, bag_size: 12737
batch 39, loss: 0.7133, instance_loss: 0.4907, weighted_loss: 0.6466, label: 0, bag_size: 4729


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.2074468085106383: correct 78/376
Epoch: 35, train_loss: 0.5627, train_clustering_loss:  0.4188, train_error: 0.1489
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.2431, val_error: 0.5455, auc: 0.7917
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.2113, instance_loss: 0.3261, weighted_loss: 0.2458, label: 1, bag_size: 5424
batch 39, loss: 0.2957, instance_loss: 0.3806, weighted_loss: 0.3212, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.22074468085106383: correct 83/376
Epoch: 36, train_loss: 0.4948, train_clustering_loss:  0.3916, train_error: 0.1489
class 0: acc 0.7, correct 7/10
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 1.0, correct 11/11
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.1230, val_error: 0.5455, auc: 0.7743
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.2775, instance_loss: 0.3231, weighted_loss: 0.2912, label: 1, bag_size: 5424
batch 39, loss: 0.0889, instance_loss: 0.2593, weighted_loss: 0.1400, label: 3, bag_size: 12626


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.2925531914893617: correct 110/376
Epoch: 37, train_loss: 0.5187, train_clustering_loss:  0.3994, train_error: 0.1702
class 0: acc 0.7, correct 7/10
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 1.0, correct 10/10
class 3: acc 0.875, correct 14/16

Val Set, val_loss: 1.2230, val_error: 0.5455, auc: 0.7812
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.6769, instance_loss: 0.5495, weighted_loss: 0.6387, label: 0, bag_size: 5626
batch 39, loss: 0.1054, instance_loss: 0.0952, weighted_loss: 0.1023, label: 3, bag_size: 4892


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.3962765957446808: correct 149/376
Epoch: 38, train_loss: 0.3554, train_clustering_loss:  0.3327, train_error: 0.0426
class 0: acc 1.0, correct 12/12
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 1.0, correct 15/15
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.2397, val_error: 0.7273, auc: 0.7812
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5893, instance_loss: 0.5268, weighted_loss: 0.5705, label: 0, bag_size: 12821
batch 39, loss: 0.6713, instance_loss: 0.5123, weighted_loss: 0.6236, label: 0, bag_size: 2928


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.2579787234042553: correct 97/376
Epoch: 39, train_loss: 0.4667, train_clustering_loss:  0.3780, train_error: 0.1489
class 0: acc 0.9411764705882353, correct 16/17
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.9, correct 9/10
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.2731, val_error: 0.7273, auc: 0.7326
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.1066, instance_loss: 0.1757, weighted_loss: 0.1273, label: 3, bag_size: 12796
batch 39, loss: 0.0443, instance_loss: 0.0890, weighted_loss: 0.0577, label: 3, bag_size: 4892


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.3058510638297872: correct 115/376
Epoch: 40, train_loss: 0.5497, train_clustering_loss:  0.3836, train_error: 0.1915
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.75, correct 9/12
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.3116, val_error: 0.6364, auc: 0.8021
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1521, instance_loss: 0.2268, weighted_loss: 0.1745, label: 3, bag_size: 17024
batch 39, loss: 0.1177, instance_loss: 0.1714, weighted_loss: 0.1338, label: 3, bag_size: 6377


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.2845744680851064: correct 107/376
Epoch: 41, train_loss: 0.4622, train_clustering_loss:  0.3933, train_error: 0.1489
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 1.0, correct 12/12
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.2409, val_error: 0.5455, auc: 0.7500
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.9491, instance_loss: 0.6116, weighted_loss: 0.8479, label: 1, bag_size: 12737
batch 39, loss: 0.4949, instance_loss: 0.3938, weighted_loss: 0.4646, label: 3, bag_size: 1295


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.3670212765957447: correct 138/376
Epoch: 42, train_loss: 0.3658, train_clustering_loss:  0.3287, train_error: 0.0851
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.7, correct 7/10
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.2310, val_error: 0.4545, auc: 0.7812
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.4073, instance_loss: 0.4131, weighted_loss: 0.4090, label: 1, bag_size: 16680
batch 39, loss: 0.0151, instance_loss: 0.0819, weighted_loss: 0.0352, label: 3, bag_size: 12626


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.300531914893617: correct 113/376
Epoch: 43, train_loss: 0.5570, train_clustering_loss:  0.4061, train_error: 0.1277
class 0: acc 0.7, correct 7/10
class 1: acc 1.0, correct 17/17
class 2: acc 0.9, correct 9/10
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.1898, val_error: 0.4545, auc: 0.7917
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.7294, instance_loss: 0.6564, weighted_loss: 0.7075, label: 0, bag_size: 14436
batch 39, loss: 0.0851, instance_loss: 0.2991, weighted_loss: 0.1493, label: 0, bag_size: 1677


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.3537234042553192: correct 133/376
Epoch: 44, train_loss: 0.3025, train_clustering_loss:  0.3323, train_error: 0.0638
class 0: acc 1.0, correct 16/16
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.3687, val_error: 0.6364, auc: 0.7708
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.4525, instance_loss: 0.4286, weighted_loss: 0.4453, label: 1, bag_size: 6021
batch 39, loss: 0.1473, instance_loss: 0.3113, weighted_loss: 0.1965, label: 0, bag_size: 5007


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.42819148936170215: correct 161/376
Epoch: 45, train_loss: 0.3311, train_clustering_loss:  0.3239, train_error: 0.0851
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 11/11
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.5337, val_error: 0.7273, auc: 0.6840
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1667, instance_loss: 0.3269, weighted_loss: 0.2148, label: 1, bag_size: 4387
batch 39, loss: 0.7256, instance_loss: 0.5134, weighted_loss: 0.6619, label: 3, bag_size: 1295


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.40691489361702127: correct 153/376
Epoch: 46, train_loss: 0.3723, train_clustering_loss:  0.3484, train_error: 0.0851
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 1.0, correct 14/14
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.3853, val_error: 0.5455, auc: 0.7118
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0740, instance_loss: 0.1623, weighted_loss: 0.1005, label: 2, bag_size: 23737
batch 39, loss: 0.6784, instance_loss: 0.6323, weighted_loss: 0.6646, label: 1, bag_size: 28374


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.3696808510638298: correct 139/376
Epoch: 47, train_loss: 0.3636, train_clustering_loss:  0.3509, train_error: 0.1277
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.6, correct 6/10
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.4194, val_error: 0.4545, auc: 0.7188
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.2593, instance_loss: 0.4236, weighted_loss: 0.3086, label: 2, bag_size: 40177
batch 39, loss: 0.3926, instance_loss: 0.2575, weighted_loss: 0.3521, label: 1, bag_size: 15079


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.3617021276595745: correct 136/376
Epoch: 48, train_loss: 0.3572, train_clustering_loss:  0.3653, train_error: 0.0213
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 7/7
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.3128, val_error: 0.4545, auc: 0.7708
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2699, instance_loss: 0.3275, weighted_loss: 0.2872, label: 0, bag_size: 33379
batch 39, loss: 0.3533, instance_loss: 0.4322, weighted_loss: 0.3770, label: 0, bag_size: 27370


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.42819148936170215: correct 161/376
Epoch: 49, train_loss: 0.3199, train_clustering_loss:  0.3164, train_error: 0.0851
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 7/7
class 2: acc 1.0, correct 11/11
class 3: acc 0.8125, correct 13/16

Val Set, val_loss: 1.3160, val_error: 0.7273, auc: 0.7153
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.0407, instance_loss: 0.1046, weighted_loss: 0.0598, label: 3, bag_size: 6377
batch 39, loss: 0.1904, instance_loss: 0.2829, weighted_loss: 0.2181, label: 1, bag_size: 20684


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.5319148936170213: correct 200/376
Epoch: 50, train_loss: 0.3647, train_clustering_loss:  0.2951, train_error: 0.1064
class 0: acc 1.0, correct 8/8
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 1.0, correct 11/11
class 3: acc 0.8666666666666667, correct 13/15

Val Set, val_loss: 1.1831, val_error: 0.5455, auc: 0.7569
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 1.1487, instance_loss: 0.6923, weighted_loss: 1.0118, label: 2, bag_size: 14084
batch 39, loss: 0.7569, instance_loss: 0.4944, weighted_loss: 0.6781, label: 3, bag_size: 39178


class 0 clustering acc 0.9847074468085106: correct 1481/1504
class 1 clustering acc 0.31117021276595747: correct 117/376
Epoch: 51, train_loss: 0.4559, train_clustering_loss:  0.4016, train_error: 0.1702
class 0: acc 0.8235294117647058, correct 14/17
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.3210, val_error: 0.4545, auc: 0.7396
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 22 out of 20
Early stopping
Val error: 0.4545, ROC AUC: 0.8264
Test error: 0.7273, ROC AUC: 0.6285
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3

Training Fold 5!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 2.0920, instance_loss: 1.0940, weighted_loss: 1.7926, label: 1, bag_size: 33605
batch 39, loss: 1.9599, instance_loss: 0.9525, weighted_loss: 1.6576, label: 1, bag_size: 6021


class 0 clustering acc 0.9507978723404256: correct 1430/1504
class 1 clustering acc 0.04521276595744681: correct 17/376
Epoch: 0, train_loss: 1.4454, train_clustering_loss:  1.0252, train_error: 0.7021
class 0: acc 0.0, correct 0/11
class 1: acc 0.0, correct 0/10
class 2: acc 1.0, correct 12/12
class 3: acc 0.14285714285714285, correct 2/14

Val Set, val_loss: 1.4073, val_error: 0.7273, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.407317).  Saving model ...


batch 19, loss: 1.4212, instance_loss: 0.7382, weighted_loss: 1.2163, label: 2, bag_size: 2632
batch 39, loss: 1.3385, instance_loss: 0.7037, weighted_loss: 1.1481, label: 1, bag_size: 4747


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4175, train_clustering_loss:  0.7435, train_error: 0.7660
class 0: acc 0.0, correct 0/9
class 1: acc 0.07692307692307693, correct 1/13
class 2: acc 0.0, correct 0/13
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.3644, val_error: 0.7273, auc: 0.8021
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.407317 --> 1.364360).  Saving model ...


batch 19, loss: 1.3299, instance_loss: 0.6349, weighted_loss: 1.1214, label: 2, bag_size: 30302
batch 39, loss: 1.1753, instance_loss: 0.6127, weighted_loss: 1.0066, label: 2, bag_size: 14084


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3856, train_clustering_loss:  0.6363, train_error: 0.6809
class 0: acc 0.0, correct 0/10
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.0, correct 0/12

Val Set, val_loss: 1.3914, val_error: 0.8182, auc: 0.8368
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1162, instance_loss: 0.6110, weighted_loss: 0.9647, label: 1, bag_size: 12737
batch 39, loss: 1.1938, instance_loss: 0.6062, weighted_loss: 1.0175, label: 3, bag_size: 4892


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3929, train_clustering_loss:  0.6170, train_error: 0.6383
class 0: acc 0.0, correct 0/10
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.25, correct 2/8
class 3: acc 0.4, correct 6/15

Val Set, val_loss: 1.3498, val_error: 0.7273, auc: 0.8403
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.364360 --> 1.349812).  Saving model ...


batch 19, loss: 1.3939, instance_loss: 0.5937, weighted_loss: 1.1539, label: 2, bag_size: 23737
batch 39, loss: 1.1112, instance_loss: 0.6097, weighted_loss: 0.9607, label: 0, bag_size: 16555


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.4050, train_clustering_loss:  0.6135, train_error: 0.7234
class 0: acc 0.4666666666666667, correct 7/15
class 1: acc 0.0, correct 0/12
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.3506, val_error: 0.7273, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2359, instance_loss: 0.6160, weighted_loss: 1.0500, label: 0, bag_size: 11326
batch 39, loss: 1.8604, instance_loss: 0.6185, weighted_loss: 1.4878, label: 2, bag_size: 15369


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3618, train_clustering_loss:  0.6078, train_error: 0.6809
class 0: acc 0.38461538461538464, correct 5/13
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.2, correct 2/10
class 3: acc 0.4666666666666667, correct 7/15

Val Set, val_loss: 1.3050, val_error: 0.4545, auc: 0.8403
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.349812 --> 1.304954).  Saving model ...


batch 19, loss: 1.5653, instance_loss: 0.6178, weighted_loss: 1.2810, label: 2, bag_size: 23737
batch 39, loss: 1.5303, instance_loss: 0.6421, weighted_loss: 1.2638, label: 2, bag_size: 2632


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3658, train_clustering_loss:  0.6111, train_error: 0.6170
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.0, correct 0/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3260, val_error: 0.6364, auc: 0.8125
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4445, instance_loss: 0.6185, weighted_loss: 1.1967, label: 1, bag_size: 12737
batch 39, loss: 0.9459, instance_loss: 0.5679, weighted_loss: 0.8325, label: 0, bag_size: 11326


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2776, train_clustering_loss:  0.6062, train_error: 0.6170
class 0: acc 1.0, correct 16/16
class 1: acc 0.09090909090909091, correct 1/11
class 2: acc 0.125, correct 1/8
class 3: acc 0.0, correct 0/12

Val Set, val_loss: 1.2898, val_error: 0.7273, auc: 0.8368
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.304954 --> 1.289828).  Saving model ...


batch 19, loss: 0.8628, instance_loss: 0.5338, weighted_loss: 0.7641, label: 0, bag_size: 15101
batch 39, loss: 1.4153, instance_loss: 0.6406, weighted_loss: 1.1829, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2460, train_clustering_loss:  0.6037, train_error: 0.6383
class 0: acc 1.0, correct 15/15
class 1: acc 0.0, correct 0/8
class 2: acc 0.13333333333333333, correct 2/15
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.2984, val_error: 0.6364, auc: 0.7986
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3965, instance_loss: 0.6400, weighted_loss: 1.1696, label: 3, bag_size: 12626
batch 39, loss: 1.6785, instance_loss: 0.6472, weighted_loss: 1.3691, label: 1, bag_size: 6021


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2314, train_clustering_loss:  0.5972, train_error: 0.5745
class 0: acc 0.08333333333333333, correct 1/12
class 1: acc 0.0, correct 0/8
class 2: acc 1.0, correct 19/19
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3767, val_error: 0.6364, auc: 0.8160
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0665, instance_loss: 0.5702, weighted_loss: 0.9176, label: 2, bag_size: 2632
batch 39, loss: 1.2966, instance_loss: 0.6384, weighted_loss: 1.0991, label: 1, bag_size: 4747


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2065, train_clustering_loss:  0.6029, train_error: 0.4468
class 0: acc 1.0, correct 10/10
class 1: acc 0.21428571428571427, correct 3/14
class 2: acc 0.8125, correct 13/16
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.3265, val_error: 0.8182, auc: 0.8264
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5681, instance_loss: 0.5495, weighted_loss: 0.5626, label: 1, bag_size: 9703
batch 39, loss: 1.5940, instance_loss: 0.6822, weighted_loss: 1.3204, label: 3, bag_size: 11206


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2053, train_clustering_loss:  0.5949, train_error: 0.4468
class 0: acc 0.3076923076923077, correct 4/13
class 1: acc 0.9444444444444444, correct 17/18
class 2: acc 0.45454545454545453, correct 5/11
class 3: acc 0.0, correct 0/5

Val Set, val_loss: 1.2759, val_error: 0.5455, auc: 0.8264
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.289828 --> 1.275863).  Saving model ...


batch 19, loss: 0.7825, instance_loss: 0.5496, weighted_loss: 0.7126, label: 2, bag_size: 11341
batch 39, loss: 0.6752, instance_loss: 0.5187, weighted_loss: 0.6283, label: 2, bag_size: 23737


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2346, train_clustering_loss:  0.5987, train_error: 0.5745
class 0: acc 0.4444444444444444, correct 4/9
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6666666666666666, correct 10/15
class 3: acc 0.08333333333333333, correct 1/12

Val Set, val_loss: 1.2524, val_error: 0.6364, auc: 0.8229
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.275863 --> 1.252386).  Saving model ...


batch 19, loss: 1.0964, instance_loss: 0.5438, weighted_loss: 0.9306, label: 2, bag_size: 30302
batch 39, loss: 1.1695, instance_loss: 0.5697, weighted_loss: 0.9896, label: 2, bag_size: 23737


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.1879, train_clustering_loss:  0.5910, train_error: 0.5106
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.16666666666666666, correct 2/12
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.2395, val_error: 0.4545, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.252386 --> 1.239511).  Saving model ...


batch 19, loss: 1.4167, instance_loss: 0.5820, weighted_loss: 1.1663, label: 1, bag_size: 12737
batch 39, loss: 1.0791, instance_loss: 0.5749, weighted_loss: 0.9278, label: 3, bag_size: 26172


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1447, train_clustering_loss:  0.5875, train_error: 0.4681
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.375, correct 3/8
class 2: acc 0.7333333333333333, correct 11/15
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.1964, val_error: 0.5455, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.239511 --> 1.196393).  Saving model ...


batch 19, loss: 1.4277, instance_loss: 0.6097, weighted_loss: 1.1823, label: 1, bag_size: 19756
batch 39, loss: 1.7092, instance_loss: 0.6310, weighted_loss: 1.3858, label: 3, bag_size: 39178


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.1613, train_clustering_loss:  0.5925, train_error: 0.4468
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.2, correct 2/10

Val Set, val_loss: 1.1446, val_error: 0.2727, auc: 0.8194
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.196393 --> 1.144580).  Saving model ...


batch 19, loss: 0.6664, instance_loss: 0.5714, weighted_loss: 0.6379, label: 2, bag_size: 23737
batch 39, loss: 0.9901, instance_loss: 0.6146, weighted_loss: 0.8775, label: 0, bag_size: 15101


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.0765, train_clustering_loss:  0.5787, train_error: 0.4043
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.75, correct 9/12
class 2: acc 0.875, correct 14/16
class 3: acc 0.23076923076923078, correct 3/13

Val Set, val_loss: 1.1579, val_error: 0.4545, auc: 0.8472
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7514, instance_loss: 0.5299, weighted_loss: 0.6849, label: 3, bag_size: 6377
batch 39, loss: 1.6197, instance_loss: 0.6630, weighted_loss: 1.3327, label: 0, bag_size: 18417


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 1.0972, train_clustering_loss:  0.5720, train_error: 0.5106
class 0: acc 0.08333333333333333, correct 1/12
class 1: acc 0.6, correct 6/10
class 2: acc 0.6470588235294118, correct 11/17
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.2211, val_error: 0.6364, auc: 0.8194
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0638, instance_loss: 0.6062, weighted_loss: 0.9265, label: 3, bag_size: 26172
batch 39, loss: 1.2040, instance_loss: 0.5709, weighted_loss: 1.0140, label: 3, bag_size: 6377


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.9993, train_clustering_loss:  0.5650, train_error: 0.3404
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.3333333333333333, correct 4/12

Val Set, val_loss: 1.1023, val_error: 0.4545, auc: 0.8368
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.144580 --> 1.102324).  Saving model ...


batch 19, loss: 0.7988, instance_loss: 0.5194, weighted_loss: 0.7150, label: 0, bag_size: 33379
batch 39, loss: 2.1630, instance_loss: 0.6888, weighted_loss: 1.7208, label: 3, bag_size: 21991


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 0.9849, train_clustering_loss:  0.5511, train_error: 0.3404
class 0: acc 0.5714285714285714, correct 8/14
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.2, correct 1/5

Val Set, val_loss: 1.1248, val_error: 0.4545, auc: 0.8819
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.9126, instance_loss: 0.7150, weighted_loss: 1.5533, label: 0, bag_size: 27370
batch 39, loss: 0.6232, instance_loss: 0.5212, weighted_loss: 0.5926, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 0.9977, train_clustering_loss:  0.5617, train_error: 0.3191
class 0: acc 0.5833333333333334, correct 7/12
class 1: acc 0.8, correct 8/10
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.1522, val_error: 0.4545, auc: 0.8160
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5368, instance_loss: 0.4982, weighted_loss: 0.5252, label: 0, bag_size: 12821
batch 39, loss: 0.8816, instance_loss: 0.5602, weighted_loss: 0.7852, label: 3, bag_size: 12626


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 0.8812, train_clustering_loss:  0.5329, train_error: 0.3404
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.0476, val_error: 0.4545, auc: 0.8646
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.102324 --> 1.047570).  Saving model ...


batch 19, loss: 1.0519, instance_loss: 0.5592, weighted_loss: 0.9041, label: 2, bag_size: 11341
batch 39, loss: 1.4512, instance_loss: 0.7083, weighted_loss: 1.2283, label: 2, bag_size: 40177


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 22, train_loss: 0.8809, train_clustering_loss:  0.5375, train_error: 0.2979
class 0: acc 0.7647058823529411, correct 13/17
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.0756, val_error: 0.5455, auc: 0.8507
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4877, instance_loss: 0.4750, weighted_loss: 0.4839, label: 2, bag_size: 11341
batch 39, loss: 1.2068, instance_loss: 0.6546, weighted_loss: 1.0411, label: 3, bag_size: 17024


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 0.8090, train_clustering_loss:  0.5170, train_error: 0.2979
class 0: acc 1.0, correct 14/14
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 1.0676, val_error: 0.4545, auc: 0.8299
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.4621, instance_loss: 0.4569, weighted_loss: 0.4605, label: 2, bag_size: 23737
batch 39, loss: 0.2692, instance_loss: 0.3482, weighted_loss: 0.2929, label: 0, bag_size: 33379


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 0.6992, train_clustering_loss:  0.4986, train_error: 0.2553
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.0915, val_error: 0.5455, auc: 0.8646
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.4129, instance_loss: 0.4969, weighted_loss: 0.4381, label: 1, bag_size: 9703
batch 39, loss: 0.6330, instance_loss: 0.4356, weighted_loss: 0.5737, label: 0, bag_size: 16555


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 25, train_loss: 0.8857, train_clustering_loss:  0.5198, train_error: 0.2766
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.0687, val_error: 0.5455, auc: 0.8507
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.9382, instance_loss: 0.5498, weighted_loss: 0.8217, label: 1, bag_size: 6021
batch 39, loss: 0.6095, instance_loss: 0.4475, weighted_loss: 0.5609, label: 1, bag_size: 17691


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 26, train_loss: 0.7495, train_clustering_loss:  0.5159, train_error: 0.2128
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.1405, val_error: 0.5455, auc: 0.8125
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.4480, instance_loss: 0.5596, weighted_loss: 1.1815, label: 2, bag_size: 14084
batch 39, loss: 1.2876, instance_loss: 0.6556, weighted_loss: 1.0980, label: 3, bag_size: 4443


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.02127659574468085: correct 8/376
Epoch: 27, train_loss: 0.8017, train_clustering_loss:  0.5020, train_error: 0.2766
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.9375, correct 15/16
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.0678, val_error: 0.4545, auc: 0.8646
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.9029, instance_loss: 0.5337, weighted_loss: 0.7922, label: 0, bag_size: 5007
batch 39, loss: 0.4898, instance_loss: 0.4945, weighted_loss: 0.4912, label: 0, bag_size: 18417


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 28, train_loss: 0.6529, train_clustering_loss:  0.4945, train_error: 0.1277
class 0: acc 0.75, correct 6/8
class 1: acc 1.0, correct 14/14
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.0702, val_error: 0.5455, auc: 0.8750
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.0884, instance_loss: 0.6279, weighted_loss: 0.9503, label: 3, bag_size: 21991
batch 39, loss: 0.6019, instance_loss: 0.4168, weighted_loss: 0.5464, label: 1, bag_size: 33605


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.018617021276595744: correct 7/376
Epoch: 29, train_loss: 0.6980, train_clustering_loss:  0.4766, train_error: 0.1277
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 1.0, correct 16/16
class 2: acc 0.9, correct 9/10
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.1227, val_error: 0.5455, auc: 0.8924
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.5043, instance_loss: 0.4206, weighted_loss: 0.4792, label: 2, bag_size: 30302
batch 39, loss: 0.4847, instance_loss: 0.3653, weighted_loss: 0.4489, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.015957446808510637: correct 6/376
Epoch: 30, train_loss: 0.7130, train_clustering_loss:  0.4924, train_error: 0.3404
class 0: acc 0.7058823529411765, correct 12/17
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.4166666666666667, correct 5/12

Val Set, val_loss: 0.8817, val_error: 0.2727, auc: 0.8819
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.047570 --> 0.881677).  Saving model ...


batch 19, loss: 0.6273, instance_loss: 0.4910, weighted_loss: 0.5864, label: 1, bag_size: 4747
batch 39, loss: 0.3162, instance_loss: 0.3847, weighted_loss: 0.3368, label: 0, bag_size: 16555


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.06648936170212766: correct 25/376
Epoch: 31, train_loss: 0.5309, train_clustering_loss:  0.4329, train_error: 0.1277
class 0: acc 1.0, correct 14/14
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.8, correct 4/5

Val Set, val_loss: 1.1086, val_error: 0.4545, auc: 0.8819
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2163, instance_loss: 0.3192, weighted_loss: 0.2472, label: 0, bag_size: 12821
batch 39, loss: 0.2343, instance_loss: 0.3086, weighted_loss: 0.2566, label: 0, bag_size: 12821


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.0851063829787234: correct 32/376
Epoch: 32, train_loss: 0.5618, train_clustering_loss:  0.4424, train_error: 0.1489
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.9, correct 9/10
class 2: acc 0.9, correct 9/10
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 0.8398, val_error: 0.2727, auc: 0.8785
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (0.881677 --> 0.839823).  Saving model ...


batch 19, loss: 0.3634, instance_loss: 0.3498, weighted_loss: 0.3593, label: 0, bag_size: 33379
batch 39, loss: 0.1601, instance_loss: 0.4003, weighted_loss: 0.2322, label: 3, bag_size: 11206


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.07446808510638298: correct 28/376
Epoch: 33, train_loss: 0.4784, train_clustering_loss:  0.4385, train_error: 0.1064
class 0: acc 1.0, correct 9/9
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 1.0, correct 14/14
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 0.9056, val_error: 0.3636, auc: 0.8924
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8879, instance_loss: 0.6209, weighted_loss: 0.8078, label: 3, bag_size: 4443
batch 39, loss: 0.4277, instance_loss: 0.3926, weighted_loss: 0.4172, label: 2, bag_size: 25227


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.13297872340425532: correct 50/376
Epoch: 34, train_loss: 0.5249, train_clustering_loss:  0.4312, train_error: 0.2128
class 0: acc 0.75, correct 9/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.9, correct 9/10
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 0.9415, val_error: 0.4545, auc: 0.8924
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5312, instance_loss: 0.5159, weighted_loss: 0.5266, label: 3, bag_size: 1295
batch 39, loss: 0.3729, instance_loss: 0.4059, weighted_loss: 0.3828, label: 0, bag_size: 18417


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.15691489361702127: correct 59/376
Epoch: 35, train_loss: 0.4941, train_clustering_loss:  0.4103, train_error: 0.1702
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.1344, val_error: 0.5455, auc: 0.8889
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1693, instance_loss: 0.3084, weighted_loss: 0.2110, label: 0, bag_size: 16555
batch 39, loss: 0.2241, instance_loss: 0.3147, weighted_loss: 0.2513, label: 2, bag_size: 25227


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.19946808510638298: correct 75/376
Epoch: 36, train_loss: 0.4189, train_clustering_loss:  0.3783, train_error: 0.0851
class 0: acc 0.9444444444444444, correct 17/18
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 1.0, correct 11/11
class 3: acc 0.8571428571428571, correct 6/7

Val Set, val_loss: 0.8738, val_error: 0.3636, auc: 0.8889
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1486, instance_loss: 0.2155, weighted_loss: 0.1686, label: 0, bag_size: 16555
batch 39, loss: 1.0169, instance_loss: 0.6719, weighted_loss: 0.9134, label: 3, bag_size: 12626


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.2553191489361702: correct 96/376
Epoch: 37, train_loss: 0.4594, train_clustering_loss:  0.4003, train_error: 0.1489
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.875, correct 7/8
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 0.9201, val_error: 0.4545, auc: 0.8611
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.4505, instance_loss: 0.5845, weighted_loss: 0.4907, label: 1, bag_size: 19756
batch 39, loss: 0.4001, instance_loss: 0.3381, weighted_loss: 0.3815, label: 2, bag_size: 30302


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.15425531914893617: correct 58/376
Epoch: 38, train_loss: 0.4640, train_clustering_loss:  0.4146, train_error: 0.1702
class 0: acc 1.0, correct 13/13
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 0.8506, val_error: 0.3636, auc: 0.8993
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1873, instance_loss: 0.2598, weighted_loss: 0.2090, label: 0, bag_size: 12821
batch 39, loss: 0.5871, instance_loss: 0.4284, weighted_loss: 0.5395, label: 0, bag_size: 14055


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.19680851063829788: correct 74/376
Epoch: 39, train_loss: 0.4789, train_clustering_loss:  0.4066, train_error: 0.1489
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 0.9338, val_error: 0.3636, auc: 0.8785
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.6881, instance_loss: 0.5779, weighted_loss: 1.3551, label: 3, bag_size: 6572
batch 39, loss: 0.2406, instance_loss: 0.3205, weighted_loss: 0.2645, label: 2, bag_size: 30302


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.26595744680851063: correct 100/376
Epoch: 40, train_loss: 0.4310, train_clustering_loss:  0.3894, train_error: 0.1064
class 0: acc 1.0, correct 9/9
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 1.0, correct 12/12
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 0.8968, val_error: 0.3636, auc: 0.8750
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1202, instance_loss: 0.1948, weighted_loss: 0.1426, label: 0, bag_size: 14952
batch 39, loss: 0.3539, instance_loss: 0.3413, weighted_loss: 0.3501, label: 2, bag_size: 11341


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.30319148936170215: correct 114/376
Epoch: 41, train_loss: 0.4211, train_clustering_loss:  0.3869, train_error: 0.1489
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9, correct 9/10
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.1110, val_error: 0.6364, auc: 0.8750
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5079, instance_loss: 0.4954, weighted_loss: 0.5042, label: 3, bag_size: 1295
batch 39, loss: 0.5969, instance_loss: 0.6025, weighted_loss: 0.5986, label: 3, bag_size: 4443


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.26595744680851063: correct 100/376
Epoch: 42, train_loss: 0.4284, train_clustering_loss:  0.4064, train_error: 0.1064
class 0: acc 1.0, correct 10/10
class 1: acc 1.0, correct 11/11
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 0.7844, val_error: 0.3636, auc: 0.8854
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (0.839823 --> 0.784365).  Saving model ...


batch 19, loss: 0.1487, instance_loss: 0.2443, weighted_loss: 0.1774, label: 1, bag_size: 26697
batch 39, loss: 0.0378, instance_loss: 0.1371, weighted_loss: 0.0676, label: 3, bag_size: 11206


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.25: correct 94/376
Epoch: 43, train_loss: 0.3517, train_clustering_loss:  0.3709, train_error: 0.0426
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 0.9709, val_error: 0.4545, auc: 0.8854
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7369, instance_loss: 0.4735, weighted_loss: 0.6579, label: 1, bag_size: 28374
batch 39, loss: 0.5976, instance_loss: 0.3867, weighted_loss: 0.5343, label: 1, bag_size: 12737


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.32978723404255317: correct 124/376
Epoch: 44, train_loss: 0.3254, train_clustering_loss:  0.3464, train_error: 0.0638
class 0: acc 0.9473684210526315, correct 18/19
class 1: acc 1.0, correct 9/9
class 2: acc 1.0, correct 12/12
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 1.0469, val_error: 0.4545, auc: 0.8924
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0789, instance_loss: 0.1819, weighted_loss: 0.1098, label: 1, bag_size: 9703
batch 39, loss: 0.1919, instance_loss: 0.3684, weighted_loss: 0.2449, label: 0, bag_size: 1677


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.45478723404255317: correct 171/376
Epoch: 45, train_loss: 0.3571, train_clustering_loss:  0.3419, train_error: 0.1064
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 11/11
class 3: acc 0.42857142857142855, correct 3/7

Val Set, val_loss: 0.7652, val_error: 0.0909, auc: 0.8924
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 1.0, correct 3/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (0.784365 --> 0.765192).  Saving model ...


batch 19, loss: 0.1292, instance_loss: 0.2412, weighted_loss: 0.1628, label: 1, bag_size: 17691
batch 39, loss: 1.7601, instance_loss: 0.8664, weighted_loss: 1.4920, label: 3, bag_size: 4443


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.3962765957446808: correct 149/376
Epoch: 46, train_loss: 0.3964, train_clustering_loss:  0.3752, train_error: 0.1064
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 1.0, correct 12/12
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.1103, val_error: 0.3636, auc: 0.8229
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0664, instance_loss: 0.3468, weighted_loss: 0.1505, label: 2, bag_size: 2632
batch 39, loss: 0.3795, instance_loss: 0.6358, weighted_loss: 0.4564, label: 3, bag_size: 17024


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.3882978723404255: correct 146/376
Epoch: 47, train_loss: 0.2892, train_clustering_loss:  0.3377, train_error: 0.0638
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 1.0, correct 9/9
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.1039, val_error: 0.3636, auc: 0.8229
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.2727272727272727: correct 24/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0817, instance_loss: 0.1252, weighted_loss: 0.0947, label: 2, bag_size: 5938
batch 39, loss: 0.6095, instance_loss: 0.3932, weighted_loss: 0.5446, label: 1, bag_size: 4747


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.3377659574468085: correct 127/376
Epoch: 48, train_loss: 0.3340, train_clustering_loss:  0.3667, train_error: 0.0851
class 0: acc 0.8, correct 12/15
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 7/7
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 0.7599, val_error: 0.1818, auc: 0.8854
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (0.765192 --> 0.759893).  Saving model ...


batch 19, loss: 0.6862, instance_loss: 0.4397, weighted_loss: 0.6122, label: 0, bag_size: 14055
batch 39, loss: 0.7705, instance_loss: 0.5510, weighted_loss: 0.7047, label: 0, bag_size: 27370


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.40425531914893614: correct 152/376
Epoch: 49, train_loss: 0.3706, train_clustering_loss:  0.3576, train_error: 0.1277
class 0: acc 1.0, correct 11/11
class 1: acc 0.8333333333333334, correct 5/6
class 2: acc 0.625, correct 5/8
class 3: acc 0.9090909090909091, correct 20/22

Val Set, val_loss: 0.9859, val_error: 0.4545, auc: 0.8542
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.1465, instance_loss: 0.2095, weighted_loss: 0.1654, label: 2, bag_size: 11341
batch 39, loss: 0.2448, instance_loss: 0.2851, weighted_loss: 0.2569, label: 1, bag_size: 6021


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.40425531914893614: correct 152/376
Epoch: 50, train_loss: 0.2774, train_clustering_loss:  0.3178, train_error: 0.0426
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 11/11
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.0187, val_error: 0.3636, auc: 0.8542
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1539, instance_loss: 0.2557, weighted_loss: 0.1845, label: 2, bag_size: 14084
batch 39, loss: 0.1228, instance_loss: 0.3619, weighted_loss: 0.1945, label: 3, bag_size: 39178


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.45478723404255317: correct 171/376
Epoch: 51, train_loss: 0.2547, train_clustering_loss:  0.3166, train_error: 0.0638
class 0: acc 1.0, correct 20/20
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.0617, val_error: 0.3636, auc: 0.8681
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0304, instance_loss: 0.1002, weighted_loss: 0.0513, label: 0, bag_size: 11326
batch 39, loss: 0.4136, instance_loss: 0.3498, weighted_loss: 0.3945, label: 2, bag_size: 30302


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.43617021276595747: correct 164/376
Epoch: 52, train_loss: 0.3161, train_clustering_loss:  0.3393, train_error: 0.0638
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 9/9
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.0426, val_error: 0.3636, auc: 0.8403
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.2840909090909091: correct 25/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2025, instance_loss: 0.3572, weighted_loss: 0.2489, label: 0, bag_size: 29269
batch 39, loss: 0.0839, instance_loss: 0.1702, weighted_loss: 0.1098, label: 1, bag_size: 19756


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.5531914893617021: correct 208/376
Epoch: 53, train_loss: 0.1920, train_clustering_loss:  0.2859, train_error: 0.0213
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 14/14
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.1764, val_error: 0.3636, auc: 0.8333
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.32954545454545453: correct 29/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.1773, instance_loss: 0.4438, weighted_loss: 0.2572, label: 0, bag_size: 5007
batch 39, loss: 0.0714, instance_loss: 0.1542, weighted_loss: 0.0962, label: 3, bag_size: 6377


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.6063829787234043: correct 228/376
Epoch: 54, train_loss: 0.1962, train_clustering_loss:  0.2802, train_error: 0.0213
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 10/10
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 0.8889, val_error: 0.3636, auc: 0.8958
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.38636363636363635: correct 34/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0771, instance_loss: 0.1604, weighted_loss: 0.1021, label: 1, bag_size: 26697
batch 39, loss: 0.0364, instance_loss: 0.0983, weighted_loss: 0.0549, label: 1, bag_size: 26697


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.6063829787234043: correct 228/376
Epoch: 55, train_loss: 0.2136, train_clustering_loss:  0.2925, train_error: 0.0638
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 14/14
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 0.9852, val_error: 0.2727, auc: 0.8750
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.375: correct 33/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.0674, instance_loss: 0.1859, weighted_loss: 0.1029, label: 3, bag_size: 6377
batch 39, loss: 0.2015, instance_loss: 0.2322, weighted_loss: 0.2107, label: 1, bag_size: 14785


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.6223404255319149: correct 234/376
Epoch: 56, train_loss: 0.1623, train_clustering_loss:  0.2595, train_error: 0.0000
class 0: acc 1.0, correct 17/17
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 0.8611, val_error: 0.2727, auc: 0.8854
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.36363636363636365: correct 32/88
class 0: acc 1.0, correct 3/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0202, instance_loss: 0.0917, weighted_loss: 0.0416, label: 0, bag_size: 18417
batch 39, loss: 0.1672, instance_loss: 0.2890, weighted_loss: 0.2037, label: 1, bag_size: 17691


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.6409574468085106: correct 241/376
Epoch: 57, train_loss: 0.1368, train_clustering_loss:  0.2450, train_error: 0.0000
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.0940, val_error: 0.3636, auc: 0.8229
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.32954545454545453: correct 29/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.0201, instance_loss: 0.3319, weighted_loss: 0.1136, label: 2, bag_size: 40177
batch 39, loss: 0.1539, instance_loss: 0.2087, weighted_loss: 0.1703, label: 3, bag_size: 4892


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.6968085106382979: correct 262/376
Epoch: 58, train_loss: 0.1502, train_clustering_loss:  0.2557, train_error: 0.0213
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 13/13
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.1047, val_error: 0.2727, auc: 0.8438
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.3068181818181818: correct 27/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2336, instance_loss: 0.2546, weighted_loss: 0.2399, label: 2, bag_size: 30302
batch 39, loss: 0.0288, instance_loss: 0.1392, weighted_loss: 0.0619, label: 1, bag_size: 19756


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.5531914893617021: correct 208/376
Epoch: 59, train_loss: 0.1550, train_clustering_loss:  0.2768, train_error: 0.0000
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.0809, val_error: 0.3636, auc: 0.8437
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.32954545454545453: correct 29/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0277, instance_loss: 0.1241, weighted_loss: 0.0567, label: 3, bag_size: 6377
batch 39, loss: 0.3621, instance_loss: 0.3952, weighted_loss: 0.3720, label: 3, bag_size: 21991


class 0 clustering acc 0.9793882978723404: correct 1473/1504
class 1 clustering acc 0.5638297872340425: correct 212/376
Epoch: 60, train_loss: 0.1989, train_clustering_loss:  0.3078, train_error: 0.0426
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.1062, val_error: 0.3636, auc: 0.8438
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.3181818181818182: correct 28/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.2621, instance_loss: 0.3932, weighted_loss: 0.3014, label: 3, bag_size: 17024
batch 39, loss: 0.0589, instance_loss: 0.1517, weighted_loss: 0.0867, label: 3, bag_size: 4892


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.5691489361702128: correct 214/376
Epoch: 61, train_loss: 0.2803, train_clustering_loss:  0.3005, train_error: 0.0638
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.1996, val_error: 0.4545, auc: 0.8194
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.3068181818181818: correct 27/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.4159, instance_loss: 0.4481, weighted_loss: 0.4256, label: 0, bag_size: 5007
batch 39, loss: 0.4009, instance_loss: 0.3433, weighted_loss: 0.3836, label: 1, bag_size: 33605


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.6329787234042553: correct 238/376
Epoch: 62, train_loss: 0.1435, train_clustering_loss:  0.2513, train_error: 0.0000
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 5/5
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 0.8722, val_error: 0.2727, auc: 0.8993
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.3522727272727273: correct 31/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1290, instance_loss: 0.1779, weighted_loss: 0.1437, label: 3, bag_size: 26172
batch 39, loss: 0.1936, instance_loss: 0.3518, weighted_loss: 0.2411, label: 0, bag_size: 5007


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.5638297872340425: correct 212/376
Epoch: 63, train_loss: 0.1849, train_clustering_loss:  0.2922, train_error: 0.0213
class 0: acc 1.0, correct 11/11
class 1: acc 1.0, correct 13/13
class 2: acc 0.875, correct 7/8
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.1131, val_error: 0.2727, auc: 0.8229
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.3522727272727273: correct 31/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.2471, instance_loss: 0.5325, weighted_loss: 0.3327, label: 0, bag_size: 27370
batch 39, loss: 0.0429, instance_loss: 0.1315, weighted_loss: 0.0695, label: 1, bag_size: 28374


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.6329787234042553: correct 238/376
Epoch: 64, train_loss: 0.1510, train_clustering_loss:  0.2505, train_error: 0.0000
class 0: acc 1.0, correct 11/11
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.3405, val_error: 0.6364, auc: 0.8542
class 0 clustering acc 0.9176136363636364: correct 323/352
class 1 clustering acc 0.3522727272727273: correct 31/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0434, instance_loss: 0.1847, weighted_loss: 0.0858, label: 0, bag_size: 15101
batch 39, loss: 0.0337, instance_loss: 0.1236, weighted_loss: 0.0607, label: 2, bag_size: 18012


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.7154255319148937: correct 269/376
Epoch: 65, train_loss: 0.1101, train_clustering_loss:  0.2369, train_error: 0.0213
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 14/14
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.2832, val_error: 0.4545, auc: 0.8333
class 0 clustering acc 0.9176136363636364: correct 323/352
class 1 clustering acc 0.3409090909090909: correct 30/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0316, instance_loss: 0.1126, weighted_loss: 0.0559, label: 1, bag_size: 4387
batch 39, loss: 0.0178, instance_loss: 0.0577, weighted_loss: 0.0298, label: 0, bag_size: 15101


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.7845744680851063: correct 295/376
Epoch: 66, train_loss: 0.0904, train_clustering_loss:  0.2217, train_error: 0.0000
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 18/18
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 4/4

Val Set, val_loss: 1.1554, val_error: 0.4545, auc: 0.8438
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.36363636363636365: correct 32/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.0494, instance_loss: 0.2818, weighted_loss: 0.1191, label: 3, bag_size: 12626
batch 39, loss: 0.0104, instance_loss: 0.0549, weighted_loss: 0.0238, label: 0, bag_size: 11326


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.7446808510638298: correct 280/376
Epoch: 67, train_loss: 0.1189, train_clustering_loss:  0.2079, train_error: 0.0213
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 1.0, correct 15/15
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 0.9410, val_error: 0.2727, auc: 0.8750
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.4318181818181818: correct 38/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0337, instance_loss: 0.1228, weighted_loss: 0.0604, label: 2, bag_size: 18012
batch 39, loss: 0.1355, instance_loss: 0.1801, weighted_loss: 0.1489, label: 2, bag_size: 2078


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.773936170212766: correct 291/376
Epoch: 68, train_loss: 0.1056, train_clustering_loss:  0.1955, train_error: 0.0213
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 16/16
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 0.9636, val_error: 0.2727, auc: 0.8750
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.42045454545454547: correct 37/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.1818, ROC AUC: 0.8854
Test error: 0.7273, ROC AUC: 0.6632
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3

Training Fold 6!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7312, instance_loss: 1.1130, weighted_loss: 1.5457, label: 1, bag_size: 33605
batch 39, loss: 1.9275, instance_loss: 0.9230, weighted_loss: 1.6261, label: 1, bag_size: 15079


class 0 clustering acc 0.9527925531914894: correct 1433/1504
class 1 clustering acc 0.061170212765957445: correct 23/376
Epoch: 0, train_loss: 1.3890, train_clustering_loss:  1.0254, train_error: 0.6596
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/9
class 2: acc 0.0, correct 0/11
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.4050, val_error: 0.7273, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.404959).  Saving model ...


batch 19, loss: 1.4179, instance_loss: 0.7434, weighted_loss: 1.2156, label: 2, bag_size: 30302
batch 39, loss: 1.4006, instance_loss: 0.6879, weighted_loss: 1.1868, label: 1, bag_size: 26697


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4039, train_clustering_loss:  0.7283, train_error: 0.7447
class 0: acc 0.0, correct 0/7
class 1: acc 0.0, correct 0/14
class 2: acc 0.07142857142857142, correct 1/14
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.3966, val_error: 0.7273, auc: 0.7187
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.404959 --> 1.396601).  Saving model ...


batch 19, loss: 1.5739, instance_loss: 0.6135, weighted_loss: 1.2857, label: 3, bag_size: 26172
batch 39, loss: 1.0795, instance_loss: 0.6016, weighted_loss: 0.9361, label: 2, bag_size: 14084


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.4061, train_clustering_loss:  0.6380, train_error: 0.7660
class 0: acc 0.0, correct 0/11
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.2857142857142857, correct 4/14
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4023, val_error: 0.8182, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.8106, instance_loss: 0.6563, weighted_loss: 1.4643, label: 0, bag_size: 5626
batch 39, loss: 1.2504, instance_loss: 0.6069, weighted_loss: 1.0573, label: 3, bag_size: 21991


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3989, train_clustering_loss:  0.6140, train_error: 0.7021
class 0: acc 0.0, correct 0/10
class 1: acc 0.6666666666666666, correct 10/15
class 2: acc 0.1, correct 1/10
class 3: acc 0.25, correct 3/12

Val Set, val_loss: 1.3496, val_error: 0.4545, auc: 0.7118
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.396601 --> 1.349555).  Saving model ...


batch 19, loss: 1.2100, instance_loss: 0.5869, weighted_loss: 1.0231, label: 2, bag_size: 30302
batch 39, loss: 1.2455, instance_loss: 0.5783, weighted_loss: 1.0453, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3534, train_clustering_loss:  0.6072, train_error: 0.5745
class 0: acc 0.4, correct 4/10
class 1: acc 0.6875, correct 11/16
class 2: acc 0.36363636363636365, correct 4/11
class 3: acc 0.1, correct 1/10

Val Set, val_loss: 1.3401, val_error: 0.5455, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.349555 --> 1.340065).  Saving model ...


batch 19, loss: 1.0584, instance_loss: 0.5700, weighted_loss: 0.9119, label: 1, bag_size: 6021
batch 39, loss: 1.5743, instance_loss: 0.6427, weighted_loss: 1.2948, label: 0, bag_size: 14055


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3375, train_clustering_loss:  0.6071, train_error: 0.6170
class 0: acc 0.0, correct 0/10
class 1: acc 1.0, correct 15/15
class 2: acc 0.0, correct 0/8
class 3: acc 0.21428571428571427, correct 3/14

Val Set, val_loss: 1.3507, val_error: 0.7273, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5790, instance_loss: 0.6343, weighted_loss: 1.2956, label: 2, bag_size: 19134
batch 39, loss: 1.2118, instance_loss: 0.6038, weighted_loss: 1.0294, label: 2, bag_size: 30302


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3151, train_clustering_loss:  0.6118, train_error: 0.5745
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.25, correct 3/12
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.3279, val_error: 0.5455, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.340065 --> 1.327919).  Saving model ...


batch 19, loss: 0.9589, instance_loss: 0.6381, weighted_loss: 0.8627, label: 0, bag_size: 5626
batch 39, loss: 1.3615, instance_loss: 0.5868, weighted_loss: 1.1291, label: 1, bag_size: 6021


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2780, train_clustering_loss:  0.6107, train_error: 0.5106
class 0: acc 1.0, correct 14/14
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.23076923076923078, correct 3/13

Val Set, val_loss: 1.2931, val_error: 0.6364, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.327919 --> 1.293054).  Saving model ...


batch 19, loss: 1.0861, instance_loss: 0.6027, weighted_loss: 0.9411, label: 0, bag_size: 18417
batch 39, loss: 1.8809, instance_loss: 0.6589, weighted_loss: 1.5143, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.1887, train_clustering_loss:  0.6035, train_error: 0.3191
class 0: acc 0.9444444444444444, correct 17/18
class 1: acc 0.3333333333333333, correct 2/6
class 2: acc 0.1111111111111111, correct 1/9
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.3344, val_error: 0.7273, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5072, instance_loss: 0.6477, weighted_loss: 1.2493, label: 2, bag_size: 11341
batch 39, loss: 0.9122, instance_loss: 0.5828, weighted_loss: 0.8134, label: 1, bag_size: 15079


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.1863, train_clustering_loss:  0.5941, train_error: 0.5106
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.35714285714285715, correct 5/14
class 2: acc 0.0, correct 0/7
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.2646, val_error: 0.5455, auc: 0.7153
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.293054 --> 1.264639).  Saving model ...


batch 19, loss: 1.1376, instance_loss: 0.6241, weighted_loss: 0.9836, label: 2, bag_size: 30302
batch 39, loss: 1.3211, instance_loss: 0.5699, weighted_loss: 1.0957, label: 1, bag_size: 16680


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.1782, train_clustering_loss:  0.6000, train_error: 0.4681
class 0: acc 0.0, correct 0/5
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.4375, correct 7/16
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.3725, val_error: 0.7273, auc: 0.7222
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5983, instance_loss: 0.5210, weighted_loss: 0.5751, label: 1, bag_size: 20684
batch 39, loss: 1.2577, instance_loss: 0.6192, weighted_loss: 1.0661, label: 2, bag_size: 2632


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.1615, train_clustering_loss:  0.5887, train_error: 0.4894
class 0: acc 0.0, correct 0/10
class 1: acc 0.8235294117647058, correct 14/17
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.3505, val_error: 0.6364, auc: 0.7361
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.6600, instance_loss: 0.5238, weighted_loss: 0.6191, label: 2, bag_size: 18012
batch 39, loss: 0.8284, instance_loss: 0.5300, weighted_loss: 0.7389, label: 2, bag_size: 19134


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.0882, train_clustering_loss:  0.5859, train_error: 0.4043
class 0: acc 0.625, correct 10/16
class 1: acc 0.6, correct 6/10
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.3634, val_error: 0.6364, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7515, instance_loss: 0.5414, weighted_loss: 0.6885, label: 3, bag_size: 26172
batch 39, loss: 1.3638, instance_loss: 0.5970, weighted_loss: 1.1338, label: 2, bag_size: 19134


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.1517, train_clustering_loss:  0.5818, train_error: 0.5745
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.0, correct 0/9
class 2: acc 0.2, correct 2/10
class 3: acc 0.6470588235294118, correct 11/17

Val Set, val_loss: 1.3089, val_error: 0.5455, auc: 0.6667
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8189, instance_loss: 0.5293, weighted_loss: 0.7320, label: 0, bag_size: 5626
batch 39, loss: 1.0458, instance_loss: 0.5600, weighted_loss: 0.9001, label: 2, bag_size: 2078


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 0.9218, train_clustering_loss:  0.5475, train_error: 0.2553
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.625, correct 5/8
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.3220, val_error: 0.6364, auc: 0.6806
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.4542, instance_loss: 0.6359, weighted_loss: 1.2087, label: 1, bag_size: 12737
batch 39, loss: 0.6751, instance_loss: 0.4510, weighted_loss: 0.6079, label: 3, bag_size: 12796


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 0.8868, train_clustering_loss:  0.5449, train_error: 0.3191
class 0: acc 0.6875, correct 11/16
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 1.0, correct 4/4

Val Set, val_loss: 1.4240, val_error: 0.5455, auc: 0.7014
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.5360, instance_loss: 0.4783, weighted_loss: 0.5187, label: 2, bag_size: 19134
batch 39, loss: 0.7001, instance_loss: 0.5340, weighted_loss: 0.6503, label: 0, bag_size: 18417


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.0004, train_clustering_loss:  0.5402, train_error: 0.4043
class 0: acc 0.5, correct 5/10
class 1: acc 0.625, correct 5/8
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.6666666666666666, correct 12/18

Val Set, val_loss: 1.3281, val_error: 0.6364, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.5330, instance_loss: 0.4479, weighted_loss: 0.5075, label: 2, bag_size: 16556
batch 39, loss: 0.4271, instance_loss: 0.4663, weighted_loss: 0.4389, label: 1, bag_size: 17691


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 0.8819, train_clustering_loss:  0.5288, train_error: 0.3191
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.5, correct 3/6

Val Set, val_loss: 1.2693, val_error: 0.4545, auc: 0.7083
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.2532, instance_loss: 0.6217, weighted_loss: 1.0637, label: 3, bag_size: 3355
batch 39, loss: 0.6155, instance_loss: 0.4296, weighted_loss: 0.5597, label: 2, bag_size: 16556


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.8195, train_clustering_loss:  0.5111, train_error: 0.3191
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 1.0, correct 14/14
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.2369, val_error: 0.5455, auc: 0.6910
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.264639 --> 1.236890).  Saving model ...


batch 19, loss: 0.2698, instance_loss: 0.3697, weighted_loss: 0.2998, label: 1, bag_size: 12367
batch 39, loss: 1.1088, instance_loss: 0.5735, weighted_loss: 0.9482, label: 2, bag_size: 2078


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 0.8168, train_clustering_loss:  0.5057, train_error: 0.3404
class 0: acc 0.75, correct 9/12
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.4, correct 4/10
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.3414, val_error: 0.6364, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4598, instance_loss: 0.4972, weighted_loss: 0.4710, label: 0, bag_size: 15101
batch 39, loss: 0.5564, instance_loss: 0.5281, weighted_loss: 0.5479, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.015957446808510637: correct 6/376
Epoch: 20, train_loss: 0.5783, train_clustering_loss:  0.4624, train_error: 0.1489
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.8, correct 8/10
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.5151, val_error: 0.7273, auc: 0.6285
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8444, instance_loss: 0.5629, weighted_loss: 0.7600, label: 2, bag_size: 28856
batch 39, loss: 0.2470, instance_loss: 0.3812, weighted_loss: 0.2873, label: 2, bag_size: 11341


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.015957446808510637: correct 6/376
Epoch: 21, train_loss: 0.5697, train_clustering_loss:  0.4378, train_error: 0.1702
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.8888888888888888, correct 16/18
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.3398, val_error: 0.5455, auc: 0.7257
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2488, instance_loss: 0.3364, weighted_loss: 0.2751, label: 2, bag_size: 18012
batch 39, loss: 0.9761, instance_loss: 0.7308, weighted_loss: 0.9025, label: 0, bag_size: 2928


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.09042553191489362: correct 34/376
Epoch: 22, train_loss: 0.5362, train_clustering_loss:  0.4255, train_error: 0.2128
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.9, correct 9/10
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.3688, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2611, instance_loss: 0.3487, weighted_loss: 0.2873, label: 2, bag_size: 18012
batch 39, loss: 0.1366, instance_loss: 0.2117, weighted_loss: 0.1591, label: 3, bag_size: 17024


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0851063829787234: correct 32/376
Epoch: 23, train_loss: 0.5595, train_clustering_loss:  0.4288, train_error: 0.2340
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.5, correct 6/12
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4852, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.2247, instance_loss: 0.3333, weighted_loss: 0.2573, label: 2, bag_size: 19134
batch 39, loss: 0.3067, instance_loss: 0.3748, weighted_loss: 0.3271, label: 1, bag_size: 12367


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.10638297872340426: correct 40/376
Epoch: 24, train_loss: 0.5618, train_clustering_loss:  0.4184, train_error: 0.1915
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.4651, val_error: 0.6364, auc: 0.6319
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.8949, instance_loss: 0.4168, weighted_loss: 0.7515, label: 1, bag_size: 20684
batch 39, loss: 0.2701, instance_loss: 0.3582, weighted_loss: 0.2966, label: 1, bag_size: 5424


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.16489361702127658: correct 62/376
Epoch: 25, train_loss: 0.5005, train_clustering_loss:  0.4023, train_error: 0.1702
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.6, correct 6/10
class 2: acc 0.875, correct 14/16
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.7834, val_error: 0.6364, auc: 0.5694
class 0 clustering acc 0.9318181818181818: correct 328/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.2665, instance_loss: 0.3349, weighted_loss: 0.2870, label: 1, bag_size: 15079
batch 39, loss: 1.2184, instance_loss: 0.4827, weighted_loss: 0.9977, label: 1, bag_size: 4747


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.21010638297872342: correct 79/376
Epoch: 26, train_loss: 0.4801, train_clustering_loss:  0.3954, train_error: 0.1277
class 0: acc 0.875, correct 7/8
class 1: acc 0.8, correct 12/15
class 2: acc 1.0, correct 10/10
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.4281, val_error: 0.6364, auc: 0.6944
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.6372, instance_loss: 0.4599, weighted_loss: 0.5840, label: 2, bag_size: 14084
batch 39, loss: 0.1111, instance_loss: 0.1795, weighted_loss: 0.1316, label: 3, bag_size: 39178


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.14361702127659576: correct 54/376
Epoch: 27, train_loss: 0.5609, train_clustering_loss:  0.4288, train_error: 0.2553
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.75, correct 9/12
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.4760, val_error: 0.5455, auc: 0.7292
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.6631, instance_loss: 0.5261, weighted_loss: 0.6220, label: 0, bag_size: 5007
batch 39, loss: 0.9267, instance_loss: 0.4895, weighted_loss: 0.7955, label: 1, bag_size: 6021


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.19148936170212766: correct 72/376
Epoch: 28, train_loss: 0.5462, train_clustering_loss:  0.3901, train_error: 0.1277
class 0: acc 0.75, correct 9/12
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.4878, val_error: 0.5455, auc: 0.7431
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2698, instance_loss: 0.2752, weighted_loss: 0.2714, label: 2, bag_size: 2078
batch 39, loss: 0.4950, instance_loss: 0.4323, weighted_loss: 0.4762, label: 1, bag_size: 33605


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.2154255319148936: correct 81/376
Epoch: 29, train_loss: 0.5788, train_clustering_loss:  0.4216, train_error: 0.2128
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.6, correct 6/10
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.5395, val_error: 0.5455, auc: 0.6875
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1811, instance_loss: 0.1840, weighted_loss: 0.1820, label: 3, bag_size: 25817
batch 39, loss: 0.3753, instance_loss: 0.4846, weighted_loss: 0.4081, label: 2, bag_size: 25227


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.2553191489361702: correct 96/376
Epoch: 30, train_loss: 0.3811, train_clustering_loss:  0.3482, train_error: 0.0851
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 1.0, correct 9/9
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.6143, val_error: 0.6364, auc: 0.6354
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.4724, instance_loss: 0.3382, weighted_loss: 0.4321, label: 1, bag_size: 26697
batch 39, loss: 0.5077, instance_loss: 0.4241, weighted_loss: 0.4826, label: 1, bag_size: 5424


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.1595744680851064: correct 60/376
Epoch: 31, train_loss: 0.5140, train_clustering_loss:  0.4068, train_error: 0.1489
class 0: acc 0.75, correct 12/16
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 5/5

Val Set, val_loss: 1.5525, val_error: 0.4545, auc: 0.7535
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3942, instance_loss: 0.3846, weighted_loss: 0.3913, label: 2, bag_size: 28856
batch 39, loss: 0.3387, instance_loss: 0.4199, weighted_loss: 0.3630, label: 2, bag_size: 28856


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.29521276595744683: correct 111/376
Epoch: 32, train_loss: 0.3949, train_clustering_loss:  0.3546, train_error: 0.0638
class 0: acc 1.0, correct 9/9
class 1: acc 1.0, correct 16/16
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.7112, val_error: 0.6364, auc: 0.5903
class 0 clustering acc 0.9232954545454546: correct 325/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0501, instance_loss: 0.1543, weighted_loss: 0.0813, label: 1, bag_size: 12367
batch 39, loss: 0.4632, instance_loss: 0.4374, weighted_loss: 0.4555, label: 2, bag_size: 2632


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.40691489361702127: correct 153/376
Epoch: 33, train_loss: 0.3298, train_clustering_loss:  0.3227, train_error: 0.0851
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 1.0, correct 18/18

Val Set, val_loss: 1.6789, val_error: 0.6364, auc: 0.6771
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.0662, instance_loss: 0.0969, weighted_loss: 0.0754, label: 3, bag_size: 39178
batch 39, loss: 0.0910, instance_loss: 0.1951, weighted_loss: 0.1223, label: 2, bag_size: 25227


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.47074468085106386: correct 177/376
Epoch: 34, train_loss: 0.2888, train_clustering_loss:  0.3034, train_error: 0.0851
class 0: acc 0.8, correct 8/10
class 1: acc 0.9, correct 9/10
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.6103, val_error: 0.4545, auc: 0.6875
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1056, instance_loss: 0.1385, weighted_loss: 0.1154, label: 3, bag_size: 4443
batch 39, loss: 0.1830, instance_loss: 0.2453, weighted_loss: 0.2017, label: 1, bag_size: 17691


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.375: correct 141/376
Epoch: 35, train_loss: 0.3683, train_clustering_loss:  0.3394, train_error: 0.1489
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.5, correct 5/10
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.7019, val_error: 0.5455, auc: 0.7083
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1680, instance_loss: 0.3047, weighted_loss: 0.2090, label: 1, bag_size: 5424
batch 39, loss: 0.1834, instance_loss: 0.2829, weighted_loss: 0.2133, label: 2, bag_size: 25227


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.3882978723404255: correct 146/376
Epoch: 36, train_loss: 0.4116, train_clustering_loss:  0.3342, train_error: 0.1277
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.875, correct 14/16
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.7448, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.3224, instance_loss: 0.3209, weighted_loss: 0.3220, label: 1, bag_size: 5424
batch 39, loss: 0.0545, instance_loss: 0.2033, weighted_loss: 0.0992, label: 2, bag_size: 11341


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.4574468085106383: correct 172/376
Epoch: 37, train_loss: 0.2944, train_clustering_loss:  0.3074, train_error: 0.0638
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 1.0, correct 13/13
class 2: acc 1.0, correct 15/15
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.8036, val_error: 0.6364, auc: 0.6771
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.2264, instance_loss: 0.5598, weighted_loss: 1.0264, label: 1, bag_size: 12737
batch 39, loss: 0.1368, instance_loss: 0.1884, weighted_loss: 0.1522, label: 3, bag_size: 26172


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.4015957446808511: correct 151/376
Epoch: 38, train_loss: 0.3576, train_clustering_loss:  0.3222, train_error: 0.1064
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 1.0, correct 14/14
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.8433, val_error: 0.5455, auc: 0.7083
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.1820, instance_loss: 0.3295, weighted_loss: 0.2263, label: 2, bag_size: 28856
batch 39, loss: 0.1590, instance_loss: 0.2308, weighted_loss: 0.1805, label: 1, bag_size: 17691


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.4095744680851064: correct 154/376
Epoch: 39, train_loss: 0.2538, train_clustering_loss:  0.3178, train_error: 0.0426
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.8281, val_error: 0.5455, auc: 0.7083
class 0 clustering acc 0.9204545454545454: correct 324/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.5104, instance_loss: 0.3834, weighted_loss: 0.4723, label: 1, bag_size: 33605
batch 39, loss: 0.5223, instance_loss: 0.2956, weighted_loss: 0.4543, label: 3, bag_size: 26172


class 0 clustering acc 0.9813829787234043: correct 1476/1504
class 1 clustering acc 0.48936170212765956: correct 184/376
Epoch: 40, train_loss: 0.3956, train_clustering_loss:  0.3422, train_error: 0.1489
class 0: acc 0.8, correct 8/10
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.7558, val_error: 0.4545, auc: 0.7083
class 0 clustering acc 0.9375: correct 330/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.3972, instance_loss: 0.3538, weighted_loss: 0.3842, label: 0, bag_size: 14952
batch 39, loss: 0.0834, instance_loss: 0.1533, weighted_loss: 0.1044, label: 2, bag_size: 18012


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.4175531914893617: correct 157/376
Epoch: 41, train_loss: 0.3863, train_clustering_loss:  0.3344, train_error: 0.1277
class 0: acc 1.0, correct 11/11
class 1: acc 0.6, correct 6/10
class 2: acc 1.0, correct 13/13
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.7027, val_error: 0.5455, auc: 0.7188
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.4848, instance_loss: 0.3638, weighted_loss: 0.4485, label: 3, bag_size: 4443
batch 39, loss: 0.0274, instance_loss: 0.0814, weighted_loss: 0.0436, label: 3, bag_size: 39178


class 0 clustering acc 0.992686170212766: correct 1493/1504
class 1 clustering acc 0.44680851063829785: correct 168/376
Epoch: 42, train_loss: 0.3457, train_clustering_loss:  0.3223, train_error: 0.0851
class 0: acc 0.75, correct 6/8
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 1.0, correct 16/16
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.7379, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.0439, instance_loss: 0.0860, weighted_loss: 0.0566, label: 3, bag_size: 20225
batch 39, loss: 0.2166, instance_loss: 0.3705, weighted_loss: 0.2628, label: 2, bag_size: 2632


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.5611702127659575: correct 211/376
Epoch: 43, train_loss: 0.2579, train_clustering_loss:  0.2655, train_error: 0.1064
class 0: acc 0.25, correct 1/4
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 1.0, correct 17/17
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.9191, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0156, instance_loss: 0.0642, weighted_loss: 0.0302, label: 3, bag_size: 12708
batch 39, loss: 0.0890, instance_loss: 0.2281, weighted_loss: 0.1307, label: 0, bag_size: 5626


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.5372340425531915: correct 202/376
Epoch: 44, train_loss: 0.3004, train_clustering_loss:  0.2937, train_error: 0.0638
class 0: acc 0.8823529411764706, correct 15/17
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.8671, val_error: 0.6364, auc: 0.6285
class 0 clustering acc 0.9005681818181818: correct 317/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.1979, instance_loss: 0.2425, weighted_loss: 0.2113, label: 1, bag_size: 20684
batch 39, loss: 0.3261, instance_loss: 0.4418, weighted_loss: 0.3608, label: 0, bag_size: 1677


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.6675531914893617: correct 251/376
Epoch: 45, train_loss: 0.2566, train_clustering_loss:  0.2524, train_error: 0.0638
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.8093, val_error: 0.4545, auc: 0.6979
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 1.6898, instance_loss: 0.7259, weighted_loss: 1.4006, label: 1, bag_size: 4747
batch 39, loss: 0.0292, instance_loss: 0.0758, weighted_loss: 0.0432, label: 3, bag_size: 39178


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.6196808510638298: correct 233/376
Epoch: 46, train_loss: 0.2997, train_clustering_loss:  0.2750, train_error: 0.0851
class 0: acc 1.0, correct 13/13
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.9269, val_error: 0.6364, auc: 0.6493
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.1069, instance_loss: 0.1415, weighted_loss: 0.1173, label: 2, bag_size: 30302
batch 39, loss: 0.0320, instance_loss: 0.0611, weighted_loss: 0.0407, label: 3, bag_size: 17024


class 0 clustering acc 0.9840425531914894: correct 1480/1504
class 1 clustering acc 0.6117021276595744: correct 230/376
Epoch: 47, train_loss: 0.2480, train_clustering_loss:  0.2849, train_error: 0.0426
class 0: acc 0.9375, correct 15/16
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.9282, val_error: 0.5455, auc: 0.6528
class 0 clustering acc 0.90625: correct 319/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.0254, instance_loss: 0.1362, weighted_loss: 0.0586, label: 0, bag_size: 11326
batch 39, loss: 0.1039, instance_loss: 0.1808, weighted_loss: 0.1270, label: 1, bag_size: 26697


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.6595744680851063: correct 248/376
Epoch: 48, train_loss: 0.1486, train_clustering_loss:  0.2468, train_error: 0.0213
class 0: acc 1.0, correct 8/8
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 1.0, correct 16/16
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.9621, val_error: 0.4545, auc: 0.7188
class 0 clustering acc 0.9204545454545454: correct 324/352
class 1 clustering acc 0.29545454545454547: correct 26/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.1836, instance_loss: 0.2538, weighted_loss: 0.2047, label: 0, bag_size: 4729
batch 39, loss: 0.1078, instance_loss: 0.2223, weighted_loss: 0.1421, label: 0, bag_size: 15101


class 0 clustering acc 0.9873670212765957: correct 1485/1504
class 1 clustering acc 0.6303191489361702: correct 237/376
Epoch: 49, train_loss: 0.1903, train_clustering_loss:  0.2506, train_error: 0.0213
class 0: acc 0.9, correct 9/10
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.9376, val_error: 0.6364, auc: 0.7153
class 0 clustering acc 0.9204545454545454: correct 324/352
class 1 clustering acc 0.25: correct 22/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0682, instance_loss: 0.1072, weighted_loss: 0.0799, label: 2, bag_size: 18012
batch 39, loss: 0.0667, instance_loss: 0.1255, weighted_loss: 0.0843, label: 1, bag_size: 15079


class 0 clustering acc 0.9840425531914894: correct 1480/1504
class 1 clustering acc 0.6648936170212766: correct 250/376
Epoch: 50, train_loss: 0.2442, train_clustering_loss:  0.2731, train_error: 0.0638
class 0: acc 0.9, correct 9/10
class 1: acc 0.875, correct 14/16
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 2.0573, val_error: 0.6364, auc: 0.6597
class 0 clustering acc 0.9119318181818182: correct 321/352
class 1 clustering acc 0.3068181818181818: correct 27/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.3008, instance_loss: 0.2840, weighted_loss: 0.2957, label: 2, bag_size: 14084
batch 39, loss: 0.1115, instance_loss: 0.2712, weighted_loss: 0.1594, label: 2, bag_size: 28856


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.6728723404255319: correct 253/376
Epoch: 51, train_loss: 0.1844, train_clustering_loss:  0.2280, train_error: 0.0638
class 0: acc 0.9375, correct 15/16
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.9840, val_error: 0.4545, auc: 0.7187
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.3068181818181818: correct 27/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 33 out of 20
Early stopping
Val error: 0.5455, ROC AUC: 0.6910
Test error: 0.6364, ROC AUC: 0.5590
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3

Training Fold 7!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7919, instance_loss: 1.0317, weighted_loss: 1.5639, label: 3, bag_size: 12796
batch 39, loss: 1.4880, instance_loss: 0.9079, weighted_loss: 1.3140, label: 0, bag_size: 4729


class 0 clustering acc 0.9501329787234043: correct 1429/1504
class 1 clustering acc 0.0398936170212766: correct 15/376
Epoch: 0, train_loss: 1.4036, train_clustering_loss:  1.0406, train_error: 0.6596
class 0: acc 0.0, correct 0/13
class 1: acc 0.0, correct 0/9
class 2: acc 1.0, correct 16/16
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4060, val_error: 0.8182, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.406002).  Saving model ...


batch 19, loss: 1.4448, instance_loss: 0.7198, weighted_loss: 1.2273, label: 2, bag_size: 11341
batch 39, loss: 1.3909, instance_loss: 0.6982, weighted_loss: 1.1831, label: 1, bag_size: 4387


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4204, train_clustering_loss:  0.7354, train_error: 0.7872
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.0, correct 0/13
class 2: acc 0.0, correct 0/9
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.3522, val_error: 0.6364, auc: 0.8542
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.406002 --> 1.352214).  Saving model ...


batch 19, loss: 1.6736, instance_loss: 0.6457, weighted_loss: 1.3652, label: 2, bag_size: 19134
batch 39, loss: 1.2371, instance_loss: 0.6357, weighted_loss: 1.0566, label: 2, bag_size: 14084


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3981, train_clustering_loss:  0.6432, train_error: 0.6809
class 0: acc 0.25, correct 2/8
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.14285714285714285, correct 2/14
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.4183, val_error: 0.8182, auc: 0.6597
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2975, instance_loss: 0.6023, weighted_loss: 1.0889, label: 1, bag_size: 19756
batch 39, loss: 1.2211, instance_loss: 0.5943, weighted_loss: 1.0330, label: 2, bag_size: 30302


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3846, train_clustering_loss:  0.6181, train_error: 0.6809
class 0: acc 0.0, correct 0/11
class 1: acc 0.15384615384615385, correct 2/13
class 2: acc 1.0, correct 13/13
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3775, val_error: 0.7273, auc: 0.6771
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0876, instance_loss: 0.5936, weighted_loss: 0.9394, label: 2, bag_size: 2632
batch 39, loss: 1.3169, instance_loss: 0.6016, weighted_loss: 1.1023, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3600, train_clustering_loss:  0.6118, train_error: 0.6809
class 0: acc 0.25, correct 4/16
class 1: acc 0.0, correct 0/12
class 2: acc 1.0, correct 11/11
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3548, val_error: 0.6364, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.2765, instance_loss: 0.6078, weighted_loss: 1.0759, label: 0, bag_size: 14055
batch 39, loss: 1.3140, instance_loss: 0.6028, weighted_loss: 1.1006, label: 0, bag_size: 27370


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.4085, train_clustering_loss:  0.6133, train_error: 0.8723
class 0: acc 0.4, correct 4/10
class 1: acc 0.0, correct 0/10
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.0625, correct 1/16

Val Set, val_loss: 1.3286, val_error: 0.5455, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.352214 --> 1.328631).  Saving model ...


batch 19, loss: 1.9192, instance_loss: 0.6450, weighted_loss: 1.5369, label: 2, bag_size: 2632
batch 39, loss: 1.6999, instance_loss: 0.6382, weighted_loss: 1.3814, label: 2, bag_size: 11341


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3592, train_clustering_loss:  0.6065, train_error: 0.6596
class 0: acc 0.0, correct 0/10
class 1: acc 0.07692307692307693, correct 1/13
class 2: acc 0.0, correct 0/8
class 3: acc 0.9375, correct 15/16

Val Set, val_loss: 1.3271, val_error: 0.7273, auc: 0.8750
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.328631 --> 1.327123).  Saving model ...


batch 19, loss: 0.9712, instance_loss: 0.5757, weighted_loss: 0.8525, label: 1, bag_size: 12737
batch 39, loss: 1.4918, instance_loss: 0.6322, weighted_loss: 1.2339, label: 0, bag_size: 14055


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3473, train_clustering_loss:  0.6063, train_error: 0.7021
class 0: acc 0.0, correct 0/12
class 1: acc 0.8125, correct 13/16
class 2: acc 0.08333333333333333, correct 1/12
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.3353, val_error: 0.7273, auc: 0.8507
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1861, instance_loss: 0.6239, weighted_loss: 1.0175, label: 0, bag_size: 3710
batch 39, loss: 1.2712, instance_loss: 0.5880, weighted_loss: 1.0663, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2940, train_clustering_loss:  0.6036, train_error: 0.5957
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 0.125, correct 1/8
class 2: acc 0.4666666666666667, correct 7/15
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3736, val_error: 0.6364, auc: 0.8229
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 2.0132, instance_loss: 0.6387, weighted_loss: 1.6008, label: 1, bag_size: 4747
batch 39, loss: 1.2305, instance_loss: 0.5949, weighted_loss: 1.0398, label: 0, bag_size: 4729


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2494, train_clustering_loss:  0.5861, train_error: 0.5745
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.0, correct 0/8
class 2: acc 0.9473684210526315, correct 18/19
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4296, val_error: 0.8182, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.7212, instance_loss: 0.5232, weighted_loss: 0.6618, label: 2, bag_size: 11341
batch 39, loss: 1.7063, instance_loss: 0.6661, weighted_loss: 1.3943, label: 1, bag_size: 4387


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.2139, train_clustering_loss:  0.5751, train_error: 0.5957
class 0: acc 0.0, correct 0/11
class 1: acc 0.0, correct 0/7
class 2: acc 1.0, correct 19/19
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3883, val_error: 0.7273, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7422, instance_loss: 0.5637, weighted_loss: 0.6886, label: 0, bag_size: 11326
batch 39, loss: 1.2727, instance_loss: 0.6207, weighted_loss: 1.0771, label: 1, bag_size: 16680


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.2372, train_clustering_loss:  0.5941, train_error: 0.5745
class 0: acc 0.75, correct 12/16
class 1: acc 0.14285714285714285, correct 2/14
class 2: acc 0.75, correct 6/8
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.2444, val_error: 0.4545, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.327123 --> 1.244369).  Saving model ...


batch 19, loss: 1.1562, instance_loss: 0.5678, weighted_loss: 0.9797, label: 3, bag_size: 20225
batch 39, loss: 1.2935, instance_loss: 0.5869, weighted_loss: 1.0815, label: 2, bag_size: 2632


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2406, train_clustering_loss:  0.5799, train_error: 0.5532
class 0: acc 0.5384615384615384, correct 7/13
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.09090909090909091, correct 1/11

Val Set, val_loss: 1.2345, val_error: 0.5455, auc: 0.8264
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.244369 --> 1.234499).  Saving model ...


batch 19, loss: 1.8213, instance_loss: 0.6476, weighted_loss: 1.4692, label: 2, bag_size: 19134
batch 39, loss: 1.4660, instance_loss: 0.6068, weighted_loss: 1.2082, label: 2, bag_size: 2632


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.1715, train_clustering_loss:  0.5719, train_error: 0.5532
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.0, correct 0/9
class 2: acc 0.2, correct 2/10
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.2485, val_error: 0.5455, auc: 0.7847
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6499, instance_loss: 0.6543, weighted_loss: 1.3512, label: 1, bag_size: 19756
batch 39, loss: 1.4461, instance_loss: 0.5368, weighted_loss: 1.1733, label: 3, bag_size: 25817


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.0179, train_clustering_loss:  0.5473, train_error: 0.3404
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.0, correct 0/7
class 2: acc 0.875, correct 14/16
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.2500, val_error: 0.5455, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2601, instance_loss: 0.6046, weighted_loss: 1.0635, label: 3, bag_size: 1295
batch 39, loss: 1.3472, instance_loss: 0.6496, weighted_loss: 1.1379, label: 3, bag_size: 39178


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 0.9518, train_clustering_loss:  0.5452, train_error: 0.3617
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.7058823529411765, correct 12/17
class 2: acc 1.0, correct 6/6
class 3: acc 0.4, correct 6/15

Val Set, val_loss: 1.2381, val_error: 0.5455, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.9512, instance_loss: 0.5953, weighted_loss: 0.8444, label: 2, bag_size: 2632
batch 39, loss: 0.7594, instance_loss: 0.5336, weighted_loss: 0.6917, label: 0, bag_size: 3710


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 0.9941, train_clustering_loss:  0.5511, train_error: 0.4255
class 0: acc 0.4117647058823529, correct 7/17
class 1: acc 1.0, correct 9/9
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.3638, val_error: 0.6364, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.6605, instance_loss: 0.5179, weighted_loss: 0.6177, label: 1, bag_size: 14785
batch 39, loss: 0.5976, instance_loss: 0.4460, weighted_loss: 0.5521, label: 2, bag_size: 6102


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 0.9465, train_clustering_loss:  0.5273, train_error: 0.4043
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.23076923076923078, correct 3/13
class 2: acc 0.7777777777777778, correct 14/18
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 1.2652, val_error: 0.5455, auc: 0.7500
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.2849, instance_loss: 0.5319, weighted_loss: 1.0590, label: 3, bag_size: 25817
batch 39, loss: 0.4839, instance_loss: 0.4996, weighted_loss: 0.4886, label: 1, bag_size: 14785


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.015957446808510637: correct 6/376
Epoch: 18, train_loss: 0.7762, train_clustering_loss:  0.4943, train_error: 0.2766
class 0: acc 0.6, correct 6/10
class 1: acc 0.7142857142857143, correct 10/14
class 2: acc 1.0, correct 13/13
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.3250, val_error: 0.4545, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.5478, instance_loss: 0.6057, weighted_loss: 1.2651, label: 0, bag_size: 18417
batch 39, loss: 1.0724, instance_loss: 0.5585, weighted_loss: 0.9182, label: 3, bag_size: 21991


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.013297872340425532: correct 5/376
Epoch: 19, train_loss: 0.8506, train_clustering_loss:  0.5055, train_error: 0.3191
class 0: acc 0.5, correct 5/10
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 1.0, correct 14/14
class 3: acc 0.5454545454545454, correct 6/11

Val Set, val_loss: 1.1935, val_error: 0.4545, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.234499 --> 1.193523).  Saving model ...


batch 19, loss: 1.1892, instance_loss: 0.5236, weighted_loss: 0.9895, label: 1, bag_size: 33605
batch 39, loss: 1.5741, instance_loss: 0.6606, weighted_loss: 1.3001, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 20, train_loss: 0.8017, train_clustering_loss:  0.5023, train_error: 0.3404
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.3076923076923077, correct 4/13
class 2: acc 0.5, correct 4/8
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.1830, val_error: 0.3636, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.193523 --> 1.182966).  Saving model ...


batch 19, loss: 0.8972, instance_loss: 0.5132, weighted_loss: 0.7820, label: 3, bag_size: 5751
batch 39, loss: 0.8807, instance_loss: 0.4890, weighted_loss: 0.7632, label: 1, bag_size: 4747


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 21, train_loss: 0.7286, train_clustering_loss:  0.4819, train_error: 0.2979
class 0: acc 0.5714285714285714, correct 8/14
class 1: acc 0.5333333333333333, correct 8/15
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.3182, val_error: 0.4545, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3546, instance_loss: 0.3895, weighted_loss: 0.3651, label: 3, bag_size: 20225
batch 39, loss: 0.4467, instance_loss: 0.5620, weighted_loss: 0.4813, label: 0, bag_size: 15101


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 22, train_loss: 0.8574, train_clustering_loss:  0.4989, train_error: 0.3404
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.9375, correct 15/16
class 2: acc 0.4, correct 2/5
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.2031, val_error: 0.3636, auc: 0.7951
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.2522, instance_loss: 0.3665, weighted_loss: 0.2865, label: 3, bag_size: 20225
batch 39, loss: 0.9414, instance_loss: 0.5720, weighted_loss: 0.8306, label: 0, bag_size: 14436


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.02127659574468085: correct 8/376
Epoch: 23, train_loss: 0.6062, train_clustering_loss:  0.4537, train_error: 0.1702
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.3335, val_error: 0.5455, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.5826, instance_loss: 0.5101, weighted_loss: 0.5609, label: 2, bag_size: 2632
batch 39, loss: 0.2598, instance_loss: 0.3346, weighted_loss: 0.2823, label: 0, bag_size: 11326


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.0398936170212766: correct 15/376
Epoch: 24, train_loss: 0.6701, train_clustering_loss:  0.4635, train_error: 0.2340
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.0, correct 0/8
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.1931, val_error: 0.3636, auc: 0.8229
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2871, instance_loss: 0.3269, weighted_loss: 0.2990, label: 0, bag_size: 11326
batch 39, loss: 0.6331, instance_loss: 0.4725, weighted_loss: 0.5849, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0425531914893617: correct 16/376
Epoch: 25, train_loss: 0.6659, train_clustering_loss:  0.4660, train_error: 0.2553
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.9375, correct 15/16
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 1.3822, val_error: 0.3636, auc: 0.7674
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.9446, instance_loss: 0.4951, weighted_loss: 0.8097, label: 0, bag_size: 4729
batch 39, loss: 0.9787, instance_loss: 0.6821, weighted_loss: 0.8897, label: 0, bag_size: 33379


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.125: correct 47/376
Epoch: 26, train_loss: 0.5647, train_clustering_loss:  0.4315, train_error: 0.1915
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 17/17
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.4002, val_error: 0.2727, auc: 0.6875
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.022727272727272728: correct 2/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.8643, instance_loss: 0.4776, weighted_loss: 0.7483, label: 2, bag_size: 14084
batch 39, loss: 0.5483, instance_loss: 0.5201, weighted_loss: 0.5399, label: 3, bag_size: 5751


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.0851063829787234: correct 32/376
Epoch: 27, train_loss: 0.5882, train_clustering_loss:  0.4377, train_error: 0.2340
class 0: acc 1.0, correct 10/10
class 1: acc 0.3, correct 3/10
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.875, correct 14/16

Val Set, val_loss: 1.3460, val_error: 0.3636, auc: 0.8021
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.4172, instance_loss: 0.5990, weighted_loss: 1.1717, label: 0, bag_size: 5007
batch 39, loss: 0.6780, instance_loss: 0.4984, weighted_loss: 0.6241, label: 0, bag_size: 14055


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.07180851063829788: correct 27/376
Epoch: 28, train_loss: 0.5493, train_clustering_loss:  0.4278, train_error: 0.2766
class 0: acc 0.3, correct 3/10
class 1: acc 0.875, correct 14/16
class 2: acc 0.9, correct 9/10
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.2525, val_error: 0.3636, auc: 0.7188
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.8082, instance_loss: 0.4681, weighted_loss: 0.7062, label: 3, bag_size: 21991
batch 39, loss: 0.0817, instance_loss: 0.2077, weighted_loss: 0.1195, label: 3, bag_size: 12796


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.14095744680851063: correct 53/376
Epoch: 29, train_loss: 0.5837, train_clustering_loss:  0.4308, train_error: 0.2340
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.0925, val_error: 0.2727, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.182966 --> 1.092485).  Saving model ...


batch 19, loss: 0.4741, instance_loss: 0.2658, weighted_loss: 0.4117, label: 2, bag_size: 19134
batch 39, loss: 0.1168, instance_loss: 0.2238, weighted_loss: 0.1489, label: 2, bag_size: 25227


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.23670212765957446: correct 89/376
Epoch: 30, train_loss: 0.4797, train_clustering_loss:  0.4039, train_error: 0.1915
class 0: acc 1.0, correct 13/13
class 1: acc 0.14285714285714285, correct 1/7
class 2: acc 1.0, correct 14/14
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 1.3477, val_error: 0.2727, auc: 0.7917
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.3726, instance_loss: 0.4946, weighted_loss: 0.4092, label: 1, bag_size: 4387
batch 39, loss: 0.7759, instance_loss: 0.4853, weighted_loss: 0.6887, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.18351063829787234: correct 69/376
Epoch: 31, train_loss: 0.5617, train_clustering_loss:  0.4162, train_error: 0.2553
class 0: acc 0.625, correct 10/16
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.2958, val_error: 0.4545, auc: 0.7188
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.3461, instance_loss: 0.4248, weighted_loss: 0.3697, label: 3, bag_size: 5751
batch 39, loss: 0.3182, instance_loss: 0.3292, weighted_loss: 0.3215, label: 0, bag_size: 12821


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.2632978723404255: correct 99/376
Epoch: 32, train_loss: 0.4895, train_clustering_loss:  0.3788, train_error: 0.2128
class 0: acc 1.0, correct 14/14
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.2501, val_error: 0.3636, auc: 0.7431
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.2748, instance_loss: 0.3218, weighted_loss: 0.2889, label: 0, bag_size: 11326
batch 39, loss: 0.9704, instance_loss: 0.6080, weighted_loss: 0.8616, label: 1, bag_size: 16680


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.2526595744680851: correct 95/376
Epoch: 33, train_loss: 0.4111, train_clustering_loss:  0.3595, train_error: 0.1277
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 1.0, correct 15/15
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.1962, val_error: 0.3636, auc: 0.8576
class 0 clustering acc 0.9772727272727273: correct 344/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0798, instance_loss: 0.2158, weighted_loss: 0.1206, label: 3, bag_size: 4443
batch 39, loss: 0.2039, instance_loss: 0.2414, weighted_loss: 0.2152, label: 2, bag_size: 25227


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.31382978723404253: correct 118/376
Epoch: 34, train_loss: 0.4465, train_clustering_loss:  0.3726, train_error: 0.2128
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.0996, val_error: 0.2727, auc: 0.8333
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.1396, instance_loss: 0.2834, weighted_loss: 0.1827, label: 3, bag_size: 4443
batch 39, loss: 0.1428, instance_loss: 0.1926, weighted_loss: 0.1577, label: 2, bag_size: 6102


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.34308510638297873: correct 129/376
Epoch: 35, train_loss: 0.3478, train_clustering_loss:  0.3440, train_error: 0.1064
class 0: acc 0.9, correct 9/10
class 1: acc 0.7, correct 7/10
class 2: acc 1.0, correct 15/15
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.1975, val_error: 0.2727, auc: 0.8542
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.6795, instance_loss: 0.4545, weighted_loss: 0.6120, label: 1, bag_size: 5424
batch 39, loss: 0.1476, instance_loss: 0.2407, weighted_loss: 0.1755, label: 2, bag_size: 25227


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.2898936170212766: correct 109/376
Epoch: 36, train_loss: 0.3781, train_clustering_loss:  0.3629, train_error: 0.1064
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 10/10
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.2175, val_error: 0.2727, auc: 0.8056
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.1464, instance_loss: 0.5462, weighted_loss: 0.9663, label: 1, bag_size: 5424
batch 39, loss: 1.0502, instance_loss: 0.5604, weighted_loss: 0.9033, label: 1, bag_size: 4747


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.2632978723404255: correct 99/376
Epoch: 37, train_loss: 0.4162, train_clustering_loss:  0.3663, train_error: 0.1489
class 0: acc 1.0, correct 14/14
class 1: acc 0.75, correct 9/12
class 2: acc 0.75, correct 9/12
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.0894, val_error: 0.2727, auc: 0.7951
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
Validation loss decreased (1.092485 --> 1.089379).  Saving model ...


batch 19, loss: 0.4912, instance_loss: 0.5271, weighted_loss: 0.5020, label: 3, bag_size: 1295
batch 39, loss: 0.0216, instance_loss: 0.0680, weighted_loss: 0.0355, label: 2, bag_size: 19134


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.36436170212765956: correct 137/376
Epoch: 38, train_loss: 0.4312, train_clustering_loss:  0.3603, train_error: 0.2766
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.1591, val_error: 0.3636, auc: 0.8056
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.2645, instance_loss: 0.5833, weighted_loss: 0.3602, label: 3, bag_size: 5751
batch 39, loss: 0.1039, instance_loss: 0.1793, weighted_loss: 0.1265, label: 2, bag_size: 6102


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.3377659574468085: correct 127/376
Epoch: 39, train_loss: 0.4743, train_clustering_loss:  0.3676, train_error: 0.1277
class 0: acc 0.75, correct 9/12
class 1: acc 1.0, correct 14/14
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.0822, val_error: 0.3636, auc: 0.8438
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.089379 --> 1.082180).  Saving model ...


batch 19, loss: 0.0696, instance_loss: 0.1486, weighted_loss: 0.0933, label: 3, bag_size: 12796
batch 39, loss: 0.0805, instance_loss: 0.2903, weighted_loss: 0.1434, label: 2, bag_size: 19134


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.3696808510638298: correct 139/376
Epoch: 40, train_loss: 0.4154, train_clustering_loss:  0.3574, train_error: 0.1702
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.875, correct 14/16
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.1106, val_error: 0.2727, auc: 0.8160
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4569, instance_loss: 0.4339, weighted_loss: 0.4500, label: 0, bag_size: 14952
batch 39, loss: 0.0727, instance_loss: 0.1658, weighted_loss: 0.1007, label: 3, bag_size: 20225


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.39361702127659576: correct 148/376
Epoch: 41, train_loss: 0.3215, train_clustering_loss:  0.3365, train_error: 0.1277
class 0: acc 0.8, correct 8/10
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 1.0, correct 14/14
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 0.9468, val_error: 0.1818, auc: 0.8056
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.082180 --> 0.946798).  Saving model ...


batch 19, loss: 0.0452, instance_loss: 0.1326, weighted_loss: 0.0714, label: 3, bag_size: 4443
batch 39, loss: 0.0493, instance_loss: 0.1903, weighted_loss: 0.0916, label: 3, bag_size: 4443


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.3271276595744681: correct 123/376
Epoch: 42, train_loss: 0.3647, train_clustering_loss:  0.3663, train_error: 0.1277
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.875, correct 7/8
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.8823529411764706, correct 15/17

Val Set, val_loss: 1.1990, val_error: 0.2727, auc: 0.7951
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.0250, instance_loss: 0.2007, weighted_loss: 0.0777, label: 1, bag_size: 12367
batch 39, loss: 0.3200, instance_loss: 0.3674, weighted_loss: 0.3342, label: 1, bag_size: 16680


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.3058510638297872: correct 115/376
Epoch: 43, train_loss: 0.4053, train_clustering_loss:  0.3757, train_error: 0.1915
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.6875, correct 11/16
class 2: acc 0.8, correct 8/10
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.1004, val_error: 0.1818, auc: 0.7951
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.1154, instance_loss: 0.1791, weighted_loss: 0.1345, label: 2, bag_size: 2078
batch 39, loss: 0.0858, instance_loss: 0.3248, weighted_loss: 0.1575, label: 1, bag_size: 19756


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.3377659574468085: correct 127/376
Epoch: 44, train_loss: 0.4449, train_clustering_loss:  0.3506, train_error: 0.1702
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.8, correct 12/15
class 2: acc 1.0, correct 14/14
class 3: acc 0.6, correct 3/5

Val Set, val_loss: 0.9998, val_error: 0.1818, auc: 0.8056
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.1806, instance_loss: 0.2735, weighted_loss: 0.2085, label: 0, bag_size: 11326
batch 39, loss: 1.3905, instance_loss: 0.6084, weighted_loss: 1.1558, label: 1, bag_size: 12737


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.3776595744680851: correct 142/376
Epoch: 45, train_loss: 0.3402, train_clustering_loss:  0.3308, train_error: 0.1064
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 1.0, correct 14/14
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.0064, val_error: 0.1818, auc: 0.8056
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.1745, instance_loss: 0.3178, weighted_loss: 0.2175, label: 0, bag_size: 33379
batch 39, loss: 0.5619, instance_loss: 0.5651, weighted_loss: 0.5629, label: 3, bag_size: 4443


class 0 clustering acc 0.9893617021276596: correct 1488/1504
class 1 clustering acc 0.3803191489361702: correct 143/376
Epoch: 46, train_loss: 0.2934, train_clustering_loss:  0.3426, train_error: 0.0638
class 0: acc 1.0, correct 11/11
class 1: acc 0.75, correct 9/12
class 2: acc 1.0, correct 15/15
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 0.8196, val_error: 0.1818, auc: 0.8611
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (0.946798 --> 0.819566).  Saving model ...


batch 19, loss: 0.0679, instance_loss: 0.0855, weighted_loss: 0.0732, label: 2, bag_size: 11341
batch 39, loss: 0.3600, instance_loss: 0.4471, weighted_loss: 0.3861, label: 0, bag_size: 14436


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.46808510638297873: correct 176/376
Epoch: 47, train_loss: 0.3101, train_clustering_loss:  0.3128, train_error: 0.1064
class 0: acc 0.75, correct 9/12
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 0.9066, val_error: 0.1818, auc: 0.8264
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.14772727272727273: correct 13/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0136, instance_loss: 0.5546, weighted_loss: 0.8759, label: 0, bag_size: 3710
batch 39, loss: 0.1493, instance_loss: 0.3134, weighted_loss: 0.1985, label: 1, bag_size: 4387


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.3537234042553192: correct 133/376
Epoch: 48, train_loss: 0.3806, train_clustering_loss:  0.3495, train_error: 0.1277
class 0: acc 0.7, correct 7/10
class 1: acc 0.9, correct 18/20
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.0886, val_error: 0.1818, auc: 0.8368
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0153, instance_loss: 0.0289, weighted_loss: 0.0194, label: 2, bag_size: 5938
batch 39, loss: 0.3336, instance_loss: 0.4215, weighted_loss: 0.3600, label: 3, bag_size: 6572


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.44680851063829785: correct 168/376
Epoch: 49, train_loss: 0.3588, train_clustering_loss:  0.3363, train_error: 0.1064
class 0: acc 0.7, correct 7/10
class 1: acc 1.0, correct 12/12
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.9444444444444444, correct 17/18

Val Set, val_loss: 1.7186, val_error: 0.4545, auc: 0.8056
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.0345, instance_loss: 0.0978, weighted_loss: 0.0535, label: 3, bag_size: 20225
batch 39, loss: 0.5875, instance_loss: 0.3952, weighted_loss: 0.5298, label: 0, bag_size: 4729


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.31117021276595747: correct 117/376
Epoch: 50, train_loss: 0.3901, train_clustering_loss:  0.3786, train_error: 0.1277
class 0: acc 0.7857142857142857, correct 11/14
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.875, correct 7/8
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 0.5609, val_error: 0.1818, auc: 0.9688
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (0.819566 --> 0.560942).  Saving model ...


batch 19, loss: 0.8116, instance_loss: 0.6151, weighted_loss: 0.7526, label: 2, bag_size: 14084
batch 39, loss: 0.1128, instance_loss: 0.2059, weighted_loss: 0.1407, label: 0, bag_size: 12821


class 0 clustering acc 0.9820478723404256: correct 1477/1504
class 1 clustering acc 0.3882978723404255: correct 146/376
Epoch: 51, train_loss: 0.3906, train_clustering_loss:  0.3556, train_error: 0.1277
class 0: acc 1.0, correct 15/15
class 1: acc 0.375, correct 3/8
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 0.9246, val_error: 0.1818, auc: 0.8993
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0483, instance_loss: 0.4735, weighted_loss: 0.8759, label: 0, bag_size: 18417
batch 39, loss: 0.0807, instance_loss: 0.1977, weighted_loss: 0.1158, label: 2, bag_size: 19134


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.42021276595744683: correct 158/376
Epoch: 52, train_loss: 0.3201, train_clustering_loss:  0.3171, train_error: 0.1489
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 1.0, correct 8/8
class 3: acc 0.9411764705882353, correct 16/17

Val Set, val_loss: 1.0846, val_error: 0.2727, auc: 0.8993
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.2840909090909091: correct 25/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0461, instance_loss: 0.1504, weighted_loss: 0.0774, label: 3, bag_size: 12708
batch 39, loss: 0.1282, instance_loss: 0.3112, weighted_loss: 0.1831, label: 3, bag_size: 1295


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.5053191489361702: correct 190/376
Epoch: 53, train_loss: 0.3288, train_clustering_loss:  0.3025, train_error: 0.1277
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8, correct 8/10
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 1.0852, val_error: 0.2727, auc: 0.8889
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.2159090909090909: correct 19/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.3791, instance_loss: 0.3871, weighted_loss: 0.3815, label: 1, bag_size: 5424
batch 39, loss: 0.0259, instance_loss: 0.0897, weighted_loss: 0.0450, label: 1, bag_size: 14785


class 0 clustering acc 0.9913563829787234: correct 1491/1504
class 1 clustering acc 0.43351063829787234: correct 163/376
Epoch: 54, train_loss: 0.3329, train_clustering_loss:  0.3200, train_error: 0.1277
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.9473684210526315, correct 18/19
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.0826, val_error: 0.2727, auc: 0.9028
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0444, instance_loss: 0.0994, weighted_loss: 0.0609, label: 1, bag_size: 12367
batch 39, loss: 0.0308, instance_loss: 0.0773, weighted_loss: 0.0448, label: 1, bag_size: 12367


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.4627659574468085: correct 174/376
Epoch: 55, train_loss: 0.2839, train_clustering_loss:  0.3055, train_error: 0.0851
class 0: acc 1.0, correct 11/11
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 1.0, correct 13/13
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.1096, val_error: 0.1818, auc: 0.8785
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.0398, instance_loss: 0.1053, weighted_loss: 0.0594, label: 1, bag_size: 14785
batch 39, loss: 0.6325, instance_loss: 0.3572, weighted_loss: 0.5499, label: 1, bag_size: 20684


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.43617021276595747: correct 164/376
Epoch: 56, train_loss: 0.3098, train_clustering_loss:  0.3200, train_error: 0.0851
class 0: acc 0.8, correct 8/10
class 1: acc 0.9333333333333333, correct 14/15
class 2: acc 1.0, correct 16/16
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.0859, val_error: 0.2727, auc: 0.8889
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.0220, instance_loss: 0.0460, weighted_loss: 0.0292, label: 2, bag_size: 6102
batch 39, loss: 2.2206, instance_loss: 0.7303, weighted_loss: 1.7735, label: 0, bag_size: 33379


class 0 clustering acc 0.9966755319148937: correct 1499/1504
class 1 clustering acc 0.5372340425531915: correct 202/376
Epoch: 57, train_loss: 0.3040, train_clustering_loss:  0.2797, train_error: 0.1277
class 0: acc 0.7, correct 7/10
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 0.9, correct 9/10
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.1598, val_error: 0.1818, auc: 0.8889
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.20454545454545456: correct 18/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.2263, instance_loss: 0.3017, weighted_loss: 0.2489, label: 0, bag_size: 15101
batch 39, loss: 0.1318, instance_loss: 0.1871, weighted_loss: 0.1483, label: 2, bag_size: 30302


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.550531914893617: correct 207/376
Epoch: 58, train_loss: 0.2064, train_clustering_loss:  0.2620, train_error: 0.0213
class 0: acc 0.9444444444444444, correct 17/18
class 1: acc 1.0, correct 9/9
class 2: acc 1.0, correct 14/14
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.3530, val_error: 0.1818, auc: 0.7604
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.22727272727272727: correct 20/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.0083, instance_loss: 0.0311, weighted_loss: 0.0151, label: 2, bag_size: 19134
batch 39, loss: 0.1904, instance_loss: 0.3904, weighted_loss: 0.2504, label: 1, bag_size: 19756


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.4973404255319149: correct 187/376
Epoch: 59, train_loss: 0.3442, train_clustering_loss:  0.3233, train_error: 0.1277
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 1.0, correct 12/12
class 3: acc 0.875, correct 14/16

Val Set, val_loss: 0.9273, val_error: 0.4545, auc: 0.9479
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.3068181818181818: correct 27/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.1137, instance_loss: 0.1641, weighted_loss: 0.1288, label: 1, bag_size: 14785
batch 39, loss: 0.7577, instance_loss: 0.6672, weighted_loss: 0.7306, label: 3, bag_size: 21991


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.4627659574468085: correct 174/376
Epoch: 60, train_loss: 0.3878, train_clustering_loss:  0.3411, train_error: 0.1277
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 1.1375, val_error: 0.3636, auc: 0.7847
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.25: correct 22/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.2070, instance_loss: 0.2448, weighted_loss: 0.2183, label: 0, bag_size: 14436
batch 39, loss: 0.0971, instance_loss: 0.1393, weighted_loss: 0.1098, label: 2, bag_size: 30302


class 0 clustering acc 0.9800531914893617: correct 1474/1504
class 1 clustering acc 0.4867021276595745: correct 183/376
Epoch: 61, train_loss: 0.3596, train_clustering_loss:  0.3407, train_error: 0.1277
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.75, correct 9/12
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.0652, val_error: 0.1818, auc: 0.7951
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.29545454545454547: correct 26/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.2490, instance_loss: 0.3676, weighted_loss: 0.2846, label: 0, bag_size: 5007
batch 39, loss: 0.0099, instance_loss: 0.0418, weighted_loss: 0.0195, label: 3, bag_size: 39178


class 0 clustering acc 0.988031914893617: correct 1486/1504
class 1 clustering acc 0.4867021276595745: correct 183/376
Epoch: 62, train_loss: 0.3050, train_clustering_loss:  0.3007, train_error: 0.1702
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.1203, val_error: 0.1818, auc: 0.7951
class 0 clustering acc 0.9659090909090909: correct 340/352
class 1 clustering acc 0.2840909090909091: correct 25/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0261, instance_loss: 0.0578, weighted_loss: 0.0356, label: 3, bag_size: 25817
batch 39, loss: 1.1860, instance_loss: 0.6283, weighted_loss: 1.0187, label: 0, bag_size: 5007


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.5877659574468085: correct 221/376
Epoch: 63, train_loss: 0.2654, train_clustering_loss:  0.2692, train_error: 0.0851
class 0: acc 0.5, correct 3/6
class 1: acc 0.9523809523809523, correct 20/21
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.1073, val_error: 0.4545, auc: 0.8611
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.29545454545454547: correct 26/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.3451, instance_loss: 0.3856, weighted_loss: 0.3573, label: 3, bag_size: 6572
batch 39, loss: 0.1031, instance_loss: 0.1645, weighted_loss: 0.1215, label: 2, bag_size: 2078


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.526595744680851: correct 198/376
Epoch: 64, train_loss: 0.3221, train_clustering_loss:  0.3028, train_error: 0.1489
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.1709, val_error: 0.2727, auc: 0.8854
class 0 clustering acc 0.9573863636363636: correct 337/352
class 1 clustering acc 0.25: correct 22/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3422, instance_loss: 0.4009, weighted_loss: 0.3598, label: 0, bag_size: 15265
batch 39, loss: 0.0355, instance_loss: 0.0792, weighted_loss: 0.0486, label: 2, bag_size: 18012


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.5638297872340425: correct 212/376
Epoch: 65, train_loss: 0.2820, train_clustering_loss:  0.2709, train_error: 0.1064
class 0: acc 1.0, correct 13/13
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.0518, val_error: 0.2727, auc: 0.8854
class 0 clustering acc 0.9460227272727273: correct 333/352
class 1 clustering acc 0.3181818181818182: correct 28/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.2694, instance_loss: 0.2783, weighted_loss: 0.2721, label: 1, bag_size: 6021
batch 39, loss: 0.3361, instance_loss: 0.3869, weighted_loss: 0.3513, label: 0, bag_size: 3710


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.43882978723404253: correct 165/376
Epoch: 66, train_loss: 0.3196, train_clustering_loss:  0.3377, train_error: 0.1064
class 0: acc 0.7777777777777778, correct 14/18
class 1: acc 0.9411764705882353, correct 16/17
class 2: acc 1.0, correct 6/6
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.0874, val_error: 0.1818, auc: 0.8160
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.2727272727272727: correct 24/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.4546, instance_loss: 0.5293, weighted_loss: 0.4770, label: 1, bag_size: 4747
batch 39, loss: 0.0492, instance_loss: 0.2676, weighted_loss: 0.1147, label: 0, bag_size: 18417


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.5398936170212766: correct 203/376
Epoch: 67, train_loss: 0.2153, train_clustering_loss:  0.2740, train_error: 0.0638
class 0: acc 1.0, correct 15/15
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.1452, val_error: 0.1818, auc: 0.7951
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.2727272727272727: correct 24/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0601, instance_loss: 0.1118, weighted_loss: 0.0756, label: 2, bag_size: 18012
batch 39, loss: 0.0391, instance_loss: 0.1205, weighted_loss: 0.0635, label: 3, bag_size: 26172


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.6728723404255319: correct 253/376
Epoch: 68, train_loss: 0.1651, train_clustering_loss:  0.2162, train_error: 0.0213
class 0: acc 1.0, correct 15/15
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.1242, val_error: 0.1818, auc: 0.8160
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.3068181818181818: correct 27/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.2689, instance_loss: 0.3390, weighted_loss: 0.2899, label: 1, bag_size: 16680
batch 39, loss: 0.0246, instance_loss: 0.0597, weighted_loss: 0.0351, label: 2, bag_size: 11341


class 0 clustering acc 0.9853723404255319: correct 1482/1504
class 1 clustering acc 0.598404255319149: correct 225/376
Epoch: 69, train_loss: 0.2333, train_clustering_loss:  0.2701, train_error: 0.0638
class 0: acc 0.9, correct 9/10
class 1: acc 0.875, correct 14/16
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.1236, val_error: 0.1818, auc: 0.7951
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.3181818181818182: correct 28/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2069, instance_loss: 0.3104, weighted_loss: 0.2379, label: 1, bag_size: 4747
batch 39, loss: 0.5155, instance_loss: 0.4527, weighted_loss: 0.4967, label: 0, bag_size: 14055


class 0 clustering acc 0.9847074468085106: correct 1481/1504
class 1 clustering acc 0.550531914893617: correct 207/376
Epoch: 70, train_loss: 0.3107, train_clustering_loss:  0.3179, train_error: 0.0638
class 0: acc 1.0, correct 10/10
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.0760, val_error: 0.1818, auc: 0.8854
class 0 clustering acc 0.9545454545454546: correct 336/352
class 1 clustering acc 0.3181818181818182: correct 28/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.1818, ROC AUC: 0.9688
Test error: 0.5455, ROC AUC: 0.5799
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3

Training Fold 8!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6527, instance_loss: 1.1017, weighted_loss: 1.4874, label: 0, bag_size: 10695
batch 39, loss: 1.8538, instance_loss: 0.9460, weighted_loss: 1.5814, label: 1, bag_size: 4387


class 0 clustering acc 0.9428191489361702: correct 1418/1504
class 1 clustering acc 0.09840425531914894: correct 37/376
Epoch: 0, train_loss: 1.4176, train_clustering_loss:  1.0324, train_error: 0.7234
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/9
class 2: acc 0.14285714285714285, correct 2/14
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.4337, val_error: 0.8182, auc: 0.4167
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (inf --> 1.433694).  Saving model ...


batch 19, loss: 1.2168, instance_loss: 0.6555, weighted_loss: 1.0484, label: 3, bag_size: 11206
batch 39, loss: 1.0319, instance_loss: 0.6963, weighted_loss: 0.9312, label: 1, bag_size: 12367


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.3343, train_clustering_loss:  0.7319, train_error: 0.5319
class 0: acc 0.0, correct 0/6
class 1: acc 0.6666666666666666, correct 12/18
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.4406, val_error: 0.7273, auc: 0.5660
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6036, instance_loss: 0.6681, weighted_loss: 1.3230, label: 2, bag_size: 18012
batch 39, loss: 1.4021, instance_loss: 0.6669, weighted_loss: 1.1816, label: 2, bag_size: 14084


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3867, train_clustering_loss:  0.6333, train_error: 0.6596
class 0: acc 0.0, correct 0/10
class 1: acc 1.0, correct 15/15
class 2: acc 0.0, correct 0/13
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.4176, val_error: 0.7273, auc: 0.5972
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.433694 --> 1.417650).  Saving model ...


batch 19, loss: 1.7079, instance_loss: 0.6480, weighted_loss: 1.3900, label: 0, bag_size: 5626
batch 39, loss: 1.2393, instance_loss: 0.5992, weighted_loss: 1.0472, label: 2, bag_size: 23737


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3551, train_clustering_loss:  0.6120, train_error: 0.6596
class 0: acc 0.0, correct 0/8
class 1: acc 1.0, correct 16/16
class 2: acc 0.0, correct 0/13
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.4183, val_error: 0.7273, auc: 0.6181
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4242, instance_loss: 0.6231, weighted_loss: 1.1839, label: 3, bag_size: 6377
batch 39, loss: 1.5119, instance_loss: 0.6131, weighted_loss: 1.2423, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.3752, train_clustering_loss:  0.6096, train_error: 0.6809
class 0: acc 0.4166666666666667, correct 5/12
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.36363636363636365, correct 4/11
class 3: acc 0.3333333333333333, correct 4/12

Val Set, val_loss: 1.3717, val_error: 0.7273, auc: 0.6562
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.417650 --> 1.371702).  Saving model ...


batch 19, loss: 1.5229, instance_loss: 0.6435, weighted_loss: 1.2591, label: 0, bag_size: 33379
batch 39, loss: 1.3039, instance_loss: 0.6180, weighted_loss: 1.0981, label: 0, bag_size: 15101


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3493, train_clustering_loss:  0.6110, train_error: 0.7447
class 0: acc 0.0, correct 0/13
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.0, correct 0/12
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3648, val_error: 0.7273, auc: 0.6736
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.371702 --> 1.364808).  Saving model ...


batch 19, loss: 1.0374, instance_loss: 0.6015, weighted_loss: 0.9066, label: 3, bag_size: 6377
batch 39, loss: 0.8161, instance_loss: 0.5859, weighted_loss: 0.7470, label: 3, bag_size: 6377


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.2860, train_clustering_loss:  0.6054, train_error: 0.5957
class 0: acc 0.4375, correct 7/16
class 1: acc 0.0, correct 0/7
class 2: acc 0.1111111111111111, correct 1/9
class 3: acc 0.7333333333333333, correct 11/15

Val Set, val_loss: 1.3619, val_error: 0.6364, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.364808 --> 1.361860).  Saving model ...


batch 19, loss: 1.0780, instance_loss: 0.5759, weighted_loss: 0.9274, label: 0, bag_size: 5626
batch 39, loss: 1.2726, instance_loss: 0.5792, weighted_loss: 1.0646, label: 0, bag_size: 2928


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.2861, train_clustering_loss:  0.6043, train_error: 0.4894
class 0: acc 1.0, correct 15/15
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.2, correct 2/10
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3415, val_error: 0.6364, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.361860 --> 1.341506).  Saving model ...


batch 19, loss: 1.2615, instance_loss: 0.5981, weighted_loss: 1.0625, label: 2, bag_size: 5938
batch 39, loss: 1.8960, instance_loss: 0.6587, weighted_loss: 1.5248, label: 1, bag_size: 28374


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.2621, train_clustering_loss:  0.5988, train_error: 0.5319
class 0: acc 0.75, correct 9/12
class 1: acc 0.0, correct 0/8
class 2: acc 0.6111111111111112, correct 11/18
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.4492, val_error: 0.8182, auc: 0.5590
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3128, instance_loss: 0.6144, weighted_loss: 1.1033, label: 1, bag_size: 17027
batch 39, loss: 1.0242, instance_loss: 0.6184, weighted_loss: 0.9024, label: 1, bag_size: 6021


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2153, train_clustering_loss:  0.5989, train_error: 0.5532
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.15384615384615385, correct 2/13
class 2: acc 0.2222222222222222, correct 2/9
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.3984, val_error: 0.6364, auc: 0.5069
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0591, instance_loss: 0.6293, weighted_loss: 0.9301, label: 3, bag_size: 6377
batch 39, loss: 1.2369, instance_loss: 0.6164, weighted_loss: 1.0508, label: 1, bag_size: 12367


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.1672, train_clustering_loss:  0.5943, train_error: 0.5319
class 0: acc 0.25, correct 2/8
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.5625, correct 9/16

Val Set, val_loss: 1.4948, val_error: 0.6364, auc: 0.5347
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.5716, instance_loss: 0.6136, weighted_loss: 1.2842, label: 0, bag_size: 4729
batch 39, loss: 0.4436, instance_loss: 0.4690, weighted_loss: 0.4512, label: 3, bag_size: 20225


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.1450, train_clustering_loss:  0.5819, train_error: 0.5532
class 0: acc 0.14285714285714285, correct 2/14
class 1: acc 0.6666666666666666, correct 12/18
class 2: acc 0.0, correct 0/6
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.4639, val_error: 0.7273, auc: 0.4965
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.3042, instance_loss: 0.4312, weighted_loss: 0.3423, label: 3, bag_size: 11206
batch 39, loss: 1.1149, instance_loss: 0.6387, weighted_loss: 0.9720, label: 2, bag_size: 11341


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.1162, train_clustering_loss:  0.5855, train_error: 0.4255
class 0: acc 0.5384615384615384, correct 7/13
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.3333333333333333, correct 4/12
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.4643, val_error: 0.8182, auc: 0.5521
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.0545, instance_loss: 0.5915, weighted_loss: 0.9156, label: 2, bag_size: 18012
batch 39, loss: 0.5028, instance_loss: 0.5112, weighted_loss: 0.5053, label: 3, bag_size: 6377


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.0473, train_clustering_loss:  0.5742, train_error: 0.3830
class 0: acc 0.7, correct 7/10
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.6428571428571429, correct 9/14
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.5063, val_error: 0.7273, auc: 0.6111
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.1302, instance_loss: 0.5698, weighted_loss: 0.9621, label: 0, bag_size: 5626
batch 39, loss: 0.7619, instance_loss: 0.5524, weighted_loss: 0.6990, label: 2, bag_size: 30302


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 0.9677, train_clustering_loss:  0.5451, train_error: 0.4043
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.6, correct 6/10
class 3: acc 0.8823529411764706, correct 15/17

Val Set, val_loss: 1.5152, val_error: 0.5455, auc: 0.6215
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 2.2302, instance_loss: 0.6489, weighted_loss: 1.7558, label: 3, bag_size: 4443
batch 39, loss: 1.0644, instance_loss: 0.6224, weighted_loss: 0.9318, label: 1, bag_size: 33605


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 15, train_loss: 0.8986, train_clustering_loss:  0.5308, train_error: 0.2340
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 1.0, correct 5/5
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.5944, val_error: 0.8182, auc: 0.5382
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.0749, instance_loss: 0.6204, weighted_loss: 0.9385, label: 2, bag_size: 11341
batch 39, loss: 0.3164, instance_loss: 0.4668, weighted_loss: 0.3616, label: 2, bag_size: 5938


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0026595744680851063: correct 1/376
Epoch: 16, train_loss: 0.9093, train_clustering_loss:  0.5239, train_error: 0.3617
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.6653, val_error: 0.9091, auc: 0.4826
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 2.1002, instance_loss: 0.6597, weighted_loss: 1.6680, label: 3, bag_size: 12626
batch 39, loss: 0.5535, instance_loss: 0.5126, weighted_loss: 0.5412, label: 0, bag_size: 11326


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.05319148936170213: correct 20/376
Epoch: 17, train_loss: 0.7969, train_clustering_loss:  0.5057, train_error: 0.2340
class 0: acc 0.75, correct 12/16
class 1: acc 0.625, correct 5/8
class 2: acc 0.8, correct 8/10
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.6571, val_error: 0.8182, auc: 0.5139
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.8760, instance_loss: 0.5413, weighted_loss: 0.7756, label: 2, bag_size: 30302
batch 39, loss: 0.5409, instance_loss: 0.4629, weighted_loss: 0.5175, label: 3, bag_size: 12626


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0425531914893617: correct 16/376
Epoch: 18, train_loss: 0.8678, train_clustering_loss:  0.5181, train_error: 0.2979
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.8, correct 8/10
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.6857, val_error: 0.7273, auc: 0.5139
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.5151, instance_loss: 0.5839, weighted_loss: 1.2357, label: 0, bag_size: 2928
batch 39, loss: 0.1340, instance_loss: 0.2591, weighted_loss: 0.1715, label: 3, bag_size: 4892


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.06382978723404255: correct 24/376
Epoch: 19, train_loss: 0.6885, train_clustering_loss:  0.4706, train_error: 0.2340
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.6923076923076923, correct 9/13
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.6557, val_error: 0.5455, auc: 0.5868
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.8426, instance_loss: 0.5153, weighted_loss: 0.7444, label: 0, bag_size: 3710
batch 39, loss: 1.0672, instance_loss: 0.5731, weighted_loss: 0.9190, label: 1, bag_size: 28374


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.047872340425531915: correct 18/376
Epoch: 20, train_loss: 0.6834, train_clustering_loss:  0.4745, train_error: 0.1489
class 0: acc 0.625, correct 5/8
class 1: acc 0.875, correct 14/16
class 2: acc 1.0, correct 12/12
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.7734, val_error: 0.5455, auc: 0.5556
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.2303, instance_loss: 0.2769, weighted_loss: 0.2443, label: 3, bag_size: 12796
batch 39, loss: 0.5119, instance_loss: 0.4024, weighted_loss: 0.4790, label: 1, bag_size: 17027


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.11436170212765957: correct 43/376
Epoch: 21, train_loss: 0.6618, train_clustering_loss:  0.4472, train_error: 0.1702
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.7777777777777778, correct 14/18
class 2: acc 0.5, correct 2/4
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.7207, val_error: 0.7273, auc: 0.5660
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0496, instance_loss: 0.1276, weighted_loss: 0.0730, label: 3, bag_size: 11206
batch 39, loss: 0.8571, instance_loss: 0.6041, weighted_loss: 0.7812, label: 0, bag_size: 14055


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.1356382978723404: correct 51/376
Epoch: 22, train_loss: 0.5342, train_clustering_loss:  0.4114, train_error: 0.1702
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.9375, correct 15/16
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.6824, val_error: 0.6364, auc: 0.6007
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.9004, instance_loss: 0.4779, weighted_loss: 0.7737, label: 3, bag_size: 12626
batch 39, loss: 0.1270, instance_loss: 0.1563, weighted_loss: 0.1358, label: 3, bag_size: 26172


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.14893617021276595: correct 56/376
Epoch: 23, train_loss: 0.5996, train_clustering_loss:  0.4261, train_error: 0.2340
class 0: acc 0.6666666666666666, correct 8/12
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.8666666666666667, correct 13/15

Val Set, val_loss: 1.6017, val_error: 0.6364, auc: 0.5903
class 0 clustering acc 0.9715909090909091: correct 342/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.6249, instance_loss: 0.4788, weighted_loss: 0.5811, label: 2, bag_size: 11341
batch 39, loss: 0.6235, instance_loss: 0.4475, weighted_loss: 0.5707, label: 0, bag_size: 4729


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.18617021276595744: correct 70/376
Epoch: 24, train_loss: 0.4885, train_clustering_loss:  0.3872, train_error: 0.1277
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.8588, val_error: 0.6364, auc: 0.5417
class 0 clustering acc 0.9602272727272727: correct 338/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.2558, instance_loss: 0.3235, weighted_loss: 0.2761, label: 0, bag_size: 4729
batch 39, loss: 0.3411, instance_loss: 0.4148, weighted_loss: 0.3632, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.10904255319148937: correct 41/376
Epoch: 25, train_loss: 0.6774, train_clustering_loss:  0.4395, train_error: 0.1702
class 0: acc 0.8666666666666667, correct 13/15
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8, correct 8/10
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.6724, val_error: 0.6364, auc: 0.5660
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 1.2489, instance_loss: 0.5944, weighted_loss: 1.0526, label: 1, bag_size: 4387
batch 39, loss: 0.6663, instance_loss: 0.4889, weighted_loss: 0.6131, label: 1, bag_size: 17691


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.19414893617021275: correct 73/376
Epoch: 26, train_loss: 0.5583, train_clustering_loss:  0.4020, train_error: 0.1702
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.9, correct 9/10
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.8417, val_error: 0.7273, auc: 0.5382
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 1.4441, instance_loss: 0.5814, weighted_loss: 1.1853, label: 2, bag_size: 14084
batch 39, loss: 0.9046, instance_loss: 0.4983, weighted_loss: 0.7828, label: 2, bag_size: 28856


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.21808510638297873: correct 82/376
Epoch: 27, train_loss: 0.5281, train_clustering_loss:  0.3951, train_error: 0.1277
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.75, correct 9/12
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.9435, val_error: 0.6364, auc: 0.5417
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.6232, instance_loss: 0.4664, weighted_loss: 0.5762, label: 0, bag_size: 16555
batch 39, loss: 0.1951, instance_loss: 0.2928, weighted_loss: 0.2244, label: 0, bag_size: 33379


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.27393617021276595: correct 103/376
Epoch: 28, train_loss: 0.5210, train_clustering_loss:  0.3636, train_error: 0.1277
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 2.0033, val_error: 0.7273, auc: 0.4965
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.8944, instance_loss: 0.5128, weighted_loss: 0.7799, label: 2, bag_size: 30302
batch 39, loss: 0.2699, instance_loss: 0.3456, weighted_loss: 0.2926, label: 0, bag_size: 10695


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.18351063829787234: correct 69/376
Epoch: 29, train_loss: 0.5098, train_clustering_loss:  0.3843, train_error: 0.1064
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.9638, val_error: 0.6364, auc: 0.5556
class 0 clustering acc 0.9346590909090909: correct 329/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.2686, instance_loss: 0.3228, weighted_loss: 0.2849, label: 2, bag_size: 18012
batch 39, loss: 1.4750, instance_loss: 0.6154, weighted_loss: 1.2171, label: 1, bag_size: 28374


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.2154255319148936: correct 81/376
Epoch: 30, train_loss: 0.4482, train_clustering_loss:  0.3623, train_error: 0.0851
class 0: acc 1.0, correct 20/20
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 1.0, correct 14/14
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 2.2147, val_error: 0.9091, auc: 0.4826
class 0 clustering acc 0.9204545454545454: correct 324/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.1885, instance_loss: 0.3297, weighted_loss: 0.2309, label: 1, bag_size: 12367
batch 39, loss: 0.5342, instance_loss: 0.4808, weighted_loss: 0.5182, label: 1, bag_size: 5424


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.3696808510638298: correct 139/376
Epoch: 31, train_loss: 0.4011, train_clustering_loss:  0.3358, train_error: 0.1064
class 0: acc 1.0, correct 11/11
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 2.0162, val_error: 0.6364, auc: 0.5764
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 3.0094, instance_loss: 1.0150, weighted_loss: 2.4111, label: 3, bag_size: 12796
batch 39, loss: 0.0547, instance_loss: 0.1318, weighted_loss: 0.0778, label: 3, bag_size: 12796


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.3484042553191489: correct 131/376
Epoch: 32, train_loss: 0.5149, train_clustering_loss:  0.3594, train_error: 0.1915
class 0: acc 0.7894736842105263, correct 15/19
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.8, correct 4/5
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.9359, val_error: 0.6364, auc: 0.5868
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.1977, instance_loss: 0.3323, weighted_loss: 0.2381, label: 0, bag_size: 4729
batch 39, loss: 0.0085, instance_loss: 0.0636, weighted_loss: 0.0250, label: 3, bag_size: 20225


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.3404255319148936: correct 128/376
Epoch: 33, train_loss: 0.3908, train_clustering_loss:  0.3212, train_error: 0.0851
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 1.9974, val_error: 0.6364, auc: 0.5625
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.5191, instance_loss: 0.3802, weighted_loss: 0.4774, label: 2, bag_size: 28856
batch 39, loss: 0.6072, instance_loss: 0.5260, weighted_loss: 0.5828, label: 1, bag_size: 28374


class 0 clustering acc 0.9980053191489362: correct 1501/1504
class 1 clustering acc 0.2925531914893617: correct 110/376
Epoch: 34, train_loss: 0.4475, train_clustering_loss:  0.3560, train_error: 0.1277
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 2.0295, val_error: 0.6364, auc: 0.5243
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.011363636363636364: correct 1/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.0837, instance_loss: 0.2206, weighted_loss: 0.1248, label: 3, bag_size: 5751
batch 39, loss: 0.1877, instance_loss: 0.4197, weighted_loss: 0.2573, label: 0, bag_size: 11326


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.3776595744680851: correct 142/376
Epoch: 35, train_loss: 0.3957, train_clustering_loss:  0.3166, train_error: 0.1064
class 0: acc 0.9, correct 9/10
class 1: acc 0.75, correct 6/8
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.8316, val_error: 0.5455, auc: 0.6319
class 0 clustering acc 0.9289772727272727: correct 327/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.2309, instance_loss: 0.3344, weighted_loss: 0.2619, label: 1, bag_size: 5424
batch 39, loss: 0.6203, instance_loss: 0.4377, weighted_loss: 0.5655, label: 1, bag_size: 28374


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.3377659574468085: correct 127/376
Epoch: 36, train_loss: 0.4032, train_clustering_loss:  0.3467, train_error: 0.1064
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8666666666666667, correct 13/15
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 2.0679, val_error: 0.6364, auc: 0.5660
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.1177, instance_loss: 0.3226, weighted_loss: 0.1792, label: 1, bag_size: 5424
batch 39, loss: 1.0615, instance_loss: 0.6831, weighted_loss: 0.9479, label: 1, bag_size: 26697


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.43617021276595747: correct 164/376
Epoch: 37, train_loss: 0.3690, train_clustering_loss:  0.3129, train_error: 0.1277
class 0: acc 0.75, correct 6/8
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8125, correct 13/16
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.9440, val_error: 0.6364, auc: 0.6042
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.056818181818181816: correct 5/88
class 0: acc 0.0, correct 0/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.3874, instance_loss: 0.4957, weighted_loss: 0.4199, label: 3, bag_size: 4443
batch 39, loss: 0.0359, instance_loss: 0.0869, weighted_loss: 0.0512, label: 3, bag_size: 4892


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.4973404255319149: correct 187/376
Epoch: 38, train_loss: 0.2951, train_clustering_loss:  0.2669, train_error: 0.0851
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 17/17

Val Set, val_loss: 2.2571, val_error: 0.7273, auc: 0.5104
class 0 clustering acc 0.9147727272727273: correct 322/352
class 1 clustering acc 0.03409090909090909: correct 3/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.0188, instance_loss: 0.1427, weighted_loss: 0.0560, label: 3, bag_size: 12796
batch 39, loss: 0.1599, instance_loss: 0.2729, weighted_loss: 0.1938, label: 0, bag_size: 18417


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.5: correct 188/376
Epoch: 39, train_loss: 0.2975, train_clustering_loss:  0.2717, train_error: 0.0638
class 0: acc 1.0, correct 15/15
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 2.1021, val_error: 0.6364, auc: 0.5729
class 0 clustering acc 0.9176136363636364: correct 323/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 32 out of 20


batch 19, loss: 2.1520, instance_loss: 0.7649, weighted_loss: 1.7359, label: 0, bag_size: 15265
batch 39, loss: 0.2621, instance_loss: 0.2448, weighted_loss: 0.2569, label: 2, bag_size: 18012


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.4441489361702128: correct 167/376
Epoch: 40, train_loss: 0.4360, train_clustering_loss:  0.3258, train_error: 0.1702
class 0: acc 0.8, correct 8/10
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.7, correct 7/10
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.9523, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 0.9517045454545454: correct 335/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.6043, instance_loss: 0.4202, weighted_loss: 0.5490, label: 2, bag_size: 2078
batch 39, loss: 0.2685, instance_loss: 0.2276, weighted_loss: 0.2562, label: 3, bag_size: 12626


class 0 clustering acc 0.9993351063829787: correct 1503/1504
class 1 clustering acc 0.47606382978723405: correct 179/376
Epoch: 41, train_loss: 0.3313, train_clustering_loss:  0.2791, train_error: 0.0426
class 0: acc 0.9, correct 9/10
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 2.0385, val_error: 0.6364, auc: 0.5729
class 0 clustering acc 0.9488636363636364: correct 334/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.1260, instance_loss: 0.1719, weighted_loss: 0.1398, label: 3, bag_size: 5751
batch 39, loss: 0.5573, instance_loss: 0.4253, weighted_loss: 0.5177, label: 2, bag_size: 28856


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.48138297872340424: correct 181/376
Epoch: 42, train_loss: 0.2705, train_clustering_loss:  0.2604, train_error: 0.0426
class 0: acc 0.875, correct 7/8
class 1: acc 0.875, correct 7/8
class 2: acc 1.0, correct 17/17
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 2.2704, val_error: 0.6364, auc: 0.4479
class 0 clustering acc 0.9204545454545454: correct 324/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.2231, instance_loss: 0.3375, weighted_loss: 0.2574, label: 1, bag_size: 20684
batch 39, loss: 0.0050, instance_loss: 0.0335, weighted_loss: 0.0135, label: 3, bag_size: 20225


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.5079787234042553: correct 191/376
Epoch: 43, train_loss: 0.3860, train_clustering_loss:  0.3157, train_error: 0.1489
class 0: acc 0.75, correct 6/8
class 1: acc 0.8125, correct 13/16
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 2.1776, val_error: 0.7273, auc: 0.5694
class 0 clustering acc 0.9403409090909091: correct 331/352
class 1 clustering acc 0.11363636363636363: correct 10/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.0297, instance_loss: 0.0796, weighted_loss: 0.0446, label: 3, bag_size: 21991
batch 39, loss: 0.2878, instance_loss: 0.2981, weighted_loss: 0.2909, label: 0, bag_size: 5626


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.5026595744680851: correct 189/376
Epoch: 44, train_loss: 0.2470, train_clustering_loss:  0.2549, train_error: 0.0426
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 2.2686, val_error: 0.6364, auc: 0.5625
class 0 clustering acc 0.8920454545454546: correct 314/352
class 1 clustering acc 0.10227272727272728: correct 9/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.2748, instance_loss: 0.2767, weighted_loss: 0.2754, label: 0, bag_size: 4729
batch 39, loss: 0.1579, instance_loss: 0.2164, weighted_loss: 0.1754, label: 0, bag_size: 1677


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.5292553191489362: correct 199/376
Epoch: 45, train_loss: 0.3010, train_clustering_loss:  0.2704, train_error: 0.0638
class 0: acc 1.0, correct 16/16
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 2.1642, val_error: 0.6364, auc: 0.5729
class 0 clustering acc 0.9090909090909091: correct 320/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.1574, instance_loss: 0.2164, weighted_loss: 0.1751, label: 1, bag_size: 17691
batch 39, loss: 1.1309, instance_loss: 0.6518, weighted_loss: 0.9871, label: 2, bag_size: 28856


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.6462765957446809: correct 243/376
Epoch: 46, train_loss: 0.2146, train_clustering_loss:  0.2273, train_error: 0.0426
class 0: acc 1.0, correct 9/9
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 2.0541, val_error: 0.6364, auc: 0.6076
class 0 clustering acc 0.9261363636363636: correct 326/352
class 1 clustering acc 0.13636363636363635: correct 12/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0187, instance_loss: 0.0729, weighted_loss: 0.0349, label: 3, bag_size: 6377
batch 39, loss: 0.3154, instance_loss: 0.3012, weighted_loss: 0.3111, label: 3, bag_size: 25817


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.625: correct 235/376
Epoch: 47, train_loss: 0.2557, train_clustering_loss:  0.2411, train_error: 0.0638
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 2.5231, val_error: 0.6364, auc: 0.4479
class 0 clustering acc 0.8920454545454546: correct 314/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.4751, instance_loss: 0.3823, weighted_loss: 0.4472, label: 0, bag_size: 12246
batch 39, loss: 0.0306, instance_loss: 0.0850, weighted_loss: 0.0469, label: 1, bag_size: 12367


class 0 clustering acc 0.9867021276595744: correct 1484/1504
class 1 clustering acc 0.5425531914893617: correct 204/376
Epoch: 48, train_loss: 0.2878, train_clustering_loss:  0.2715, train_error: 0.1277
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.75, correct 12/16
class 2: acc 0.8333333333333334, correct 5/6
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 2.3686, val_error: 0.6364, auc: 0.5625
class 0 clustering acc 0.8977272727272727: correct 316/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.2136, instance_loss: 0.2955, weighted_loss: 0.2382, label: 0, bag_size: 18417
batch 39, loss: 0.3841, instance_loss: 0.3326, weighted_loss: 0.3686, label: 0, bag_size: 3710


class 0 clustering acc 0.9840425531914894: correct 1480/1504
class 1 clustering acc 0.6329787234042553: correct 238/376
Epoch: 49, train_loss: 0.2200, train_clustering_loss:  0.2617, train_error: 0.0213
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 1.0, correct 5/5
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 2.2483, val_error: 0.5455, auc: 0.5799
class 0 clustering acc 0.8863636363636364: correct 312/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.1877, instance_loss: 0.2318, weighted_loss: 0.2009, label: 3, bag_size: 12626
batch 39, loss: 0.3739, instance_loss: 0.3516, weighted_loss: 0.3672, label: 1, bag_size: 6021


class 0 clustering acc 0.995345744680851: correct 1497/1504
class 1 clustering acc 0.6382978723404256: correct 240/376
Epoch: 50, train_loss: 0.1765, train_clustering_loss:  0.2249, train_error: 0.0213
class 0: acc 1.0, correct 13/13
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 2.0213, val_error: 0.5455, auc: 0.6424
class 0 clustering acc 0.90625: correct 319/352
class 1 clustering acc 0.25: correct 22/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.5596, instance_loss: 0.4142, weighted_loss: 0.5160, label: 2, bag_size: 14084
batch 39, loss: 0.0159, instance_loss: 0.0702, weighted_loss: 0.0322, label: 3, bag_size: 12796


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.6835106382978723: correct 257/376
Epoch: 51, train_loss: 0.1937, train_clustering_loss:  0.2157, train_error: 0.0213
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 12/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.9775, val_error: 0.5455, auc: 0.7049
class 0 clustering acc 0.9176136363636364: correct 323/352
class 1 clustering acc 0.2727272727272727: correct 24/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 44 out of 20
Early stopping
Val error: 0.6364, ROC AUC: 0.6944
Test error: 0.9091, ROC AUC: 0.6667
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3

Training Fold 9!

Init train/val/test splits... 
Done!
Training on 47 samples
Validating on 11 samples
Testing on 11 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.6317, instance_loss: 1.0815, weighted_loss: 1.4666, label: 0, bag_size: 12821
batch 39, loss: 2.3066, instance_loss: 0.9258, weighted_loss: 1.8924, label: 1, bag_size: 12367


class 0 clustering acc 0.8949468085106383: correct 1346/1504
class 1 clustering acc 0.2074468085106383: correct 78/376
Epoch: 0, train_loss: 1.3785, train_clustering_loss:  0.9955, train_error: 0.5319
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/9
class 2: acc 0.0, correct 0/6
class 3: acc 0.9565217391304348, correct 22/23

Val Set, val_loss: 1.4846, val_error: 0.7273, auc: 0.6181
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (inf --> 1.484598).  Saving model ...


batch 19, loss: 0.9575, instance_loss: 0.7038, weighted_loss: 0.8814, label: 3, bag_size: 4892
batch 39, loss: 1.2244, instance_loss: 0.7047, weighted_loss: 1.0685, label: 1, bag_size: 15079


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 1, train_loss: 1.4054, train_clustering_loss:  0.7645, train_error: 0.7021
class 0: acc 0.0, correct 0/7
class 1: acc 0.0, correct 0/15
class 2: acc 0.0, correct 0/11
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.3929, val_error: 0.7273, auc: 0.8438
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.484598 --> 1.392919).  Saving model ...


batch 19, loss: 1.3897, instance_loss: 0.6368, weighted_loss: 1.1639, label: 3, bag_size: 26172
batch 39, loss: 1.0574, instance_loss: 0.6523, weighted_loss: 0.9359, label: 2, bag_size: 14084


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 2, train_loss: 1.3919, train_clustering_loss:  0.6585, train_error: 0.7021
class 0: acc 0.0, correct 0/9
class 1: acc 0.6428571428571429, correct 9/14
class 2: acc 0.3125, correct 5/16
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4273, val_error: 0.8182, auc: 0.7049
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6682, instance_loss: 0.6715, weighted_loss: 1.3692, label: 0, bag_size: 1677
batch 39, loss: 1.0823, instance_loss: 0.5844, weighted_loss: 0.9330, label: 3, bag_size: 25817


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 3, train_loss: 1.3733, train_clustering_loss:  0.6150, train_error: 0.6809
class 0: acc 0.0, correct 0/8
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 0.1, correct 1/10
class 3: acc 0.35294117647058826, correct 6/17

Val Set, val_loss: 1.3910, val_error: 0.7273, auc: 0.8333
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.392919 --> 1.391028).  Saving model ...


batch 19, loss: 1.1170, instance_loss: 0.5712, weighted_loss: 0.9533, label: 2, bag_size: 30302
batch 39, loss: 1.7336, instance_loss: 0.6249, weighted_loss: 1.4010, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 4, train_loss: 1.4490, train_clustering_loss:  0.6222, train_error: 0.8511
class 0: acc 0.26666666666666666, correct 4/15
class 1: acc 0.0, correct 0/12
class 2: acc 0.2727272727272727, correct 3/11
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3514, val_error: 0.7273, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.391028 --> 1.351352).  Saving model ...


batch 19, loss: 1.5318, instance_loss: 0.6221, weighted_loss: 1.2589, label: 0, bag_size: 14055
batch 39, loss: 1.4713, instance_loss: 0.6322, weighted_loss: 1.2196, label: 0, bag_size: 10695


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 5, train_loss: 1.3739, train_clustering_loss:  0.6106, train_error: 0.7021
class 0: acc 0.07692307692307693, correct 1/13
class 1: acc 1.0, correct 12/12
class 2: acc 0.07692307692307693, correct 1/13
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3692, val_error: 0.6364, auc: 0.7396
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5190, instance_loss: 0.5873, weighted_loss: 1.2395, label: 2, bag_size: 30302
batch 39, loss: 1.6117, instance_loss: 0.6334, weighted_loss: 1.3182, label: 3, bag_size: 4892


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 6, train_loss: 1.3395, train_clustering_loss:  0.6079, train_error: 0.6596
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.1, correct 1/10
class 2: acc 0.2, correct 3/15
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3959, val_error: 0.7273, auc: 0.7708
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.2193, instance_loss: 0.5943, weighted_loss: 1.0318, label: 0, bag_size: 1677
batch 39, loss: 1.1505, instance_loss: 0.5967, weighted_loss: 0.9843, label: 0, bag_size: 14055


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 7, train_loss: 1.3045, train_clustering_loss:  0.6043, train_error: 0.5319
class 0: acc 0.6875, correct 11/16
class 1: acc 0.3, correct 3/10
class 2: acc 0.0, correct 0/5
class 3: acc 0.5, correct 8/16

Val Set, val_loss: 1.3505, val_error: 0.7273, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.351352 --> 1.350515).  Saving model ...


batch 19, loss: 1.6834, instance_loss: 0.6182, weighted_loss: 1.3638, label: 2, bag_size: 15369
batch 39, loss: 1.6891, instance_loss: 0.6373, weighted_loss: 1.3736, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 8, train_loss: 1.3136, train_clustering_loss:  0.5983, train_error: 0.5745
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.0, correct 0/7
class 2: acc 0.0, correct 0/13
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.3483, val_error: 0.7273, auc: 0.7326
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.350515 --> 1.348300).  Saving model ...


batch 19, loss: 1.0989, instance_loss: 0.6194, weighted_loss: 0.9550, label: 3, bag_size: 20225
batch 39, loss: 1.2519, instance_loss: 0.6065, weighted_loss: 1.0583, label: 1, bag_size: 12367


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 9, train_loss: 1.2609, train_clustering_loss:  0.5964, train_error: 0.4894
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.3333333333333333, correct 3/9
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.3247, val_error: 0.5455, auc: 0.6979
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.348300 --> 1.324663).  Saving model ...


batch 19, loss: 1.1187, instance_loss: 0.5777, weighted_loss: 0.9564, label: 3, bag_size: 4892
batch 39, loss: 1.4428, instance_loss: 0.6155, weighted_loss: 1.1946, label: 1, bag_size: 15079


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 10, train_loss: 1.3119, train_clustering_loss:  0.6006, train_error: 0.6170
class 0: acc 0.2222222222222222, correct 2/9
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.21428571428571427, correct 3/14
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.3283, val_error: 0.5455, auc: 0.7326
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7985, instance_loss: 0.5771, weighted_loss: 0.7321, label: 1, bag_size: 6021
batch 39, loss: 1.1497, instance_loss: 0.5903, weighted_loss: 0.9819, label: 2, bag_size: 11341


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 11, train_loss: 1.1982, train_clustering_loss:  0.5929, train_error: 0.4894
class 0: acc 0.23076923076923078, correct 3/13
class 1: acc 0.9444444444444444, correct 17/18
class 2: acc 0.16666666666666666, correct 2/12
class 3: acc 0.5, correct 2/4

Val Set, val_loss: 1.3541, val_error: 0.5455, auc: 0.7674
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1485, instance_loss: 0.5916, weighted_loss: 0.9814, label: 2, bag_size: 23737
batch 39, loss: 1.2529, instance_loss: 0.5968, weighted_loss: 1.0561, label: 2, bag_size: 30302


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 12, train_loss: 1.2438, train_clustering_loss:  0.5946, train_error: 0.6170
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.75, correct 9/12
class 2: acc 0.38461538461538464, correct 5/13
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.2921, val_error: 0.6364, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.324663 --> 1.292139).  Saving model ...


batch 19, loss: 0.7392, instance_loss: 0.6073, weighted_loss: 0.6996, label: 3, bag_size: 26172
batch 39, loss: 1.2713, instance_loss: 0.5882, weighted_loss: 1.0664, label: 2, bag_size: 30302


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 13, train_loss: 1.2263, train_clustering_loss:  0.5921, train_error: 0.5745
class 0: acc 0.2222222222222222, correct 2/9
class 1: acc 0.2, correct 2/10
class 2: acc 0.375, correct 6/16
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.2792, val_error: 0.5455, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.3333333333333333, correct 1/3
Validation loss decreased (1.292139 --> 1.279226).  Saving model ...


batch 19, loss: 1.2998, instance_loss: 0.6146, weighted_loss: 1.0942, label: 0, bag_size: 1677
batch 39, loss: 0.9817, instance_loss: 0.5354, weighted_loss: 0.8478, label: 3, bag_size: 3355


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 14, train_loss: 1.1615, train_clustering_loss:  0.5823, train_error: 0.4681
class 0: acc 0.25, correct 2/8
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.6875, correct 11/16
class 3: acc 0.6428571428571429, correct 9/14

Val Set, val_loss: 1.2955, val_error: 0.7273, auc: 0.7535
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.6666666666666666, correct 2/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3511, instance_loss: 0.6523, weighted_loss: 1.1414, label: 0, bag_size: 5626
batch 39, loss: 1.5686, instance_loss: 0.5918, weighted_loss: 1.2756, label: 3, bag_size: 5751


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 15, train_loss: 1.2082, train_clustering_loss:  0.5940, train_error: 0.5106
class 0: acc 0.38461538461538464, correct 5/13
class 1: acc 0.46153846153846156, correct 6/13
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.2608, val_error: 0.7273, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
Validation loss decreased (1.279226 --> 1.260769).  Saving model ...


batch 19, loss: 1.4983, instance_loss: 0.5776, weighted_loss: 1.2221, label: 2, bag_size: 30302
batch 39, loss: 0.8902, instance_loss: 0.5260, weighted_loss: 0.7810, label: 2, bag_size: 15369


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 16, train_loss: 1.0620, train_clustering_loss:  0.5694, train_error: 0.4255
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.09090909090909091, correct 1/11
class 3: acc 0.5714285714285714, correct 8/14

Val Set, val_loss: 1.2738, val_error: 0.5455, auc: 0.7465
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.1303, instance_loss: 0.5900, weighted_loss: 0.9682, label: 2, bag_size: 2632
batch 39, loss: 0.8211, instance_loss: 0.5190, weighted_loss: 0.7305, label: 2, bag_size: 6102


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 17, train_loss: 0.9157, train_clustering_loss:  0.5553, train_error: 0.2979
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.125, correct 1/8
class 2: acc 0.7142857142857143, correct 10/14
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.2815, val_error: 0.7273, auc: 0.7431
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1130, instance_loss: 0.5647, weighted_loss: 0.9485, label: 3, bag_size: 3355
batch 39, loss: 1.0516, instance_loss: 0.5739, weighted_loss: 0.9083, label: 2, bag_size: 2632


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 18, train_loss: 0.9862, train_clustering_loss:  0.5599, train_error: 0.3830
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.16666666666666666, correct 2/12
class 2: acc 0.9375, correct 15/16
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.2642, val_error: 0.5455, auc: 0.7917
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.3564, instance_loss: 0.5963, weighted_loss: 1.1284, label: 0, bag_size: 4729
batch 39, loss: 1.9627, instance_loss: 0.6620, weighted_loss: 1.5725, label: 2, bag_size: 2078


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 19, train_loss: 1.1439, train_clustering_loss:  0.5772, train_error: 0.4894
class 0: acc 0.3333333333333333, correct 5/15
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 0.25, correct 2/8
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.2903, val_error: 0.6364, auc: 0.6875
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.3333333333333333, correct 1/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.3593, instance_loss: 0.5527, weighted_loss: 1.1173, label: 1, bag_size: 33605
batch 39, loss: 1.8474, instance_loss: 0.7147, weighted_loss: 1.5076, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 20, train_loss: 0.9984, train_clustering_loss:  0.5547, train_error: 0.4468
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.125, correct 1/8
class 3: acc 0.75, correct 12/16

Val Set, val_loss: 1.3274, val_error: 0.5455, auc: 0.6319
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.0, correct 0/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.3453, instance_loss: 0.5848, weighted_loss: 1.1171, label: 3, bag_size: 4443
batch 39, loss: 0.2517, instance_loss: 0.5065, weighted_loss: 0.3282, label: 3, bag_size: 20225


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 21, train_loss: 0.9348, train_clustering_loss:  0.5426, train_error: 0.3404
class 0: acc 0.7, correct 7/10
class 1: acc 0.8, correct 12/15
class 2: acc 0.2727272727272727, correct 3/11
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.2939, val_error: 0.7273, auc: 0.6840
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.9457, instance_loss: 0.5782, weighted_loss: 0.8354, label: 2, bag_size: 23737
batch 39, loss: 0.5739, instance_loss: 0.5093, weighted_loss: 0.5546, label: 0, bag_size: 12246


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 22, train_loss: 0.9321, train_clustering_loss:  0.5407, train_error: 0.3617
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 0.4, correct 4/10
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.2922, val_error: 0.6364, auc: 0.7292
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.9278, instance_loss: 0.5736, weighted_loss: 0.8215, label: 2, bag_size: 23737
batch 39, loss: 0.8868, instance_loss: 0.5799, weighted_loss: 0.7947, label: 3, bag_size: 12708


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 23, train_loss: 0.9491, train_clustering_loss:  0.5427, train_error: 0.3830
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.6153846153846154, correct 8/13
class 3: acc 0.625, correct 10/16

Val Set, val_loss: 1.1425, val_error: 0.2727, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 3/3
Validation loss decreased (1.260769 --> 1.142511).  Saving model ...


batch 19, loss: 1.0602, instance_loss: 0.5907, weighted_loss: 0.9194, label: 2, bag_size: 30302
batch 39, loss: 0.4138, instance_loss: 0.4595, weighted_loss: 0.4275, label: 0, bag_size: 4729


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 24, train_loss: 0.8567, train_clustering_loss:  0.5245, train_error: 0.3191
class 0: acc 0.5384615384615384, correct 7/13
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.6875, correct 11/16
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.2822, val_error: 0.4545, auc: 0.7882
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3021, instance_loss: 0.5975, weighted_loss: 1.0907, label: 1, bag_size: 6021
batch 39, loss: 0.5454, instance_loss: 0.5056, weighted_loss: 0.5334, label: 1, bag_size: 5424


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 25, train_loss: 0.7880, train_clustering_loss:  0.5067, train_error: 0.2979
class 0: acc 1.0, correct 13/13
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.7, correct 7/10
class 3: acc 0.6153846153846154, correct 8/13

Val Set, val_loss: 1.2493, val_error: 0.4545, auc: 0.7812
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.0962, instance_loss: 0.2588, weighted_loss: 0.1450, label: 1, bag_size: 12367
batch 39, loss: 0.8582, instance_loss: 0.5099, weighted_loss: 0.7537, label: 1, bag_size: 4387


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 26, train_loss: 0.8819, train_clustering_loss:  0.5274, train_error: 0.3617
class 0: acc 0.5, correct 4/8
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.42857142857142855, correct 6/14
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.2328, val_error: 0.4545, auc: 0.7778
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.0535, instance_loss: 0.5696, weighted_loss: 0.9083, label: 2, bag_size: 14084
batch 39, loss: 0.5728, instance_loss: 0.5165, weighted_loss: 0.5559, label: 3, bag_size: 1295


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0: correct 0/376
Epoch: 27, train_loss: 0.7884, train_clustering_loss:  0.5071, train_error: 0.3191
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.45454545454545453, correct 5/11
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.2880, val_error: 0.4545, auc: 0.7569
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.5259, instance_loss: 0.4521, weighted_loss: 0.5038, label: 0, bag_size: 16555
batch 39, loss: 0.6939, instance_loss: 0.4913, weighted_loss: 0.6331, label: 2, bag_size: 6102


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.007978723404255319: correct 3/376
Epoch: 28, train_loss: 0.7437, train_clustering_loss:  0.4989, train_error: 0.3617
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.4166666666666667, correct 5/12
class 3: acc 0.5384615384615384, correct 7/13

Val Set, val_loss: 1.4773, val_error: 0.6364, auc: 0.6944
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.9549, instance_loss: 0.5994, weighted_loss: 0.8483, label: 2, bag_size: 2078
batch 39, loss: 0.4889, instance_loss: 0.4243, weighted_loss: 0.4695, label: 2, bag_size: 28856


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.015957446808510637: correct 6/376
Epoch: 29, train_loss: 0.6605, train_clustering_loss:  0.4813, train_error: 0.2128
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.9, correct 9/10
class 2: acc 0.7692307692307693, correct 10/13
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.2483, val_error: 0.5455, auc: 0.7604
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1611, instance_loss: 0.3182, weighted_loss: 0.2082, label: 3, bag_size: 26172
batch 39, loss: 0.5813, instance_loss: 0.5331, weighted_loss: 0.5668, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.005319148936170213: correct 2/376
Epoch: 30, train_loss: 0.6133, train_clustering_loss:  0.4638, train_error: 0.1277
class 0: acc 0.9285714285714286, correct 13/14
class 1: acc 0.75, correct 6/8
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.4760, val_error: 0.5455, auc: 0.7257
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.0: correct 0/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.8336, instance_loss: 0.5744, weighted_loss: 0.7559, label: 1, bag_size: 15079
batch 39, loss: 0.6324, instance_loss: 0.5384, weighted_loss: 0.6042, label: 1, bag_size: 5424


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.04521276595744681: correct 17/376
Epoch: 31, train_loss: 0.6011, train_clustering_loss:  0.4515, train_error: 0.1915
class 0: acc 0.85, correct 17/20
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 1.6846, val_error: 0.7273, auc: 0.6528
class 0 clustering acc 0.9744318181818182: correct 343/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.7926, instance_loss: 0.4886, weighted_loss: 0.7014, label: 3, bag_size: 4443
batch 39, loss: 0.5959, instance_loss: 0.4409, weighted_loss: 0.5494, label: 3, bag_size: 4443


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.05851063829787234: correct 22/376
Epoch: 32, train_loss: 0.5452, train_clustering_loss:  0.4528, train_error: 0.1064
class 0: acc 1.0, correct 11/11
class 1: acc 1.0, correct 13/13
class 2: acc 0.75, correct 9/12
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.3394, val_error: 0.4545, auc: 0.7326
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.06818181818181818: correct 6/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.2273, instance_loss: 0.3118, weighted_loss: 0.2527, label: 0, bag_size: 4729
batch 39, loss: 0.8713, instance_loss: 0.6059, weighted_loss: 0.7917, label: 2, bag_size: 11341


class 0 clustering acc 0.9986702127659575: correct 1502/1504
class 1 clustering acc 0.08244680851063829: correct 31/376
Epoch: 33, train_loss: 0.5040, train_clustering_loss:  0.4323, train_error: 0.1915
class 0: acc 0.9, correct 9/10
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.4, correct 4/10
class 3: acc 1.0, correct 18/18

Val Set, val_loss: 1.4006, val_error: 0.4545, auc: 0.6979
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.6206, instance_loss: 0.4849, weighted_loss: 0.5799, label: 3, bag_size: 1295
batch 39, loss: 0.4801, instance_loss: 0.5258, weighted_loss: 0.4938, label: 2, bag_size: 25227


class 0 clustering acc 1.0: correct 1504/1504
class 1 clustering acc 0.0797872340425532: correct 30/376
Epoch: 34, train_loss: 0.5271, train_clustering_loss:  0.4435, train_error: 0.0638
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 1.0, correct 11/11
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.5014, val_error: 0.4545, auc: 0.6319
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.045454545454545456: correct 4/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.3892, instance_loss: 0.4052, weighted_loss: 0.3940, label: 1, bag_size: 19756
batch 39, loss: 0.5643, instance_loss: 0.5041, weighted_loss: 0.5462, label: 2, bag_size: 6102


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.13297872340425532: correct 50/376
Epoch: 35, train_loss: 0.4282, train_clustering_loss:  0.4215, train_error: 0.0851
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 13/13
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.3599, val_error: 0.4545, auc: 0.7396
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.4235, instance_loss: 0.3662, weighted_loss: 0.4063, label: 1, bag_size: 5424
batch 39, loss: 0.3845, instance_loss: 0.5167, weighted_loss: 0.4242, label: 2, bag_size: 25227


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.14893617021276595: correct 56/376
Epoch: 36, train_loss: 0.4831, train_clustering_loss:  0.4249, train_error: 0.1489
class 0: acc 0.75, correct 9/12
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.75, correct 9/12
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.5131, val_error: 0.4545, auc: 0.7049
class 0 clustering acc 0.9943181818181818: correct 350/352
class 1 clustering acc 0.07954545454545454: correct 7/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.7346, instance_loss: 0.4510, weighted_loss: 0.6495, label: 1, bag_size: 5424
batch 39, loss: 0.0948, instance_loss: 0.2157, weighted_loss: 0.1311, label: 3, bag_size: 20225


class 0 clustering acc 0.9940159574468085: correct 1495/1504
class 1 clustering acc 0.13829787234042554: correct 52/376
Epoch: 37, train_loss: 0.5362, train_clustering_loss:  0.4504, train_error: 0.1489
class 0: acc 0.75, correct 9/12
class 1: acc 0.8, correct 8/10
class 2: acc 0.9411764705882353, correct 16/17
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.6412, val_error: 0.4545, auc: 0.7188
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.0756, instance_loss: 0.1920, weighted_loss: 0.1105, label: 0, bag_size: 5626
batch 39, loss: 0.0862, instance_loss: 0.2241, weighted_loss: 0.1275, label: 3, bag_size: 26172


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.17819148936170212: correct 67/376
Epoch: 38, train_loss: 0.4023, train_clustering_loss:  0.3875, train_error: 0.0426
class 0: acc 1.0, correct 12/12
class 1: acc 1.0, correct 7/7
class 2: acc 0.9285714285714286, correct 13/14
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.4643, val_error: 0.4545, auc: 0.7396
class 0 clustering acc 0.9914772727272727: correct 349/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.4141, instance_loss: 0.3723, weighted_loss: 0.4016, label: 3, bag_size: 4443
batch 39, loss: 0.5795, instance_loss: 0.5576, weighted_loss: 0.5729, label: 2, bag_size: 40177


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.25: correct 94/376
Epoch: 39, train_loss: 0.3905, train_clustering_loss:  0.3908, train_error: 0.0851
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.7630, val_error: 0.4545, auc: 0.6771
class 0 clustering acc 0.9431818181818182: correct 332/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.2498, instance_loss: 0.3257, weighted_loss: 0.2725, label: 2, bag_size: 28856
batch 39, loss: 0.0658, instance_loss: 0.1892, weighted_loss: 0.1028, label: 3, bag_size: 26172


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.19414893617021275: correct 73/376
Epoch: 40, train_loss: 0.4172, train_clustering_loss:  0.4202, train_error: 0.0851
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.9375, correct 15/16
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.5253, val_error: 0.4545, auc: 0.7083
class 0 clustering acc 0.9886363636363636: correct 348/352
class 1 clustering acc 0.125: correct 11/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1243, instance_loss: 0.2435, weighted_loss: 0.1600, label: 0, bag_size: 29269
batch 39, loss: 0.2254, instance_loss: 0.3211, weighted_loss: 0.2541, label: 2, bag_size: 23737


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.19148936170212766: correct 72/376
Epoch: 41, train_loss: 0.3755, train_clustering_loss:  0.4108, train_error: 0.1064
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.5341, val_error: 0.4545, auc: 0.7361
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.09090909090909091: correct 8/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.4087, instance_loss: 0.4138, weighted_loss: 0.4102, label: 1, bag_size: 19756
batch 39, loss: 0.4510, instance_loss: 0.4811, weighted_loss: 0.4600, label: 3, bag_size: 1295


class 0 clustering acc 0.9946808510638298: correct 1496/1504
class 1 clustering acc 0.2978723404255319: correct 112/376
Epoch: 42, train_loss: 0.5023, train_clustering_loss:  0.4026, train_error: 0.1064
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 1.0, correct 9/9
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.7144, val_error: 0.4545, auc: 0.6771
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.7612, instance_loss: 0.4825, weighted_loss: 0.6776, label: 1, bag_size: 26697
batch 39, loss: 0.2726, instance_loss: 0.4019, weighted_loss: 0.3114, label: 2, bag_size: 11341


class 0 clustering acc 0.9960106382978723: correct 1498/1504
class 1 clustering acc 0.17553191489361702: correct 66/376
Epoch: 43, train_loss: 0.3594, train_clustering_loss:  0.3947, train_error: 0.0426
class 0: acc 0.75, correct 6/8
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.4590, val_error: 0.4545, auc: 0.7153
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.1590909090909091: correct 14/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.3308, instance_loss: 0.3938, weighted_loss: 0.3497, label: 1, bag_size: 28374
batch 39, loss: 0.0612, instance_loss: 0.2213, weighted_loss: 0.1093, label: 0, bag_size: 1677


class 0 clustering acc 0.9886968085106383: correct 1487/1504
class 1 clustering acc 0.30851063829787234: correct 116/376
Epoch: 44, train_loss: 0.3581, train_clustering_loss:  0.3710, train_error: 0.0426
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 1.0, correct 13/13
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.6885, val_error: 0.4545, auc: 0.6979
class 0 clustering acc 0.9829545454545454: correct 346/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.3652, instance_loss: 0.3571, weighted_loss: 0.3628, label: 1, bag_size: 6021
batch 39, loss: 0.1401, instance_loss: 0.2298, weighted_loss: 0.1670, label: 0, bag_size: 5007


class 0 clustering acc 0.9933510638297872: correct 1494/1504
class 1 clustering acc 0.3617021276595745: correct 136/376
Epoch: 45, train_loss: 0.2858, train_clustering_loss:  0.3414, train_error: 0.0213
class 0: acc 1.0, correct 15/15
class 1: acc 1.0, correct 13/13
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.9320, val_error: 0.4545, auc: 0.6319
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.17045454545454544: correct 15/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.0629, instance_loss: 0.3422, weighted_loss: 0.1467, label: 1, bag_size: 4387
batch 39, loss: 0.4346, instance_loss: 0.5013, weighted_loss: 0.4546, label: 3, bag_size: 1295


class 0 clustering acc 0.9906914893617021: correct 1490/1504
class 1 clustering acc 0.4122340425531915: correct 155/376
Epoch: 46, train_loss: 0.2557, train_clustering_loss:  0.3517, train_error: 0.0213
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 1.0, correct 14/14
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.4296, val_error: 0.4545, auc: 0.7812
class 0 clustering acc 0.9971590909090909: correct 351/352
class 1 clustering acc 0.18181818181818182: correct 16/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.0855, instance_loss: 0.2587, weighted_loss: 0.1374, label: 3, bag_size: 4892
batch 39, loss: 0.1471, instance_loss: 0.4582, weighted_loss: 0.2404, label: 3, bag_size: 12708


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.43617021276595747: correct 164/376
Epoch: 47, train_loss: 0.2597, train_clustering_loss:  0.3480, train_error: 0.0213
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.5793, val_error: 0.4545, auc: 0.7188
class 0 clustering acc 0.9630681818181818: correct 339/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 24 out of 20


batch 19, loss: 1.2954, instance_loss: 0.6496, weighted_loss: 1.1017, label: 2, bag_size: 15369
batch 39, loss: 0.0630, instance_loss: 0.2216, weighted_loss: 0.1105, label: 1, bag_size: 15079


class 0 clustering acc 0.9840425531914894: correct 1480/1504
class 1 clustering acc 0.3882978723404255: correct 146/376
Epoch: 48, train_loss: 0.2702, train_clustering_loss:  0.3367, train_error: 0.0426
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 1.0, correct 14/14
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.4244, val_error: 0.4545, auc: 0.7778
class 0 clustering acc 0.9857954545454546: correct 347/352
class 1 clustering acc 0.25: correct 22/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.2380, instance_loss: 0.5212, weighted_loss: 0.3230, label: 2, bag_size: 40177
batch 39, loss: 0.3852, instance_loss: 0.3195, weighted_loss: 0.3655, label: 1, bag_size: 33605


class 0 clustering acc 0.9900265957446809: correct 1489/1504
class 1 clustering acc 0.31117021276595747: correct 117/376
Epoch: 49, train_loss: 0.3484, train_clustering_loss:  0.3720, train_error: 0.1064
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.9375, correct 15/16
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.3907, val_error: 0.4545, auc: 0.8194
class 0 clustering acc 1.0: correct 352/352
class 1 clustering acc 0.19318181818181818: correct 17/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.1625, instance_loss: 0.2770, weighted_loss: 0.1969, label: 2, bag_size: 23737
batch 39, loss: 0.0155, instance_loss: 0.0806, weighted_loss: 0.0351, label: 1, bag_size: 12367


class 0 clustering acc 0.9920212765957447: correct 1492/1504
class 1 clustering acc 0.3962765957446808: correct 149/376
Epoch: 50, train_loss: 0.2875, train_clustering_loss:  0.3237, train_error: 0.0638
class 0: acc 0.9, correct 9/10
class 1: acc 1.0, correct 14/14
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.7415, val_error: 0.4545, auc: 0.7639
class 0 clustering acc 0.9801136363636364: correct 345/352
class 1 clustering acc 0.23863636363636365: correct 21/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.1335, instance_loss: 0.3175, weighted_loss: 0.1887, label: 2, bag_size: 14084
batch 39, loss: 0.1128, instance_loss: 0.3217, weighted_loss: 0.1755, label: 3, bag_size: 5751


class 0 clustering acc 0.9973404255319149: correct 1500/1504
class 1 clustering acc 0.4627659574468085: correct 174/376
Epoch: 51, train_loss: 0.2365, train_clustering_loss:  0.3055, train_error: 0.0000
class 0: acc 1.0, correct 16/16
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.5803, val_error: 0.4545, auc: 0.7535
class 0 clustering acc 0.96875: correct 341/352
class 1 clustering acc 0.26136363636363635: correct 23/88
class 0: acc 0.6666666666666666, correct 2/3
class 1: acc 0.6666666666666666, correct 2/3
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3
EarlyStopping counter: 28 out of 20
Early stopping
Val error: 0.2727, ROC AUC: 0.7778
Test error: 0.7273, ROC AUC: 0.8368
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/3
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3
finished!
end script
Completed: Wed Apr 27 19:18:23 EDT 2022
