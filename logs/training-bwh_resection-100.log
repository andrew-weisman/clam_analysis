
Load Dataset
label column: label
label dictionary: {'pole': 0, 'msi': 1, 'lcn': 2, 'p53': 3}
number of classes: 4
slide-level counts:  
 0    13
1    14
2    13
3    14
Name: label, dtype: int64
Patient-LVL; Number of samples registered in class 0: 13
Slide-LVL; Number of samples registered in class 0: 13
Patient-LVL; Number of samples registered in class 1: 14
Slide-LVL; Number of samples registered in class 1: 14
Patient-LVL; Number of samples registered in class 2: 13
Slide-LVL; Number of samples registered in class 2: 13
Patient-LVL; Number of samples registered in class 3: 14
Slide-LVL; Number of samples registered in class 3: 14
split_dir:  splits/idibell_100
################# Settings ###################
num_splits:  5
k_start:  -1
k_end:  -1
task:  idibell
max_epochs:  200
results_dir:  /home/weismanal/notebook/2021-11-11/testing_clam/results/bwh_resection/training
lr:  0.0002
experiment:  idibell_CLAM_100
reg:  1e-05
label_frac:  1.0
bag_loss:  ce
seed:  1
model_type:  clam_sb
model_size:  small
use_drop_out:  True
weighted_sample:  True
opt:  adam
bag_weight:  0.7
inst_loss:  svm
B:  8
split_dir:  splits/idibell_100

Training Fold 0!

Init train/val/test splits... 
Done!
Training on 38 samples
Validating on 8 samples
Testing on 8 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.2765, instance_loss: 1.0943, weighted_loss: 1.2219, label: 2, bag_size: 23349


class 0 clustering acc 0.9095394736842105: correct 1106/1216
class 1 clustering acc 0.13157894736842105: correct 40/304
Epoch: 0, train_loss: 1.4153, train_clustering_loss:  1.0850, train_error: 0.7632
class 0: acc 0.0, correct 0/10
class 1: acc 0.0, correct 0/5
class 2: acc 0.21428571428571427, correct 3/14
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.4437, val_error: 0.7500, auc: 0.5000
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (inf --> 1.443721).  Saving model ...


batch 19, loss: 1.5164, instance_loss: 0.7331, weighted_loss: 1.2815, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 1, train_loss: 1.4293, train_clustering_loss:  0.7904, train_error: 0.7368
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.0, correct 0/9
class 2: acc 0.16666666666666666, correct 1/6
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.4078, val_error: 0.7500, auc: 0.5833
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.443721 --> 1.407774).  Saving model ...


batch 19, loss: 1.5822, instance_loss: 0.6868, weighted_loss: 1.3136, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 2, train_loss: 1.4421, train_clustering_loss:  0.6603, train_error: 0.7895
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 0.23076923076923078, correct 3/13
class 2: acc 0.0, correct 0/10
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.3902, val_error: 0.7500, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.407774 --> 1.390170).  Saving model ...


batch 19, loss: 1.5321, instance_loss: 0.6390, weighted_loss: 1.2642, label: 0, bag_size: 13999


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 3, train_loss: 1.3602, train_clustering_loss:  0.6322, train_error: 0.7368
class 0: acc 0.0, correct 0/6
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 0.5, correct 6/12
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3884, val_error: 0.7500, auc: 0.6667
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.390170 --> 1.388401).  Saving model ...


batch 19, loss: 0.9388, instance_loss: 0.5957, weighted_loss: 0.8359, label: 1, bag_size: 66789


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 4, train_loss: 1.4181, train_clustering_loss:  0.6366, train_error: 0.7105
class 0: acc 0.14285714285714285, correct 2/14
class 1: acc 1.0, correct 9/9
class 2: acc 0.0, correct 0/7
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3655, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.388401 --> 1.365535).  Saving model ...


batch 19, loss: 1.2282, instance_loss: 0.6009, weighted_loss: 1.0400, label: 2, bag_size: 17501


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 5, train_loss: 1.3583, train_clustering_loss:  0.6329, train_error: 0.7632
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.0, correct 0/11
class 2: acc 0.5, correct 6/12
class 3: acc 0.0, correct 0/6

Val Set, val_loss: 1.3747, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.7227, instance_loss: 0.6587, weighted_loss: 1.4035, label: 3, bag_size: 113328


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 6, train_loss: 1.3617, train_clustering_loss:  0.6383, train_error: 0.6842
class 0: acc 0.2222222222222222, correct 2/9
class 1: acc 0.25, correct 3/12
class 2: acc 0.875, correct 7/8
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3559, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.365535 --> 1.355879).  Saving model ...


batch 19, loss: 1.3934, instance_loss: 0.6236, weighted_loss: 1.1625, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 7, train_loss: 1.3210, train_clustering_loss:  0.6324, train_error: 0.6579
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.0, correct 0/9
class 2: acc 0.36363636363636365, correct 4/11
class 3: acc 0.14285714285714285, correct 1/7

Val Set, val_loss: 1.3465, val_error: 0.7500, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.355879 --> 1.346515).  Saving model ...


batch 19, loss: 1.5604, instance_loss: 0.6496, weighted_loss: 1.2871, label: 3, bag_size: 196107


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 8, train_loss: 1.2881, train_clustering_loss:  0.6251, train_error: 0.4737
class 0: acc 0.8, correct 8/10
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.6, correct 3/5
class 3: acc 0.35714285714285715, correct 5/14

Val Set, val_loss: 1.3977, val_error: 0.7500, auc: 0.7083
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8436, instance_loss: 0.5632, weighted_loss: 0.7595, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 9, train_loss: 1.1820, train_clustering_loss:  0.6069, train_error: 0.5263
class 0: acc 0.0, correct 0/3
class 1: acc 0.0, correct 0/9
class 2: acc 0.0, correct 0/8
class 3: acc 1.0, correct 18/18

Val Set, val_loss: 1.4916, val_error: 0.7500, auc: 0.7292
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0580, instance_loss: 0.6048, weighted_loss: 0.9221, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 10, train_loss: 1.3625, train_clustering_loss:  0.6222, train_error: 0.6316
class 0: acc 0.0, correct 0/10
class 1: acc 0.6, correct 6/10
class 2: acc 0.2, correct 2/10
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.3353, val_error: 0.5000, auc: 0.7292
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.5, correct 1/2
Validation loss decreased (1.346515 --> 1.335343).  Saving model ...


batch 19, loss: 1.0302, instance_loss: 0.5795, weighted_loss: 0.8950, label: 1, bag_size: 69073


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 11, train_loss: 1.2733, train_clustering_loss:  0.6159, train_error: 0.4737
class 0: acc 0.0, correct 0/5
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3491, val_error: 0.5000, auc: 0.7083
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9524, instance_loss: 0.6012, weighted_loss: 0.8471, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 12, train_loss: 1.2376, train_clustering_loss:  0.6125, train_error: 0.5789
class 0: acc 0.2857142857142857, correct 2/7
class 1: acc 0.1111111111111111, correct 1/9
class 2: acc 0.6153846153846154, correct 8/13
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.3659, val_error: 0.6250, auc: 0.7292
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.4611, instance_loss: 0.6352, weighted_loss: 1.2133, label: 1, bag_size: 47433


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 13, train_loss: 1.2455, train_clustering_loss:  0.6058, train_error: 0.5000
class 0: acc 0.5, correct 4/8
class 1: acc 0.36363636363636365, correct 4/11
class 2: acc 0.75, correct 6/8
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3086, val_error: 0.5000, auc: 0.7083
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.335343 --> 1.308570).  Saving model ...


batch 19, loss: 0.7532, instance_loss: 0.5601, weighted_loss: 0.6953, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 14, train_loss: 1.2322, train_clustering_loss:  0.6016, train_error: 0.5000
class 0: acc 0.3, correct 3/10
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.0, correct 0/8
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3059, val_error: 0.6250, auc: 0.7292
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.308570 --> 1.305871).  Saving model ...


batch 19, loss: 0.9908, instance_loss: 0.5837, weighted_loss: 0.8687, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 15, train_loss: 1.2514, train_clustering_loss:  0.6050, train_error: 0.5000
class 0: acc 0.1111111111111111, correct 1/9
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.2916, val_error: 0.5000, auc: 0.7292
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.5, correct 1/2
Validation loss decreased (1.305871 --> 1.291629).  Saving model ...


batch 19, loss: 1.4244, instance_loss: 0.5983, weighted_loss: 1.1766, label: 3, bag_size: 25448


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 16, train_loss: 1.1385, train_clustering_loss:  0.5991, train_error: 0.5000
class 0: acc 0.6923076923076923, correct 9/13
class 1: acc 0.8, correct 4/5
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.09090909090909091, correct 1/11

Val Set, val_loss: 1.3591, val_error: 0.5000, auc: 0.7500
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.6754, instance_loss: 0.5223, weighted_loss: 0.6295, label: 3, bag_size: 196107


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 17, train_loss: 1.1833, train_clustering_loss:  0.5844, train_error: 0.5263
class 0: acc 0.25, correct 2/8
class 1: acc 0.0, correct 0/7
class 2: acc 0.3, correct 3/10
class 3: acc 1.0, correct 13/13

Val Set, val_loss: 1.2937, val_error: 0.6250, auc: 0.7500
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.8208, instance_loss: 0.5602, weighted_loss: 0.7426, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 18, train_loss: 1.1018, train_clustering_loss:  0.5836, train_error: 0.2895
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 1.0, correct 10/10
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.2906, val_error: 0.6250, auc: 0.7708
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.291629 --> 1.290586).  Saving model ...


batch 19, loss: 0.8785, instance_loss: 0.5023, weighted_loss: 0.7657, label: 3, bag_size: 113328


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 19, train_loss: 1.0881, train_clustering_loss:  0.5777, train_error: 0.3158
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7, correct 7/10
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.4229, val_error: 0.6250, auc: 0.6667
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4261, instance_loss: 0.4900, weighted_loss: 0.4453, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 20, train_loss: 0.9924, train_clustering_loss:  0.5599, train_error: 0.4474
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 0.0, correct 0/5
class 2: acc 0.6666666666666666, correct 8/12
class 3: acc 0.3333333333333333, correct 2/6

Val Set, val_loss: 1.2949, val_error: 0.6250, auc: 0.7708
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.6920, instance_loss: 0.5183, weighted_loss: 0.6399, label: 3, bag_size: 231301


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 21, train_loss: 1.0882, train_clustering_loss:  0.5789, train_error: 0.4737
class 0: acc 0.5, correct 3/6
class 1: acc 0.4666666666666667, correct 7/15
class 2: acc 0.4, correct 2/5
class 3: acc 0.6666666666666666, correct 8/12

Val Set, val_loss: 1.2670, val_error: 0.5000, auc: 0.7500
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.290586 --> 1.267017).  Saving model ...


batch 19, loss: 1.1178, instance_loss: 0.5605, weighted_loss: 0.9506, label: 2, bag_size: 22130


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 22, train_loss: 1.0958, train_clustering_loss:  0.5688, train_error: 0.5526
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.6, correct 6/10
class 2: acc 0.3333333333333333, correct 4/12
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.2878, val_error: 0.3750, auc: 0.7500
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.5757, instance_loss: 0.5075, weighted_loss: 0.5552, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 23, train_loss: 1.0414, train_clustering_loss:  0.5624, train_error: 0.3684
class 0: acc 0.5, correct 4/8
class 1: acc 1.0, correct 13/13
class 2: acc 0.7, correct 7/10
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.2543, val_error: 0.7500, auc: 0.6667
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
Validation loss decreased (1.267017 --> 1.254341).  Saving model ...


batch 19, loss: 1.3346, instance_loss: 0.5988, weighted_loss: 1.1139, label: 1, bag_size: 66789


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 24, train_loss: 0.8091, train_clustering_loss:  0.5289, train_error: 0.2105
class 0: acc 0.75, correct 6/8
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.3531, val_error: 0.6250, auc: 0.7500
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 2.1299, instance_loss: 0.6662, weighted_loss: 1.6908, label: 2, bag_size: 393657


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 25, train_loss: 0.8902, train_clustering_loss:  0.5385, train_error: 0.2632
class 0: acc 0.7692307692307693, correct 10/13
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.6666666666666666, correct 4/6
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.3657, val_error: 0.6250, auc: 0.5833
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.3115, instance_loss: 0.6151, weighted_loss: 1.1026, label: 1, bag_size: 64834


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 26, train_loss: 0.7816, train_clustering_loss:  0.5156, train_error: 0.2105
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.75, correct 9/12
class 2: acc 0.7142857142857143, correct 5/7
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.3416, val_error: 0.6250, auc: 0.5833
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.3462, instance_loss: 0.3800, weighted_loss: 0.3564, label: 0, bag_size: 453871


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 27, train_loss: 0.7949, train_clustering_loss:  0.5118, train_error: 0.2368
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.75, correct 6/8
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.5150, val_error: 0.6250, auc: 0.7708
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.8660, instance_loss: 0.5254, weighted_loss: 0.7638, label: 0, bag_size: 10671


class 0 clustering acc 0.9991776315789473: correct 1215/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 28, train_loss: 0.7953, train_clustering_loss:  0.5127, train_error: 0.2632
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.42857142857142855, correct 3/7
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.2969, val_error: 0.5000, auc: 0.7500
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.9100, instance_loss: 0.5208, weighted_loss: 0.7932, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.03618421052631579: correct 11/304
Epoch: 29, train_loss: 0.6622, train_clustering_loss:  0.4719, train_error: 0.1316
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.8333333333333334, correct 5/6
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.3224, val_error: 0.7500, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.1483, instance_loss: 0.6919, weighted_loss: 1.0114, label: 2, bag_size: 176020


class 0 clustering acc 0.9950657894736842: correct 1210/1216
class 1 clustering acc 0.0625: correct 19/304
Epoch: 30, train_loss: 0.6380, train_clustering_loss:  0.4878, train_error: 0.1053
class 0: acc 1.0, correct 7/7
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.6666666666666666, correct 4/6
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.4134, val_error: 0.5000, auc: 0.7500
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.4242, instance_loss: 0.3828, weighted_loss: 0.4118, label: 3, bag_size: 25448


class 0 clustering acc 0.9991776315789473: correct 1215/1216
class 1 clustering acc 0.003289473684210526: correct 1/304
Epoch: 31, train_loss: 0.7290, train_clustering_loss:  0.4816, train_error: 0.2895
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.8, correct 4/5
class 2: acc 0.5, correct 6/12
class 3: acc 1.0, correct 15/15

Val Set, val_loss: 1.6629, val_error: 0.6250, auc: 0.6667
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.9762, instance_loss: 0.5837, weighted_loss: 0.8585, label: 1, bag_size: 23122


class 0 clustering acc 0.9975328947368421: correct 1213/1216
class 1 clustering acc 0.006578947368421052: correct 2/304
Epoch: 32, train_loss: 0.7795, train_clustering_loss:  0.4978, train_error: 0.2895
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.8, correct 8/10
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.5502, val_error: 0.6250, auc: 0.6667
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.2592, instance_loss: 0.3605, weighted_loss: 0.2896, label: 2, bag_size: 158432


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.03289473684210526: correct 10/304
Epoch: 33, train_loss: 0.5563, train_clustering_loss:  0.4366, train_error: 0.1316
class 0: acc 0.625, correct 5/8
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.4534, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.5991, instance_loss: 0.3941, weighted_loss: 0.5376, label: 3, bag_size: 240896


class 0 clustering acc 0.9983552631578947: correct 1214/1216
class 1 clustering acc 0.0625: correct 19/304
Epoch: 34, train_loss: 0.6522, train_clustering_loss:  0.4564, train_error: 0.2895
class 0: acc 0.6, correct 6/10
class 1: acc 0.375, correct 3/8
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.7685, val_error: 0.6250, auc: 0.7500
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.09375: correct 6/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 11 out of 20


batch 19, loss: 1.2917, instance_loss: 0.5745, weighted_loss: 1.0766, label: 2, bag_size: 17501


class 0 clustering acc 0.9991776315789473: correct 1215/1216
class 1 clustering acc 0.125: correct 38/304
Epoch: 35, train_loss: 0.6900, train_clustering_loss:  0.4490, train_error: 0.2105
class 0: acc 0.625, correct 5/8
class 1: acc 0.6, correct 6/10
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.3545, val_error: 0.5000, auc: 0.6875
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.03125: correct 2/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.1240, instance_loss: 0.2314, weighted_loss: 0.1562, label: 0, bag_size: 453871


class 0 clustering acc 0.9851973684210527: correct 1198/1216
class 1 clustering acc 0.22039473684210525: correct 67/304
Epoch: 36, train_loss: 0.5283, train_clustering_loss:  0.4068, train_error: 0.1579
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.625, correct 5/8
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.5334, val_error: 0.6250, auc: 0.6667
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0625: correct 4/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.4304, instance_loss: 0.3006, weighted_loss: 0.3915, label: 0, bag_size: 59350


class 0 clustering acc 0.9991776315789473: correct 1215/1216
class 1 clustering acc 0.15789473684210525: correct 48/304
Epoch: 37, train_loss: 0.5829, train_clustering_loss:  0.4290, train_error: 0.1579
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.5298, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.046875: correct 3/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.1547, instance_loss: 0.3529, weighted_loss: 0.2141, label: 0, bag_size: 18551


class 0 clustering acc 0.9950657894736842: correct 1210/1216
class 1 clustering acc 0.1875: correct 57/304
Epoch: 38, train_loss: 0.6352, train_clustering_loss:  0.4340, train_error: 0.2105
class 0: acc 1.0, correct 12/12
class 1: acc 0.16666666666666666, correct 1/6
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.6199, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.125: correct 8/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.4514, instance_loss: 0.4852, weighted_loss: 1.1615, label: 0, bag_size: 13999


class 0 clustering acc 0.9876644736842105: correct 1201/1216
class 1 clustering acc 0.12828947368421054: correct 39/304
Epoch: 39, train_loss: 0.6386, train_clustering_loss:  0.4608, train_error: 0.2632
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.75, correct 12/16
class 2: acc 0.75, correct 6/8
class 3: acc 0.8, correct 4/5

Val Set, val_loss: 1.4354, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.125: correct 8/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1518, instance_loss: 0.2590, weighted_loss: 0.1839, label: 3, bag_size: 231301


class 0 clustering acc 0.9983552631578947: correct 1214/1216
class 1 clustering acc 0.10855263157894737: correct 33/304
Epoch: 40, train_loss: 0.6040, train_clustering_loss:  0.4330, train_error: 0.2368
class 0: acc 0.875, correct 7/8
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.625, correct 5/8
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.6707, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.078125: correct 5/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.1489, instance_loss: 0.3338, weighted_loss: 0.2044, label: 1, bag_size: 47433


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.21052631578947367: correct 64/304
Epoch: 41, train_loss: 0.4319, train_clustering_loss:  0.3838, train_error: 0.1316
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.8333333333333334, correct 5/6
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.7312, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 0.99609375: correct 255/256
class 1 clustering acc 0.09375: correct 6/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.4400, instance_loss: 0.4356, weighted_loss: 0.4387, label: 2, bag_size: 103108


class 0 clustering acc 0.9958881578947368: correct 1211/1216
class 1 clustering acc 0.08881578947368421: correct 27/304
Epoch: 42, train_loss: 0.5305, train_clustering_loss:  0.4376, train_error: 0.0789
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 1.0, correct 6/6
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.5684, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 0.99609375: correct 255/256
class 1 clustering acc 0.109375: correct 7/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0848, instance_loss: 0.1789, weighted_loss: 0.1130, label: 2, bag_size: 158432


class 0 clustering acc 0.9950657894736842: correct 1210/1216
class 1 clustering acc 0.20394736842105263: correct 62/304
Epoch: 43, train_loss: 0.4625, train_clustering_loss:  0.3939, train_error: 0.1842
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.7, correct 7/10
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.8589, val_error: 0.6250, auc: 0.6875
class 0 clustering acc 0.97265625: correct 249/256
class 1 clustering acc 0.171875: correct 11/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.5119, instance_loss: 0.4734, weighted_loss: 0.5004, label: 0, bag_size: 222326


class 0 clustering acc 0.9983552631578947: correct 1214/1216
class 1 clustering acc 0.28618421052631576: correct 87/304
Epoch: 44, train_loss: 0.3835, train_clustering_loss:  0.3608, train_error: 0.0526
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.6231, val_error: 0.6250, auc: 0.6875
class 0 clustering acc 0.99609375: correct 255/256
class 1 clustering acc 0.125: correct 8/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.0963, instance_loss: 0.2929, weighted_loss: 0.1553, label: 2, bag_size: 393657


class 0 clustering acc 0.993421052631579: correct 1208/1216
class 1 clustering acc 0.19078947368421054: correct 58/304
Epoch: 45, train_loss: 0.5252, train_clustering_loss:  0.4159, train_error: 0.1579
class 0: acc 1.0, correct 6/6
class 1: acc 0.7, correct 7/10
class 2: acc 0.8571428571428571, correct 12/14
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.7759, val_error: 0.6250, auc: 0.6042
class 0 clustering acc 0.984375: correct 252/256
class 1 clustering acc 0.0625: correct 4/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.5844, instance_loss: 0.4094, weighted_loss: 0.5319, label: 2, bag_size: 17501


class 0 clustering acc 0.993421052631579: correct 1208/1216
class 1 clustering acc 0.14802631578947367: correct 45/304
Epoch: 46, train_loss: 0.4608, train_clustering_loss:  0.4001, train_error: 0.1053
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.9, correct 9/10
class 2: acc 1.0, correct 11/11
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.7863, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 0.984375: correct 252/256
class 1 clustering acc 0.109375: correct 7/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.5310, instance_loss: 0.5758, weighted_loss: 0.5445, label: 1, bag_size: 132271


class 0 clustering acc 0.9958881578947368: correct 1211/1216
class 1 clustering acc 0.22039473684210525: correct 67/304
Epoch: 47, train_loss: 0.3745, train_clustering_loss:  0.3657, train_error: 0.0263
class 0: acc 1.0, correct 6/6
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 1.0, correct 7/7
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.9931, val_error: 0.5000, auc: 0.6250
class 0 clustering acc 0.94921875: correct 243/256
class 1 clustering acc 0.203125: correct 13/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.1069, instance_loss: 0.1800, weighted_loss: 0.1289, label: 3, bag_size: 56291


class 0 clustering acc 0.990953947368421: correct 1205/1216
class 1 clustering acc 0.3355263157894737: correct 102/304
Epoch: 48, train_loss: 0.3479, train_clustering_loss:  0.3470, train_error: 0.0526
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.9234, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 0.9609375: correct 246/256
class 1 clustering acc 0.171875: correct 11/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.1470, instance_loss: 0.1943, weighted_loss: 0.1612, label: 2, bag_size: 23349


class 0 clustering acc 0.993421052631579: correct 1208/1216
class 1 clustering acc 0.2532894736842105: correct 77/304
Epoch: 49, train_loss: 0.3782, train_clustering_loss:  0.3630, train_error: 0.1053
class 0: acc 0.625, correct 5/8
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.8769, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 0.97265625: correct 249/256
class 1 clustering acc 0.15625: correct 10/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.6315, instance_loss: 0.4290, weighted_loss: 0.5707, label: 2, bag_size: 17501


class 0 clustering acc 0.9967105263157895: correct 1212/1216
class 1 clustering acc 0.28618421052631576: correct 87/304
Epoch: 50, train_loss: 0.3823, train_clustering_loss:  0.3572, train_error: 0.1053
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7, correct 7/10
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.9951, val_error: 0.6250, auc: 0.6667
class 0 clustering acc 0.9453125: correct 242/256
class 1 clustering acc 0.171875: correct 11/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.4645, instance_loss: 0.4212, weighted_loss: 0.4515, label: 2, bag_size: 103108


class 0 clustering acc 0.990953947368421: correct 1205/1216
class 1 clustering acc 0.24342105263157895: correct 74/304
Epoch: 51, train_loss: 0.4264, train_clustering_loss:  0.3663, train_error: 0.1316
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8, correct 8/10
class 2: acc 1.0, correct 11/11
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.8947, val_error: 0.6250, auc: 0.6042
class 0 clustering acc 0.97265625: correct 249/256
class 1 clustering acc 0.125: correct 8/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 28 out of 20
Early stopping
Val error: 0.7500, ROC AUC: 0.6667
Test error: 0.6250, ROC AUC: 0.7500
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2

Training Fold 1!

Init train/val/test splits... 
Done!
Training on 38 samples
Validating on 8 samples
Testing on 8 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.4505, instance_loss: 1.1203, weighted_loss: 1.3515, label: 0, bag_size: 10671


class 0 clustering acc 0.9416118421052632: correct 1145/1216
class 1 clustering acc 0.039473684210526314: correct 12/304
Epoch: 0, train_loss: 1.4172, train_clustering_loss:  1.1119, train_error: 0.7895
class 0: acc 0.08333333333333333, correct 1/12
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.0, correct 0/9
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3919, val_error: 0.7500, auc: 0.5000
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (inf --> 1.391907).  Saving model ...


batch 19, loss: 1.5508, instance_loss: 0.7768, weighted_loss: 1.3186, label: 2, bag_size: 278757


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 1, train_loss: 1.3349, train_clustering_loss:  0.7721, train_error: 0.6316
class 0: acc 1.0, correct 14/14
class 1: acc 0.0, correct 0/5
class 2: acc 0.0, correct 0/8
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.4349, val_error: 0.7500, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.9775, instance_loss: 0.7211, weighted_loss: 1.6006, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 2, train_loss: 1.3722, train_clustering_loss:  0.6380, train_error: 0.7632
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.0, correct 0/5
class 2: acc 0.0, correct 0/12
class 3: acc 0.5, correct 6/12

Val Set, val_loss: 1.4389, val_error: 0.7500, auc: 0.5000
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.3663, instance_loss: 0.6254, weighted_loss: 1.1440, label: 0, bag_size: 108548


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 3, train_loss: 1.3985, train_clustering_loss:  0.6268, train_error: 0.7105
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/8
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4235, val_error: 0.6250, auc: 0.5208
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.6634, instance_loss: 0.6078, weighted_loss: 1.3467, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 4, train_loss: 1.3572, train_clustering_loss:  0.6193, train_error: 0.6842
class 0: acc 0.5384615384615384, correct 7/13
class 1: acc 0.0, correct 0/9
class 2: acc 0.5555555555555556, correct 5/9
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.4121, val_error: 0.7500, auc: 0.5625
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.4706, instance_loss: 0.6171, weighted_loss: 1.2145, label: 3, bag_size: 262536


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 5, train_loss: 1.4075, train_clustering_loss:  0.6224, train_error: 0.7895
class 0: acc 0.0, correct 0/7
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.0, correct 0/9
class 3: acc 0.1, correct 1/10

Val Set, val_loss: 1.4053, val_error: 0.7500, auc: 0.4792
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.4425, instance_loss: 0.6355, weighted_loss: 1.2004, label: 2, bag_size: 163352


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 6, train_loss: 1.3673, train_clustering_loss:  0.6241, train_error: 0.7368
class 0: acc 0.0, correct 0/8
class 1: acc 0.0, correct 0/10
class 2: acc 0.0, correct 0/9
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.3926, val_error: 0.7500, auc: 0.5833
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.3536, instance_loss: 0.6154, weighted_loss: 1.1321, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 7, train_loss: 1.3079, train_clustering_loss:  0.6162, train_error: 0.6579
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.0, correct 0/5
class 3: acc 0.125, correct 1/8

Val Set, val_loss: 1.4199, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.5713, instance_loss: 0.6196, weighted_loss: 1.2858, label: 0, bag_size: 222491


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 8, train_loss: 1.3318, train_clustering_loss:  0.6254, train_error: 0.6316
class 0: acc 0.25, correct 2/8
class 1: acc 0.5, correct 5/10
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.3890, val_error: 0.8750, auc: 0.5833
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.391907 --> 1.388971).  Saving model ...


batch 19, loss: 1.4607, instance_loss: 0.5769, weighted_loss: 1.1956, label: 3, bag_size: 48489


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 9, train_loss: 1.3317, train_clustering_loss:  0.6186, train_error: 0.5526
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.2, correct 2/10
class 2: acc 1.0, correct 11/11
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.4009, val_error: 0.7500, auc: 0.5625
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8885, instance_loss: 0.5914, weighted_loss: 0.7994, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 10, train_loss: 1.3055, train_clustering_loss:  0.6176, train_error: 0.5789
class 0: acc 0.0, correct 0/7
class 1: acc 1.0, correct 13/13
class 2: acc 0.25, correct 2/8
class 3: acc 0.1, correct 1/10

Val Set, val_loss: 1.4179, val_error: 0.5000, auc: 0.5833
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.0014, instance_loss: 0.5870, weighted_loss: 0.8770, label: 1, bag_size: 58270


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 11, train_loss: 1.1941, train_clustering_loss:  0.6049, train_error: 0.4211
class 0: acc 0.0, correct 0/3
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 0.1111111111111111, correct 1/9
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.4696, val_error: 0.7500, auc: 0.5417
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.9807, instance_loss: 0.5979, weighted_loss: 0.8658, label: 2, bag_size: 149988


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 12, train_loss: 1.3246, train_clustering_loss:  0.6293, train_error: 0.6053
class 0: acc 0.0, correct 0/12
class 1: acc 0.6666666666666666, correct 4/6
class 2: acc 0.6, correct 6/10
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.4027, val_error: 0.8750, auc: 0.5625
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.7671, instance_loss: 0.6385, weighted_loss: 1.4285, label: 1, bag_size: 57038


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 13, train_loss: 1.1996, train_clustering_loss:  0.6039, train_error: 0.4737
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.125, correct 1/8
class 2: acc 0.7, correct 7/10
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.4172, val_error: 0.8750, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.8718, instance_loss: 0.6122, weighted_loss: 0.7939, label: 2, bag_size: 149988


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 14, train_loss: 1.1651, train_clustering_loss:  0.5941, train_error: 0.4474
class 0: acc 0.0, correct 0/5
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.2, correct 2/10

Val Set, val_loss: 1.5238, val_error: 0.8750, auc: 0.4167
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 6 out of 20


batch 19, loss: 1.4385, instance_loss: 0.5825, weighted_loss: 1.1817, label: 1, bag_size: 66789


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 15, train_loss: 1.1247, train_clustering_loss:  0.5920, train_error: 0.3684
class 0: acc 0.0, correct 0/5
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.75, correct 9/12
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.4906, val_error: 0.7500, auc: 0.5417
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.5032, instance_loss: 0.7219, weighted_loss: 1.2688, label: 0, bag_size: 108548


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 16, train_loss: 1.0967, train_clustering_loss:  0.6000, train_error: 0.4474
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.8, correct 8/10
class 2: acc 0.5, correct 3/6
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.4932, val_error: 0.7500, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 8 out of 20


batch 19, loss: 1.2795, instance_loss: 0.6178, weighted_loss: 1.0810, label: 0, bag_size: 222491


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 17, train_loss: 1.0676, train_clustering_loss:  0.5794, train_error: 0.3947
class 0: acc 0.6, correct 6/10
class 1: acc 0.14285714285714285, correct 1/7
class 2: acc 0.875, correct 7/8
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.4847, val_error: 0.6250, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 9 out of 20


batch 19, loss: 1.3792, instance_loss: 0.5932, weighted_loss: 1.1434, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 18, train_loss: 0.9891, train_clustering_loss:  0.5745, train_error: 0.3158
class 0: acc 0.45454545454545453, correct 5/11
class 1: acc 0.8, correct 4/5
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.5329, val_error: 0.8750, auc: 0.5208
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.6681, instance_loss: 0.5678, weighted_loss: 0.6380, label: 2, bag_size: 163352


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 19, train_loss: 0.9268, train_clustering_loss:  0.5673, train_error: 0.2632
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.5, correct 4/8
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.5, correct 4/8

Val Set, val_loss: 1.5586, val_error: 0.8750, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.6486, instance_loss: 0.5778, weighted_loss: 0.6274, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 20, train_loss: 0.9130, train_clustering_loss:  0.5616, train_error: 0.3158
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.875, correct 7/8
class 3: acc 0.5, correct 5/10

Val Set, val_loss: 1.5624, val_error: 0.7500, auc: 0.5625
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.7384, instance_loss: 0.6807, weighted_loss: 1.4211, label: 1, bag_size: 445537


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 21, train_loss: 0.9408, train_clustering_loss:  0.5618, train_error: 0.3947
class 0: acc 0.5, correct 2/4
class 1: acc 0.5625, correct 9/16
class 2: acc 0.3333333333333333, correct 2/6
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.6971, val_error: 0.7500, auc: 0.5625
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.6829, instance_loss: 0.4347, weighted_loss: 0.6085, label: 3, bag_size: 196107


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 22, train_loss: 1.0278, train_clustering_loss:  0.5548, train_error: 0.4474
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.625, correct 5/8
class 2: acc 0.5, correct 4/8
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.5925, val_error: 0.8750, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 14 out of 20


batch 19, loss: 1.1798, instance_loss: 0.6063, weighted_loss: 1.0077, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 23, train_loss: 0.8508, train_clustering_loss:  0.5405, train_error: 0.2632
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 1.0, correct 11/11
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.6833, val_error: 0.7500, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.5525, instance_loss: 0.6082, weighted_loss: 1.2692, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 24, train_loss: 0.8171, train_clustering_loss:  0.5365, train_error: 0.2632
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 1.0, correct 13/13
class 2: acc 0.75, correct 6/8
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.5838, val_error: 0.6250, auc: 0.5417
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.5942, instance_loss: 0.5454, weighted_loss: 0.5796, label: 2, bag_size: 393657


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 25, train_loss: 0.7982, train_clustering_loss:  0.5261, train_error: 0.2368
class 0: acc 0.25, correct 2/8
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 1.0, correct 17/17
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.8010, val_error: 0.8750, auc: 0.5000
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.2951, instance_loss: 0.4321, weighted_loss: 0.3362, label: 2, bag_size: 209612


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 26, train_loss: 0.8124, train_clustering_loss:  0.5173, train_error: 0.3684
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 1.0, correct 13/13
class 3: acc 0.42857142857142855, correct 3/7

Val Set, val_loss: 1.6510, val_error: 0.7500, auc: 0.5000
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.9982, instance_loss: 0.6076, weighted_loss: 0.8810, label: 0, bag_size: 222326


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.006578947368421052: correct 2/304
Epoch: 27, train_loss: 0.6076, train_clustering_loss:  0.4829, train_error: 0.1579
class 0: acc 0.8, correct 8/10
class 1: acc 0.8333333333333334, correct 5/6
class 2: acc 1.0, correct 11/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.6895, val_error: 0.7500, auc: 0.4583
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2342, instance_loss: 0.3727, weighted_loss: 0.2757, label: 1, bag_size: 69073


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.02631578947368421: correct 8/304
Epoch: 28, train_loss: 0.8096, train_clustering_loss:  0.4994, train_error: 0.2632
class 0: acc 0.2857142857142857, correct 2/7
class 1: acc 0.8235294117647058, correct 14/17
class 2: acc 1.0, correct 4/4
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.6814, val_error: 0.5000, auc: 0.5625
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.2541, instance_loss: 0.3420, weighted_loss: 0.2805, label: 1, bag_size: 69073


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.02631578947368421: correct 8/304
Epoch: 29, train_loss: 0.6504, train_clustering_loss:  0.4824, train_error: 0.2105
class 0: acc 0.5, correct 6/12
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.7315, val_error: 0.7500, auc: 0.5000
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 21 out of 20


batch 19, loss: 2.7749, instance_loss: 0.8532, weighted_loss: 2.1984, label: 3, bag_size: 28883


class 0 clustering acc 0.9991776315789473: correct 1215/1216
class 1 clustering acc 0.006578947368421052: correct 2/304
Epoch: 30, train_loss: 0.6707, train_clustering_loss:  0.4424, train_error: 0.1842
class 0: acc 0.4, correct 2/5
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 1.0, correct 14/14
class 3: acc 0.6, correct 3/5

Val Set, val_loss: 2.1129, val_error: 0.7500, auc: 0.5208
class 0 clustering acc 0.984375: correct 252/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.8593, instance_loss: 0.6037, weighted_loss: 0.7826, label: 0, bag_size: 108548


class 0 clustering acc 0.9991776315789473: correct 1215/1216
class 1 clustering acc 0.10526315789473684: correct 32/304
Epoch: 31, train_loss: 0.5902, train_clustering_loss:  0.4545, train_error: 0.2105
class 0: acc 0.75, correct 9/12
class 1: acc 1.0, correct 1/1
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.6951, val_error: 0.8750, auc: 0.5000
class 0 clustering acc 0.984375: correct 252/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 23 out of 20


batch 19, loss: 1.6334, instance_loss: 0.6794, weighted_loss: 1.3472, label: 1, bag_size: 64834


class 0 clustering acc 0.9983552631578947: correct 1214/1216
class 1 clustering acc 0.08552631578947369: correct 26/304
Epoch: 32, train_loss: 0.7379, train_clustering_loss:  0.4806, train_error: 0.2895
class 0: acc 0.5, correct 5/10
class 1: acc 0.3333333333333333, correct 2/6
class 2: acc 1.0, correct 9/9
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.8973, val_error: 0.6250, auc: 0.5625
class 0 clustering acc 0.9921875: correct 254/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.1262, instance_loss: 0.3717, weighted_loss: 0.1998, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.029605263157894735: correct 9/304
Epoch: 33, train_loss: 0.7611, train_clustering_loss:  0.5018, train_error: 0.3158
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 1.0, correct 5/5
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.6441, val_error: 0.6250, auc: 0.5417
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 25 out of 20


batch 19, loss: 1.0455, instance_loss: 0.5803, weighted_loss: 0.9059, label: 1, bag_size: 445537


class 0 clustering acc 0.9967105263157895: correct 1212/1216
class 1 clustering acc 0.08881578947368421: correct 27/304
Epoch: 34, train_loss: 0.6555, train_clustering_loss:  0.4638, train_error: 0.1842
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.6666666666666666, correct 4/6
class 2: acc 1.0, correct 7/7
class 3: acc 0.75, correct 9/12

Val Set, val_loss: 1.6909, val_error: 0.7500, auc: 0.5833
class 0 clustering acc 0.99609375: correct 255/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.7848, instance_loss: 0.5963, weighted_loss: 0.7283, label: 3, bag_size: 262536


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.1611842105263158: correct 49/304
Epoch: 35, train_loss: 0.4849, train_clustering_loss:  0.4087, train_error: 0.1316
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.8, correct 8/10
class 2: acc 1.0, correct 14/14
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.7306, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 0.97265625: correct 249/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.4921, instance_loss: 0.4861, weighted_loss: 0.4903, label: 0, bag_size: 222326


class 0 clustering acc 0.9975328947368421: correct 1213/1216
class 1 clustering acc 0.13815789473684212: correct 42/304
Epoch: 36, train_loss: 0.5696, train_clustering_loss:  0.4488, train_error: 0.1842
class 0: acc 0.9333333333333333, correct 14/15
class 1: acc 0.5, correct 3/6
class 2: acc 1.0, correct 7/7
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.7150, val_error: 0.6250, auc: 0.5833
class 0 clustering acc 0.9765625: correct 250/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.8274, instance_loss: 0.5225, weighted_loss: 0.7359, label: 0, bag_size: 13999


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.019736842105263157: correct 6/304
Epoch: 37, train_loss: 0.6129, train_clustering_loss:  0.4597, train_error: 0.2368
class 0: acc 0.6666666666666666, correct 12/18
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.8333333333333334, correct 5/6
class 3: acc 0.6666666666666666, correct 2/3

Val Set, val_loss: 1.9245, val_error: 0.6250, auc: 0.5833
class 0 clustering acc 0.96875: correct 248/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.2383, instance_loss: 0.3377, weighted_loss: 0.2681, label: 1, bag_size: 16373


class 0 clustering acc 0.9958881578947368: correct 1211/1216
class 1 clustering acc 0.14802631578947367: correct 45/304
Epoch: 38, train_loss: 0.4986, train_clustering_loss:  0.4188, train_error: 0.1316
class 0: acc 1.0, correct 8/8
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 1.0, correct 13/13
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 1.9886, val_error: 0.8750, auc: 0.6042
class 0 clustering acc 0.96875: correct 248/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.8674, instance_loss: 0.5864, weighted_loss: 0.7831, label: 0, bag_size: 13999


class 0 clustering acc 0.9967105263157895: correct 1212/1216
class 1 clustering acc 0.14144736842105263: correct 43/304
Epoch: 39, train_loss: 0.6676, train_clustering_loss:  0.4366, train_error: 0.3421
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.8571428571428571, correct 12/14
class 2: acc 1.0, correct 2/2
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.7839, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 0.9609375: correct 246/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.3826, instance_loss: 0.3457, weighted_loss: 0.3715, label: 1, bag_size: 445537


class 0 clustering acc 0.9958881578947368: correct 1211/1216
class 1 clustering acc 0.29276315789473684: correct 89/304
Epoch: 40, train_loss: 0.5246, train_clustering_loss:  0.3937, train_error: 0.2105
class 0: acc 0.75, correct 9/12
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.6666666666666666, correct 2/3
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.9938, val_error: 0.6250, auc: 0.5000
class 0 clustering acc 0.94921875: correct 243/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.6690, instance_loss: 0.3962, weighted_loss: 0.5871, label: 1, bag_size: 57038


class 0 clustering acc 0.9958881578947368: correct 1211/1216
class 1 clustering acc 0.10855263157894737: correct 33/304
Epoch: 41, train_loss: 0.5110, train_clustering_loss:  0.4328, train_error: 0.1053
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 1.0, correct 5/5
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.9402, val_error: 0.8750, auc: 0.5208
class 0 clustering acc 0.9765625: correct 250/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.5111, instance_loss: 0.2737, weighted_loss: 0.4398, label: 2, bag_size: 176020


class 0 clustering acc 0.9983552631578947: correct 1214/1216
class 1 clustering acc 0.35526315789473684: correct 108/304
Epoch: 42, train_loss: 0.4243, train_clustering_loss:  0.3495, train_error: 0.1579
class 0: acc 0.8, correct 4/5
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 1.0, correct 13/13
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 2.0479, val_error: 0.7500, auc: 0.5833
class 0 clustering acc 0.94140625: correct 241/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 34 out of 20


batch 19, loss: 1.8042, instance_loss: 0.6891, weighted_loss: 1.4697, label: 0, bag_size: 54249


class 0 clustering acc 0.990953947368421: correct 1205/1216
class 1 clustering acc 0.23355263157894737: correct 71/304
Epoch: 43, train_loss: 0.5395, train_clustering_loss:  0.4147, train_error: 0.1579
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 1.0, correct 8/8
class 2: acc 1.0, correct 8/8
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.8341, val_error: 0.6250, auc: 0.5833
class 0 clustering acc 0.953125: correct 244/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.4047, instance_loss: 0.3135, weighted_loss: 0.3774, label: 2, bag_size: 525276


class 0 clustering acc 0.9925986842105263: correct 1207/1216
class 1 clustering acc 0.34210526315789475: correct 104/304
Epoch: 44, train_loss: 0.4269, train_clustering_loss:  0.3649, train_error: 0.0789
class 0: acc 0.8, correct 4/5
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 13/13
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 2.0811, val_error: 0.6250, auc: 0.5208
class 0 clustering acc 0.93359375: correct 239/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.5, correct 1/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.2228, instance_loss: 0.3884, weighted_loss: 0.2725, label: 2, bag_size: 393657


class 0 clustering acc 0.9901315789473685: correct 1204/1216
class 1 clustering acc 0.4769736842105263: correct 145/304
Epoch: 45, train_loss: 0.2904, train_clustering_loss:  0.3201, train_error: 0.0526
class 0: acc 1.0, correct 7/7
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 1.0, correct 13/13
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 2.1067, val_error: 0.6250, auc: 0.5417
class 0 clustering acc 0.9296875: correct 238/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.5, correct 1/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.4737, instance_loss: 0.5116, weighted_loss: 0.4851, label: 3, bag_size: 189694


class 0 clustering acc 0.9893092105263158: correct 1203/1216
class 1 clustering acc 0.48355263157894735: correct 147/304
Epoch: 46, train_loss: 0.4954, train_clustering_loss:  0.3446, train_error: 0.1842
class 0: acc 0.4, correct 2/5
class 1: acc 1.0, correct 12/12
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 2.0555, val_error: 0.6250, auc: 0.5208
class 0 clustering acc 0.921875: correct 236/256
class 1 clustering acc 0.0625: correct 4/64
class 0: acc 0.5, correct 1/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.6870, instance_loss: 0.3827, weighted_loss: 0.5957, label: 1, bag_size: 132271


class 0 clustering acc 0.977796052631579: correct 1189/1216
class 1 clustering acc 0.39144736842105265: correct 119/304
Epoch: 47, train_loss: 0.5325, train_clustering_loss:  0.4144, train_error: 0.1842
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.6666666666666666, correct 4/6
class 3: acc 0.8571428571428571, correct 12/14

Val Set, val_loss: 1.9234, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 0.9375: correct 240/256
class 1 clustering acc 0.046875: correct 3/64
class 0: acc 0.5, correct 1/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.0755, instance_loss: 0.1275, weighted_loss: 0.0911, label: 2, bag_size: 278757


class 0 clustering acc 0.9975328947368421: correct 1213/1216
class 1 clustering acc 0.40131578947368424: correct 122/304
Epoch: 48, train_loss: 0.3776, train_clustering_loss:  0.3298, train_error: 0.0789
class 0: acc 0.875, correct 7/8
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 2.1458, val_error: 0.6250, auc: 0.5833
class 0 clustering acc 0.9375: correct 240/256
class 1 clustering acc 0.03125: correct 2/64
class 0: acc 0.5, correct 1/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.1124, instance_loss: 0.5747, weighted_loss: 0.2511, label: 0, bag_size: 10671


class 0 clustering acc 0.9860197368421053: correct 1199/1216
class 1 clustering acc 0.3684210526315789: correct 112/304
Epoch: 49, train_loss: 0.3656, train_clustering_loss:  0.3479, train_error: 0.1053
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 1.0, correct 7/7
class 2: acc 1.0, correct 9/9
class 3: acc 0.8, correct 8/10

Val Set, val_loss: 1.9607, val_error: 0.7500, auc: 0.6250
class 0 clustering acc 0.94140625: correct 241/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.3999, instance_loss: 0.4695, weighted_loss: 0.4208, label: 3, bag_size: 262536


class 0 clustering acc 0.9925986842105263: correct 1207/1216
class 1 clustering acc 0.35855263157894735: correct 109/304
Epoch: 50, train_loss: 0.3316, train_clustering_loss:  0.3479, train_error: 0.0263
class 0: acc 0.875, correct 7/8
class 1: acc 1.0, correct 8/8
class 2: acc 1.0, correct 8/8
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.9384, val_error: 0.7500, auc: 0.5833
class 0 clustering acc 0.94140625: correct 241/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.2356, instance_loss: 0.2327, weighted_loss: 0.2348, label: 2, bag_size: 176020


class 0 clustering acc 0.9893092105263158: correct 1203/1216
class 1 clustering acc 0.4605263157894737: correct 140/304
Epoch: 51, train_loss: 0.3206, train_clustering_loss:  0.3171, train_error: 0.0789
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 5/5
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.9304, val_error: 0.7500, auc: 0.5833
class 0 clustering acc 0.9375: correct 240/256
class 1 clustering acc 0.03125: correct 2/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 43 out of 20
Early stopping
Val error: 0.8750, ROC AUC: 0.5833
Test error: 0.6250, ROC AUC: 0.7500
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.5, correct 1/2

Training Fold 2!

Init train/val/test splits... 
Done!
Training on 38 samples
Validating on 8 samples
Testing on 8 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7406, instance_loss: 1.1287, weighted_loss: 1.5570, label: 0, bag_size: 54249


class 0 clustering acc 0.9432565789473685: correct 1147/1216
class 1 clustering acc 0.06578947368421052: correct 20/304
Epoch: 0, train_loss: 1.3536, train_clustering_loss:  1.0725, train_error: 0.5526
class 0: acc 0.0, correct 0/7
class 1: acc 0.0, correct 0/6
class 2: acc 1.0, correct 17/17
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4796, val_error: 0.7500, auc: 0.3750
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (inf --> 1.479596).  Saving model ...


batch 19, loss: 1.1026, instance_loss: 0.7852, weighted_loss: 1.0074, label: 2, bag_size: 103108


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 1, train_loss: 1.4807, train_clustering_loss:  0.8073, train_error: 0.7368
class 0: acc 0.0, correct 0/9
class 1: acc 0.0, correct 0/11
class 2: acc 1.0, correct 10/10
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.4061, val_error: 0.7500, auc: 0.4375
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.479596 --> 1.406093).  Saving model ...


batch 19, loss: 1.6028, instance_loss: 0.7013, weighted_loss: 1.3324, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 2, train_loss: 1.4788, train_clustering_loss:  0.6930, train_error: 0.8158
class 0: acc 0.0, correct 0/7
class 1: acc 0.07692307692307693, correct 1/13
class 2: acc 0.75, correct 6/8
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3916, val_error: 0.7500, auc: 0.5833
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.406093 --> 1.391630).  Saving model ...


batch 19, loss: 1.4617, instance_loss: 0.6858, weighted_loss: 1.2289, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 3, train_loss: 1.3716, train_clustering_loss:  0.6604, train_error: 0.7105
class 0: acc 0.0, correct 0/9
class 1: acc 0.4166666666666667, correct 5/12
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.0, correct 0/6

Val Set, val_loss: 1.3831, val_error: 0.7500, auc: 0.6875
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.391630 --> 1.383060).  Saving model ...


batch 19, loss: 1.3038, instance_loss: 0.6199, weighted_loss: 1.0986, label: 1, bag_size: 64834


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 4, train_loss: 1.3935, train_clustering_loss:  0.6159, train_error: 0.7632
class 0: acc 0.0, correct 0/9
class 1: acc 0.6, correct 3/5
class 2: acc 0.0, correct 0/11
class 3: acc 0.46153846153846156, correct 6/13

Val Set, val_loss: 1.3836, val_error: 0.7500, auc: 0.7500
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.5973, instance_loss: 0.6462, weighted_loss: 1.3120, label: 0, bag_size: 222491


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 5, train_loss: 1.3792, train_clustering_loss:  0.6122, train_error: 0.7368
class 0: acc 0.0, correct 0/9
class 1: acc 0.07692307692307693, correct 1/13
class 2: acc 0.8, correct 8/10
class 3: acc 0.16666666666666666, correct 1/6

Val Set, val_loss: 1.3728, val_error: 0.6250, auc: 0.7292
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.383060 --> 1.372758).  Saving model ...


batch 19, loss: 1.7716, instance_loss: 0.6260, weighted_loss: 1.4279, label: 3, bag_size: 99257


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 6, train_loss: 1.3521, train_clustering_loss:  0.6129, train_error: 0.6053
class 0: acc 0.0, correct 0/9
class 1: acc 1.0, correct 12/12
class 2: acc 0.3333333333333333, correct 3/9
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3772, val_error: 0.7500, auc: 0.7083
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.9043, instance_loss: 0.6390, weighted_loss: 0.8247, label: 0, bag_size: 13999


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 7, train_loss: 1.2898, train_clustering_loss:  0.6236, train_error: 0.5789
class 0: acc 0.7894736842105263, correct 15/19
class 1: acc 0.16666666666666666, correct 1/6
class 2: acc 0.0, correct 0/9
class 3: acc 0.0, correct 0/4

Val Set, val_loss: 1.4672, val_error: 0.7500, auc: 0.7292
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.7758, instance_loss: 0.6884, weighted_loss: 1.4496, label: 3, bag_size: 231301


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 8, train_loss: 1.4120, train_clustering_loss:  0.6185, train_error: 0.7368
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.1, correct 1/10
class 2: acc 0.375, correct 3/8
class 3: acc 0.0, correct 0/11

Val Set, val_loss: 1.3417, val_error: 0.8750, auc: 0.7500
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
Validation loss decreased (1.372758 --> 1.341653).  Saving model ...


batch 19, loss: 1.0441, instance_loss: 0.6334, weighted_loss: 0.9209, label: 3, bag_size: 25448


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 9, train_loss: 1.2842, train_clustering_loss:  0.6118, train_error: 0.5526
class 0: acc 0.25, correct 1/4
class 1: acc 0.0, correct 0/8
class 2: acc 0.0, correct 0/10
class 3: acc 1.0, correct 16/16

Val Set, val_loss: 1.3988, val_error: 0.7500, auc: 0.7917
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.4329, instance_loss: 0.6427, weighted_loss: 1.1958, label: 0, bag_size: 13999


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 10, train_loss: 1.3400, train_clustering_loss:  0.6102, train_error: 0.6316
class 0: acc 0.18181818181818182, correct 2/11
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 0.0, correct 0/8
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.3402, val_error: 0.7500, auc: 0.7500
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.341653 --> 1.340197).  Saving model ...


batch 19, loss: 1.1438, instance_loss: 0.5802, weighted_loss: 0.9748, label: 1, bag_size: 23122


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 11, train_loss: 1.3025, train_clustering_loss:  0.6066, train_error: 0.6053
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.1, correct 1/10
class 3: acc 0.2222222222222222, correct 2/9

Val Set, val_loss: 1.3350, val_error: 0.5000, auc: 0.7500
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
Validation loss decreased (1.340197 --> 1.335028).  Saving model ...


batch 19, loss: 1.1796, instance_loss: 0.6083, weighted_loss: 1.0082, label: 3, bag_size: 113328


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 12, train_loss: 1.2947, train_clustering_loss:  0.6084, train_error: 0.5789
class 0: acc 0.0, correct 0/9
class 1: acc 0.75, correct 6/8
class 2: acc 0.0, correct 0/9
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.3579, val_error: 0.7500, auc: 0.7292
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6463, instance_loss: 0.6091, weighted_loss: 1.3351, label: 1, bag_size: 66789


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 13, train_loss: 1.2151, train_clustering_loss:  0.5839, train_error: 0.4737
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 1.3843, val_error: 0.6250, auc: 0.7083
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1176, instance_loss: 0.5612, weighted_loss: 0.9507, label: 3, bag_size: 113328


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 14, train_loss: 1.2323, train_clustering_loss:  0.5893, train_error: 0.5789
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.7, correct 7/10
class 2: acc 0.18181818181818182, correct 2/11
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3323, val_error: 0.3750, auc: 0.7292
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.335028 --> 1.332344).  Saving model ...


batch 19, loss: 0.8243, instance_loss: 0.5404, weighted_loss: 0.7391, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 15, train_loss: 1.2149, train_clustering_loss:  0.5944, train_error: 0.5000
class 0: acc 0.1111111111111111, correct 1/9
class 1: acc 0.7, correct 7/10
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.3178, val_error: 0.6250, auc: 0.6667
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
Validation loss decreased (1.332344 --> 1.317754).  Saving model ...


batch 19, loss: 0.4794, instance_loss: 0.6533, weighted_loss: 0.5316, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 16, train_loss: 1.1483, train_clustering_loss:  0.5994, train_error: 0.4737
class 0: acc 0.9166666666666666, correct 11/12
class 1: acc 0.5, correct 3/6
class 2: acc 0.3333333333333333, correct 3/9
class 3: acc 0.2727272727272727, correct 3/11

Val Set, val_loss: 1.3770, val_error: 0.8750, auc: 0.6875
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.7757, instance_loss: 0.4951, weighted_loss: 0.6915, label: 3, bag_size: 240896


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 17, train_loss: 1.1489, train_clustering_loss:  0.5849, train_error: 0.4211
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.0, correct 0/6
class 2: acc 0.36363636363636365, correct 4/11
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.3740, val_error: 0.7500, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.7856, instance_loss: 0.6461, weighted_loss: 1.4437, label: 0, bag_size: 54249


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 18, train_loss: 1.0333, train_clustering_loss:  0.5693, train_error: 0.2895
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.2857142857142857, correct 2/7
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4161, val_error: 0.8750, auc: 0.5625
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.8772, instance_loss: 0.5462, weighted_loss: 0.7779, label: 3, bag_size: 99257


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 19, train_loss: 1.0275, train_clustering_loss:  0.5855, train_error: 0.4211
class 0: acc 0.6153846153846154, correct 8/13
class 1: acc 0.0, correct 0/7
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.5, correct 3/6

Val Set, val_loss: 1.3920, val_error: 0.7500, auc: 0.6875
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.2452, instance_loss: 0.4929, weighted_loss: 0.3195, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 20, train_loss: 0.8244, train_clustering_loss:  0.5378, train_error: 0.2632
class 0: acc 1.0, correct 12/12
class 1: acc 0.0, correct 0/6
class 2: acc 0.9166666666666666, correct 11/12
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.5579, val_error: 1.0000, auc: 0.5833
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.7650, instance_loss: 0.5183, weighted_loss: 0.6910, label: 2, bag_size: 17501


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 21, train_loss: 0.8022, train_clustering_loss:  0.5244, train_error: 0.2632
class 0: acc 1.0, correct 10/10
class 1: acc 0.3, correct 3/10
class 2: acc 1.0, correct 10/10
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.4182, val_error: 0.6250, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.3470, instance_loss: 0.4183, weighted_loss: 0.3684, label: 2, bag_size: 209612


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 22, train_loss: 0.7490, train_clustering_loss:  0.5082, train_error: 0.2895
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.5384615384615384, correct 7/13
class 2: acc 1.0, correct 10/10
class 3: acc 0.6666666666666666, correct 4/6

Val Set, val_loss: 1.3581, val_error: 0.5000, auc: 0.7083
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.9600, instance_loss: 0.6327, weighted_loss: 1.5618, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 23, train_loss: 0.8382, train_clustering_loss:  0.5075, train_error: 0.3421
class 0: acc 0.2857142857142857, correct 2/7
class 1: acc 0.8125, correct 13/16
class 2: acc 0.8, correct 8/10
class 3: acc 0.4, correct 2/5

Val Set, val_loss: 1.4317, val_error: 0.7500, auc: 0.5833
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.7557, instance_loss: 0.4369, weighted_loss: 0.6601, label: 1, bag_size: 64834


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 24, train_loss: 0.8191, train_clustering_loss:  0.5091, train_error: 0.3158
class 0: acc 0.7, correct 7/10
class 1: acc 0.6666666666666666, correct 8/12
class 2: acc 1.0, correct 7/7
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.3297, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5268, instance_loss: 0.4257, weighted_loss: 0.4965, label: 2, bag_size: 393657


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 25, train_loss: 0.7088, train_clustering_loss:  0.4784, train_error: 0.2895
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.3333333333333333, correct 2/6
class 2: acc 1.0, correct 11/11
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4761, val_error: 0.6250, auc: 0.5417
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.8302, instance_loss: 0.5528, weighted_loss: 0.7470, label: 1, bag_size: 57038


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.009868421052631578: correct 3/304
Epoch: 26, train_loss: 0.6663, train_clustering_loss:  0.4675, train_error: 0.2632
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.9, correct 9/10
class 2: acc 1.0, correct 10/10
class 3: acc 0.5833333333333334, correct 7/12

Val Set, val_loss: 1.4139, val_error: 0.7500, auc: 0.5833
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.0899, instance_loss: 0.2551, weighted_loss: 0.1395, label: 3, bag_size: 189694


class 0 clustering acc 0.9991776315789473: correct 1215/1216
class 1 clustering acc 0.06578947368421052: correct 20/304
Epoch: 27, train_loss: 0.6868, train_clustering_loss:  0.4596, train_error: 0.3158
class 0: acc 0.125, correct 1/8
class 1: acc 0.875, correct 7/8
class 2: acc 1.0, correct 8/8
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.4267, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.3233, instance_loss: 0.4455, weighted_loss: 0.3599, label: 0, bag_size: 130978


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.03618421052631579: correct 11/304
Epoch: 28, train_loss: 0.6210, train_clustering_loss:  0.4350, train_error: 0.1842
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 1.0, correct 10/10
class 3: acc 0.5, correct 3/6

Val Set, val_loss: 1.8889, val_error: 0.8750, auc: 0.5208
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.8627, instance_loss: 0.5033, weighted_loss: 0.7549, label: 0, bag_size: 130978


class 0 clustering acc 0.9991776315789473: correct 1215/1216
class 1 clustering acc 0.10197368421052631: correct 31/304
Epoch: 29, train_loss: 0.6543, train_clustering_loss:  0.4204, train_error: 0.2368
class 0: acc 0.6, correct 6/10
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.3841, val_error: 0.7500, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 14 out of 20


batch 19, loss: 2.1723, instance_loss: 0.7655, weighted_loss: 1.7502, label: 3, bag_size: 231301


class 0 clustering acc 0.9942434210526315: correct 1209/1216
class 1 clustering acc 0.15460526315789475: correct 47/304
Epoch: 30, train_loss: 0.6576, train_clustering_loss:  0.4293, train_error: 0.2895
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.8, correct 8/10
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.4047, val_error: 0.8750, auc: 0.6667
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.2665, instance_loss: 0.3939, weighted_loss: 0.3047, label: 0, bag_size: 59350


class 0 clustering acc 0.9958881578947368: correct 1211/1216
class 1 clustering acc 0.05592105263157895: correct 17/304
Epoch: 31, train_loss: 0.7386, train_clustering_loss:  0.4493, train_error: 0.2895
class 0: acc 0.6, correct 3/5
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 1.0, correct 13/13
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.2123, val_error: 0.5000, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.5, correct 1/2
Validation loss decreased (1.317754 --> 1.212344).  Saving model ...


batch 19, loss: 0.3083, instance_loss: 0.2915, weighted_loss: 0.3032, label: 1, bag_size: 16373


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.13486842105263158: correct 41/304
Epoch: 32, train_loss: 0.6708, train_clustering_loss:  0.4332, train_error: 0.2632
class 0: acc 0.2857142857142857, correct 2/7
class 1: acc 0.7272727272727273, correct 8/11
class 2: acc 0.875, correct 7/8
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.3861, val_error: 0.7500, auc: 0.6042
class 0 clustering acc 0.9765625: correct 250/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.4014, instance_loss: 0.3472, weighted_loss: 0.3851, label: 2, bag_size: 23349


class 0 clustering acc 0.9983552631578947: correct 1214/1216
class 1 clustering acc 0.15789473684210525: correct 48/304
Epoch: 33, train_loss: 0.5416, train_clustering_loss:  0.4164, train_error: 0.2105
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.75, correct 6/8
class 2: acc 1.0, correct 11/11
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.6121, val_error: 0.7500, auc: 0.5833
class 0 clustering acc 0.9609375: correct 246/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.5535, instance_loss: 0.2729, weighted_loss: 0.4693, label: 2, bag_size: 17501


class 0 clustering acc 0.9983552631578947: correct 1214/1216
class 1 clustering acc 0.1513157894736842: correct 46/304
Epoch: 34, train_loss: 0.6083, train_clustering_loss:  0.4188, train_error: 0.3158
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.125, correct 1/8
class 2: acc 1.0, correct 10/10
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.7047, val_error: 0.8750, auc: 0.6250
class 0 clustering acc 0.93359375: correct 239/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.6684, instance_loss: 0.6589, weighted_loss: 1.3655, label: 0, bag_size: 222491


class 0 clustering acc 0.9983552631578947: correct 1214/1216
class 1 clustering acc 0.32894736842105265: correct 100/304
Epoch: 35, train_loss: 0.4580, train_clustering_loss:  0.3513, train_error: 0.2105
class 0: acc 0.5, correct 6/12
class 1: acc 0.6666666666666666, correct 4/6
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.6310, val_error: 0.8750, auc: 0.6042
class 0 clustering acc 0.90625: correct 232/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.0342, instance_loss: 0.1323, weighted_loss: 0.0636, label: 3, bag_size: 189694


class 0 clustering acc 0.993421052631579: correct 1208/1216
class 1 clustering acc 0.28618421052631576: correct 87/304
Epoch: 36, train_loss: 0.6373, train_clustering_loss:  0.4273, train_error: 0.3684
class 0: acc 0.2857142857142857, correct 2/7
class 1: acc 0.3333333333333333, correct 4/12
class 2: acc 1.0, correct 10/10
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.5819, val_error: 0.5000, auc: 0.6458
class 0 clustering acc 0.9375: correct 240/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.0671, instance_loss: 0.5657, weighted_loss: 0.9167, label: 0, bag_size: 46742


class 0 clustering acc 0.9958881578947368: correct 1211/1216
class 1 clustering acc 0.26644736842105265: correct 81/304
Epoch: 37, train_loss: 0.5095, train_clustering_loss:  0.3774, train_error: 0.2368
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.6477, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 0.9296875: correct 238/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.1418, instance_loss: 0.3199, weighted_loss: 0.1952, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.4934210526315789: correct 150/304
Epoch: 38, train_loss: 0.3807, train_clustering_loss:  0.3087, train_error: 0.1842
class 0: acc 1.0, correct 13/13
class 1: acc 0.0, correct 0/6
class 2: acc 1.0, correct 10/10
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.7225, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 0.8671875: correct 222/256
class 1 clustering acc 0.09375: correct 6/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.9881, instance_loss: 0.4660, weighted_loss: 0.8315, label: 0, bag_size: 46742


class 0 clustering acc 0.9958881578947368: correct 1211/1216
class 1 clustering acc 0.2532894736842105: correct 77/304
Epoch: 39, train_loss: 0.5719, train_clustering_loss:  0.4006, train_error: 0.2895
class 0: acc 0.375, correct 3/8
class 1: acc 0.7647058823529411, correct 13/17
class 2: acc 0.875, correct 7/8
class 3: acc 0.8, correct 4/5

Val Set, val_loss: 1.2152, val_error: 0.5000, auc: 0.7083
class 0 clustering acc 0.93359375: correct 239/256
class 1 clustering acc 0.1875: correct 12/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.1129, instance_loss: 0.2532, weighted_loss: 0.1550, label: 3, bag_size: 240896


class 0 clustering acc 0.9917763157894737: correct 1206/1216
class 1 clustering acc 0.25: correct 76/304
Epoch: 40, train_loss: 0.6137, train_clustering_loss:  0.3928, train_error: 0.2632
class 0: acc 0.5, correct 5/10
class 1: acc 1.0, correct 11/11
class 2: acc 0.8333333333333334, correct 5/6
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.8439, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 0.86328125: correct 221/256
class 1 clustering acc 0.15625: correct 10/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5827, instance_loss: 0.4754, weighted_loss: 0.5505, label: 1, bag_size: 66789


class 0 clustering acc 0.9860197368421053: correct 1199/1216
class 1 clustering acc 0.4342105263157895: correct 132/304
Epoch: 41, train_loss: 0.6412, train_clustering_loss:  0.3995, train_error: 0.2105
class 0: acc 0.5, correct 4/8
class 1: acc 1.0, correct 5/5
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.6998, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 0.94140625: correct 241/256
class 1 clustering acc 0.0625: correct 4/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 10 out of 20


batch 19, loss: 0.1397, instance_loss: 0.2284, weighted_loss: 0.1663, label: 2, bag_size: 22130


class 0 clustering acc 0.9983552631578947: correct 1214/1216
class 1 clustering acc 0.3157894736842105: correct 96/304
Epoch: 42, train_loss: 0.5818, train_clustering_loss:  0.3898, train_error: 0.2368
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.7, correct 7/10
class 2: acc 0.75, correct 6/8
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.3941, val_error: 0.5000, auc: 0.7083
class 0 clustering acc 0.9453125: correct 242/256
class 1 clustering acc 0.21875: correct 14/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.1129, instance_loss: 0.1541, weighted_loss: 0.1252, label: 2, bag_size: 158432


class 0 clustering acc 0.9958881578947368: correct 1211/1216
class 1 clustering acc 0.24342105263157895: correct 74/304
Epoch: 43, train_loss: 0.5069, train_clustering_loss:  0.3886, train_error: 0.1053
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.3159, val_error: 0.6250, auc: 0.7292
class 0 clustering acc 0.9375: correct 240/256
class 1 clustering acc 0.234375: correct 15/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 12 out of 20


batch 19, loss: 0.0218, instance_loss: 0.0466, weighted_loss: 0.0292, label: 3, bag_size: 262536


class 0 clustering acc 0.9975328947368421: correct 1213/1216
class 1 clustering acc 0.40131578947368424: correct 122/304
Epoch: 44, train_loss: 0.3752, train_clustering_loss:  0.3258, train_error: 0.1053
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 1.0, correct 12/12
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.5243, val_error: 0.6250, auc: 0.7917
class 0 clustering acc 0.91015625: correct 233/256
class 1 clustering acc 0.25: correct 16/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.0445, instance_loss: 0.0771, weighted_loss: 0.0543, label: 2, bag_size: 393657


class 0 clustering acc 0.9942434210526315: correct 1209/1216
class 1 clustering acc 0.5197368421052632: correct 158/304
Epoch: 45, train_loss: 0.3533, train_clustering_loss:  0.3030, train_error: 0.0789
class 0: acc 0.5, correct 2/4
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 15/15
class 3: acc 1.0, correct 7/7

Val Set, val_loss: 1.4024, val_error: 0.6250, auc: 0.7083
class 0 clustering acc 0.9140625: correct 234/256
class 1 clustering acc 0.234375: correct 15/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.6188, instance_loss: 0.5494, weighted_loss: 0.5980, label: 3, bag_size: 28883


class 0 clustering acc 0.990953947368421: correct 1205/1216
class 1 clustering acc 0.4473684210526316: correct 136/304
Epoch: 46, train_loss: 0.4469, train_clustering_loss:  0.3582, train_error: 0.1842
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.9, correct 9/10
class 3: acc 1.0, correct 10/10

Val Set, val_loss: 1.4632, val_error: 0.6250, auc: 0.7292
class 0 clustering acc 0.9140625: correct 234/256
class 1 clustering acc 0.21875: correct 14/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 15 out of 20


batch 19, loss: 0.5107, instance_loss: 0.5243, weighted_loss: 0.5148, label: 0, bag_size: 13999


class 0 clustering acc 0.9917763157894737: correct 1206/1216
class 1 clustering acc 0.45723684210526316: correct 139/304
Epoch: 47, train_loss: 0.3805, train_clustering_loss:  0.3190, train_error: 0.1053
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 1.0, correct 8/8
class 2: acc 1.0, correct 9/9
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4656, val_error: 0.6250, auc: 0.7083
class 0 clustering acc 0.91796875: correct 235/256
class 1 clustering acc 0.09375: correct 6/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.0561, instance_loss: 0.1947, weighted_loss: 0.0977, label: 2, bag_size: 103108


class 0 clustering acc 0.9950657894736842: correct 1210/1216
class 1 clustering acc 0.47368421052631576: correct 144/304
Epoch: 48, train_loss: 0.3985, train_clustering_loss:  0.3204, train_error: 0.1316
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 0.9285714285714286, correct 13/14
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.3990, val_error: 0.6250, auc: 0.6875
class 0 clustering acc 0.9140625: correct 234/256
class 1 clustering acc 0.15625: correct 10/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 17 out of 20


batch 19, loss: 1.1717, instance_loss: 0.7266, weighted_loss: 1.0382, label: 0, bag_size: 54249


class 0 clustering acc 0.9925986842105263: correct 1207/1216
class 1 clustering acc 0.5855263157894737: correct 178/304
Epoch: 49, train_loss: 0.3064, train_clustering_loss:  0.2814, train_error: 0.1316
class 0: acc 0.5, correct 4/8
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 1.0, correct 12/12
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.5050, val_error: 0.6250, auc: 0.6667
class 0 clustering acc 0.91796875: correct 235/256
class 1 clustering acc 0.203125: correct 13/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.2037, instance_loss: 0.3873, weighted_loss: 0.2588, label: 0, bag_size: 222491


class 0 clustering acc 0.9901315789473685: correct 1204/1216
class 1 clustering acc 0.3782894736842105: correct 115/304
Epoch: 50, train_loss: 0.3747, train_clustering_loss:  0.3539, train_error: 0.0789
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 1.0, correct 9/9
class 2: acc 1.0, correct 8/8
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.2574, val_error: 0.7500, auc: 0.7708
class 0 clustering acc 0.90625: correct 232/256
class 1 clustering acc 0.140625: correct 9/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.2061, instance_loss: 0.2989, weighted_loss: 0.2339, label: 2, bag_size: 22130


class 0 clustering acc 0.9901315789473685: correct 1204/1216
class 1 clustering acc 0.3782894736842105: correct 115/304
Epoch: 51, train_loss: 0.4898, train_clustering_loss:  0.3777, train_error: 0.1579
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 1.0, correct 5/5

Val Set, val_loss: 1.5095, val_error: 0.6250, auc: 0.7292
class 0 clustering acc 0.9296875: correct 238/256
class 1 clustering acc 0.25: correct 16/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.5000, ROC AUC: 0.6250
Test error: 0.5000, ROC AUC: 0.5417
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2

Training Fold 3!

Init train/val/test splits... 
Done!
Training on 38 samples
Validating on 8 samples
Testing on 8 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7512, instance_loss: 1.0797, weighted_loss: 1.5497, label: 0, bag_size: 130978


class 0 clustering acc 0.928453947368421: correct 1129/1216
class 1 clustering acc 0.08881578947368421: correct 27/304
Epoch: 0, train_loss: 1.4326, train_clustering_loss:  1.0822, train_error: 0.7632
class 0: acc 0.0, correct 0/11
class 1: acc 0.0, correct 0/7
class 2: acc 0.3333333333333333, correct 4/12
class 3: acc 0.625, correct 5/8

Val Set, val_loss: 1.4050, val_error: 0.7500, auc: 0.4792
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (inf --> 1.405017).  Saving model ...


batch 19, loss: 1.4638, instance_loss: 0.8127, weighted_loss: 1.2685, label: 2, bag_size: 103108


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 1, train_loss: 1.4403, train_clustering_loss:  0.8293, train_error: 0.8158
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 0.18181818181818182, correct 2/11
class 2: acc 0.14285714285714285, correct 1/7
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3953, val_error: 0.7500, auc: 0.3958
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.405017 --> 1.395311).  Saving model ...


batch 19, loss: 1.7389, instance_loss: 0.6782, weighted_loss: 1.4207, label: 1, bag_size: 16373


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 2, train_loss: 1.4178, train_clustering_loss:  0.6907, train_error: 0.7368
class 0: acc 0.1111111111111111, correct 1/9
class 1: acc 0.0, correct 0/7
class 2: acc 0.0, correct 0/9
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.3993, val_error: 0.7500, auc: 0.5417
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.2383, instance_loss: 0.6288, weighted_loss: 1.0555, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 3, train_loss: 1.4130, train_clustering_loss:  0.6339, train_error: 0.8158
class 0: acc 0.0, correct 0/8
class 1: acc 0.0, correct 0/11
class 2: acc 0.5, correct 6/12
class 3: acc 0.14285714285714285, correct 1/7

Val Set, val_loss: 1.3870, val_error: 0.7500, auc: 0.5417
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.395311 --> 1.386968).  Saving model ...


batch 19, loss: 1.3818, instance_loss: 0.6282, weighted_loss: 1.1557, label: 1, bag_size: 57038


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 4, train_loss: 1.3894, train_clustering_loss:  0.6115, train_error: 0.7895
class 0: acc 0.1, correct 1/10
class 1: acc 0.0, correct 0/8
class 2: acc 0.0, correct 0/9
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.3798, val_error: 0.7500, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.386968 --> 1.379823).  Saving model ...


batch 19, loss: 1.5049, instance_loss: 0.6098, weighted_loss: 1.2364, label: 3, bag_size: 28883


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 5, train_loss: 1.3523, train_clustering_loss:  0.6125, train_error: 0.5789
class 0: acc 0.3333333333333333, correct 4/12
class 1: acc 0.5, correct 5/10
class 2: acc 0.875, correct 7/8
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3732, val_error: 0.8750, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.379823 --> 1.373156).  Saving model ...


batch 19, loss: 1.4568, instance_loss: 0.6137, weighted_loss: 1.2039, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 6, train_loss: 1.3205, train_clustering_loss:  0.6155, train_error: 0.7368
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 0.5, correct 6/12
class 2: acc 0.0, correct 0/8
class 3: acc 0.2727272727272727, correct 3/11

Val Set, val_loss: 1.3803, val_error: 0.6250, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0791, instance_loss: 0.6267, weighted_loss: 0.9434, label: 0, bag_size: 46742


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 7, train_loss: 1.3070, train_clustering_loss:  0.6209, train_error: 0.5526
class 0: acc 0.8125, correct 13/16
class 1: acc 0.14285714285714285, correct 1/7
class 2: acc 0.0, correct 0/10
class 3: acc 0.6, correct 3/5

Val Set, val_loss: 1.4249, val_error: 0.7500, auc: 0.5625
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.9404, instance_loss: 0.6660, weighted_loss: 1.5581, label: 3, bag_size: 40869


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 8, train_loss: 1.2477, train_clustering_loss:  0.6075, train_error: 0.6053
class 0: acc 0.7142857142857143, correct 10/14
class 1: acc 0.0, correct 0/7
class 2: acc 0.5, correct 5/10
class 3: acc 0.0, correct 0/7

Val Set, val_loss: 1.4111, val_error: 0.6250, auc: 0.5208
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.6341, instance_loss: 0.5417, weighted_loss: 0.6064, label: 0, bag_size: 59350


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 9, train_loss: 1.1571, train_clustering_loss:  0.6058, train_error: 0.5263
class 0: acc 1.0, correct 11/11
class 1: acc 0.0, correct 0/7
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.4124, val_error: 0.7500, auc: 0.4792
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 4 out of 20


batch 19, loss: 1.7772, instance_loss: 0.5819, weighted_loss: 1.4186, label: 0, bag_size: 46742


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 10, train_loss: 1.1846, train_clustering_loss:  0.6079, train_error: 0.4211
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.4503, val_error: 0.7500, auc: 0.5000
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 5 out of 20


batch 19, loss: 1.1709, instance_loss: 0.6115, weighted_loss: 1.0030, label: 1, bag_size: 47433


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 11, train_loss: 1.1481, train_clustering_loss:  0.5966, train_error: 0.3684
class 0: acc 0.2857142857142857, correct 2/7
class 1: acc 0.5454545454545454, correct 6/11
class 2: acc 0.7142857142857143, correct 5/7
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.4887, val_error: 1.0000, auc: 0.5208
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.4604, instance_loss: 0.4816, weighted_loss: 0.4668, label: 3, bag_size: 99257


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 12, train_loss: 1.1711, train_clustering_loss:  0.5984, train_error: 0.5263
class 0: acc 0.2, correct 2/10
class 1: acc 0.25, correct 2/8
class 2: acc 0.25, correct 2/8
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.4820, val_error: 0.8750, auc: 0.4792
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 7 out of 20


batch 19, loss: 1.2185, instance_loss: 0.6017, weighted_loss: 1.0335, label: 1, bag_size: 104549


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 13, train_loss: 1.0868, train_clustering_loss:  0.5905, train_error: 0.3684
class 0: acc 0.6, correct 3/5
class 1: acc 0.6153846153846154, correct 8/13
class 2: acc 0.25, correct 2/8
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.4706, val_error: 0.6250, auc: 0.5417
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.5812, instance_loss: 0.5042, weighted_loss: 0.5581, label: 3, bag_size: 99257


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 14, train_loss: 1.0735, train_clustering_loss:  0.5916, train_error: 0.4211
class 0: acc 0.25, correct 2/8
class 1: acc 0.8, correct 8/10
class 2: acc 0.3333333333333333, correct 3/9
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.4629, val_error: 0.7500, auc: 0.5208
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.5241, instance_loss: 0.5274, weighted_loss: 0.5251, label: 1, bag_size: 16373


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 15, train_loss: 1.1170, train_clustering_loss:  0.5976, train_error: 0.4211
class 0: acc 0.125, correct 1/8
class 1: acc 1.0, correct 11/11
class 2: acc 0.6153846153846154, correct 8/13
class 3: acc 0.3333333333333333, correct 2/6

Val Set, val_loss: 1.4906, val_error: 0.7500, auc: 0.5417
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.6433, instance_loss: 0.6832, weighted_loss: 1.3553, label: 0, bag_size: 46742


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 16, train_loss: 1.0257, train_clustering_loss:  0.5814, train_error: 0.4474
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.7, correct 7/10
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.125, correct 1/8

Val Set, val_loss: 1.4175, val_error: 1.0000, auc: 0.5833
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.8474, instance_loss: 0.5350, weighted_loss: 0.7537, label: 2, bag_size: 278757


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 17, train_loss: 1.0059, train_clustering_loss:  0.5832, train_error: 0.3947
class 0: acc 0.6, correct 3/5
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.5384615384615384, correct 7/13
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 1.5069, val_error: 0.7500, auc: 0.5417
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.1774, instance_loss: 0.5751, weighted_loss: 0.9967, label: 0, bag_size: 130978


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 18, train_loss: 0.9178, train_clustering_loss:  0.5579, train_error: 0.3684
class 0: acc 0.6, correct 6/10
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.8181818181818182, correct 9/11
class 3: acc 0.4, correct 4/10

Val Set, val_loss: 1.5171, val_error: 1.0000, auc: 0.5000
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 13 out of 20


batch 19, loss: 1.2560, instance_loss: 0.5986, weighted_loss: 1.0588, label: 3, bag_size: 56291


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 19, train_loss: 0.9151, train_clustering_loss:  0.5603, train_error: 0.3421
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.875, correct 7/8
class 2: acc 0.75, correct 6/8
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.5793, val_error: 0.8750, auc: 0.5000
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3643, instance_loss: 0.4730, weighted_loss: 0.3969, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 20, train_loss: 0.8647, train_clustering_loss:  0.5321, train_error: 0.3421
class 0: acc 0.8571428571428571, correct 12/14
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.7, correct 7/10
class 3: acc 0.2857142857142857, correct 2/7

Val Set, val_loss: 1.5467, val_error: 0.7500, auc: 0.4792
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.1282, instance_loss: 0.5887, weighted_loss: 0.9663, label: 3, bag_size: 196107


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 21, train_loss: 0.8456, train_clustering_loss:  0.5444, train_error: 0.3158
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.7692307692307693, correct 10/13
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.5555555555555556, correct 5/9

Val Set, val_loss: 1.6109, val_error: 0.8750, auc: 0.4792
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.2258, instance_loss: 0.3637, weighted_loss: 0.2672, label: 2, bag_size: 209612


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 22, train_loss: 0.9813, train_clustering_loss:  0.5213, train_error: 0.3947
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.7058823529411765, correct 12/17
class 3: acc 0.6666666666666666, correct 2/3

Val Set, val_loss: 1.7130, val_error: 0.7500, auc: 0.4167
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.7639, instance_loss: 0.6161, weighted_loss: 0.7196, label: 0, bag_size: 10671


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 23, train_loss: 0.8408, train_clustering_loss:  0.5155, train_error: 0.3684
class 0: acc 0.4444444444444444, correct 4/9
class 1: acc 0.6923076923076923, correct 9/13
class 2: acc 1.0, correct 8/8
class 3: acc 0.375, correct 3/8

Val Set, val_loss: 1.5987, val_error: 0.7500, auc: 0.4375
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.6919, instance_loss: 0.4624, weighted_loss: 0.6230, label: 1, bag_size: 57038


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 24, train_loss: 0.7461, train_clustering_loss:  0.4986, train_error: 0.2895
class 0: acc 0.7, correct 7/10
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.0, correct 0/6
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.6507, val_error: 0.8750, auc: 0.4375
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.6548, instance_loss: 0.4742, weighted_loss: 0.6006, label: 2, bag_size: 525276


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 25, train_loss: 0.6472, train_clustering_loss:  0.4797, train_error: 0.2368
class 0: acc 0.7142857142857143, correct 5/7
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.8461538461538461, correct 11/13

Val Set, val_loss: 1.7677, val_error: 1.0000, auc: 0.4375
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.1324, instance_loss: 0.2848, weighted_loss: 0.1781, label: 3, bag_size: 181076


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 26, train_loss: 0.6694, train_clustering_loss:  0.4739, train_error: 0.2895
class 0: acc 0.3333333333333333, correct 3/9
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.5, correct 3/6
class 3: acc 0.9285714285714286, correct 13/14

Val Set, val_loss: 1.7129, val_error: 0.8750, auc: 0.4583
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.4442, instance_loss: 0.3830, weighted_loss: 0.4258, label: 3, bag_size: 189694


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.003289473684210526: correct 1/304
Epoch: 27, train_loss: 0.5801, train_clustering_loss:  0.4476, train_error: 0.1842
class 0: acc 1.0, correct 8/8
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.7142857142857143, correct 5/7
class 3: acc 0.7857142857142857, correct 11/14

Val Set, val_loss: 1.9119, val_error: 0.8750, auc: 0.4583
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.2257, instance_loss: 0.3547, weighted_loss: 0.2644, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.009868421052631578: correct 3/304
Epoch: 28, train_loss: 0.7069, train_clustering_loss:  0.4601, train_error: 0.3158
class 0: acc 0.4444444444444444, correct 4/9
class 1: acc 0.6875, correct 11/16
class 2: acc 0.5, correct 2/4
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.7534, val_error: 0.8750, auc: 0.4375
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 23 out of 20


batch 19, loss: 0.2467, instance_loss: 0.3318, weighted_loss: 0.2722, label: 1, bag_size: 36943


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 29, train_loss: 0.6299, train_clustering_loss:  0.4529, train_error: 0.2632
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.5, correct 5/10
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 1.8275, val_error: 0.8750, auc: 0.4375
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.3523, instance_loss: 0.3561, weighted_loss: 0.3534, label: 3, bag_size: 40869


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.006578947368421052: correct 2/304
Epoch: 30, train_loss: 0.5432, train_clustering_loss:  0.4190, train_error: 0.2105
class 0: acc 0.625, correct 5/8
class 1: acc 0.9, correct 9/10
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.7272727272727273, correct 8/11

Val Set, val_loss: 2.0197, val_error: 1.0000, auc: 0.4375
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 25 out of 20


batch 19, loss: 1.6886, instance_loss: 0.6955, weighted_loss: 1.3907, label: 2, bag_size: 23349


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.019736842105263157: correct 6/304
Epoch: 31, train_loss: 0.7876, train_clustering_loss:  0.4722, train_error: 0.2105
class 0: acc 0.9090909090909091, correct 10/11
class 1: acc 0.5714285714285714, correct 4/7
class 2: acc 0.8666666666666667, correct 13/15
class 3: acc 0.6, correct 3/5

Val Set, val_loss: 2.0806, val_error: 0.7500, auc: 0.4167
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.9452, instance_loss: 0.5567, weighted_loss: 0.8287, label: 1, bag_size: 81420


class 0 clustering acc 0.9991776315789473: correct 1215/1216
class 1 clustering acc 0.019736842105263157: correct 6/304
Epoch: 32, train_loss: 0.5850, train_clustering_loss:  0.4222, train_error: 0.1579
class 0: acc 0.9, correct 9/10
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 1.0, correct 11/11
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 1.9070, val_error: 0.8750, auc: 0.4375
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.1851, instance_loss: 0.2933, weighted_loss: 0.2175, label: 0, bag_size: 43538


class 0 clustering acc 0.9975328947368421: correct 1213/1216
class 1 clustering acc 0.05263157894736842: correct 16/304
Epoch: 33, train_loss: 0.7268, train_clustering_loss:  0.4587, train_error: 0.2632
class 0: acc 1.0, correct 13/13
class 1: acc 0.5, correct 4/8
class 2: acc 0.9, correct 9/10
class 3: acc 0.2857142857142857, correct 2/7

Val Set, val_loss: 1.9404, val_error: 0.8750, auc: 0.4167
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 28 out of 20


batch 19, loss: 1.0368, instance_loss: 0.6510, weighted_loss: 0.9210, label: 3, bag_size: 196107


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.09539473684210527: correct 29/304
Epoch: 34, train_loss: 0.6619, train_clustering_loss:  0.4542, train_error: 0.1842
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 0.8, correct 8/10
class 3: acc 0.75, correct 6/8

Val Set, val_loss: 2.0190, val_error: 0.8750, auc: 0.3750
class 0 clustering acc 0.99609375: correct 255/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 29 out of 20


batch 19, loss: 0.9944, instance_loss: 0.4124, weighted_loss: 0.8198, label: 2, bag_size: 17501


class 0 clustering acc 0.9967105263157895: correct 1212/1216
class 1 clustering acc 0.11513157894736842: correct 35/304
Epoch: 35, train_loss: 0.5759, train_clustering_loss:  0.4157, train_error: 0.2368
class 0: acc 0.7777777777777778, correct 7/9
class 1: acc 1.0, correct 7/7
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.6363636363636364, correct 7/11

Val Set, val_loss: 2.0092, val_error: 0.8750, auc: 0.4375
class 0 clustering acc 0.9921875: correct 254/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.2365, instance_loss: 0.3568, weighted_loss: 0.2726, label: 3, bag_size: 189694


class 0 clustering acc 0.9950657894736842: correct 1210/1216
class 1 clustering acc 0.1513157894736842: correct 46/304
Epoch: 36, train_loss: 0.6517, train_clustering_loss:  0.4229, train_error: 0.2105
class 0: acc 1.0, correct 12/12
class 1: acc 0.6, correct 6/10
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.7142857142857143, correct 5/7

Val Set, val_loss: 2.1093, val_error: 0.8750, auc: 0.3958
class 0 clustering acc 0.9921875: correct 254/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 31 out of 20


batch 19, loss: 1.0954, instance_loss: 0.6305, weighted_loss: 0.9559, label: 0, bag_size: 54249


class 0 clustering acc 0.9967105263157895: correct 1212/1216
class 1 clustering acc 0.24671052631578946: correct 75/304
Epoch: 37, train_loss: 0.3613, train_clustering_loss:  0.3647, train_error: 0.0526
class 0: acc 1.0, correct 14/14
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 10/10
class 3: acc 0.5, correct 2/4

Val Set, val_loss: 2.0598, val_error: 0.8750, auc: 0.3750
class 0 clustering acc 0.984375: correct 252/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 32 out of 20


batch 19, loss: 0.2908, instance_loss: 0.3657, weighted_loss: 0.3133, label: 1, bag_size: 69073


class 0 clustering acc 0.9983552631578947: correct 1214/1216
class 1 clustering acc 0.27960526315789475: correct 85/304
Epoch: 38, train_loss: 0.4555, train_clustering_loss:  0.3533, train_error: 0.1842
class 0: acc 1.0, correct 11/11
class 1: acc 0.75, correct 3/4
class 2: acc 0.8, correct 8/10
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 2.2279, val_error: 1.0000, auc: 0.4167
class 0 clustering acc 0.9921875: correct 254/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 33 out of 20


batch 19, loss: 0.9940, instance_loss: 0.5417, weighted_loss: 0.8583, label: 2, bag_size: 23349


class 0 clustering acc 0.9975328947368421: correct 1213/1216
class 1 clustering acc 0.3190789473684211: correct 97/304
Epoch: 39, train_loss: 0.4451, train_clustering_loss:  0.3643, train_error: 0.1316
class 0: acc 0.6666666666666666, correct 6/9
class 1: acc 0.9375, correct 15/16
class 2: acc 1.0, correct 8/8
class 3: acc 0.8, correct 4/5

Val Set, val_loss: 2.0739, val_error: 0.8750, auc: 0.3958
class 0 clustering acc 0.98828125: correct 253/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 34 out of 20


batch 19, loss: 0.3885, instance_loss: 0.2768, weighted_loss: 0.3550, label: 2, bag_size: 278757


class 0 clustering acc 0.9991776315789473: correct 1215/1216
class 1 clustering acc 0.4375: correct 133/304
Epoch: 40, train_loss: 0.4029, train_clustering_loss:  0.3433, train_error: 0.1053
class 0: acc 1.0, correct 11/11
class 1: acc 0.9090909090909091, correct 10/11
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 2.1333, val_error: 0.8750, auc: 0.3958
class 0 clustering acc 0.984375: correct 252/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 35 out of 20


batch 19, loss: 0.1381, instance_loss: 0.2371, weighted_loss: 0.1678, label: 1, bag_size: 104549


class 0 clustering acc 0.9967105263157895: correct 1212/1216
class 1 clustering acc 0.2631578947368421: correct 80/304
Epoch: 41, train_loss: 0.5390, train_clustering_loss:  0.3954, train_error: 0.2105
class 0: acc 1.0, correct 8/8
class 1: acc 0.8333333333333334, correct 5/6
class 2: acc 0.7857142857142857, correct 11/14
class 3: acc 0.6, correct 6/10

Val Set, val_loss: 2.3305, val_error: 0.8750, auc: 0.4167
class 0 clustering acc 0.95703125: correct 245/256
class 1 clustering acc 0.03125: correct 2/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 36 out of 20


batch 19, loss: 0.1824, instance_loss: 0.2607, weighted_loss: 0.2059, label: 2, bag_size: 22130


class 0 clustering acc 0.9983552631578947: correct 1214/1216
class 1 clustering acc 0.5230263157894737: correct 159/304
Epoch: 42, train_loss: 0.3123, train_clustering_loss:  0.3000, train_error: 0.0263
class 0: acc 1.0, correct 7/7
class 1: acc 1.0, correct 10/10
class 2: acc 1.0, correct 11/11
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 2.1766, val_error: 0.7500, auc: 0.3958
class 0 clustering acc 0.93359375: correct 239/256
class 1 clustering acc 0.03125: correct 2/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 37 out of 20


batch 19, loss: 0.2725, instance_loss: 0.3864, weighted_loss: 0.3067, label: 0, bag_size: 70920


class 0 clustering acc 0.9876644736842105: correct 1201/1216
class 1 clustering acc 0.3848684210526316: correct 117/304
Epoch: 43, train_loss: 0.5293, train_clustering_loss:  0.3850, train_error: 0.1316
class 0: acc 1.0, correct 12/12
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 0.875, correct 7/8

Val Set, val_loss: 2.0235, val_error: 0.8750, auc: 0.4167
class 0 clustering acc 0.94921875: correct 243/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 38 out of 20


batch 19, loss: 0.1483, instance_loss: 0.3018, weighted_loss: 0.1943, label: 3, bag_size: 262536


class 0 clustering acc 0.9967105263157895: correct 1212/1216
class 1 clustering acc 0.4473684210526316: correct 136/304
Epoch: 44, train_loss: 0.3213, train_clustering_loss:  0.3196, train_error: 0.0000
class 0: acc 1.0, correct 13/13
class 1: acc 1.0, correct 7/7
class 2: acc 1.0, correct 10/10
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 2.1207, val_error: 0.8750, auc: 0.4167
class 0 clustering acc 0.9296875: correct 238/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 39 out of 20


batch 19, loss: 0.2208, instance_loss: 0.3102, weighted_loss: 0.2476, label: 2, bag_size: 525276


class 0 clustering acc 0.993421052631579: correct 1208/1216
class 1 clustering acc 0.5723684210526315: correct 174/304
Epoch: 45, train_loss: 0.3433, train_clustering_loss:  0.2786, train_error: 0.0789
class 0: acc 1.0, correct 9/9
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 1.0, correct 11/11
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 2.1252, val_error: 0.8750, auc: 0.4167
class 0 clustering acc 0.9375: correct 240/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 40 out of 20


batch 19, loss: 0.9438, instance_loss: 0.6526, weighted_loss: 0.8564, label: 2, bag_size: 17501


class 0 clustering acc 0.9958881578947368: correct 1211/1216
class 1 clustering acc 0.4868421052631579: correct 148/304
Epoch: 46, train_loss: 0.4015, train_clustering_loss:  0.3408, train_error: 0.2105
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.8888888888888888, correct 8/9
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.7692307692307693, correct 10/13

Val Set, val_loss: 2.1350, val_error: 1.0000, auc: 0.3958
class 0 clustering acc 0.92578125: correct 237/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 41 out of 20


batch 19, loss: 0.6880, instance_loss: 0.5722, weighted_loss: 0.6533, label: 0, bag_size: 46742


class 0 clustering acc 0.9967105263157895: correct 1212/1216
class 1 clustering acc 0.48355263157894735: correct 147/304
Epoch: 47, train_loss: 0.3725, train_clustering_loss:  0.3189, train_error: 0.0789
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 1.0, correct 8/8
class 2: acc 1.0, correct 9/9
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 2.2526, val_error: 0.8750, auc: 0.4167
class 0 clustering acc 0.8984375: correct 230/256
class 1 clustering acc 0.046875: correct 3/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 42 out of 20


batch 19, loss: 0.2962, instance_loss: 0.3230, weighted_loss: 0.3043, label: 2, bag_size: 103108


class 0 clustering acc 0.9967105263157895: correct 1212/1216
class 1 clustering acc 0.5789473684210527: correct 176/304
Epoch: 48, train_loss: 0.2597, train_clustering_loss:  0.2714, train_error: 0.0789
class 0: acc 1.0, correct 10/10
class 1: acc 1.0, correct 11/11
class 2: acc 1.0, correct 7/7
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 2.3058, val_error: 1.0000, auc: 0.4167
class 0 clustering acc 0.89453125: correct 229/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 43 out of 20


batch 19, loss: 0.2650, instance_loss: 0.3693, weighted_loss: 0.2963, label: 0, bag_size: 130978


class 0 clustering acc 0.9868421052631579: correct 1200/1216
class 1 clustering acc 0.5526315789473685: correct 168/304
Epoch: 49, train_loss: 0.3692, train_clustering_loss:  0.2952, train_error: 0.1053
class 0: acc 1.0, correct 8/8
class 1: acc 0.9, correct 9/10
class 2: acc 1.0, correct 10/10
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 2.6277, val_error: 1.0000, auc: 0.4167
class 0 clustering acc 0.9296875: correct 238/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 44 out of 20


batch 19, loss: 1.3156, instance_loss: 0.4121, weighted_loss: 1.0446, label: 2, bag_size: 17501


class 0 clustering acc 0.9917763157894737: correct 1206/1216
class 1 clustering acc 0.48355263157894735: correct 147/304
Epoch: 50, train_loss: 0.5390, train_clustering_loss:  0.3190, train_error: 0.1842
class 0: acc 1.0, correct 7/7
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.5, correct 4/8
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 2.3821, val_error: 1.0000, auc: 0.3958
class 0 clustering acc 0.94921875: correct 243/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 45 out of 20


batch 19, loss: 0.1442, instance_loss: 0.2600, weighted_loss: 0.1790, label: 2, bag_size: 22130


class 0 clustering acc 0.9958881578947368: correct 1211/1216
class 1 clustering acc 0.5032894736842105: correct 153/304
Epoch: 51, train_loss: 0.3750, train_clustering_loss:  0.2948, train_error: 0.0526
class 0: acc 1.0, correct 8/8
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 11/11
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 2.3772, val_error: 0.8750, auc: 0.3958
class 0 clustering acc 0.9296875: correct 238/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 46 out of 20
Early stopping
Val error: 0.8750, ROC AUC: 0.6042
Test error: 0.8750, ROC AUC: 0.4792
class 0: acc 0.5, correct 1/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2

Training Fold 4!

Init train/val/test splits... 
Done!
Training on 38 samples
Validating on 8 samples
Testing on 8 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!


batch 19, loss: 1.7671, instance_loss: 1.0890, weighted_loss: 1.5637, label: 0, bag_size: 70920


class 0 clustering acc 0.9424342105263158: correct 1146/1216
class 1 clustering acc 0.08552631578947369: correct 26/304
Epoch: 0, train_loss: 1.4085, train_clustering_loss:  1.0766, train_error: 0.7632
class 0: acc 0.0, correct 0/8
class 1: acc 0.0, correct 0/8
class 2: acc 0.36363636363636365, correct 4/11
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.4016, val_error: 0.7500, auc: 0.4792
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
Validation loss decreased (inf --> 1.401643).  Saving model ...


batch 19, loss: 1.3666, instance_loss: 0.7922, weighted_loss: 1.1943, label: 2, bag_size: 149988


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 1, train_loss: 1.3880, train_clustering_loss:  0.7721, train_error: 0.7368
class 0: acc 0.46153846153846156, correct 6/13
class 1: acc 0.25, correct 2/8
class 2: acc 0.125, correct 1/8
class 3: acc 0.1111111111111111, correct 1/9

Val Set, val_loss: 1.4000, val_error: 0.7500, auc: 0.4792
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.401643 --> 1.400023).  Saving model ...


batch 19, loss: 1.8961, instance_loss: 0.7031, weighted_loss: 1.5382, label: 1, bag_size: 69073


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 2, train_loss: 1.4247, train_clustering_loss:  0.6494, train_error: 0.6842
class 0: acc 0.375, correct 3/8
class 1: acc 0.0, correct 0/8
class 2: acc 0.0, correct 0/9
class 3: acc 0.6923076923076923, correct 9/13

Val Set, val_loss: 1.3950, val_error: 0.7500, auc: 0.5000
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.400023 --> 1.395031).  Saving model ...


batch 19, loss: 1.3262, instance_loss: 0.6305, weighted_loss: 1.1175, label: 0, bag_size: 13999


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 3, train_loss: 1.4172, train_clustering_loss:  0.6309, train_error: 0.8421
class 0: acc 0.3, correct 3/10
class 1: acc 0.0, correct 0/10
class 2: acc 0.0, correct 0/11
class 3: acc 0.42857142857142855, correct 3/7

Val Set, val_loss: 1.3889, val_error: 0.7500, auc: 0.5625
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.395031 --> 1.388863).  Saving model ...


batch 19, loss: 1.5085, instance_loss: 0.6540, weighted_loss: 1.2522, label: 1, bag_size: 57038


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 4, train_loss: 1.3421, train_clustering_loss:  0.6213, train_error: 0.5789
class 0: acc 1.0, correct 12/12
class 1: acc 0.0, correct 0/8
class 2: acc 0.4444444444444444, correct 4/9
class 3: acc 0.0, correct 0/9

Val Set, val_loss: 1.3794, val_error: 0.6250, auc: 0.5417
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.388863 --> 1.379433).  Saving model ...


batch 19, loss: 1.2369, instance_loss: 0.6259, weighted_loss: 1.0536, label: 1, bag_size: 445537


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 5, train_loss: 1.3503, train_clustering_loss:  0.6301, train_error: 0.6579
class 0: acc 0.5555555555555556, correct 5/9
class 1: acc 0.6363636363636364, correct 7/11
class 2: acc 0.125, correct 1/8
class 3: acc 0.0, correct 0/10

Val Set, val_loss: 1.3721, val_error: 0.6250, auc: 0.5417
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.379433 --> 1.372074).  Saving model ...


batch 19, loss: 1.6218, instance_loss: 0.6161, weighted_loss: 1.3201, label: 2, bag_size: 209612


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 6, train_loss: 1.3163, train_clustering_loss:  0.6307, train_error: 0.5000
class 0: acc 0.7, correct 7/10
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.0, correct 0/9
class 3: acc 0.375, correct 3/8

Val Set, val_loss: 1.3888, val_error: 0.5000, auc: 0.5833
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.6947, instance_loss: 0.6555, weighted_loss: 1.3830, label: 3, bag_size: 25448


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 7, train_loss: 1.2735, train_clustering_loss:  0.6296, train_error: 0.5263
class 0: acc 1.0, correct 14/14
class 1: acc 0.3333333333333333, correct 3/9
class 2: acc 0.14285714285714285, correct 1/7
class 3: acc 0.0, correct 0/8

Val Set, val_loss: 1.3910, val_error: 0.6250, auc: 0.5625
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.6506, instance_loss: 0.6541, weighted_loss: 1.3516, label: 2, bag_size: 17501


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 8, train_loss: 1.2884, train_clustering_loss:  0.6226, train_error: 0.6316
class 0: acc 0.8181818181818182, correct 9/11
class 1: acc 0.0, correct 0/9
class 2: acc 0.25, correct 2/8
class 3: acc 0.3, correct 3/10

Val Set, val_loss: 1.3703, val_error: 0.6250, auc: 0.5625
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.372074 --> 1.370260).  Saving model ...


batch 19, loss: 1.4390, instance_loss: 0.6356, weighted_loss: 1.1980, label: 1, bag_size: 132271


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 9, train_loss: 1.2345, train_clustering_loss:  0.6210, train_error: 0.5000
class 0: acc 0.75, correct 3/4
class 1: acc 0.09090909090909091, correct 1/11
class 2: acc 0.1111111111111111, correct 1/9
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 1.3823, val_error: 0.5000, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.3238, instance_loss: 0.5957, weighted_loss: 1.1054, label: 3, bag_size: 25448


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 10, train_loss: 1.2580, train_clustering_loss:  0.6201, train_error: 0.6579
class 0: acc 0.125, correct 1/8
class 1: acc 0.8181818181818182, correct 9/11
class 2: acc 0.0, correct 0/10
class 3: acc 0.3333333333333333, correct 3/9

Val Set, val_loss: 1.3706, val_error: 0.7500, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1386, instance_loss: 0.5796, weighted_loss: 0.9709, label: 1, bag_size: 23122


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 11, train_loss: 1.2011, train_clustering_loss:  0.5967, train_error: 0.4474
class 0: acc 0.3333333333333333, correct 1/3
class 1: acc 0.5714285714285714, correct 8/14
class 2: acc 0.2857142857142857, correct 2/7
class 3: acc 0.7142857142857143, correct 10/14

Val Set, val_loss: 1.4459, val_error: 0.5000, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 1.4038, instance_loss: 0.6905, weighted_loss: 1.1898, label: 2, bag_size: 103108


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 12, train_loss: 1.3366, train_clustering_loss:  0.6228, train_error: 0.5789
class 0: acc 0.09090909090909091, correct 1/11
class 1: acc 0.625, correct 5/8
class 2: acc 0.0, correct 0/8
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.3614, val_error: 0.6250, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.370260 --> 1.361419).  Saving model ...


batch 19, loss: 1.5271, instance_loss: 0.6005, weighted_loss: 1.2491, label: 1, bag_size: 104549


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 13, train_loss: 1.2303, train_clustering_loss:  0.6081, train_error: 0.5526
class 0: acc 0.4, correct 2/5
class 1: acc 0.25, correct 3/12
class 2: acc 0.2, correct 2/10
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.3685, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8152, instance_loss: 0.6211, weighted_loss: 0.7570, label: 2, bag_size: 103108


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 14, train_loss: 1.2344, train_clustering_loss:  0.6106, train_error: 0.5000
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 1.0, correct 9/9
class 2: acc 0.6363636363636364, correct 7/11
class 3: acc 0.18181818181818182, correct 2/11

Val Set, val_loss: 1.3280, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
Validation loss decreased (1.361419 --> 1.327968).  Saving model ...


batch 19, loss: 1.0607, instance_loss: 0.5758, weighted_loss: 0.9153, label: 1, bag_size: 69073


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 15, train_loss: 1.1604, train_clustering_loss:  0.5998, train_error: 0.4211
class 0: acc 0.4444444444444444, correct 4/9
class 1: acc 0.6, correct 6/10
class 2: acc 0.125, correct 1/8
class 3: acc 1.0, correct 11/11

Val Set, val_loss: 1.3294, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 1.0407, instance_loss: 0.6106, weighted_loss: 0.9117, label: 0, bag_size: 13999


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 16, train_loss: 1.0892, train_clustering_loss:  0.5894, train_error: 0.4474
class 0: acc 0.6666666666666666, correct 10/15
class 1: acc 0.6666666666666666, correct 6/9
class 2: acc 0.3333333333333333, correct 3/9
class 3: acc 0.4, correct 2/5

Val Set, val_loss: 1.3443, val_error: 0.7500, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 1.1283, instance_loss: 0.6056, weighted_loss: 0.9715, label: 2, bag_size: 17501


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 17, train_loss: 1.1854, train_clustering_loss:  0.5949, train_error: 0.5263
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.3, correct 3/10
class 2: acc 0.5454545454545454, correct 6/11
class 3: acc 0.45454545454545453, correct 5/11

Val Set, val_loss: 1.3139, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
Validation loss decreased (1.327968 --> 1.313884).  Saving model ...


batch 19, loss: 1.5959, instance_loss: 0.6410, weighted_loss: 1.3094, label: 0, bag_size: 70920


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 18, train_loss: 1.1638, train_clustering_loss:  0.5847, train_error: 0.5263
class 0: acc 0.2222222222222222, correct 2/9
class 1: acc 0.5, correct 5/10
class 2: acc 0.3, correct 3/10
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.3253, val_error: 0.7500, auc: 0.6667
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8797, instance_loss: 0.5348, weighted_loss: 0.7763, label: 2, bag_size: 209612


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 19, train_loss: 1.1401, train_clustering_loss:  0.5929, train_error: 0.4211
class 0: acc 0.7272727272727273, correct 8/11
class 1: acc 0.4444444444444444, correct 4/9
class 2: acc 0.9, correct 9/10
class 3: acc 0.125, correct 1/8

Val Set, val_loss: 1.3055, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.5, correct 1/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
Validation loss decreased (1.313884 --> 1.305524).  Saving model ...


batch 19, loss: 0.8299, instance_loss: 0.5739, weighted_loss: 0.7531, label: 0, bag_size: 130978


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 20, train_loss: 0.9874, train_clustering_loss:  0.5618, train_error: 0.4474
class 0: acc 0.9230769230769231, correct 12/13
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.4, correct 4/10
class 3: acc 0.25, correct 2/8

Val Set, val_loss: 1.3385, val_error: 0.7500, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20


batch 19, loss: 0.8854, instance_loss: 0.5976, weighted_loss: 0.7991, label: 3, bag_size: 28883


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 21, train_loss: 1.0511, train_clustering_loss:  0.5773, train_error: 0.4211
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 0.38461538461538464, correct 5/13
class 2: acc 0.5, correct 3/6
class 3: acc 0.9166666666666666, correct 11/12

Val Set, val_loss: 1.3895, val_error: 0.6250, auc: 0.6875
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20


batch 19, loss: 0.7388, instance_loss: 0.5526, weighted_loss: 0.6829, label: 3, bag_size: 40869


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 22, train_loss: 1.0263, train_clustering_loss:  0.5621, train_error: 0.4474
class 0: acc 0.4, correct 4/10
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.125, correct 1/8
class 3: acc 0.8181818181818182, correct 9/11

Val Set, val_loss: 1.3428, val_error: 0.6250, auc: 0.6875
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 3 out of 20


batch 19, loss: 0.3313, instance_loss: 0.4765, weighted_loss: 0.3749, label: 0, bag_size: 43538


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 23, train_loss: 0.9756, train_clustering_loss:  0.5471, train_error: 0.2895
class 0: acc 0.3333333333333333, correct 2/6
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.5714285714285714, correct 4/7
class 3: acc 0.8333333333333334, correct 10/12

Val Set, val_loss: 1.4088, val_error: 0.7500, auc: 0.7083
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 4 out of 20


batch 19, loss: 0.7519, instance_loss: 0.4934, weighted_loss: 0.6743, label: 1, bag_size: 57038


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 24, train_loss: 0.9770, train_clustering_loss:  0.5429, train_error: 0.4474
class 0: acc 0.25, correct 2/8
class 1: acc 1.0, correct 13/13
class 2: acc 0.0, correct 0/8
class 3: acc 0.6666666666666666, correct 6/9

Val Set, val_loss: 1.3915, val_error: 0.7500, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 5 out of 20


batch 19, loss: 0.5177, instance_loss: 0.3858, weighted_loss: 0.4781, label: 2, bag_size: 393657


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 25, train_loss: 0.8646, train_clustering_loss:  0.5256, train_error: 0.4737
class 0: acc 0.5454545454545454, correct 6/11
class 1: acc 0.14285714285714285, correct 1/7
class 2: acc 0.8461538461538461, correct 11/13
class 3: acc 0.2857142857142857, correct 2/7

Val Set, val_loss: 1.4458, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 6 out of 20


batch 19, loss: 0.7975, instance_loss: 0.5359, weighted_loss: 0.7190, label: 3, bag_size: 99257


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 26, train_loss: 0.8634, train_clustering_loss:  0.5405, train_error: 0.3684
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.8, correct 8/10
class 2: acc 0.7142857142857143, correct 5/7
class 3: acc 0.5, correct 7/14

Val Set, val_loss: 1.5666, val_error: 0.7500, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 7 out of 20


batch 19, loss: 0.4928, instance_loss: 0.4984, weighted_loss: 0.4945, label: 0, bag_size: 453871


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 27, train_loss: 0.8114, train_clustering_loss:  0.5173, train_error: 0.2632
class 0: acc 0.75, correct 6/8
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.8275, val_error: 0.6250, auc: 0.5000
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 8 out of 20


batch 19, loss: 0.2245, instance_loss: 0.4257, weighted_loss: 0.2848, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 28, train_loss: 0.9175, train_clustering_loss:  0.5299, train_error: 0.3947
class 0: acc 0.6363636363636364, correct 7/11
class 1: acc 0.7333333333333333, correct 11/15
class 2: acc 0.6, correct 3/5
class 3: acc 0.2857142857142857, correct 2/7

Val Set, val_loss: 1.5747, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 9 out of 20


batch 19, loss: 0.3011, instance_loss: 0.4140, weighted_loss: 0.3350, label: 0, bag_size: 18551


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.01644736842105263: correct 5/304
Epoch: 29, train_loss: 0.7218, train_clustering_loss:  0.4871, train_error: 0.2895
class 0: acc 0.7333333333333333, correct 11/15
class 1: acc 0.75, correct 6/8
class 2: acc 1.0, correct 6/6
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 1.5294, val_error: 0.6250, auc: 0.6667
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 10 out of 20


batch 19, loss: 1.5096, instance_loss: 0.8689, weighted_loss: 1.3174, label: 3, bag_size: 240896


class 0 clustering acc 0.9991776315789473: correct 1215/1216
class 1 clustering acc 0.0: correct 0/304
Epoch: 30, train_loss: 0.7729, train_clustering_loss:  0.5189, train_error: 0.2895
class 0: acc 0.6, correct 3/5
class 1: acc 0.5555555555555556, correct 5/9
class 2: acc 0.6666666666666666, correct 6/9
class 3: acc 0.8666666666666667, correct 13/15

Val Set, val_loss: 1.3238, val_error: 0.5000, auc: 0.7708
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 11 out of 20


batch 19, loss: 0.9761, instance_loss: 0.5289, weighted_loss: 0.8419, label: 0, bag_size: 13999


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.006578947368421052: correct 2/304
Epoch: 31, train_loss: 0.8954, train_clustering_loss:  0.5169, train_error: 0.3947
class 0: acc 0.25, correct 2/8
class 1: acc 0.625, correct 5/8
class 2: acc 0.5833333333333334, correct 7/12
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.5610, val_error: 0.6250, auc: 0.6667
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 12 out of 20


batch 19, loss: 1.2463, instance_loss: 0.5767, weighted_loss: 1.0454, label: 1, bag_size: 66789


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.039473684210526314: correct 12/304
Epoch: 32, train_loss: 0.7730, train_clustering_loss:  0.5020, train_error: 0.2895
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 0.5833333333333334, correct 7/12
class 2: acc 0.7, correct 7/10
class 3: acc 1.0, correct 9/9

Val Set, val_loss: 1.6929, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 13 out of 20


batch 19, loss: 0.4233, instance_loss: 0.2934, weighted_loss: 0.3843, label: 2, bag_size: 158432


class 0 clustering acc 1.0: correct 1216/1216
class 1 clustering acc 0.03289473684210526: correct 10/304
Epoch: 33, train_loss: 0.7281, train_clustering_loss:  0.4802, train_error: 0.3421
class 0: acc 0.3, correct 3/10
class 1: acc 0.5, correct 4/8
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.9230769230769231, correct 12/13

Val Set, val_loss: 1.6247, val_error: 0.6250, auc: 0.6042
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 14 out of 20


batch 19, loss: 0.3441, instance_loss: 0.3895, weighted_loss: 0.3577, label: 3, bag_size: 28883


class 0 clustering acc 0.9983552631578947: correct 1214/1216
class 1 clustering acc 0.046052631578947366: correct 14/304
Epoch: 34, train_loss: 0.6898, train_clustering_loss:  0.4933, train_error: 0.2632
class 0: acc 0.8333333333333334, correct 10/12
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.625, correct 5/8
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.4717, val_error: 0.6250, auc: 0.6875
class 0 clustering acc 0.984375: correct 252/256
class 1 clustering acc 0.0: correct 0/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 15 out of 20


batch 19, loss: 1.4917, instance_loss: 0.6197, weighted_loss: 1.2301, label: 1, bag_size: 445537


class 0 clustering acc 0.9975328947368421: correct 1213/1216
class 1 clustering acc 0.09868421052631579: correct 30/304
Epoch: 35, train_loss: 0.7108, train_clustering_loss:  0.4688, train_error: 0.2632
class 0: acc 0.4444444444444444, correct 4/9
class 1: acc 0.875, correct 7/8
class 2: acc 0.9090909090909091, correct 10/11
class 3: acc 0.7, correct 7/10

Val Set, val_loss: 1.4746, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 0.984375: correct 252/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 16 out of 20


batch 19, loss: 0.1681, instance_loss: 0.3112, weighted_loss: 0.2110, label: 0, bag_size: 453871


class 0 clustering acc 0.9917763157894737: correct 1206/1216
class 1 clustering acc 0.11513157894736842: correct 35/304
Epoch: 36, train_loss: 0.7012, train_clustering_loss:  0.4746, train_error: 0.2368
class 0: acc 0.8461538461538461, correct 11/13
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.75, correct 6/8
class 3: acc 0.9, correct 9/10

Val Set, val_loss: 1.6597, val_error: 0.6250, auc: 0.6667
class 0 clustering acc 0.96875: correct 248/256
class 1 clustering acc 0.109375: correct 7/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 17 out of 20


batch 19, loss: 0.0775, instance_loss: 0.2312, weighted_loss: 0.1236, label: 0, bag_size: 59350


class 0 clustering acc 0.9942434210526315: correct 1209/1216
class 1 clustering acc 0.22039473684210525: correct 67/304
Epoch: 37, train_loss: 0.5795, train_clustering_loss:  0.4219, train_error: 0.1842
class 0: acc 0.75, correct 9/12
class 1: acc 0.8, correct 8/10
class 2: acc 0.9, correct 9/10
class 3: acc 0.8333333333333334, correct 5/6

Val Set, val_loss: 1.5901, val_error: 0.6250, auc: 0.7083
class 0 clustering acc 0.96875: correct 248/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 18 out of 20


batch 19, loss: 0.4908, instance_loss: 0.5543, weighted_loss: 0.5098, label: 1, bag_size: 36943


class 0 clustering acc 0.9991776315789473: correct 1215/1216
class 1 clustering acc 0.23026315789473684: correct 70/304
Epoch: 38, train_loss: 0.5752, train_clustering_loss:  0.4143, train_error: 0.2105
class 0: acc 0.9, correct 9/10
class 1: acc 0.42857142857142855, correct 3/7
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.5833, val_error: 0.6250, auc: 0.6667
class 0 clustering acc 0.96875: correct 248/256
class 1 clustering acc 0.109375: correct 7/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 19 out of 20


batch 19, loss: 0.0783, instance_loss: 0.1916, weighted_loss: 0.1123, label: 0, bag_size: 59350


class 0 clustering acc 0.9942434210526315: correct 1209/1216
class 1 clustering acc 0.08223684210526316: correct 25/304
Epoch: 39, train_loss: 0.6617, train_clustering_loss:  0.4803, train_error: 0.2632
class 0: acc 0.375, correct 3/8
class 1: acc 0.7857142857142857, correct 11/14
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.6588, val_error: 0.6250, auc: 0.6875
class 0 clustering acc 0.96875: correct 248/256
class 1 clustering acc 0.0625: correct 4/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 20 out of 20


batch 19, loss: 0.5415, instance_loss: 0.4649, weighted_loss: 0.5186, label: 3, bag_size: 28883


class 0 clustering acc 0.993421052631579: correct 1208/1216
class 1 clustering acc 0.05263157894736842: correct 16/304
Epoch: 40, train_loss: 0.6843, train_clustering_loss:  0.4925, train_error: 0.3158
class 0: acc 0.4, correct 4/10
class 1: acc 0.8461538461538461, correct 11/13
class 2: acc 0.5, correct 3/6
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.7792, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 0.96875: correct 248/256
class 1 clustering acc 0.09375: correct 6/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 21 out of 20


batch 19, loss: 0.9307, instance_loss: 0.6675, weighted_loss: 0.8518, label: 1, bag_size: 104549


class 0 clustering acc 0.9958881578947368: correct 1211/1216
class 1 clustering acc 0.25: correct 76/304
Epoch: 41, train_loss: 0.4476, train_clustering_loss:  0.3881, train_error: 0.1053
class 0: acc 1.0, correct 16/16
class 1: acc 0.5, correct 2/4
class 2: acc 0.8333333333333334, correct 10/12
class 3: acc 1.0, correct 6/6

Val Set, val_loss: 1.8476, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 0.96875: correct 248/256
class 1 clustering acc 0.03125: correct 2/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 22 out of 20


batch 19, loss: 0.2905, instance_loss: 0.3247, weighted_loss: 0.3008, label: 2, bag_size: 163352


class 0 clustering acc 0.9876644736842105: correct 1201/1216
class 1 clustering acc 0.23684210526315788: correct 72/304
Epoch: 42, train_loss: 0.5436, train_clustering_loss:  0.4274, train_error: 0.1842
class 0: acc 1.0, correct 5/5
class 1: acc 0.8, correct 8/10
class 2: acc 1.0, correct 14/14
class 3: acc 0.4444444444444444, correct 4/9

Val Set, val_loss: 2.0933, val_error: 0.6250, auc: 0.5625
class 0 clustering acc 0.96484375: correct 247/256
class 1 clustering acc 0.09375: correct 6/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 23 out of 20


batch 19, loss: 2.0769, instance_loss: 0.7411, weighted_loss: 1.6761, label: 0, bag_size: 46742


class 0 clustering acc 0.9942434210526315: correct 1209/1216
class 1 clustering acc 0.15460526315789475: correct 47/304
Epoch: 43, train_loss: 0.6051, train_clustering_loss:  0.4465, train_error: 0.2632
class 0: acc 0.625, correct 5/8
class 1: acc 0.75, correct 6/8
class 2: acc 0.42857142857142855, correct 3/7
class 3: acc 0.9333333333333333, correct 14/15

Val Set, val_loss: 1.9616, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 0.96875: correct 248/256
class 1 clustering acc 0.046875: correct 3/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 24 out of 20


batch 19, loss: 0.3057, instance_loss: 0.1972, weighted_loss: 0.2732, label: 2, bag_size: 525276


class 0 clustering acc 0.9967105263157895: correct 1212/1216
class 1 clustering acc 0.08552631578947369: correct 26/304
Epoch: 44, train_loss: 0.5262, train_clustering_loss:  0.4386, train_error: 0.1316
class 0: acc 0.75, correct 6/8
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.7777777777777778, correct 7/9
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 2.0660, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 0.96875: correct 248/256
class 1 clustering acc 0.015625: correct 1/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 25 out of 20


batch 19, loss: 0.0916, instance_loss: 0.1305, weighted_loss: 0.1033, label: 2, bag_size: 393657


class 0 clustering acc 0.9975328947368421: correct 1213/1216
class 1 clustering acc 0.23026315789473684: correct 70/304
Epoch: 45, train_loss: 0.3411, train_clustering_loss:  0.3552, train_error: 0.0526
class 0: acc 1.0, correct 3/3
class 1: acc 0.875, correct 7/8
class 2: acc 0.9230769230769231, correct 12/13
class 3: acc 1.0, correct 14/14

Val Set, val_loss: 2.0779, val_error: 0.6250, auc: 0.5833
class 0 clustering acc 0.9609375: correct 246/256
class 1 clustering acc 0.125: correct 8/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 26 out of 20


batch 19, loss: 0.7704, instance_loss: 0.5360, weighted_loss: 0.7001, label: 0, bag_size: 222491


class 0 clustering acc 0.990953947368421: correct 1205/1216
class 1 clustering acc 0.19407894736842105: correct 59/304
Epoch: 46, train_loss: 0.5901, train_clustering_loss:  0.4426, train_error: 0.2632
class 0: acc 0.5, correct 3/6
class 1: acc 0.8333333333333334, correct 10/12
class 2: acc 0.7272727272727273, correct 8/11
class 3: acc 0.7777777777777778, correct 7/9

Val Set, val_loss: 1.6091, val_error: 0.6250, auc: 0.7292
class 0 clustering acc 1.0: correct 256/256
class 1 clustering acc 0.109375: correct 7/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 27 out of 20


batch 19, loss: 0.8655, instance_loss: 0.5019, weighted_loss: 0.7564, label: 3, bag_size: 25448


class 0 clustering acc 0.9942434210526315: correct 1209/1216
class 1 clustering acc 0.15460526315789475: correct 47/304
Epoch: 47, train_loss: 0.4976, train_clustering_loss:  0.4007, train_error: 0.1842
class 0: acc 0.5, correct 5/10
class 1: acc 0.9, correct 9/10
class 2: acc 0.8333333333333334, correct 5/6
class 3: acc 1.0, correct 12/12

Val Set, val_loss: 1.9439, val_error: 0.6250, auc: 0.6250
class 0 clustering acc 0.97265625: correct 249/256
class 1 clustering acc 0.03125: correct 2/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 28 out of 20


batch 19, loss: 0.1980, instance_loss: 0.2681, weighted_loss: 0.2190, label: 2, bag_size: 209612


class 0 clustering acc 0.993421052631579: correct 1208/1216
class 1 clustering acc 0.25: correct 76/304
Epoch: 48, train_loss: 0.3688, train_clustering_loss:  0.3703, train_error: 0.0789
class 0: acc 0.75, correct 6/8
class 1: acc 0.9230769230769231, correct 12/13
class 2: acc 1.0, correct 9/9
class 3: acc 1.0, correct 8/8

Val Set, val_loss: 1.9671, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 0.97265625: correct 249/256
class 1 clustering acc 0.078125: correct 5/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 29 out of 20


batch 19, loss: 1.0984, instance_loss: 0.6887, weighted_loss: 0.9755, label: 0, bag_size: 70920


class 0 clustering acc 0.9917763157894737: correct 1206/1216
class 1 clustering acc 0.27631578947368424: correct 84/304
Epoch: 49, train_loss: 0.4184, train_clustering_loss:  0.3718, train_error: 0.1579
class 0: acc 0.5, correct 4/8
class 1: acc 0.875, correct 7/8
class 2: acc 1.0, correct 11/11
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.9541, val_error: 0.6250, auc: 0.6042
class 0 clustering acc 0.96875: correct 248/256
class 1 clustering acc 0.09375: correct 6/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 30 out of 20


batch 19, loss: 0.6240, instance_loss: 0.5480, weighted_loss: 0.6012, label: 1, bag_size: 445537


class 0 clustering acc 0.9901315789473685: correct 1204/1216
class 1 clustering acc 0.2532894736842105: correct 77/304
Epoch: 50, train_loss: 0.4483, train_clustering_loss:  0.3787, train_error: 0.1316
class 0: acc 0.875, correct 7/8
class 1: acc 0.8, correct 8/10
class 2: acc 0.8888888888888888, correct 8/9
class 3: acc 0.9090909090909091, correct 10/11

Val Set, val_loss: 1.9971, val_error: 0.6250, auc: 0.6458
class 0 clustering acc 0.97265625: correct 249/256
class 1 clustering acc 0.109375: correct 7/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 31 out of 20


batch 19, loss: 0.3580, instance_loss: 0.3839, weighted_loss: 0.3658, label: 2, bag_size: 163352


class 0 clustering acc 0.9893092105263158: correct 1203/1216
class 1 clustering acc 0.22039473684210525: correct 67/304
Epoch: 51, train_loss: 0.4430, train_clustering_loss:  0.3936, train_error: 0.1579
class 0: acc 0.7, correct 7/10
class 1: acc 0.9166666666666666, correct 11/12
class 2: acc 0.8571428571428571, correct 6/7
class 3: acc 0.8888888888888888, correct 8/9

Val Set, val_loss: 1.6733, val_error: 0.6250, auc: 0.7083
class 0 clustering acc 0.97265625: correct 249/256
class 1 clustering acc 0.125: correct 8/64
class 0: acc 0.0, correct 0/2
class 1: acc 0.5, correct 1/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 32 out of 20
Early stopping
Val error: 0.6250, ROC AUC: 0.6250
Test error: 0.5000, ROC AUC: 0.7292
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
finished!
end script
