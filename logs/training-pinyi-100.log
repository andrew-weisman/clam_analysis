
Load Dataset
label column: label
label dictionary: {'pole': 0, 'msi': 1, 'lcn': 2, 'p53': 3}
number of classes: 4
slide-level counts:  
 0    3
1    1
2    5
3    7
Name: label, dtype: int64
Patient-LVL; Number of samples registered in class 0: 3
Slide-LVL; Number of samples registered in class 0: 3
Patient-LVL; Number of samples registered in class 1: 1
Slide-LVL; Number of samples registered in class 1: 1
Patient-LVL; Number of samples registered in class 2: 5
Slide-LVL; Number of samples registered in class 2: 5
Patient-LVL; Number of samples registered in class 3: 7
Slide-LVL; Number of samples registered in class 3: 7
split_dir:  splits/idibell_100
################# Settings ###################
num_splits:  5
k_start:  -1
k_end:  -1
task:  idibell
max_epochs:  200
results_dir:  /home/weismanal/notebook/2021-11-11/testing_clam/results/pinyi/training
lr:  0.0002
experiment:  idibell_CLAM_100
reg:  1e-05
label_frac:  1.0
bag_loss:  ce
seed:  1
model_type:  clam_sb
model_size:  small
use_drop_out:  True
weighted_sample:  True
opt:  adam
bag_weight:  0.7
inst_loss:  svm
B:  8
split_dir:  splits/idibell_100

Training Fold 0!

Init train/val/test splits... 
Done!
Training on 6 samples
Validating on 5 samples
Testing on 5 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_SB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (classifiers): Linear(in_features=512, out_features=4, bias=True)
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
    (3): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 793869
Total number of trainable parameters: 793869

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!




class 0 clustering acc 0.6875: correct 132/192
class 1 clustering acc 0.20833333333333334: correct 10/48
Epoch: 0, train_loss: 1.3419, train_clustering_loss:  1.2884, train_error: 0.5000
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 3/3
class 2: acc None, correct 0/0
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.5304, val_error: 1.0000, auc: 0.1944
class 0 clustering acc 0.68125: correct 109/160
class 1 clustering acc 0.15: correct 6/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (inf --> 1.530389).  Saving model ...




class 0 clustering acc 0.90625: correct 174/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 1, train_loss: 1.4536, train_clustering_loss:  1.2189, train_error: 0.8333
class 0: acc 0.0, correct 0/1
class 1: acc 1.0, correct 1/1
class 2: acc 0.0, correct 0/4
class 3: acc None, correct 0/0

Val Set, val_loss: 1.5452, val_error: 1.0000, auc: 0.2500
class 0 clustering acc 0.99375: correct 159/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 2, train_loss: 1.2975, train_clustering_loss:  1.1303, train_error: 0.5000
class 0: acc 0.0, correct 0/1
class 1: acc 1.0, correct 3/3
class 2: acc None, correct 0/0
class 3: acc 0.0, correct 0/2

Val Set, val_loss: 1.5244, val_error: 1.0000, auc: 0.4167
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.530389 --> 1.524364).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 3, train_loss: 1.3865, train_clustering_loss:  1.0585, train_error: 0.8333
class 0: acc 0.0, correct 0/2
class 1: acc 1.0, correct 1/1
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.5319, val_error: 1.0000, auc: 0.5278
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 4, train_loss: 1.4214, train_clustering_loss:  0.9678, train_error: 0.8333
class 0: acc 0.0, correct 0/1
class 1: acc 1.0, correct 1/1
class 2: acc 0.0, correct 0/1
class 3: acc 0.0, correct 0/3

Val Set, val_loss: 1.4903, val_error: 1.0000, auc: 0.5278
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.524364 --> 1.490278).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 5, train_loss: 1.3566, train_clustering_loss:  0.9143, train_error: 0.6667
class 0: acc 0.5, correct 1/2
class 1: acc 1.0, correct 1/1
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.4183, val_error: 1.0000, auc: 0.6944
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.490278 --> 1.418334).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 6, train_loss: 1.2966, train_clustering_loss:  0.8698, train_error: 0.3333
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 1/1
class 2: acc 0.3333333333333333, correct 1/3
class 3: acc None, correct 0/0

Val Set, val_loss: 1.3863, val_error: 0.8000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.418334 --> 1.386267).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 7, train_loss: 1.2392, train_clustering_loss:  0.8156, train_error: 0.3333
class 0: acc 1.0, correct 3/3
class 1: acc 0.0, correct 0/1
class 2: acc 1.0, correct 1/1
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.3704, val_error: 0.6000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.386267 --> 1.370431).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 8, train_loss: 1.3860, train_clustering_loss:  0.7931, train_error: 0.8333
class 0: acc 1.0, correct 1/1
class 1: acc 0.0, correct 0/2
class 2: acc None, correct 0/0
class 3: acc 0.0, correct 0/3

Val Set, val_loss: 1.3645, val_error: 0.8000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.370431 --> 1.364530).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 9, train_loss: 1.3404, train_clustering_loss:  0.7571, train_error: 0.6667
class 0: acc 1.0, correct 1/1
class 1: acc 0.5, correct 1/2
class 2: acc None, correct 0/0
class 3: acc 0.0, correct 0/3

Val Set, val_loss: 1.3970, val_error: 0.8000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 1 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 10, train_loss: 1.1757, train_clustering_loss:  0.7239, train_error: 0.1667
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 3/3
class 2: acc None, correct 0/0
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.4545, val_error: 0.8000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 2 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 11, train_loss: 1.1358, train_clustering_loss:  0.6921, train_error: 0.1667
class 0: acc 1.0, correct 3/3
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/1
class 3: acc None, correct 0/0

Val Set, val_loss: 1.5400, val_error: 1.0000, auc: 0.6944
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 3 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 12, train_loss: 1.4533, train_clustering_loss:  0.6897, train_error: 0.6667
class 0: acc 1.0, correct 2/2
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/3
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.5625, val_error: 1.0000, auc: 0.6944
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 4 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 13, train_loss: 1.1740, train_clustering_loss:  0.6597, train_error: 0.5000
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 1/1
class 2: acc 0.0, correct 0/1
class 3: acc 0.0, correct 0/2

Val Set, val_loss: 1.5046, val_error: 1.0000, auc: 0.6944
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 5 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 14, train_loss: 0.9235, train_clustering_loss:  0.6419, train_error: 0.1667
class 0: acc 1.0, correct 3/3
class 1: acc 1.0, correct 2/2
class 2: acc None, correct 0/0
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.4836, val_error: 0.8000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 6 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 15, train_loss: 0.9208, train_clustering_loss:  0.6292, train_error: 0.1667
class 0: acc 1.0, correct 3/3
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/1
class 3: acc None, correct 0/0

Val Set, val_loss: 1.5392, val_error: 0.8000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 7 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 16, train_loss: 1.1605, train_clustering_loss:  0.6418, train_error: 0.5000
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 1/1
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.5464, val_error: 0.8000, auc: 0.8056
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 8 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 17, train_loss: 1.3851, train_clustering_loss:  0.6630, train_error: 0.8333
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/1
class 3: acc 0.0, correct 0/4

Val Set, val_loss: 1.4411, val_error: 0.8000, auc: 0.8056
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 9 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 18, train_loss: 1.1610, train_clustering_loss:  0.6429, train_error: 0.3333
class 0: acc 1.0, correct 1/1
class 1: acc 1.0, correct 1/1
class 2: acc 0.0, correct 0/1
class 3: acc 0.6666666666666666, correct 2/3

Val Set, val_loss: 1.3468, val_error: 0.6000, auc: 0.8056
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.364530 --> 1.346766).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 19, train_loss: 0.9332, train_clustering_loss:  0.5977, train_error: 0.1667
class 0: acc 1.0, correct 3/3
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/1
class 3: acc None, correct 0/0

Val Set, val_loss: 1.3277, val_error: 0.6000, auc: 0.8056
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.346766 --> 1.327677).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 20, train_loss: 0.8217, train_clustering_loss:  0.5744, train_error: 0.0000
class 0: acc 1.0, correct 3/3
class 1: acc 1.0, correct 2/2
class 2: acc None, correct 0/0
class 3: acc 1.0, correct 1/1

Val Set, val_loss: 1.3535, val_error: 0.6000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 1 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 21, train_loss: 1.1409, train_clustering_loss:  0.6338, train_error: 0.3333
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/1
class 3: acc 0.6666666666666666, correct 2/3

Val Set, val_loss: 1.3691, val_error: 0.6000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 22, train_loss: 0.8767, train_clustering_loss:  0.5955, train_error: 0.1667
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/1
class 3: acc None, correct 0/0

Val Set, val_loss: 1.4304, val_error: 0.8000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 3 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 23, train_loss: 0.6829, train_clustering_loss:  0.5798, train_error: 0.0000
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 3/3
class 2: acc None, correct 0/0
class 3: acc 1.0, correct 1/1

Val Set, val_loss: 1.5433, val_error: 1.0000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 4 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 24, train_loss: 1.3099, train_clustering_loss:  0.6244, train_error: 0.6667
class 0: acc 1.0, correct 1/1
class 1: acc 1.0, correct 1/1
class 2: acc 0.0, correct 0/4
class 3: acc None, correct 0/0

Val Set, val_loss: 1.6081, val_error: 1.0000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 5 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 25, train_loss: 1.3314, train_clustering_loss:  0.6257, train_error: 0.8333
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/4
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.4933, val_error: 1.0000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 6 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 26, train_loss: 0.9762, train_clustering_loss:  0.6100, train_error: 0.3333
class 0: acc 1.0, correct 1/1
class 1: acc 1.0, correct 2/2
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.4303, val_error: 0.8000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 7 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 27, train_loss: 0.7232, train_clustering_loss:  0.5809, train_error: 0.0000
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 2/2
class 2: acc 1.0, correct 2/2
class 3: acc None, correct 0/0

Val Set, val_loss: 1.4179, val_error: 0.8000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 8 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 28, train_loss: 1.2154, train_clustering_loss:  0.6249, train_error: 0.5000
class 0: acc 1.0, correct 1/1
class 1: acc 1.0, correct 2/2
class 2: acc None, correct 0/0
class 3: acc 0.0, correct 0/3

Val Set, val_loss: 1.3619, val_error: 0.8000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 9 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 29, train_loss: 1.1963, train_clustering_loss:  0.6129, train_error: 0.6667
class 0: acc 1.0, correct 1/1
class 1: acc 1.0, correct 1/1
class 2: acc None, correct 0/0
class 3: acc 0.0, correct 0/4

Val Set, val_loss: 1.2875, val_error: 0.8000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
Validation loss decreased (1.327677 --> 1.287520).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 30, train_loss: 0.4659, train_clustering_loss:  0.5141, train_error: 0.0000
class 0: acc 1.0, correct 6/6
class 1: acc None, correct 0/0
class 2: acc None, correct 0/0
class 3: acc None, correct 0/0

Val Set, val_loss: 1.2313, val_error: 0.4000, auc: 0.8333
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.287520 --> 1.231270).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 31, train_loss: 1.0361, train_clustering_loss:  0.5913, train_error: 0.6667
class 0: acc 1.0, correct 1/1
class 1: acc 1.0, correct 1/1
class 2: acc 0.0, correct 0/3
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.2147, val_error: 0.4000, auc: 0.8889
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.231270 --> 1.214740).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 32, train_loss: 0.8914, train_clustering_loss:  0.5967, train_error: 0.3333
class 0: acc 1.0, correct 1/1
class 1: acc 1.0, correct 3/3
class 2: acc 0.0, correct 0/1
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.2544, val_error: 0.4000, auc: 0.8333
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 33, train_loss: 1.0028, train_clustering_loss:  0.5810, train_error: 0.1667
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 1.0, correct 3/3
class 3: acc 0.5, correct 1/2

Val Set, val_loss: 1.2935, val_error: 0.6000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 34, train_loss: 0.7495, train_clustering_loss:  0.5406, train_error: 0.1667
class 0: acc 1.0, correct 3/3
class 1: acc None, correct 0/0
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.2532, val_error: 0.6000, auc: 0.7500
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 3 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 35, train_loss: 1.0858, train_clustering_loss:  0.6165, train_error: 0.5000
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 1/1
class 2: acc 1.0, correct 2/2
class 3: acc 0.0, correct 0/3

Val Set, val_loss: 1.1996, val_error: 0.4000, auc: 0.8056
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.214740 --> 1.199615).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 36, train_loss: 0.9036, train_clustering_loss:  0.6021, train_error: 0.0000
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 2/2
class 2: acc None, correct 0/0
class 3: acc 1.0, correct 4/4

Val Set, val_loss: 1.2180, val_error: 0.6000, auc: 0.8056
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 37, train_loss: 0.7099, train_clustering_loss:  0.5573, train_error: 0.0000
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc None, correct 0/0
class 3: acc 1.0, correct 5/5

Val Set, val_loss: 1.2392, val_error: 0.6000, auc: 0.8889
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 38, train_loss: 0.7438, train_clustering_loss:  0.5782, train_error: 0.3333
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 3/3

Val Set, val_loss: 1.2185, val_error: 0.6000, auc: 1.0000
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 3 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 39, train_loss: 0.7738, train_clustering_loss:  0.5371, train_error: 0.3333
class 0: acc 1.0, correct 4/4
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc None, correct 0/0

Val Set, val_loss: 1.0817, val_error: 0.6000, auc: 1.0000
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.199615 --> 1.081661).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 40, train_loss: 0.8183, train_clustering_loss:  0.5650, train_error: 0.3333
class 0: acc 1.0, correct 2/2
class 1: acc 0.0, correct 0/1
class 2: acc 0.0, correct 0/1
class 3: acc 1.0, correct 2/2

Val Set, val_loss: 1.0051, val_error: 0.4000, auc: 0.9444
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.081661 --> 1.005142).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 41, train_loss: 0.5356, train_clustering_loss:  0.5097, train_error: 0.3333
class 0: acc 1.0, correct 4/4
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc None, correct 0/0

Val Set, val_loss: 0.9955, val_error: 0.4000, auc: 1.0000
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 1.0, correct 1/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
Validation loss decreased (1.005142 --> 0.995547).  Saving model ...




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 42, train_loss: 0.9461, train_clustering_loss:  0.5912, train_error: 0.5000
class 0: acc 1.0, correct 1/1
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 1/1
class 3: acc 0.5, correct 1/2

Val Set, val_loss: 1.0852, val_error: 0.6000, auc: 0.9444
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 1 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 43, train_loss: 0.6062, train_clustering_loss:  0.5238, train_error: 0.0000
class 0: acc 1.0, correct 3/3
class 1: acc 1.0, correct 1/1
class 2: acc 1.0, correct 1/1
class 3: acc 1.0, correct 1/1

Val Set, val_loss: 1.1733, val_error: 0.6000, auc: 0.8889
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 2 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 44, train_loss: 0.6133, train_clustering_loss:  0.5101, train_error: 0.0000
class 0: acc 1.0, correct 2/2
class 1: acc None, correct 0/0
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 2/2

Val Set, val_loss: 1.1767, val_error: 0.4000, auc: 0.8889
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 3 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 45, train_loss: 0.7324, train_clustering_loss:  0.5444, train_error: 0.0000
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 1/1
class 2: acc 1.0, correct 1/1
class 3: acc 1.0, correct 2/2

Val Set, val_loss: 1.1903, val_error: 0.6000, auc: 0.8889
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 4 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 46, train_loss: 0.5491, train_clustering_loss:  0.5137, train_error: 0.0000
class 0: acc 1.0, correct 3/3
class 1: acc 1.0, correct 2/2
class 2: acc None, correct 0/0
class 3: acc 1.0, correct 1/1

Val Set, val_loss: 1.2300, val_error: 0.6000, auc: 0.7778
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 1.0, correct 2/2
EarlyStopping counter: 5 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 47, train_loss: 0.6182, train_clustering_loss:  0.5478, train_error: 0.0000
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 2/2
class 2: acc 1.0, correct 1/1
class 3: acc 1.0, correct 1/1

Val Set, val_loss: 1.2480, val_error: 0.8000, auc: 0.7778
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 6 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 48, train_loss: 0.8842, train_clustering_loss:  0.6297, train_error: 0.0000
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 2/2
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 2/2

Val Set, val_loss: 1.2868, val_error: 0.8000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 7 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 49, train_loss: 0.6395, train_clustering_loss:  0.6235, train_error: 0.0000
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 4/4
class 2: acc None, correct 0/0
class 3: acc 1.0, correct 2/2

Val Set, val_loss: 1.4610, val_error: 0.8000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 8 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 50, train_loss: 0.7549, train_clustering_loss:  0.5365, train_error: 0.5000
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 1/1
class 2: acc 0.0, correct 0/3
class 3: acc None, correct 0/0

Val Set, val_loss: 1.5029, val_error: 0.8000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 9 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 51, train_loss: 0.7223, train_clustering_loss:  0.5546, train_error: 0.5000
class 0: acc 1.0, correct 1/1
class 1: acc 1.0, correct 2/2
class 2: acc 0.0, correct 0/2
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.4095, val_error: 0.8000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 10 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 52, train_loss: 0.7854, train_clustering_loss:  0.5888, train_error: 0.0000
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 2/2
class 2: acc 1.0, correct 2/2
class 3: acc 1.0, correct 2/2

Val Set, val_loss: 1.2943, val_error: 0.8000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 11 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 53, train_loss: 0.5150, train_clustering_loss:  0.5025, train_error: 0.0000
class 0: acc 1.0, correct 3/3
class 1: acc 1.0, correct 1/1
class 2: acc 1.0, correct 1/1
class 3: acc 1.0, correct 1/1

Val Set, val_loss: 1.1300, val_error: 0.6000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 12 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 54, train_loss: 0.6257, train_clustering_loss:  0.5478, train_error: 0.0000
class 0: acc 1.0, correct 1/1
class 1: acc 1.0, correct 3/3
class 2: acc 1.0, correct 1/1
class 3: acc 1.0, correct 1/1

Val Set, val_loss: 1.1723, val_error: 0.6000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 13 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 55, train_loss: 0.4737, train_clustering_loss:  0.4832, train_error: 0.0000
class 0: acc 1.0, correct 3/3
class 1: acc 1.0, correct 1/1
class 2: acc 1.0, correct 1/1
class 3: acc 1.0, correct 1/1

Val Set, val_loss: 1.1996, val_error: 0.6000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 14 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 56, train_loss: 0.6410, train_clustering_loss:  0.5180, train_error: 0.0000
class 0: acc 1.0, correct 2/2
class 1: acc None, correct 0/0
class 2: acc 1.0, correct 3/3
class 3: acc 1.0, correct 1/1

Val Set, val_loss: 1.2142, val_error: 0.6000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 15 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 57, train_loss: 0.5809, train_clustering_loss:  0.5357, train_error: 0.0000
class 0: acc 1.0, correct 1/1
class 1: acc 1.0, correct 2/2
class 2: acc 1.0, correct 3/3
class 3: acc None, correct 0/0

Val Set, val_loss: 1.1986, val_error: 0.6000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 16 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 58, train_loss: 0.5221, train_clustering_loss:  0.5096, train_error: 0.1667
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 2/2
class 2: acc 1.0, correct 1/1
class 3: acc 0.0, correct 0/1

Val Set, val_loss: 1.2149, val_error: 0.8000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.0, correct 0/2
EarlyStopping counter: 17 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 59, train_loss: 0.5699, train_clustering_loss:  0.5302, train_error: 0.1667
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 2/2
class 2: acc None, correct 0/0
class 3: acc 0.5, correct 1/2

Val Set, val_loss: 1.2486, val_error: 0.6000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 18 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 60, train_loss: 0.6235, train_clustering_loss:  0.5409, train_error: 0.1667
class 0: acc 1.0, correct 1/1
class 1: acc 1.0, correct 2/2
class 2: acc 1.0, correct 1/1
class 3: acc 0.5, correct 1/2

Val Set, val_loss: 1.2878, val_error: 0.6000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.5, correct 1/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 19 out of 20




class 0 clustering acc 1.0: correct 192/192
class 1 clustering acc 0.0: correct 0/48
Epoch: 61, train_loss: 0.7279, train_clustering_loss:  0.5526, train_error: 0.0000
class 0: acc 1.0, correct 1/1
class 1: acc 1.0, correct 1/1
class 2: acc 1.0, correct 1/1
class 3: acc 1.0, correct 3/3

Val Set, val_loss: 1.2171, val_error: 0.8000, auc: 0.7222
class 0 clustering acc 1.0: correct 160/160
class 1 clustering acc 0.0: correct 0/40
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
class 2: acc 0.0, correct 0/2
class 3: acc 0.5, correct 1/2
EarlyStopping counter: 20 out of 20
Early stopping
Val error: 0.4000, ROC AUC: 1.0000
Test error: 0.6000, ROC AUC: 0.4722
class 0: acc 0.0, correct 0/1
class 1: acc None, correct 0/0
Traceback (most recent call last):
  File "/home/weismanal/notebook/2021-11-10/testing_clam/repo/main.py", line 227, in <module>
    results = main(args)
  File "/home/weismanal/notebook/2021-11-10/testing_clam/repo/main.py", line 49, in main
    results, test_auc, val_auc, test_acc, val_acc  = train(datasets, i, args)
  File "/gpfs/gsfs10/users/weismanal/notebook/2021-11-10/testing_clam/repo/utils/core_utils.py", line 212, in train
    writer.add_scalar('final/test_class_{}_acc'.format(i), acc, 0)
  File "/data/weismanal/miniconda3/envs/clam/lib/python3.7/site-packages/tensorboardX/writer.py", line 388, in add_scalar
    scalar(tag, scalar_value), global_step, walltime)
  File "/data/weismanal/miniconda3/envs/clam/lib/python3.7/site-packages/tensorboardX/summary.py", line 139, in scalar
    scalar = make_np(scalar)
  File "/data/weismanal/miniconda3/envs/clam/lib/python3.7/site-packages/tensorboardX/x2num.py", line 34, in make_np
    'Got {}, but expected numpy array or torch tensor.'.format(type(x)))
NotImplementedError: Got <class 'NoneType'>, but expected numpy array or torch tensor.
